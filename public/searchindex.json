{"categories":[{"title":"app","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/app/"},{"title":"lang","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/lang/"},{"title":"math","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/math/"},{"title":"os","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/os/"},{"title":"other","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/other/"},{"title":"robat","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/robat/"}],"posts":[{"content":"å¸¸ç”¨çš„packageåŒ…å®‰è£… matplotlib matlab å›¾å½¢åŒ…\nconda install matplotlib\r numpy Numeric Pythonã€‚ å®ƒæ˜¯ä¸€ä¸ªç”±å¤šç»´æ•°ç»„å¯¹è±¡å’Œç”¨äºå¤„ç†æ•°ç»„çš„ä¾‹ç¨‹é›†åˆç»„æˆçš„åº“ã€‚\nconda install numpy\r SciPy Scientific Pythonã€‚SciPy æ˜¯ä¸€ä¸ªå¼€æºçš„ Python ç®—æ³•åº“å’Œæ•°å­¦å·¥å…·åŒ…ã€‚SciPy åŒ…å«çš„æ¨¡å—æœ‰æœ€ä¼˜åŒ–ã€çº¿æ€§ä»£æ•°ã€ç§¯åˆ†ã€æ’å€¼ã€ç‰¹æ®Šå‡½æ•°ã€å¿«é€Ÿå‚…é‡Œå¶å˜æ¢ã€ä¿¡å·å¤„ç†å’Œå›¾åƒå¤„ç†ã€å¸¸å¾®åˆ†æ–¹ç¨‹æ±‚è§£å’Œå…¶ä»–ç§‘å­¦ä¸å·¥ç¨‹ä¸­å¸¸ç”¨çš„è®¡ç®—ã€‚\nconda install scipy\r pandas Pandas æ˜¯ä¸€ä¸ªå¼€æºçš„ç¬¬ä¸‰æ–¹ Python åº“ï¼Œä» Numpy å’Œ Matplotlib çš„åŸºç¡€ä¸Šæ„å»ºè€Œæ¥ï¼Œäº«æœ‰æ•°æ®åˆ†æâ€œä¸‰å‰‘å®¢ä¹‹ä¸€â€çš„ç››åï¼ˆNumPyã€Matplotlibã€Pandasï¼‰ã€‚Pandas å·²ç»æˆä¸º Python æ•°æ®åˆ†æçš„å¿…å¤‡é«˜çº§å·¥å…·ï¼Œå®ƒçš„ç›®æ ‡æ˜¯æˆä¸ºå¼ºå¤§ã€çµæ´»ã€å¯ä»¥æ”¯æŒä»»ä½•ç¼–ç¨‹è¯­è¨€çš„æ•°æ®åˆ†æå·¥å…·ã€‚\nPandas è¿™ä¸ªåå­—æ¥æºäºé¢æ¿æ•°æ®ï¼ˆPanel Dataï¼‰ä¸æ•°æ®åˆ†æï¼ˆdata analysisï¼‰è¿™ä¸¤ä¸ªåè¯çš„ç»„åˆã€‚\nconda install pandas\r control æ§åˆ¶åŸç†åº“\nconda install -c conda-forge control\r ","id":0,"section":"categories","summary":"å¸¸ç”¨çš„packageåŒ…å®‰è£… matplotlib matlab å›¾å½¢åŒ… conda install matplotlib numpy Numeric Pythonã€‚ å®ƒæ˜¯ä¸€ä¸ªç”±å¤šç»´æ•°ç»„å¯¹è±¡å’Œç”¨äºå¤„ç†æ•°ç»„çš„ä¾‹ç¨‹é›†åˆç»„æˆçš„åº“ã€‚ conda install numpy SciPy Scientific Pythonã€‚","tags":[" python"],"title":"ä¸€äº›å¸¸ç”¨çš„packageåŒ…å®‰è£…","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/lang/python/package/%E4%B8%80%E4%BA%9B%E5%B8%B8%E7%94%A8%E7%9A%84package%E5%8C%85%E5%AE%89%E8%A3%85/","year":"2022"},{"content":"å®‰è£…anaconda 1.ç¯å¢ƒé…ç½® D:\\[Anaconda]\\ D:\\Anaconda\\Scripts D:\\Anaconda\\Library\\bin D:\\Anaconda\\Library\\mingw-w64\\binï¼ˆå¯é€‰ï¼‰\r 2. æ¢æº æ‰“å¼€C:\\Users\\Geton.condarc\nchannels:\r- defaults\rshow_channel_urls: true\rdefault_channels:\r- http://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main\r- http://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/r\r- http://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/msys2\rcustom_channels:\rconda-forge: http://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud\rmsys2: http://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud\rbioconda: http://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud\rmenpo: http://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud\rpytorch: http://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud\rsimpleitk: http://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud\r 3.åˆ›å»ºæ–°çš„è™šæ‹Ÿç¯å¢ƒ conda create -p path python=3.10\r ","id":1,"section":"categories","summary":"å®‰è£…anaconda 1.ç¯å¢ƒé…ç½® D:\\[Anaconda]\\ D:\\Anaconda\\Scripts D:\\Anaconda\\Library\\bin D:\\Anaconda\\Library\\mingw-w64\\binï¼ˆå¯é€‰ï¼‰ 2. æ¢æº æ‰“å¼€C:\\Users\\","tags":[" python"],"title":"å¦‚ä½•å®‰è£…anaconda","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/lang/python/anaconda/%E5%A6%82%E4%BD%95%E5%AE%89%E8%A3%85anaconda/","year":"2022"},{"content":".vscodeçš„é…ç½® c_cpp_properties.json ctrl+shift+p ,è¿è¡ŒC/Cpp: Edit configurations...\n{\r\u0026quot;configurations\u0026quot;: [\r{\r\u0026quot;name\u0026quot;: \u0026quot;linux\u0026quot;,\r\u0026quot;includePath\u0026quot;: [\r\u0026quot;/opt/ros/melodic/include\u0026quot;,\r\u0026quot;/usr/include\u0026quot;,\r\u0026quot;${workspaceFolder}/**\u0026quot;,\r\u0026quot;${workspaceFolder}/devel/include\u0026quot;\r],\r\u0026quot;intelliSenseMode\u0026quot;: \u0026quot;linux-gcc-x64\u0026quot;,\r\u0026quot;compilerPath\u0026quot;: \u0026quot;/usr/bin/gcc\u0026quot;,\r\u0026quot;cppStandard\u0026quot;: \u0026quot;c++17\u0026quot;,\r\u0026quot;cStandard\u0026quot;: \u0026quot;c17\u0026quot;\r}\r],\r\u0026quot;version\u0026quot;: 4\r}\r tasks.json ctrl+shift+p ,è¿è¡Œtask\n{\r// See https://go.microsoft.com/fwlink/?LinkId=733558\r// for the documentation about the tasks.json format\r\u0026quot;version\u0026quot;: \u0026quot;2.0.0\u0026quot;,\r\u0026quot;tasks\u0026quot;: [\r/*1. mkdir build*/\r{\r\u0026quot;label\u0026quot;: \u0026quot;mkdir build\u0026quot;,\r\u0026quot;type\u0026quot;: \u0026quot;shell\u0026quot;,\r\u0026quot;command\u0026quot;: \u0026quot;mkdir\u0026quot;,\r\u0026quot;args\u0026quot;: [\r\u0026quot;-p\u0026quot;,\r\u0026quot;build\u0026quot;\r],\r\u0026quot;options\u0026quot;: {\u0026quot;cwd\u0026quot;: \u0026quot;${workspaceFolder}\u0026quot;},\r\u0026quot;group\u0026quot;: \u0026quot;build\u0026quot;,\r},\r/*2. cmake ..*/\r{\r\u0026quot;label\u0026quot;: \u0026quot;cmake ..\u0026quot;,\r\u0026quot;type\u0026quot;: \u0026quot;shell\u0026quot;,\r\u0026quot;command\u0026quot;: \u0026quot;cmake\u0026quot;,\r\u0026quot;args\u0026quot;: [\r\u0026quot;..\u0026quot;\r],\r\u0026quot;options\u0026quot;: {\r\u0026quot;cwd\u0026quot;: \u0026quot;${workspaceFolder}/build\u0026quot;,\r},\r\u0026quot;group\u0026quot;: \u0026quot;build\u0026quot;,\r\u0026quot;dependsOn\u0026quot;:[\r\u0026quot;mkdir build\u0026quot;,//è¡¨ç¤ºåœ¨\u0026quot;åˆ›å»ºbuild\u0026quot;ä»»åŠ¡ç»“æŸåè¿›è¡Œ\r]\r},\r/*3. make */\r{\r\u0026quot;label\u0026quot;: \u0026quot;make\u0026quot;,\r\u0026quot;type\u0026quot;: \u0026quot;shell\u0026quot;,\r\u0026quot;command\u0026quot;: \u0026quot;make\u0026quot;,\r\u0026quot;args\u0026quot;: [\r\u0026quot;\u0026quot;\r],\r\u0026quot;group\u0026quot;: \u0026quot;build\u0026quot;,\r\u0026quot;dependsOn\u0026quot;:[\r\u0026quot;cmake ..\u0026quot;,//è¡¨ç¤ºåœ¨\u0026quot;åˆ›å»ºbuild\u0026quot;ä»»åŠ¡ç»“æŸåè¿›è¡Œ\r],\r\u0026quot;presentation\u0026quot;: {//é…ç½®ç”¨äºæ˜¾ç¤ºä»»åŠ¡è¾“å‡ºå¹¶è¯»å–å…¶è¾“å…¥çš„é¢æ¿\r\u0026quot;echo\u0026quot;: true,\r\u0026quot;reveal\u0026quot;: \u0026quot;never\u0026quot;,\r\u0026quot;focus\u0026quot;: false,\r\u0026quot;panel\u0026quot;: \u0026quot;shared\u0026quot;,\r\u0026quot;showReuseMessage\u0026quot;: true,\r\u0026quot;clear\u0026quot;: false\r},\r\u0026quot;options\u0026quot;: {\u0026quot;cwd\u0026quot;: \u0026quot;${workspaceFolder}/build\u0026quot;},\r}\r]\r}\r é¢„å®šä¹‰å˜é‡åå­—\n${workspaceFolder} - å½“å‰å·¥ä½œç›®å½•(æ ¹ç›®å½•)\r${workspaceFolderBasename} - å½“å‰æ–‡ä»¶çš„çˆ¶ç›®å½•\r${file} - å½“å‰æ‰“å¼€çš„æ–‡ä»¶å(å®Œæ•´è·¯å¾„)\r${relativeFile} - å½“å‰æ ¹ç›®å½•åˆ°å½“å‰æ‰“å¼€æ–‡ä»¶çš„ç›¸å¯¹è·¯å¾„(åŒ…æ‹¬æ–‡ä»¶å)\r${relativeFileDirname} - å½“å‰æ ¹ç›®å½•åˆ°å½“å‰æ‰“å¼€æ–‡ä»¶çš„ç›¸å¯¹è·¯å¾„(ä¸åŒ…æ‹¬æ–‡ä»¶å)\r${fileBasename} - å½“å‰æ‰“å¼€çš„æ–‡ä»¶å(åŒ…æ‹¬æ‰©å±•å)\r${fileBasenameNoExtension} - å½“å‰æ‰“å¼€çš„æ–‡ä»¶å(ä¸åŒ…æ‹¬æ‰©å±•å)\r${fileDirname} - å½“å‰æ‰“å¼€æ–‡ä»¶çš„ç›®å½•\r${fileExtname} - å½“å‰æ‰“å¼€æ–‡ä»¶çš„æ‰©å±•å\r${cwd} - å¯åŠ¨æ—¶taskå·¥ä½œçš„ç›®å½•\r${lineNumber} - å½“å‰æ¿€æ´»æ–‡ä»¶æ‰€é€‰è¡Œ\r${selectedText} - å½“å‰æ¿€æ´»æ–‡ä»¶ä¸­æ‰€é€‰æ‹©çš„æ–‡æœ¬\r${execPath} - vscodeæ‰§è¡Œæ–‡ä»¶æ‰€åœ¨çš„ç›®å½•\r${defaultBuildTask} - é»˜è®¤ç¼–è¯‘ä»»åŠ¡(build task)çš„åå­—\r ","id":2,"section":"categories","summary":".vscodeçš„é…ç½® c_cpp_properties.json ctrl+shift+p ,è¿è¡ŒC/Cpp: Edit configurations... { \u0026quot;configurations\u0026quot;: [ { \u0026quot;name\u0026quot;: \u0026quot;linux\u0026quot;, \u0026quot;includePath\u0026quot;: [ \u0026quot;/opt/ros/melodic/include\u0026quot;, \u0026quot;/usr/include\u0026quot;, \u0026quot;${workspaceFolder}/**\u0026quot;, \u0026quot;${workspaceFolder}/devel/include\u0026quot; ], \u0026quot;intelliSenseMode\u0026quot;: \u0026quot;linux-gcc-x64\u0026quot;, \u0026quot;compilerPath\u0026quot;: \u0026quot;/usr/bin/gcc\u0026quot;, \u0026quot;cppStandard\u0026quot;: \u0026quot;c++17\u0026quot;, \u0026quot;cStandard\u0026quot;: \u0026quot;c17\u0026quot; } ], \u0026quot;version\u0026quot;: 4 } tasks.json ctrl+shift+p ,è¿è¡Œtask { // See https://go.microsoft.com/fwlink/?LinkId=733558 // for the documentation about the tasks.json format","tags":[" vscode"],"title":"Vscodeçš„c_cppé…ç½®","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/app/vscode/vscode%E7%9A%84c_cpp%E9%85%8D%E7%BD%AE/","year":"2022"},{"content":"é…ç½®vscode å¤´æ–‡ä»¶æ™ºèƒ½æç¤º  è¿›å…¥c/c++æ’ä»¶   é…ç½®å¤´æ–‡ä»¶è·¯å¾„\n\r  rosä¸­æ–‡ä¹±ç é—®é¢˜ setlocale(LC_ALL,\u0026quot;\u0026quot;);\r c_cpp_properties.json {\r\u0026quot;configurations\u0026quot;: [\r{\r\u0026quot;name\u0026quot;: \u0026quot;linux\u0026quot;,\r\u0026quot;includePath\u0026quot;: [\r\u0026quot;/opt/ros/melodic/include\u0026quot;,\r\u0026quot;/usr/include\u0026quot;,\r\u0026quot;${workspaceFolder}/**\u0026quot;,\r\u0026quot;${workspaceFolder}/devel/include\u0026quot;\r],\r\u0026quot;intelliSenseMode\u0026quot;: \u0026quot;linux-gcc-x64\u0026quot;,\r\u0026quot;compilerPath\u0026quot;: \u0026quot;/usr/bin/gcc\u0026quot;,\r\u0026quot;cppStandard\u0026quot;: \u0026quot;c++17\u0026quot;,\r\u0026quot;cStandard\u0026quot;: \u0026quot;c17\u0026quot;\r}\r],\r\u0026quot;version\u0026quot;: 4\r}\r ","id":3,"section":"categories","summary":"é…ç½®vscode å¤´æ–‡ä»¶æ™ºèƒ½æç¤º è¿›å…¥c/c++æ’ä»¶ é…ç½®å¤´æ–‡ä»¶è·¯å¾„ rosä¸­æ–‡ä¹±ç é—®é¢˜ setlocale(LC_ALL,\u0026quot;\u0026quot;); c_cpp_properties.json { \u0026quot;configurations\u0026quot;: [ { \u0026quot;name\u0026quot;: \u0026quot;linux\u0026quot;, \u0026quot;includePath\u0026quot;: [ \u0026quot;/opt/ros/melodic/include\u0026quot;, \u0026quot;/usr/include\u0026quot;, \u0026quot;${workspaceFolder}/**\u0026quot;, \u0026quot;${workspaceFolder}/devel/include\u0026quot; ], \u0026quot;intelliSenseMode\u0026quot;: \u0026quot;linux-gcc-x64\u0026quot;, \u0026quot;compilerPath\u0026quot;: \u0026quot;/usr/bin/gcc\u0026quot;, \u0026quot;cppStandard\u0026quot;: \u0026quot;c++17\u0026quot;, \u0026quot;cStandard\u0026quot;: \u0026quot;c17\u0026quot; } ], \u0026quot;version\u0026quot;: 4 }","tags":[" ros"],"title":"8_vscodeé€‚é…","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/os/ros/8_vscode%E9%80%82%E9%85%8D/","year":"2022"},{"content":"gitflow å‚è€ƒæ–‡æ¡£ï¼š\nå›¾è§£git flowå¼€å‘æµç¨‹ - çŸ¥ä¹ (zhihu.com)\n\r","id":4,"section":"categories","summary":"gitflow å‚è€ƒæ–‡æ¡£ï¼š å›¾è§£git flowå¼€å‘æµç¨‹ - çŸ¥ä¹ (zhihu.com)","tags":[" git"],"title":"Gitflow","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/app/git/gitflow/","year":"2022"},{"content":"dockerå¸¸ç”¨å‘½ä»¤ 1.å‘½ä»¤å›¾ 2.docker runæµç¨‹ 3.docker å‘½ä»¤ 3.1 å¸®åŠ©å‘½ä»¤ sudo docker version #æ˜¾ç¤ºdockerç‰ˆæœ¬ä¿¡æ¯\rsudo docker info #æ˜¾ç¤ºdockerç³»ç»Ÿä¿¡æ¯ï¼ŒåŒ…æ‹¬é•œåƒå’Œå®¹å™¨çš„æ•°é‡\rdocker å‘½ä»¤ --help\r 3.2 é•œåƒå‘½ä»¤   æŸ¥çœ‹æ‰€æœ‰é•œåƒ sudo docker images -a\r   æœç´¢é•œåƒ //æœç´¢starsæ•°é‡å¤§äº500çš„é•œåƒ\rsudo docker search [é•œåƒå] --filter=STARS=500\r   ä¸‹è½½é•œåƒ sudo docker pull [é•œåƒå]\rsudo docker pull [é•œåƒå]:[ç‰ˆæœ¬å]\r   åˆ é™¤é•œåƒ sudo docker rmi -f [é•œåƒID]\r   3.3 å®¹å™¨å‘½ä»¤   æ–°å»ºå®¹å™¨å¹¶å¯åŠ¨ sudo docker run [å¯é€‰å‚æ•°] [é•œåƒå]\r#å‚æ•°è¯´æ˜\r--name='name' å®¹å™¨çš„åå­—\r-d\tåå°äº¤äº’è¿è¡Œ\r-it ä½¿ç”¨äº¤äº’æ–¹å¼è¿è¡Œï¼Œè¿›å…¥å®¹å™¨æŸ¥çœ‹å†…å®¹\r-P\tæŒ‡å®šå®¹å™¨çš„ç«¯å£ -P 8080:8080\r-p\téšæœºæŒ‡å®šç«¯å£\r//å¯åŠ¨å¹¶è¿›å…¥å®¹å™¨\rsudo docker run -it [é•œåƒå] /bin/bash\r//é€€å‡ºå®¹å™¨\rexit #ç›´æ¥å®¹å™¨åœæ­¢å¹¶é€€å‡º\rctrl+p+q #å®¹å™¨ä¸åœæ­¢ï¼Œé€€å‡º\r   åˆ—å‡ºå®¹å™¨ //åˆ—å‡ºæ‰€æœ‰æ­£åœ¨è¿è¡Œä¸­çš„å®¹å™¨\rsudo docker ps\r//åˆ—å‡ºæ‰€æœ‰æ­£åœ¨è¿è¡Œä¸­çš„å®¹å™¨+å†å²è®°å½•\rsudo docker ps -a\r//åˆ—å‡ºæœ€è¿‘åˆ›å»ºçš„å‰numberä¸ªçš„å®¹å™¨\rsudo docker ps -a -n=number\r   åˆ é™¤å®¹å™¨ //åˆ é™¤åœæ­¢è¿è¡Œçš„å®¹å™¨\rsudo docker rm [å®¹å™¨id]\r//åˆ é™¤æ­£åœ¨è¿è¡Œçš„å®¹å™¨\rsudo docker rm -f [å®¹å™¨id]\r//åˆ é™¤æ‰€æœ‰å®¹å™¨\rsudo docker rm -f $(docker ps -aq)\r   å¯åŠ¨å’Œåœæ­¢å®¹å™¨ //å¯åŠ¨å®¹å™¨\rsudo docker start [å®¹å™¨ID]\r//é‡å¯å®¹å™¨\rsudo docker restart [å®¹å™¨ID]\r//åœæ­¢å½“å‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨\rsudo docker stop [å®¹å™¨ID]\r//å¼ºåˆ¶åœæ­¢å®¹å™¨\rsudo docker kill [å®¹å™¨ID]\r   3.4 å¸¸ç”¨çš„å…¶ä»–å‘½ä»¤ æ—¥å¿—ä¿¡æ¯ sudo docker logs [å®¹å™¨ID ]\r å®¹å™¨è¿›ç¨‹ä¿¡æ¯ sudo docker top [å®¹å™¨ID ]\r å®¹å™¨å…ƒæ•°æ® sudo docker inspect [å®¹å™¨ID]  è¿›å…¥æ­£åœ¨è¿è¡Œçš„å®¹å™¨ //è¿›å…¥å®¹å™¨åå¼€å¯ä¸€ä¸ªæ–°çš„ç»ˆç«¯\rsudo docker exec -it [å®¹å™¨ID] /bin/bash\r//è¿›å…¥å®¹å™¨æ‰§è¡Œçš„å½“å‰ç»ˆç«¯\rsudo docker attach [å®¹å™¨ID]  copy[å®¹å™¨æ–‡ä»¶copyåˆ°linuxç³»ç»Ÿ] sudo docker cp [å®¹å™¨ID]:/home/chao/demo.txt /home/chao\r ","id":5,"section":"categories","summary":"dockerå¸¸ç”¨å‘½ä»¤ 1.å‘½ä»¤å›¾ 2.docker runæµç¨‹ 3.docker å‘½ä»¤ 3.1 å¸®åŠ©å‘½ä»¤ sudo docker version #æ˜¾ç¤ºdockerç‰ˆæœ¬ä¿¡æ¯ sudo docker info #æ˜¾ç¤ºdockerç³»ç»Ÿä¿¡æ¯ï¼ŒåŒ…æ‹¬é•œåƒå’Œå®¹å™¨çš„","tags":[" docker"],"title":"Dockerå¸¸ç”¨å‘½ä»¤","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/app/docker/docker%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/","year":"2022"},{"content":"gitå¸¸ç”¨æŒ‡ä»¤ git æµç¨‹å›¾ gitæŒ‡ä»¤ 1 åˆ†æ”¯æ“ä½œ 1æŸ¥çœ‹ //æŸ¥çœ‹æœ¬åœ°æ‰€æœ‰åˆ†æ”¯ git branch //æŸ¥çœ‹è¿œç¨‹æ‰€æœ‰åˆ†æ”¯\rgit branch -r //æŸ¥çœ‹æœ¬åœ°å’Œè¿œç¨‹çš„æ‰€æœ‰åˆ†æ”¯\rgit branch -a 2æ–°å»º\r//æ–°å»ºåˆ†æ”¯\rgit branch æœ¬åœ°åˆ†æ”¯å\r//æ–°å»ºä¸€ä¸ªæœ¬åœ°åˆ†æ”¯å¹¶åˆ‡æ¢åˆ°è¯¥åˆ†æ”¯\rgit checkout -b æœ¬åœ°åˆ†æ”¯å\r3åˆ é™¤\r//åˆ é™¤æœ¬åœ°åˆ†æ”¯\rgit branch -d \u0026lt;branchname\u0026gt; //åˆ é™¤è¿œç¨‹åˆ†æ”¯\rgit push origin :XXX 4é‡å‘½å\r//é‡å‘½åæœ¬åœ°åˆ†æ”¯\rgit branch -m \u0026lt;oldbranch\u0026gt; \u0026lt;newbranch\u0026gt; 5å…³è”è¿œç¨‹\r//æœ¬åœ°åˆ†æ”¯ä¸è¿œç¨‹åˆ†æ”¯å»ºç«‹å…³è”\rgit branch -u origin/åˆ†æ”¯å git branch --set-upstream-to=origin/sit-basic-v1.0.1\r//æ’¤é”€æœ¬åœ°åˆ†æ”¯ä¸è¿œç¨‹åˆ†æ”¯çš„å…³ç³»\rgit branch --unset-upstream\r//æŸ¥çœ‹æœ¬åœ°åˆ†æ”¯ä¸è¿œç¨‹åˆ†æ”¯çš„æ˜ å°„å…³ç³»\rgit branch -vv\r6åˆå¹¶åˆ†æ”¯\r//åˆ‡æ¢åˆ°masteråˆ†æ”¯\rgit checkout master\r//å°†developåˆ†æ”¯åˆå¹¶åˆ°masteråˆ†æ”¯\rgit merge develop\r 2 fetch+mergeæ“ä½œ //æ‹‰å–è¿œç¨‹åˆ†æ”¯\rgit fetch origin\rgit fetch origin master\r//å†²çªæŸ¥çœ‹\rgit log -p FETCH_HEAD\r//å°†æ‹‰å–ä¸‹æ¥çš„æœ€æ–°å†…å®¹åˆå¹¶åˆ°å½“å‰æ‰€åœ¨çš„åˆ†æ”¯ä¸­\rgit merge FETCH_HEAD git merge [è¿œç¨‹ä¸»æœºå]/[branch] --allow-unrelated-histories\r 3 pushæ“ä½œ git push \u0026lt;è¿œç¨‹ä¸»æœºå\u0026gt; \u0026lt;è¿œç¨‹åˆ†æ”¯å\u0026gt;:\u0026lt;æœ¬åœ°åˆ†æ”¯å\u0026gt;\r 4 remoteæ“ä½œ 1.æŸ¥çœ‹å½“å‰ä»“åº“\rgit remote -v\r2.æ–°å¢è¿œç¨‹ä»“åº“\rgit remote add [name] [url]\r3.åˆ é™¤è¿œç¨‹ä»“åº“\rgit remote remove [name]\r4.ä¿®æ”¹è¿œç«¯ä»“åº“åœ°å€\rgit remote set-url [have_a_name] [url]\r5.ä¿®æ”¹è¿œç«¯ä»“åº“åå­—\rgit remote rename \u0026lt;old_name\u0026gt; \u0026lt;new_name\u0026gt;\r6.åŒæ­¥æœ¬åœ°ä»“åº“ä¸è¿œç¨‹ä»“åº“çš„åˆ†æ”¯\r//åœºæ™¯ï¼šæœ‰äº›åˆ†æ”¯åœ¨è¿œç¨‹å…¶å®æ—©å°±è¢«åˆ é™¤äº†ï¼Œä½†æ˜¯åœ¨ä½ æœ¬åœ°ä¾ç„¶å¯ä»¥çœ‹è§è¿™äº›è¢«åˆ é™¤çš„åˆ†æ”¯\rgit remote prune [è¿œç¨‹ä»“åº“å]\r ","id":6,"section":"categories","summary":"gitå¸¸ç”¨æŒ‡ä»¤ git æµç¨‹å›¾ gitæŒ‡ä»¤ 1 åˆ†æ”¯æ“ä½œ 1æŸ¥çœ‹ //æŸ¥çœ‹æœ¬åœ°æ‰€æœ‰åˆ†æ”¯ git branch //æŸ¥çœ‹è¿œç¨‹æ‰€æœ‰åˆ†æ”¯ git branch -r //æŸ¥çœ‹æœ¬åœ°å’Œè¿œç¨‹çš„æ‰€æœ‰åˆ†æ”¯ git branch -a 2æ–°å»º /","tags":[" git"],"title":"Gitå¸¸ç”¨å‘½ä»¤","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/app/git/git%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/","year":"2022"},{"content":"dockerå®‰è£… Docker å®˜æ–¹æ–‡æ¡£ | Docker Documentation\n1. windowå®‰è£… éœ€è¦å®‰è£…wsl2\n 2. linux 2.1. ubuntuå®‰è£… 1.ç³»ç»Ÿéœ€æ±‚\n Ubuntu Jammy 22.04 (LTS) Ubuntu Impish 21.10 Ubuntu Focal 20.04 (LTS) Ubuntu Bionic 18.04 (LTS)  Docker Engine is supported on x86_64 (or amd64), armhf, arm64, and s390x architectures.\n2.å¸è½½æ—§ç‰ˆæœ¬\nsudo apt-get remove docker docker-engine docker.io containerd runc\r 3.ä½¿ç”¨ä»“åº“å®‰è£…(ä¹Ÿå¯ä»¥ä½¿ç”¨äºŒè¿›åˆ¶åŒ…å®‰è£…)\nsudo apt-get update\rsudo apt-get install \\\rca-certificates \\\rcurl \\\rgnupg \\\rlsb-release\r 4.æ·»åŠ  GPG key\ncurl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg\r 5.æ·»åŠ dockeræº\necho \\\r\u0026quot;deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/ubuntu \\\r$(lsb_release -cs) stable\u0026quot; | sudo tee /etc/apt/sources.list.d/docker.list \u0026gt; /dev/null\r å®‰è£… Docker Engine  #å®‰è£…æœ€æ–°docker\rsudo apt-get update\rsudo apt-get install docker-ce docker-ce-cli containerd.io docker-compose-plugin\r#å®‰è£…æŒ‡å®šç‰ˆæœ¬\rapt-cache madison docker-ce\rudo apt-get install docker-ce=\u0026lt;VERSION_STRING\u0026gt; docker-ce-cli=\u0026lt;VERSION_STRING\u0026gt; containerd.io docker-compose-plugin\r 7.æµ‹è¯•\ndocker version\rsudo docker run hello-world\r 8.å¸è½½ Docker EngineğŸ”—\n//1.Uninstall the Docker Engine, CLI, Containerd, and Docker Compose packages:\rsudo apt-get purge docker-ce docker-ce-cli containerd.io docker-compose-plugin\r//2.Images, containers, volumes, or customized configuration files on your host are not automatically removed. To delete all images, containers, and volumes:\rsudo rm -rf /var/lib/docker\rsudo rm -rf /var/lib/containerd\r 3.dockeråŠ é€Ÿ è½»é‡åº”ç”¨æœåŠ¡å™¨ å®‰è£… Docker å¹¶é…ç½®é•œåƒåŠ é€Ÿæº-æœ€ä½³å®è·µ-æ–‡æ¡£ä¸­å¿ƒ-è…¾è®¯äº‘-è…¾è®¯äº‘ (tencent.com)\n","id":7,"section":"categories","summary":"dockerå®‰è£… Docker å®˜æ–¹æ–‡æ¡£ | Docker Documentation 1. windowå®‰è£… éœ€è¦å®‰è£…wsl2 2. linux 2.1. ubuntuå®‰è£… 1.ç³»ç»Ÿéœ€æ±‚ Ubuntu Jammy 22.04 (LTS) Ubuntu Impish 21.10 Ubuntu Focal 20.04 (LTS) Ubuntu Bionic 18.04 (LTS) Docker Engine is supported on","tags":[" docker"],"title":"Dockerå®‰è£…","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/app/docker/docker%E5%AE%89%E8%A3%85/","year":"2022"},{"content":"ç¦»çº¿ä½¿ç”¨remote ssh å‚è€ƒé“¾æ¥\nVS Code Serverçš„ç¦»çº¿å®‰è£…è¿‡ç¨‹ - çŸ¥ä¹ (zhihu.com)\n.vscode-server å‡†å¤‡å·¥ä½œ ä¸‹è½½å®‰è£…åŒ… 1 ç¡®å®švscodeçš„commit id\nç‚¹å‡»å¸®åŠ©\u0026ndash;\u0026gt;å…³äº\n2 è§‚å¯Ÿå¹¶è®°å½•commit id å·\nç‰ˆæœ¬: 1.67.0 (system setup) æäº¤: 57fd6d0195bb9b9d1b49f6da5db789060795de47 æ—¥æœŸ: 2022-05-04T12:06:02.889Z Electron: 17.4.1 Chromium: 98.0.4758.141 Node.js: 16.13.0 V8: 9.8.177.13-electron.0 OS: Windows_NT x64 10.0.19044\n3 ä¸‹è½½è¿œç¨‹è¿æ¥æœºå™¨çš„å®‰è£…åŒ…\nç”¨2ä¸­çš„å†…å®¹æ›¿æ¢${commit id}\r#arm64\rhttps://update.code.visualstudio.com/commit:${commit id}/server-linux-arm64/stable\r#x64\rhttps://update.code.visualstudio.com/commit:${commit id}/server-linux-x64/stable\r#armhf\rhttps://update.code.visualstudio.com/commit:${commit id}/server-linux-armhf/stable\r å®‰è£…å·¥ä½œ 1 è¿›å…¥è¦è¿æ¥çš„æœºå™¨ä¸Šï¼Œåˆ›å»ºæ–‡ä»¶å¤¹\nmkdir -p $HOME/.vscode-server/bin\r 2 å°†ä¸‹è½½åŒ…æ‹·è´è¿›$HOME/.vscode-server/binç›®å½•ä¸‹\n3 è§£å‹\ncd $HOME/.vscode-server/bin\rtar -zxvf vscode-server-linux-armhf.tar.gz\rrm -rf vscode-server-linux-armhf.tar.gz\r 4 é‡å‘½å\nmv vscode-server-linux-armhf ${commit id}\ræ›¿æ¢ä¸ºå…·ä½“çš„id\rmv vscode-server-linux-armhf 57fd6d0195bb9b9d1b49f6da5db789060795de47\r 5 æ”¹æƒé™\ncd $HOME/.vscode-server/bin\rchmod -R 775 ${commit id}\rå³\rchmod -R 775 57fd6d0195bb9b9d1b49f6da5db789060795de47\r 6 è¿æ¥\nä½¿ç”¨vscodeè¿œç¨‹è¿æ¥\nother å¦‚æœéœ€è¦æ’ä»¶ï¼Œæ‰¾åˆ°ä¸€ä¸ªç±»ä¼¼çš„æœºå™¨ï¼Œåœ¨ä¸Šé¢è”ç½‘å®‰è£…ï¼Œå®‰è£…åçš„æ’ä»¶åœ¨$HOME/.vscode-server/extensionsä¸‹ï¼Œç›´æ¥æ‰“åŒ…æ‹·è´åˆ°ç¦»çº¿æœºå™¨äººç›¸åŒç›®å½•å°±å¯ä»¥äº†ã€‚\nç”¨winä¸Šçš„æ‹·è´ä¹Ÿå¯ä»¥\n","id":8,"section":"categories","summary":"ç¦»çº¿ä½¿ç”¨remote ssh å‚è€ƒé“¾æ¥ VS Code Serverçš„ç¦»çº¿å®‰è£…è¿‡ç¨‹ - çŸ¥ä¹ (zhihu.com) .vscode-server å‡†å¤‡å·¥ä½œ ä¸‹è½½å®‰è£…åŒ… 1 ç¡®å®švscodeçš„commit id ç‚¹å‡»å¸®åŠ©\u0026ndas","tags":[" vscode"],"title":"ç¦»çº¿ä½¿ç”¨remote ssh","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/app/vscode/%E7%A6%BB%E7%BA%BF%E4%BD%BF%E7%94%A8remote-ssh/","year":"2022"},{"content":"MountæŒ‚è½½ mountç½‘ç»œæŒ‚è½½ 1 win10ä¸Šæ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ ä¿®æ”¹å±æ€§ï¼Œè®¾ç½®å…±äº«\nå¦‚æœä¸ç¡®å®šwin10çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œå°±æ–°å»ºä¸€ä¸ªæœ¬åœ°ç”¨æˆ·\n2 linuxæŒ‚è½½å‘½ä»¤ æŸ¥çœ‹å½“å‰linuxç”¨æˆ·id\nid  æŒ‚è½½\nsudo mount -t cifs -o username=chao2,password=88888888zc! -o rw,uid=1000,gid=1000 //192.168.209.1/shrae_file /home/chao/Desktop/mountpoint\r 3 other windowsçš„cifsçš„ç«¯å£æ˜¯445\nç«¯å£æ˜ å°„\ræ ‘è“æ´¾(è½¦ä½“æ§åˆ¶)\rsudo iptables -t nat -I PREROUTING -p tcp --dport 445 -j DNAT --to-destination 192.168.8.50:445\rsudo iptables -t nat -I POSTROUTING -p tcp -d 192.168.8.50/24 --dport 445 -j SNAT --to-source 192.168.8.101\rros(å¯¼èˆª)\rsudo mount -t cifs -o username=chao2,password=88888888zc! -o rw,uid=1000,gid=1000 //192.168.20.3/shrae_file /home/ubuntu/mount\r ","id":9,"section":"categories","summary":"MountæŒ‚è½½ mountç½‘ç»œæŒ‚è½½ 1 win10ä¸Šæ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ ä¿®æ”¹å±æ€§ï¼Œè®¾ç½®å…±äº« å¦‚æœä¸ç¡®å®šwin10çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œå°±æ–°å»ºä¸€ä¸ªæœ¬åœ°ç”¨æˆ· 2 lin","tags":["linux"," tool"],"title":"MountæŒ‚è½½","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/os/linux/tool/mount%E6%8C%82%E8%BD%BD/","year":"2022"},{"content":"netfilter ç›¸å…³ç½‘å€ å®˜ç½‘ï¼šnetfilter/iptables project homepage\niptablesåŸºç¡€çŸ¥è¯†è¯¦è§£_LarryHai6çš„åšå®¢-CSDNåšå®¢_iptables\nä½¿ç”¨iptablesè¿›è¡Œç«¯å£è½¬å‘ - äº‘+ç¤¾åŒº - è…¾è®¯äº‘ (tencent.com)\nåŸç†å›¾ iptables 1. åŸç†å™è¿° iptableså…·æœ‰Filter, NAT, Mangle, Rawå››ç§å†…å»ºè¡¨ï¼š\n1. Filterè¡¨\nFilterè¡¨ç¤ºiptablesçš„é»˜è®¤è¡¨ï¼Œå› æ­¤å¦‚æœä½ æ²¡æœ‰è‡ªå®šä¹‰è¡¨ï¼Œé‚£ä¹ˆå°±é»˜è®¤ä½¿ç”¨filterè¡¨ï¼Œå®ƒå…·æœ‰ä»¥ä¸‹ä¸‰ç§å†…å»ºé“¾ï¼š\n INPUTé“¾ â€“ å¤„ç†æ¥è‡ªå¤–éƒ¨çš„æ•°æ®ã€‚ OUTPUTé“¾ â€“ å¤„ç†å‘å¤–å‘é€çš„æ•°æ®ã€‚ FORWARDé“¾ â€“ å°†æ•°æ®è½¬å‘åˆ°æœ¬æœºçš„å…¶ä»–ç½‘å¡è®¾å¤‡ä¸Šã€‚  2. NATè¡¨\nNATè¡¨æœ‰ä¸‰ç§å†…å»ºé“¾ï¼š\n PREROUTINGé“¾ â€“ å¤„ç†åˆšåˆ°è¾¾æœ¬æœºå¹¶åœ¨è·¯ç”±è½¬å‘å‰çš„æ•°æ®åŒ…ã€‚å®ƒä¼šè½¬æ¢æ•°æ®åŒ…ä¸­çš„ç›®æ ‡IPåœ°å€ï¼ˆdestination ip addressï¼‰ï¼Œé€šå¸¸ç”¨äºDNAT(destination NAT)ã€‚ POSTROUTINGé“¾ â€“ å¤„ç†å³å°†ç¦»å¼€æœ¬æœºçš„æ•°æ®åŒ…ã€‚å®ƒä¼šè½¬æ¢æ•°æ®åŒ…ä¸­çš„æºIPåœ°å€ï¼ˆsource ip addressï¼‰ï¼Œé€šå¸¸ç”¨äºSNATï¼ˆsource NATï¼‰ã€‚ OUTPUTé“¾ â€“ å¤„ç†æœ¬æœºäº§ç”Ÿçš„æ•°æ®åŒ…ã€‚  3. Mangleè¡¨\nMangleè¡¨ç”¨äºæŒ‡å®šå¦‚ä½•å¤„ç†æ•°æ®åŒ…ã€‚å®ƒèƒ½æ”¹å˜TCPå¤´ä¸­çš„QoSä½ã€‚Mangleè¡¨å…·æœ‰5ä¸ªå†…å»ºé“¾ï¼š\n PREROUTING OUTPUT FORWARD INPUT POSTROUTING  4. Rawè¡¨\nRawè¡¨ç”¨äºå¤„ç†å¼‚å¸¸ï¼Œå®ƒå…·æœ‰2ä¸ªå†…å»ºé“¾ï¼š\n PREROUTING chain OUTPUT chain  2. å‘½ä»¤ä½¿ç”¨ æ˜¾ç¤ºè¡¨å†…å®¹\nsudo iptables -t filter â€“L   num â€“ æŒ‡å®šé“¾ä¸­çš„è§„åˆ™ç¼–å· target â€“ å‰é¢æåˆ°çš„targetçš„ç‰¹æ®Šå€¼  ACCEPT â€“ å…è®¸é˜²ç«å¢™æ¥æ”¶æ•°æ®åŒ… DROP â€“ é˜²ç«å¢™ä¸¢å¼ƒåŒ… QUEUE â€“ é˜²ç«å¢™å°†æ•°æ®åŒ…ç§»äº¤åˆ°ç”¨æˆ·ç©ºé—´ RETURN â€“ é˜²ç«å¢™åœæ­¢æ‰§è¡Œå½“å‰é“¾ä¸­çš„åç»­Rulesï¼Œå¹¶è¿”å›åˆ°è°ƒç”¨é“¾(the calling chain)ä¸­ã€‚   prot â€“ åè®®ï¼štcp, udp, icmpç­‰ source â€“ æ•°æ®åŒ…çš„æºIPåœ°å€ destination â€“ æ•°æ®åŒ…çš„ç›®æ ‡IPåœ°å€  æ¸…ç©ºè¡¨\niptables -t NAT -F\r æ·»åŠ è§„åˆ™\niptables -t è¡¨å \u0026lt;-A/I/D/R\u0026gt; è§„åˆ™é“¾å [è§„åˆ™å·] \u0026lt;-i/o ç½‘å¡å\u0026gt; -p åè®®å \u0026lt;-s æºIP/æºå­ç½‘\u0026gt; --sport æºç«¯å£ \u0026lt;-d ç›®æ ‡IP/ç›®æ ‡å­ç½‘\u0026gt; --dport ç›®æ ‡ç«¯å£ -j åŠ¨ä½œ\r 3. ç‰¹å®šåœºæ™¯ ç«¯å£æ˜ å°„ sudo nano /etc/sysctl.conf\rnet.ipv4.ip_forward=0 æ”¹ä¸º net.ipv4.ip_forward=1\rç”Ÿæ•ˆ\rsudo sysctl -p\r æ·»åŠ è§„åˆ™\niptables -t nat -A PREROUTING -p tcp --dport [ç«¯å£å·] -j DNAT --to-destination [ç›®æ ‡IP]\riptables -t nat -A PREROUTING -p udp --dport [ç«¯å£å·] -j DNAT --to-destination [ç›®æ ‡IP]\riptables -t nat -A POSTROUTING -p tcp -d [ç›®æ ‡IP] --dport [ç«¯å£å·] -j SNAT --to-source [æœ¬åœ°æœåŠ¡å™¨IP]\riptables -t nat -A POSTROUTING -p udp -d [ç›®æ ‡IP] --dport [ç«¯å£å·] -j SNAT --to-source [æœ¬åœ°æœåŠ¡å™¨IP]\rå°†æœ¬åœ°(å†…ç½‘:192.168.20.3 å¤–ç½‘:192.168.8.101)10022ç«¯å£æ˜ å°„åˆ°192.168.20.2:22\rsudo iptables -t nat -I PREROUTING -p tcp --dport 10022 -j DNAT --to-destination 192.168.20.2:22\rsudo iptables -t nat -I PREROUTING -p udp --dport 10022 -j DNAT --to-destination 192.168.20.2:22\rsudo iptables -t nat -I POSTROUTING -p tcp -d 192.168.20.2/24 --dport 22 -j SNAT --to-source 192.168.20.3\rsudo iptables -t nat -I POSTROUTING -p udp -d 192.168.20.2/24 --dport 22 -j SNAT --to-source 192.168.20.3\r ä¿å­˜ç”Ÿæ•ˆ\nservice iptables save\rservice iptables restart\r æ°¸ä¹…ä¿å­˜\n é¦–å…ˆå®‰è£…iptables-persistentå·¥å…·  sudo apt install iptables-persistent\r  æ¯å½“è®¾ç½®äº†æ–°çš„iptablesè§„åˆ™åï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ä¿å­˜è§„åˆ™å³å¯ï¼Œè§„åˆ™ä¼šæ ¹æ®ipv4å’Œipv6åˆ†åˆ«ä¿å­˜åœ¨äº†/etc/iptables/rules.v4å’Œ/etc/iptables/rules.v6æ–‡ä»¶ä¸­ã€‚  sudo netfilter-persistent save\r ç”±äº iptÂ­aÂ­bles-perÂ­sisÂ­tent åœ¨å®‰è£…æ—¶å·²ç»æŠŠå®ƒä½œä¸ºä¸€ä¸ªæœåŠ¡è®¾ç½®ä¸ºå¼€æœºå¯åŠ¨äº†ï¼Œå®ƒåœ¨å¼€æœºåä¼šè‡ªåŠ¨åŠ è½½å·²ç»ä¿å­˜çš„è§„åˆ™ï¼Œæ‰€ä»¥ä¹Ÿå°±è¾¾åˆ°äº†æ°¸ä¹…ä¿å­˜çš„ç›®çš„ã€‚å…¶å®åŸç†å’Œç¬¬ä¸€ç§æ–¹æ³•æ˜¯ç±»ä¼¼çš„ï¼Œåªæ˜¯è®¾ç½®èµ·æ¥ä¼šæ›´ç®€å•ä¸€äº›ã€‚\n","id":10,"section":"categories","summary":"netfilter ç›¸å…³ç½‘å€ å®˜ç½‘ï¼šnetfilter/iptables project homepage iptablesåŸºç¡€çŸ¥è¯†è¯¦è§£_LarryHai6çš„åšå®¢-CSDNåšå®¢_iptable","tags":[" linux","net","tool"],"title":"Netfilter","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/os/linux/tool/netfilter/","year":"2022"},{"content":"å†…ç½‘ç©¿é€ 1. frpè§£å†³æ–¹æ¡ˆ 1.1 ä¸‹è½½ wget https://github.com/fatedier/frp/releases/download/v0.42.0/frp_0.42.0_linux_arm.tar.gz\rtar -zxvf frp_0.42.0_linux_arm.tar.gz\r 1.2 serveré…ç½® â€‹\tnoteï¼šè”å¡‘é¡¹ç›®ï¼šè½¦ä½“æ§åˆ¶ç¨‹åºæ˜¯æœåŠ¡ç«¯\nè¿›å…¥ç¨‹åºç›®å½•\ncd frp_0.42.0_linux_arm\r å›¾ä¸­çº¢çº¿éƒ¨åˆ†æ˜¯serverç¨‹åºåŠå…¶é…ç½®æ–‡ä»¶\nä¿®æ”¹æƒé™\nchmod 755 frpc frps\r é…ç½®æ–‡ä»¶\nnano frps.ini\r å†™å…¥å¦‚ä¸‹å†…å®¹\n[common]\rbind_port = 7000\r 1.3 clienté…ç½® noteï¼šè”å¡‘é¡¹ç›®ï¼šrosæ˜¯å®¢æˆ·ç«¯\nè¿›å…¥ç¨‹åºç›®å½•\ncd frp_0.42.0_linux_arm\r ä¿®æ”¹æƒé™\nchmod 755 frpc frps\r å›¾ä¸­çº¢çº¿éƒ¨åˆ†æ˜¯clientç¨‹åºåŠå…¶é…ç½®æ–‡ä»¶\né…ç½®æ–‡ä»¶\nnano frpc.ini\r å†™å…¥å¦‚ä¸‹å†…å®¹\n[common]\rserver_addr = 192.168.8.147\rserver_port = 7000\r[ssh]\rtype = tcp\rlocal_ip = 192.168.100.10\rlocal_port = 22\rremote_port = 10022\r 1.4 æµ‹è¯•   æ‰“å¼€serverç«¯ï¼Œå³è½¦ä½“æ§åˆ¶ç¨‹åºæ¿å­ ./frps\r   æ‰“å¼€clientç«¯ï¼Œå³rosç¨‹åºæ¿å­ ./frpc\r   æ‰“å¼€æœ¬åœ°ç”µè„‘ç»ˆç«¯ ssh -oPort=10022 pi@192.168.8.147\r   1.5 å¼€æœºè‡ªå¯åŠ¨ æ ‘è“æ´¾ sudo nano /etc/rc.local\råœ¨\u0026quot;exit 0\u0026quot;å‰æ·»åŠ è„šæœ¬\rsu pi -c \u0026quot;bash ~/start/Mystart.sh \u0026amp;\u0026quot;\r åˆ›å»ºè„šæœ¬\nmkdir $HOME/start \u0026amp;\u0026amp; cd $HOME/start \u0026amp;\u0026amp; touch Mystart.sh\rchmod 755 Mystart.sh\r è„šæœ¬å†…å®¹\n#!/bin/bash\rsu pi -c \u0026quot;exec ~/frp/frps \u0026gt;/dev/null \u0026amp;\u0026quot;\r ubuntu cd /etc/init.d \u0026amp;\u0026amp; sudo nano Mystart.sh\r è„šæœ¬å†…å®¹\n#!/bin/bash\rsu ubuntu -c \u0026quot;exec ~/frp/frpc \u0026gt;/dev/null \u0026amp;\u0026quot;\r ç»™ä¸å¯åŠ¨æƒé™\nsudo chmod 775 Mystart.sh\rsudo update-rc.d Mystart.sh defaults 90\r åˆ é™¤å¯åŠ¨æƒé™\nsudo update-rc.d -f Mystart.sh remove\r ","id":11,"section":"categories","summary":"å†…ç½‘ç©¿é€ 1. frpè§£å†³æ–¹æ¡ˆ 1.1 ä¸‹è½½ wget https://github.com/fatedier/frp/releases/download/v0.42.0/frp_0.42.0_linux_arm.tar.gz tar -zxvf frp_0.42.0_linux_arm.tar.gz 1.2 serveré…ç½® â€‹ noteï¼šè”å¡‘é¡¹ç›®ï¼šè½¦ä½“æ§åˆ¶ç¨‹åºæ˜¯æœåŠ¡ç«¯ è¿›å…¥ç¨‹åºç›®å½• cd frp_0.42.0_linux_arm å›¾ä¸­çº¢çº¿éƒ¨åˆ†æ˜¯serve","tags":[" linux","tool"],"title":"å†…ç½‘ç©¿é€","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/os/linux/app/frp%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/","year":"2022"},{"content":"launchæ–‡ä»¶ æ¨¡æ¿ \u0026lt;?xml version=\u0026quot;1.0\u0026quot;?\u0026gt;\r\u0026lt;launch\u0026gt;\r\u0026lt;include file=\u0026quot;$(find pepperl_fuchs_r2000)/launch/r2000.launch\u0026quot;/\u0026gt;\r\u0026lt;!--pkg:åŠŸèƒ½åŒ…åç§°(æ–‡ä»¶å¤¹) typeï¼šèŠ‚ç‚¹çš„å¯æ‰§è¡Œæ–‡ä»¶åç§°ã€‚nameï¼šè¿è¡ŒèŠ‚ç‚¹å --\u0026gt;\r\u0026lt;node pkg=\u0026quot;\u0026quot; type=\u0026quot;\u0026quot; name=\u0026quot;\u0026quot; output=\u0026quot;screen\u0026quot;\u0026gt;\u0026lt;/node\u0026gt;\r\u0026lt;/launch\u0026gt;\r ","id":12,"section":"categories","summary":"launchæ–‡ä»¶ æ¨¡æ¿ \u0026lt;?xml version=\u0026quot;1.0\u0026quot;?\u0026gt; \u0026lt;launch\u0026gt; \u0026lt;include file=\u0026quot;$(find pepperl_fuchs_r2000)/launch/r2000.launch\u0026quot;/\u0026gt; \u0026lt;!--pkg:åŠŸèƒ½åŒ…åç§°(æ–‡ä»¶å¤¹) typeï¼šèŠ‚ç‚¹çš„å¯æ‰§è¡Œæ–‡ä»¶åç§°ã€‚nameï¼šè¿è¡ŒèŠ‚ç‚¹å --\u0026gt; \u0026lt;node pkg=\u0026quot;\u0026quot; type=\u0026quot;\u0026quot; name=\u0026quot;\u0026quot; output=\u0026quot;screen\u0026quot;\u0026gt;\u0026lt;/node\u0026gt; \u0026lt;/launch\u0026gt;","tags":[" ros","robat"],"title":"6_launchæ–‡ä»¶","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/os/ros/6_launch%E6%96%87%E4%BB%B6/","year":"2022"},{"content":"rosç¼–ç¨‹ 1.topic 1.1 topic_pulisherç¨‹åºå®ç°å››ä¸ªæ­¥éª¤ 1.2 topic_subscriberç¨‹åºå®ç°å››ä¸ªæ­¥éª¤ \r noteï¼šä¿è¯å›è°ƒå‡½æ•°ä¸­å¤„ç†ä¸èƒ½å¤ªé•¿\n 1.3 è¯é¢˜æ¶ˆæ¯çš„å®šä¹‰ä¸ä½¿ç”¨ - \u0026mdash;\u0026ndash;\u0026gt;å®šä¹‰ #åœ¨åŠŸèƒ½åŒ…src/package/,åˆ›å»ºmsgæ–‡ä»¶å¤¹\rmkdir msg\r#ç¼–å†™msg/*.msg\r#æ‰“å¼€package.xmlï¼Œæ·»åŠ åŠ¨æ€ç”Ÿæˆç¨‹åºçš„ä¾èµ–\r\u0026lt;build_depend\u0026gt;message_generation\u0026lt;/build_depend\u0026gt;\r\u0026lt;exec_depend\u0026gt;message_runtime\u0026lt;/exec_depend\u0026gt;\r#CMakeLists.txtæ·»åŠ ç¼–è¯‘é€‰é¡¹\rfind_package(..... message_generation)\radd_message_files(FILES person.msg)\rgenerate_messages(DEPENDENCIES std_msgs)#person.msgä¾èµ–é‚£äº›åº“\rcatkin_package(CATKIN_DEPENDS ... message_runtime)\r  \u0026mdash;\u0026mdash;-\u0026gt;ä½¿ç”¨ï¼šè®¢é˜…è‡ªå®šä¹‰çš„æ¶ˆæ¯ ROSè®¢é˜…è‡ªå®šä¹‰æ¶ˆæ¯_plokm789456çš„åšå®¢-CSDNåšå®¢\n1.package.xml custom_pack_nameéœ€è¦ä¿®æ”¹æˆå‘å¸ƒæ¶ˆæ¯çš„åŒ…åç§°ã€‚\n\u0026lt;depend\u0026gt;custom_pack_name\u0026lt;/depend\u0026gt;\r 2.ä¿®æ”¹CMakeLists.txt,åœ¨find_packageä¸­æ·»åŠ å£°æ˜ï¼Œå…¶ä¸­publish_pack_nameä¸ºå‘å¸ƒæ¶ˆæ¯çš„åŒ…çš„åç§°,å…¶ä¸­new_pack_nameä¸ºéœ€è¦è®¢é˜…æ¶ˆæ¯çš„åŒ…åã€‚\nfind_package(catkin REQUIRED COMPONENTS\rroscpp\rrospy\rpublish_pack_name\r)\radd_dependencies(new_pack_name publish_pack_name_generate_messages_cpp)\r 1.4 roså†…ç½®æ¶ˆæ¯ç±»å‹\u0026ndash;std_msgs\nè¯¦è§£å¸¸ç”¨çš„ROSå†…ç½®æ¶ˆæ¯ç±»å‹\n","id":13,"section":"categories","summary":"rosç¼–ç¨‹ 1.topic 1.1 topic_pulisherç¨‹åºå®ç°å››ä¸ªæ­¥éª¤ 1.2 topic_subscriberç¨‹åºå®ç°å››ä¸ªæ­¥éª¤ noteï¼šä¿è¯å›è°ƒå‡½æ•°ä¸­å¤„ç†ä¸èƒ½","tags":["robat"," ros"],"title":"5_rosç¼–ç¨‹","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/os/ros/5_ros%E7%BC%96%E7%A8%8B/","year":"2022"},{"content":"TFè½¬æ¢ å®‰è£… sudo apt install ros-melodic-turtle-tf\r å¯è§†åŒ–è§‚æµ‹tf tree #pdf\rrosrun tf view_frames\r#stdout\rrosrun tf tf_echo node1 nodde2\r å¸¸ç”¨çš„tfåæ ‡ç³» laser_linkï¼šæ¿€å…‰é›·è¾¾\rbase_linkï¼šè½¦ä½“\rodom:é‡Œç¨‹è®¡åæ ‡ç³»\rmapï¼šå•ä¸ªæœºå™¨äººå…¨å±€åæ ‡ç³»\rearthï¼šå¤šä¸ªæœºå™¨äººåä½œ\r rosåæ ‡è½¬æ¢çš„ç±» rosmsg info geometry_msgs/TransformStamped\r geometry_msgså¤´æ–‡ä»¶å†…å®¹\nAccel.h AccelStamped.h AccelWithCovariance.h AccelWithCovarianceStamped.h Inertia.h\rInertiaStamped.h\rPoint32.h\rPoint.h\rPointStamped.h\rPolygon.h\rPolygonStamped.h\rPose2D.h\rPoseArray.h\rPose.h\rPoseStamped.h\rPoseWithCovariance.h\rPoseWithCovarianceStamped.h\rQuaternion.h QuaternionStamped.h Transform.h TransformStamped.h Twist.h TwistStamped.h TwistWithCovariance.h\rTwistWithCovarianceStamped.h Vector3.h\rVector3Stamped.h\rWrench.h\rWrenchStamped.h\r 1. geometry_msgs::TransformStamped åæ ‡ç³»ä¹‹é—´çš„å…³è”ä¿¡æ¯\nstd_msgs/Header header\ruint32 seq\rtime stamp\rstring frame_id\rstring child_frame_id\rgeometry_msgs/Transform transform\rgeometry_msgs/Vector3 translation\rfloat64 x\rfloat64 y\rfloat64 z\rgeometry_msgs/Quaternion rotation\rfloat64 x\rfloat64 y\rfloat64 z\rfloat64 w\r 2.geometry_msgs/PointStamped åæ ‡ç‚¹ä¿¡æ¯\nstd_msgs/Header header\ruint32 seq\rtime stamp\rstring frame_id\rgeometry_msgs/Point point\rfloat64 x\rfloat64 y\rfloat64 z\r ","id":14,"section":"categories","summary":"TFè½¬æ¢ å®‰è£… sudo apt install ros-melodic-turtle-tf å¯è§†åŒ–è§‚æµ‹tf tree #pdf rosrun tf view_frames #stdout rosrun tf tf_echo node1 nodde2 å¸¸ç”¨çš„tfåæ ‡ç³» laser_linkï¼šæ¿€å…‰é›·è¾¾ base_linkï¼šè½¦ä½“ odom:é‡Œç¨‹","tags":[" ros","robat "],"title":"7_tfè½¬æ¢","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/os/ros/7_tf%E8%BD%AC%E6%8D%A2/","year":"2022"},{"content":"WiringPi å®‰è£… WiringPi\nå®˜ç½‘ä»‹ç»æˆªå–   WiringPi is a PIN based GPIO access library written in C for the BCM2835, BCM2836 and BCM2837 SoC devices used in all Raspberry Pi. versions. The source code is not publicly available but may be made available to those who wish commercial support.\n  Itâ€™s designed to be familiar to people who have used the Arduino â€œwiringâ€ system1 and is intended for use by experienced C/C++ programmers. It is not a newbie learning tool.\n  WiringPi is developed directly on a Raspberry Pi running 32-bit Raspbian.I do not support any other platform, cross compiling or operating systems.\n  Raspberry Pi | Wiring | Download \u0026amp; Install | Wiring Pi\n note:å¦‚æœå®˜ç½‘åœ°å€æ‰“ä¸å¼€ï¼Œç›´æ¥ä¸‹è½½githubä¸­çš„ä¸‹è½½åŒ…\n install wget https://github.com/WiringPi/WiringPi/archive/refs/tags/2.61-1.tar.gz\rtar zxvf 2.61-1.tar.gz cd WiringPi-2.61-1/\r./build\rOK\r test gpio -v\r gpio readall\r wiringpi API å‚è€ƒåšå®¢\næ ‘è“æ´¾wiringPiåº“è¯¦è§£ - lulipro - åšå®¢å›­ (cnblogs.com)\næ ‘è“æ´¾WiringPiå¸¸ç”¨å‡½æ•°ä¸­æ–‡æ‰‹å†Œ-Arduinoä¸­æ–‡ç¤¾åŒº - Powered by Discuz!\næ ‘è“æ´¾ wiringPi åº“_~è˜è˜çš„åšå®¢-ç¨‹åºå‘˜å®å®_wiringpi - ç¨‹åºå‘˜å®å® (cxybb.com)\n//Core wiringPi functions\rextern struct wiringPiNodeStruct *wiringPiFindNode (int pin) ;\rextern struct wiringPiNodeStruct *wiringPiNewNode (int pinBase, int numPins) ;\rextern void wiringPiVersion\t(int *major, int *minor) ;\rextern int wiringPiSetup (void) ;\rextern int wiringPiSetupSys (void) ;\rextern int wiringPiSetupGpio (void) ;\rextern int wiringPiSetupPhys (void) ;\rextern void pinModeAlt (int pin, int mode) ;\rextern void pinMode (int pin, int mode) ;\rextern void pullUpDnControl (int pin, int pud) ;\rextern int digitalRead (int pin) ;\rextern void digitalWrite (int pin, int value) ;\rextern unsigned int digitalRead8 (int pin) ;\rextern void digitalWrite8 (int pin, int value) ;\rextern void pwmWrite (int pin, int value) ;\rextern int analogRead (int pin) ;\rextern void analogWrite (int pin, int value) ;\r ","id":15,"section":"categories","summary":"WiringPi å®‰è£… WiringPi å®˜ç½‘ä»‹ç»æˆªå– WiringPi is a PIN based GPIO access library written in C for the BCM2835, BCM2836 and BCM2837 SoC devices used in all Raspberry Pi. versions. The source code is not publicly available but may be made available to those who wish commercial support. Itâ€™s designed to be familiar to people who have used the Arduino â€œw","tags":[" raspberry"],"title":"Wiringpiçš„å®‰è£…åŠä½¿ç”¨","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/os/raspberry/wiringpi/","year":"2022"},{"content":"æ ‘è“æ´¾ç¡¬ä»¶èµ„æ–™ 40pin  SDA.0ã€SDA.1ï¼šI2Cæ•°æ®ä¼ è¾“å£ SCL.0ã€SCL.1ï¼šI2Cçš„æ—¶é’Ÿä¿¡å· GPIO.xï¼ˆx = 0,1,2,3,4,5,6,7;21,22,23,24,25,26,27,28,29ï¼‰:é€šç”¨çš„è¾“å…¥è¾“å‡ºï¼Œè‡ªå·±å®šä¹‰å³å¯ TXD\\RXD: ä¸²å£ MOSIï¼šä¸»è¾“å‡º ä»è¾“å…¥(SPI) MISOï¼šä¸»è¾“å…¥ ä»è¾“å‡º(SPI) SCLKï¼šSPIé€šä¿¡çš„æ—¶é’Ÿçº¿(SPI) CE0ã€CE1ï¼šç‰‡é€‰ä¿¡å·(SPI)  ","id":16,"section":"categories","summary":"æ ‘è“æ´¾ç¡¬ä»¶èµ„æ–™ 40pin SDA.0ã€SDA.1ï¼šI2Cæ•°æ®ä¼ è¾“å£ SCL.0ã€SCL.1ï¼šI2Cçš„æ—¶é’Ÿä¿¡å· GPIO.xï¼ˆx = 0,1,2,3,4,5,6","tags":["raspberry "],"title":"æ ‘è“æ´¾ç¡¬ä»¶èµ„æ–™","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/os/raspberry/%E6%A0%91%E8%8E%93%E6%B4%BE%E7%A1%AC%E4%BB%B6%E8%B5%84%E6%96%99/","year":"2022"},{"content":"Raspberryç³»ç»Ÿåˆå§‹é…ç½®æ“ä½œ  note: Raspberry Pi OSä»bullseye(2022-04-04 debaian 11)ä»¥åä¸åœ¨è®¾ç½®é»˜è®¤ç”¨æˆ·piå’Œå¯†ç raspberryï¼Œå»ºè®®ç”¨å®˜æ–¹ä¸‹è½½å™¨çƒ§å½•ç³»ç»Ÿï¼Œå¯ä»¥è‡ªå®šä¹‰åˆå§‹åŒ–ä¸€ä¸ªç”¨æˆ·åå’Œå¯†ç ã€‚\n   ä¸‹è½½å™¨åœ°å€ï¼šRaspberry Pi OS â€“ Raspberry Pi\n  Raspberry Pi OSä¸‹è½½åœ°å€ï¼šOperating system images â€“ Raspberry Pi\n  1. ç½‘ç»œé…ç½® 1.1 ä»¥å¤ªç½‘å›ºå®šipåœ°å€ sudo nano /etc/dhcpcd.conf\r å–æ¶ˆç›¸åº”çš„æ³¨é‡Š\ninterface wlan0\rstatic ip_address=192.168.1.102/24\rstatic ip6_address=fd51:42f8:caae:d92e::ff/64\rstatic routers=192.168.1.1\rstatic domain_name_servers=192.168.18.1 192.168.1.1 fd51:42f8:caae:d92e::1\rinterface eth0\rstatic ip_address=192.168.1.181/24\rstatic routers=192.168.1.1\rstatic domain_name_servers=192.168.1.1\r 1.2 wifiè¿æ¥ 1.2.1 å·²ç»è¿›å…¥ç³»ç»Ÿï¼Œè”ç½‘æƒ…å†µä¸‹ //è¿›å…¥é…ç½®æ–‡ä»¶\rsudo nano /etc/wpa_supplicant/wpa_supplicant.conf\r//æ·»åŠ \rnetwork={\rssid=\u0026quot;æ— çº¿åç§°\u0026quot;\rpsk=\u0026quot;æ— çº¿å¯†ç \u0026quot;\r}\r 1.2.1 æ²¡ç”¨è¿›å…¥åˆ°ç³»ç»Ÿï¼Œbootä¸­é…ç½® bootç›˜ä¸­ï¼Œæ–°å»ºæ–‡ä»¶ï¼Œæ–‡ä»¶åä¸ºwpa_supplicant.conf,å†™å…¥\ncountry=CN\rctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdev\rupdate_config=1\rnetwork={\rssid=\u0026quot;æ— çº¿åç§°\u0026quot;\rpsk=\u0026quot;æ— çº¿å¯†ç \u0026quot;\rkey_mgmt=WPA-PSK\rpriority=1\r}\r åŒä¸Šåˆ›å»ºä¸€ä¸ªåå­—æ˜¯sshçš„æ–‡æœ¬æ–‡æ¡£ï¼Œä»€ä¹ˆéƒ½ä¸å†™ï¼Œå¼€å¯sshæœåŠ¡\n2. æ¢æº å‚è€ƒèµ„æºâ€”æ ‘è“æ´¾å®éªŒå®¤\nç¡®å®šæ ‘è“æ´¾ç³»ç»Ÿç‰ˆæœ¬\nlsb_release -a\r  note:\næ ‘è“æ´¾æœ‰å¦‚ä¸‹ä¸¤ä¸ªæ¶æ„ï¼š\n arm64 armhf  æ ‘è“æ´¾ç³»ç»Ÿæœ‰å¦‚ä¸‹å‡ ä¸ªç‰ˆæœ¬\n wheezy jessie stretchï¼ˆDebian 9ï¼‰ busterï¼ˆDebian 10ï¼‰ bullseyeï¼ˆDebian 11ï¼‰   å¯ç”¨ä»¥ä¸‹ç½‘ç«™æ›¿æ¢ä¸‹é¢æº\nä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦ Raspbian http://mirrors.ustc.edu.cn/raspbian/raspbian/\né˜¿é‡Œäº‘ Raspbian http://mirrors.aliyun.com/raspbian/raspbian/\næ¸…åå¤§å­¦ Raspbian http://mirrors.tuna.tsinghua.edu.cn/raspbian/raspbian/\nåä¸­ç§‘æŠ€å¤§å­¦ Raspbian http://mirrors.hustunique.com/raspbian/raspbian/ Arch Linux ARM http://mirrors.hustunique.com/archlinuxarm/\nåå—å†œä¸šå¤§å­¦ï¼ˆåå—ç”¨æˆ·ï¼‰ Raspbian http://mirrors.scau.edu.cn/raspbian/\nå¤§è¿ä¸œè½¯ä¿¡æ¯å­¦é™¢æºï¼ˆåŒ—æ–¹ç”¨æˆ·ï¼‰ Raspbian http://mirrors.neusoft.edu.cn/raspbian/raspbian/\né‡åº†å¤§å­¦æºï¼ˆä¸­è¥¿éƒ¨ç”¨æˆ·ï¼‰ Raspbian http://mirrors.cqu.edu.cn/Raspbian/raspbian/\nä¸­å±±å¤§å­¦ å·²è·³è½¬è‡³ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦æº Raspbian http://mirror.sysu.edu.cn/raspbian/raspbian/\næ–°åŠ å¡å›½ç«‹å¤§å­¦ Raspbian http://mirror.nus.edu.sg/raspbian/raspbian\nç‰›æ´¥å¤§å­¦ Raspbian http://mirror.ox.ac.uk/sites/archive.raspbian.org/archive/raspbian/\néŸ©å›½KAISTå¤§å­¦ Raspbian http://ftp.kaist.ac.kr/raspbian/raspbian/\n sudo nano /etc/apt/sources.list  wheezy\ndeb http://mirrors.sysu.edu.cn/raspbian/raspbian/ wheezy main contrib non-free\rdeb-src http://mirrors.sysu.edu.cn/raspbian/raspbian/ wheezy main contrib non-free\r jessie\ndeb http://mirrors.sysu.edu.cn/raspbian/raspbian/ jessie main contrib non-free\rdeb-src http://mirrors.sysu.edu.cn/raspbian/raspbian/ jessie main contrib non-free\r stretch\ndeb http://mirrors.sysu.edu.cn/raspbian/raspbian/ stretch main contrib non-free\rdeb-src http://mirrors.sysu.edu.cn/raspbian/raspbian/ stretch main contrib non-free\r buster\ndeb http://mirrors.tuna.tsinghua.edu.cn/raspbian/raspbian/ buster main non-free contrib\rdeb-src http://mirrors.tuna.tsinghua.edu.cn/raspbian/raspbian/ buster main non-free contrib\r bullseye\n\r#å¦‚æœéœ€è¦ armhfè½¯ä»¶æº\rdeb [arch=armhf] http://mirrors.tuna.tsinghua.edu.cn/raspbian/raspbian/ bullseye main non-free contrib rpi\rdeb-src http://mirrors.tuna.tsinghua.edu.cn/raspbian/raspbian/ bullseye main non-free contrib rpi\r# å¦‚æœéœ€è¦ arm64 è½¯ä»¶æºï¼Œåœ¨ `/etc/apt/sources.list` ä¸­åŠ ä¸Š\rdeb [arch=arm64] http://mirrors.tuna.tsinghua.edu.cn/raspbian/multiarch/ bullseye main\r ","id":17,"section":"categories","summary":"Raspberryç³»ç»Ÿåˆå§‹é…ç½®æ“ä½œ note: Raspberry Pi OSä»bullseye(2022-04-04 debaian 11)ä»¥åä¸åœ¨è®¾ç½®é»˜è®¤ç”¨æˆ·piå’Œå¯†ç raspberry","tags":["command","raspberry"],"title":"Raspberryç³»ç»Ÿåˆå§‹é…ç½®æ“ä½œ","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/os/raspberry/raspberry%E7%B3%BB%E7%BB%9F%E5%88%9D%E5%A7%8B%E9%85%8D%E7%BD%AE%E6%93%8D%E4%BD%9C/","year":"2022"},{"content":"Amclè¸©å‘é›† 2022.4.29 Q1 [ERROR] [1651219018.862852200]: Couldn't determine robot's pose associated with laser scan\r[ WARN] [1651219018.942895300]: Failed to compute odom pose, skipping scan (Lookup would require extrapolation into the past. Requested time 1651219008.851113400 but the earliest data is at time 1651219008.964298200, when looking up transform from frame [base_link] to frame [odom])\r A2\nåŸå› æ˜¯æˆ‘åœ¨amclä¸­æ‰“å°r2000æ¿€å…‰é›·è¾¾çš„æ•°æ®ï¼Œå¯¼è‡´ç¨‹åºå»¶è¿Ÿï¼Œä¸èƒ½å¤ŸåŠæ—¶çš„æ‹¿åˆ°r2000æˆ–è€…é‡Œç¨‹è®¡çš„æ•°æ®\ræºç ï¼š\ramcl_node.cpp\r// Where was the robot when this scan was taken?\r// pty:è·å¾—é‡Œç¨‹è®¡æ•°æ®\rpf_vector_t pose;\rif(!getOdomPose(latest_odom_pose_, pose.v[0], pose.v[1], pose.v[2],\rlaser_scan-\u0026gt;header.stamp, base_frame_id_))\r{\rROS_ERROR(\u0026quot;Couldn't determine robot's pose associated with laser scan\u0026quot;);\rreturn;\r}\r ","id":18,"section":"categories","summary":"Amclè¸©å‘é›† 2022.4.29 Q1 [ERROR] [1651219018.862852200]: Couldn't determine robot's pose associated with laser scan [ WARN] [1651219018.942895300]: Failed to compute odom pose, skipping scan (Lookup would require extrapolation into the past. Requested time 1651219008.851113400 but the earliest data is at time 1651219008.964298200, when looking up transform from frame [base_link] to frame [odom]) A2 åŸå› æ˜¯æˆ‘åœ¨amclä¸­æ‰“å°","tags":["slam "," project"],"title":"Amclè¸©å‘é›†","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/robat/slam/amcl%E8%B8%A9%E5%9D%91%E9%9B%86/","year":"2022"},{"content":"roså¸¸ç”¨å‘½ä»¤ åˆ›å»ºroså·¥ä½œç©ºé—´ mkdir -p ~/catkin_ws/src\rcd ~/catkin_ws\rcatkin_make\rsource devel/setup.bash\recho $ROS_PACKAGE_PATH\recho \u0026quot;source /home/chao/Desktop/code/02c/ros1/src/devel/setup.bash\u0026quot; \u0026gt;\u0026gt; ~/.bashrc  åˆ›å»ºrosç¨‹åºåŒ… cd ~/catkin_ws/src\rcatkin_create_pkg beginner_tutorials std_msgs rospy roscpp\r roså‚æ•°å‘½ä»¤ rosparam set [param_name] è®¾ç½®å‚æ•°\rrosparam get [param_name] è·å–å‚æ•°\rrosparam load params.yaml ä»æ–‡ä»¶ä¸­åŠ è½½å‚æ•°\rrosparam dump params.yaml å‘æ–‡ä»¶ä¸­è½¬å‚¨å‚æ•°\rrosparam delete [param_name] åˆ é™¤å‚æ•°\rrosparam list åˆ—å‡ºå‚æ•°å\r ","id":19,"section":"categories","summary":"roså¸¸ç”¨å‘½ä»¤ åˆ›å»ºroså·¥ä½œç©ºé—´ mkdir -p ~/catkin_ws/src cd ~/catkin_ws catkin_make source devel/setup.bash echo $ROS_PACKAGE_PATH echo \u0026quot;source /home/chao/Desktop/code/02c/ros1/src/devel/setup.bash\u0026quot; \u0026gt;\u0026gt; ~/.bashrc åˆ›å»ºrosç¨‹åºåŒ… cd ~/catkin_ws/src catkin_create_pkg beginner_tutorials std_msgs rospy roscpp roså‚æ•°å‘½ä»¤ rosparam set [param_name] è®¾ç½®å‚æ•° rosparam get [param_name] è·å–å‚æ•° rosparam load params.yaml","tags":["ros ","robat "],"title":"4_roså¸¸ç”¨å‘½ä»¤","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/os/ros/4_ros%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/","year":"2022"},{"content":"linuxå®˜æ–¹è“ç‰™åè®®bluezçš„ä½¿ç”¨ ç›¸å…³ç½‘å€  å®˜ç½‘æºç  å®˜ç½‘æ–‡æ¡£ pythonè°ƒç”¨bluez bluepy - a Bluetooth LE interface for Python â€” bluepy 0.9.11 documentation (ianharvey.github.io)  å®‰è£…bluez (Ubuntu 20.04ç¼–è¯‘å®‰è£…BlueZ-5.6_ä¿®ä¸å¥½çš„BUGçš„åšå®¢-CSDNåšå®¢_bluezå®‰è£…\næ ‘è“æ´¾å®‰è£…BlueZåè®®æ ˆï¼ˆRaspberry pi Bluetooth LEï¼‰_PaulYoung_Blogçš„åšå®¢-CSDNåšå®¢_bluezå®‰è£…\nxz -d bluez-5.64.tar.xz\rtar zvf bluez-5.64.tar ./configure --prefix=/usr/local --mandir=/usr/local/share/man --sysconfdir=/etc --localstatedir=/var\r ","id":20,"section":"categories","summary":"linuxå®˜æ–¹è“ç‰™åè®®bluezçš„ä½¿ç”¨ ç›¸å…³ç½‘å€ å®˜ç½‘æºç  å®˜ç½‘æ–‡æ¡£ pythonè°ƒç”¨bluez bluepy - a Bluetooth LE interface for Python â€” bluepy 0.9.11 documentation (ianharvey.github.io) å®‰è£…bluez (Ubuntu 20.04","tags":["c ","project"],"title":"Bluez","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/lang/c/bluez/","year":"2022"},{"content":"TCP server epoll å¤´æ–‡ä»¶ #include \u0026lt;sys/epoll.h\u0026gt;\r ç»“æ„ä½“ typedef union epoll_data\r{\rvoid *ptr;\rint fd;\ruint32_t u32;\ruint64_t u64;\r} epoll_data_t;\rstruct epoll_event\r{\ruint32_t events;\t/* Epoll events å³enum EPOLL_EVENTS*/\repoll_data_t data;\t/* User data variable */\r} __EPOLL_PACKED;\r å® enum EPOLL_EVENTS\r{\rEPOLLIN = 0x001,//è¡¨ç¤ºå¯¹åº”çš„æ–‡ä»¶æè¿°ç¬¦å¯ä»¥è¯»\r#define EPOLLIN EPOLLIN\rEPOLLPRI = 0x002,//è¡¨ç¤ºå¯¹åº”çš„æ–‡ä»¶æè¿°ç¬¦æœ‰ç´§æ€¥çš„æ•°æ®å¯è¯»\r#define EPOLLPRI EPOLLPRI\rEPOLLOUT = 0x004,//è¡¨ç¤ºå¯¹åº”çš„æ–‡ä»¶æè¿°ç¬¦å¯ä»¥å†™\r#define EPOLLOUT EPOLLOUT\rEPOLLRDNORM = 0x040,\r#define EPOLLRDNORM EPOLLRDNORM\rEPOLLRDBAND = 0x080,\r#define EPOLLRDBAND EPOLLRDBAND\rEPOLLWRNORM = 0x100,\r#define EPOLLWRNORM EPOLLWRNORM\rEPOLLWRBAND = 0x200,\r#define EPOLLWRBAND EPOLLWRBAND\rEPOLLMSG = 0x400,\r#define EPOLLMSG EPOLLMSG\rEPOLLERR = 0x008,//è¡¨ç¤ºå¯¹åº”çš„æ–‡ä»¶æè¿°ç¬¦å‘ç”Ÿé”™è¯¯\r#define EPOLLERR EPOLLERR\rEPOLLHUP = 0x010,//è¡¨ç¤ºå¯¹åº”çš„æ–‡ä»¶æè¿°ç¬¦è¢«æŒ‚æ–­\r#define EPOLLHUP EPOLLHUP\rEPOLLRDHUP = 0x2000,\r#define EPOLLRDHUP EPOLLRDHUP\rEPOLLEXCLUSIVE = 1u \u0026lt;\u0026lt; 28,\r#define EPOLLEXCLUSIVE EPOLLEXCLUSIVE\rEPOLLWAKEUP = 1u \u0026lt;\u0026lt; 29,\r#define EPOLLWAKEUP EPOLLWAKEUP\rEPOLLONESHOT = 1u \u0026lt;\u0026lt; 30,//åªç›‘å¬ä¸€æ¬¡äº‹ä»¶ï¼Œå½“ç›‘å¬å®Œè¿™æ¬¡äº‹ä»¶ä¹‹åï¼Œå¦‚æœè¿˜éœ€è¦ç»§ç»­ç›‘å¬è¿™ä¸ªsocketçš„è¯ï¼Œéœ€è¦å†æ¬¡æŠŠè¿™ä¸ªsocketåŠ å…¥åˆ°EPOLLé˜Ÿåˆ—é‡Œã€‚\r#define EPOLLONESHOT EPOLLONESHOT\rEPOLLET = 1u \u0026lt;\u0026lt; 31//å°†EPOLLè®¾ä¸ºè¾¹ç¼˜è§¦å‘(Edge Triggered)æ¨¡å¼\r#define EPOLLET EPOLLET\r};\r/* Valid opcodes ( \u0026quot;op\u0026quot; parameter ) to issue to epoll_ctl(). */\r#define EPOLL_CTL_ADD 1\t/* Add a file descriptor to the interface. */\r#define EPOLL_CTL_DEL 2\t/* Remove a file descriptor from the interface. */\r#define EPOLL_CTL_MOD 3\t/* Change file descriptor epoll_event structure. */\r API epoll_create()å‡½æ•° åŠŸèƒ½ï¼šåˆ›å»ºä¸€ä¸ªepollå®ä¾‹ã€‚\nè¿”å›å€¼ï¼šå¦‚æœæˆåŠŸï¼Œè¿”å›ä¸€ä¸ªepoll çš„å¥æŸ„fdï¼ˆnoteï¼šepollå ç”¨ä¸€ä¸ªfdï¼Œå‘ç”Ÿé”™è¯¯æ—¶ï¼Œè¿”å›-1ï¼Œ\næ³¨æ„ï¼šä»Linux 2.6.8å¼€å§‹ï¼Œsizeå‚æ•°è¢«å¿½ç•¥ï¼Œä½†å¿…é¡»å¤§äºé›¶ï¼›\n#include \u0026lt;sys/epoll.h\u0026gt;\rint epoll_create (int __size)\r â€ƒè¿™ä¸ªæ–‡ä»¶æè¿°ç¬¦ç”¨äºæ‰€æœ‰åç»­è°ƒç”¨epollçš„æ‰€æœ‰æ¥å£ã€‚ å½“ä¸å†éœ€è¦æ–‡ä»¶æè¿°ç¬¦æ—¶ï¼Œä½¿ç”¨closeå…³é—­ã€‚ å½“æ‰€æœ‰æŒ‡å‘è¿™ä¸ªepollå®ä¾‹çš„æ–‡ä»¶æè¿°ç¬¦éƒ½å…³é—­æ—¶ï¼Œå†…æ ¸é”€æ¯å®ä¾‹å¹¶é‡Šæ”¾å…³è”çš„é‡ç”¨èµ„æº\nepoll_create1()å‡½æ•° åŠŸèƒ½ï¼šåˆ›å»ºä¸€ä¸ªepollå®ä¾‹ã€‚ å¦‚æœflagsä¸º0ï¼Œepoll_create1ï¼ˆï¼‰å’Œåˆ é™¤äº†è¿‡æ—¶sizeå‚æ•°çš„epoll_createï¼ˆï¼‰ç›¸åŒã€‚\n#include \u0026lt;sys/epoll.h\u0026gt;\rint epoll_create1 (int __flags)\r epoll_ctl()å‡½æ•° åŠŸèƒ½ï¼šè¯¥ç³»ç»Ÿè°ƒç”¨å¯¹æ–‡ä»¶æè¿°ç¬¦epfdå¼•ç”¨çš„epollå®ä¾‹æ‰§è¡Œæ§åˆ¶æ“ä½œã€‚\n#include \u0026lt;sys/epoll.h\u0026gt;\rint epoll_ctl (int __epfd, int __op, int __fd,struct epoll_event *__event)  op: EPOLL_CTL_ADDã€EPOLL_CTL_DELã€EPOLL_CTL_MOD\nepoll_wait()å‡½æ•° #include \u0026lt;sys/epoll.h\u0026gt;\rint epoll_wait (int __epfd, struct epoll_event *__events,int __maxevents, int __timeout)\r epoll_pwait()å‡½æ•° #include \u0026lt;sys/epoll.h\u0026gt; int epoll_pwait (int __epfd, struct epoll_event *__events,int __maxevents, int __timeout,\rconst __sigset_t *__ss);\r ","id":21,"section":"categories","summary":"TCP server epoll å¤´æ–‡ä»¶ #include \u0026lt;sys/epoll.h\u0026gt; ç»“æ„ä½“ typedef union epoll_data { void *ptr; int fd; uint32_t u32; uint64_t u64; } epoll_data_t; struct epoll_event { uint32_t events; /* Epoll events å³enum EPOLL_EVENTS*/ epoll_data_t data; /* User data variable */ } __EPOLL_PACKED; å® enum EPOLL_EVENTS { EPOLLIN = 0x001,//è¡¨ç¤ºå¯¹åº”çš„æ–‡ä»¶æ","tags":[" c","linux ","project","net"],"title":"Tcp_server","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/lang/c/tcp_server/","year":"2022"},{"content":"LINUXä¸²å£ç¼–ç¨‹\u0026ndash;raw å‚è€ƒblog [ linux-ä¸²å£åº”ç”¨ç¼–ç¨‹_é‚»å±…å®¶çš„å°å—ç“œçš„åšå®¢-CSDNåšå®¢](https://blog.csdn.net/qq_37932504/article/details/121125906?ops_request_misc=\u0026amp;request_id=\u0026amp;biz_id=102\u0026amp;utm_term=linux ä¸²å£api\u0026amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-4-121125906.142^v9^pc_search_result_control_group,157^v4^new_style\u0026amp;spm=1018.2226.3001.4187)\nAPIæ€»ç»“ \u0026lt;termios.h\u0026gt; /* Return the output baud rate stored in *TERMIOS_P. */\rextern speed_t cfgetospeed (const struct termios *__termios_p) __THROW;\r/* Return the input baud rate stored in *TERMIOS_P. */\rextern speed_t cfgetispeed (const struct termios *__termios_p) __THROW;\r/* Set the output baud rate stored in *TERMIOS_P to SPEED. */\rextern int cfsetospeed (struct termios *__termios_p, speed_t __speed) __THROW;\r/* Set the input baud rate stored in *TERMIOS_P to SPEED. */\rextern int cfsetispeed (struct termios *__termios_p, speed_t __speed) __THROW;\r#ifdef\t__USE_MISC\r/* Set both the input and output baud rates in *TERMIOS_OP to SPEED. */\rextern int cfsetspeed (struct termios *__termios_p, speed_t __speed) __THROW;\r#endif\r/* Put the state of FD into *TERMIOS_P. */\rextern int tcgetattr (int __fd, struct termios *__termios_p) __THROW;\r/* Set the state of FD to *TERMIOS_P.\rValues for OPTIONAL_ACTIONS (TCSA*) are in \u0026lt;bits/termios.h\u0026gt;. */\rextern int tcsetattr (int __fd, int __optional_actions,\rconst struct termios *__termios_p) __THROW;\r#ifdef\t__USE_MISC\r/* Set *TERMIOS_P to indicate raw mode. */\rextern void cfmakeraw (struct termios *__termios_p) __THROW;\r#endif\r/* Send zero bits on FD. */\rextern int tcsendbreak (int __fd, int __duration) __THROW;\r/* Wait for pending output to be written on FD.\rThis function is a cancellation point and therefore not marked with\r__THROW. */\rextern int tcdrain (int __fd);\r/* Flush pending data on FD.\rValues for QUEUE_SELECTOR (TC{I,O,IO}FLUSH) are in \u0026lt;bits/termios.h\u0026gt;. */\rextern int tcflush (int __fd, int __queue_selector) __THROW;\r/* Suspend or restart transmission on FD.\rValues for ACTION (TC[IO]{OFF,ON}) are in \u0026lt;bits/termios.h\u0026gt;. */\rextern int tcflow (int __fd, int __action) __THROW;\r#if defined __USE_XOPEN_EXTENDED || defined __USE_XOPEN2K8\r/* Get process group ID for session leader for controlling terminal FD. */\rextern __pid_t tcgetsid (int __fd) __THROW;\r#endif\r open()å‡½æ•° åŠŸèƒ½ï¼šæ‰“å¼€è®¾å¤‡æ–‡ä»¶\nè¿”å›å€¼ï¼šå¦‚æœæ“ä½œæˆåŠŸï¼Œå®ƒå°†è¿”å›ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œå¦‚æœæ“ä½œå¤±è´¥ï¼Œå®ƒå°†è¿”å›-1\nint open (const char *__path, int __oflag, ...)\r  note:flags = O_RDWR | O_NOCTTY | O_NDELAY | O_EXCL;ï¼ˆlibmodbusä»£ç æˆªå–ï¼‰\nO_RDWR ï¼š å¯è¯»å¯å†™\nO_NOCTTY ï¼šè¯¥å‚æ•°ä¸ä¼šä½¿æ‰“å¼€çš„æ–‡ä»¶æˆä¸ºè¯¥è¿›ç¨‹çš„æ§åˆ¶ç»ˆç«¯ã€‚å¦‚æœæ²¡æœ‰æŒ‡å®šè¿™ä¸ªæ ‡å¿—ï¼Œé‚£ä¹ˆä»»ä½•ä¸€ä¸ª è¾“å…¥éƒ½å°†ä¼šå½±å“ç”¨æˆ·çš„è¿›ç¨‹ã€‚\nO_NDELAY ï¼šè¿™ä¸ªç¨‹åºä¸å…³å¿ƒDCDä¿¡å·çº¿æ‰€å¤„çš„çŠ¶æ€,ç«¯å£çš„å¦ä¸€ç«¯æ˜¯å¦æ¿€æ´»æˆ–è€…åœæ­¢ã€‚å¦‚æœç”¨æˆ·ä¸æŒ‡å®šäº†è¿™ä¸ªæ ‡å¿—ï¼Œåˆ™è¿›ç¨‹å°†ä¼šä¸€ç›´å¤„åœ¨ç¡çœ çŠ¶æ€ï¼Œç›´åˆ°DCDä¿¡å·çº¿è¢«æ¿€æ´»ã€‚\nO_EXCLï¼šåŸå­æ“ä½œï¼Œç¡®ä¿åªæœ‰ä¸€ä¸ªæ‰§è¡Œæµä½¿ç”¨è¿™ä¸ªè®¾å¤‡æ–‡ä»¶\n tcgetattr()å‡½æ•° åŠŸèƒ½ï¼šè·å–ç»ˆç«¯çš„å±æ€§\nè¿”å›å€¼ï¼šè¿”å›å€¼ï¼šè°ƒç”¨æˆåŠŸæ—¶è¿”å› 0ï¼›å¤±è´¥å°†è¿”å›-1\n#include \u0026lt;termios.h\u0026gt;\rint tcgetattr(int fd, struct termios *termios_p);\r tcsetattr()å‡½æ•° åŠŸèƒ½ï¼šä¿®æ”¹ç»ˆç«¯çš„å±æ€§\nè¿”å›å€¼ï¼šè¿”å›å€¼ï¼šè°ƒç”¨æˆåŠŸæ—¶è¿”å› 0ï¼›å¤±è´¥å°†è¿”å›-1\n#include \u0026lt;termios.h\u0026gt;\rint tcsetattr(int fd, int optional_actions,const struct termios *termios_p);\r  noteï¼šoptional_actions\u0026ndash;æ›´æ”¹ä½•æ—¶ç”Ÿæ•ˆ\n         TCSANOW é…ç½®ç«‹å³ç”Ÿæ•ˆ   TCSADRAIN é…ç½®åœ¨æ‰€æœ‰å†™å…¥ fd çš„è¾“å‡ºéƒ½ä¼ è¾“å®Œæ¯•ä¹‹åç”Ÿæ•ˆ   TCSAFLUSH æ‰€æœ‰å·²æ¥æ”¶ä½†æœªè¯»å–çš„è¾“å…¥éƒ½å°†åœ¨é…ç½®ç”Ÿæ•ˆä¹‹å‰è¢«ä¸¢å¼ƒ     cfmakeraw()å‡½æ•° åŠŸèƒ½ï¼šå°†ç»ˆç«¯é…ç½®ä¸ºåŸå§‹æ¨¡å¼ã€‚\nvoid cfmakeraw(struct termios *termios_p);\r æ³¢ç‰¹ç‡è®¾ç½® //è·å–è¾“å…¥è¾“å‡ºæ³¢ç‰¹ç‡\rextern speed_t cfgetospeed (const struct termios *__termios_p) __THROW;\rextern speed_t cfgetispeed (const struct termios *__termios_p) __THROW;\r//ä¿®æ”¹è¾“å…¥è¾“å‡ºæ³¢ç‰¹ç‡\rextern int cfsetospeed (struct termios *__termios_p, speed_t __speed) __THROW;\rextern int cfsetispeed (struct termios *__termios_p, speed_t __speed) __THROW;\r//åŒæ—¶ä¿®æ”¹è¾“å…¥è¾“å‡ºæ³¢ç‰¹ç‡\rextern int cfsetspeed (struct termios *__termios_p, speed_t __speed) __THROW;\r tcdrain()å‡½æ•° åŠŸèƒ½ï¼šè°ƒç”¨ tcdrain()å‡½æ•°åä¼šä½¿å¾—åº”ç”¨ç¨‹åºé˜»å¡ï¼Œ ç›´åˆ°ä¸²å£è¾“å‡ºç¼“å†²åŒºä¸­çš„æ•°æ®å…¨éƒ¨å‘é€å®Œæ¯•ä¸ºæ­¢\nè¿”å›å€¼ï¼šè°ƒç”¨æˆåŠŸæ—¶è¿”å› 0ï¼›å¤±è´¥å°†è¿”å›-1ï¼Œ\n#include \u0026lt;termios.h\u0026gt; int tcdrain(int fd);\r tcflush()å‡½æ•° åŠŸèƒ½ï¼šè°ƒç”¨è¯¥å‡½æ•°ä¼šæ¸…ç©ºè¾“å…¥/è¾“å‡ºç¼“å†²åŒºä¸­çš„æ•°æ®\nè¿”å›å€¼ï¼šè¿”å›å€¼ï¼šè°ƒç”¨æˆåŠŸæ—¶è¿”å› 0ï¼›å¤±è´¥å°†è¿”å›-1\n#include \u0026lt;termios.h\u0026gt;\rint tcflush(int fd, int queue_selector);\r  note:queue_selector\n   TCIFLUSH å¯¹æ¥æ”¶åˆ°è€Œæœªè¢«è¯»å–çš„æ•°æ®è¿›è¡Œæ¸…ç©ºå¤„ç†     TCOFLUSH å¯¹å°šæœªä¼ è¾“æˆåŠŸçš„è¾“å‡ºæ•°æ®è¿›è¡Œæ¸…ç©ºå¤„ç†   TCIOFLUSH å¯¹å°šæœªå¤„ç†çš„è¾“å…¥/è¾“å‡ºæ•°æ®è¿›è¡Œæ¸…ç©ºå¤„ç†     tcflow()å‡½æ•° åŠŸèƒ½ï¼šè°ƒç”¨ tcflow()å‡½æ•°ä¼šæš‚åœæ•°æ®ä¼ è¾“æˆ–æ¥æ”¶å·¥ä½œã€‚\nè¿”å›å€¼ï¼šè¿”å›å€¼ï¼šè°ƒç”¨æˆåŠŸæ—¶è¿”å› 0ï¼›å¤±è´¥å°†è¿”å›-1ã€‚\n#include \u0026lt;termios.h\u0026gt;\rint tcflow(int fd, int action);\r  note: action\n         TCOOFF æš‚åœæ•°æ®è¾“å‡ºï¼ˆè¾“å‡ºä¼ è¾“ï¼‰   TCOON é‡æ–°å¯åŠ¨æš‚åœçš„è¾“å‡º   TCIOFF å‘é€ STOP å­—ç¬¦ï¼Œåœæ­¢ç»ˆç«¯è®¾å¤‡å‘ç³»ç»Ÿå‘é€æ•°æ®   TCION å‘é€ä¸€ä¸ª START å­—ç¬¦ï¼Œå¯åŠ¨ç»ˆç«¯è®¾å¤‡å‘ç³»ç»Ÿå‘é€æ•°æ®ï¼›     struct termiosç»“æ„ä½“ struct termios\r{\rtcflag_t c_iflag; /* input mode flags */\rtcflag_t c_oflag; /* output mode flags */\rtcflag_t c_cflag; /* control mode flags */\rtcflag_t c_lflag; /* local mode flags */\rcc_t c_line; /* line discipline */\rcc_t c_cc[NCCS]; /* control characters */\rspeed_t c_ispeed; /* input speed */\rspeed_t c_ospeed; /* output speed */\r};\r æ³¢ç‰¹ç‡ã€æ•°æ®ä½ã€åœæ­¢ä½ä½¿ç”¨æ¡ˆä¾‹ /*0. ä¿å­˜åŸæœ‰çš„termios*/\rtcgetattr(this-\u0026gt;fd, \u0026amp;old_termios);\r/*1. è®¾ç½®æ³¢ç‰¹ç‡ */\rnew_termios.c_cflag\u0026amp;=~CBAUD;//æ³¢ç‰¹ç‡æ©ç (000000010017 /* baud speed mask)\rif(cfsetispeed(\u0026amp;(new_termios),baud_adapt(baudrate))\u0026lt;0)\r{\rstd::cerr\u0026lt;\u0026lt;\u0026quot;[err]:function cfsetispeed()--set \u0026quot;\u0026lt;\u0026lt; baudrate\u0026lt;\u0026lt;\u0026quot; input baudrate failed!!!\\n\u0026quot;;\rthis-\u0026gt;uart_close();\rreturn -1;\r}\rif(cfsetospeed(\u0026amp;(new_termios),baud_adapt(baudrate))\u0026lt;0)\r{\rstd::cerr\u0026lt;\u0026lt;\u0026quot;[err]:function cfsetospeed()--set \u0026quot;\u0026lt;\u0026lt; baudrate\u0026lt;\u0026lt;\u0026quot; output baudrate failed!!!\\n\u0026quot;;\rthis-\u0026gt;uart_close();\rreturn -1;\r}\r/* 2.è®¾ç½®æ•°æ®ä½ */\rnew_termios.c_cflag\u0026amp;=~CSIZE;//å±è”½å…¶ä»–æ ‡å¿—\rswitch (databits)//è®¾ç½®æ•°æ®ä½\r{\rcase 5:\rnew_termios.c_cflag|=CS5;\rbreak;\rcase 6:\rnew_termios.c_cflag|=CS6;\rbreak;\rcase 7:\rnew_termios.c_cflag|=CS7;\rbreak;\rcase 8:\rnew_termios.c_cflag|=CS8;\rbreak;\rdefault:\rthis-\u0026gt;uart_close();\rstd::cerr\u0026lt;\u0026lt;\u0026quot;[err]:set databits failed!!!\\n\u0026quot;;\rreturn -1;\rbreak;\r}\r/*3. è®¾ç½®å¥‡å¶æ£€éªŒ */\rswitch (parity)\r{\rcase 'N'://æ— \rnew_termios.c_iflag \u0026amp;= ~(INPCK | ISTRIP);//å…³é—­è¾“å…¥å¥‡å¶æ£€éªŒæ£€æŸ¥\rnew_termios.c_cflag \u0026amp;= ~PARENB;//å…³é—­å¥‡å¶ä½\rbreak;\rcase 'E'://å¥‡\rnew_termios.c_iflag |= (INPCK );//å¼€å¯è¾“å…¥å¥‡å¶æ£€éªŒæ£€æŸ¥\rnew_termios.c_cflag |= PARENB;//å¼€å¯å¥‡å¶ä½\rnew_termios.c_cflag \u0026amp;= ~PARODD;//å…³é—­å¶ä½\rbreak;\rcase 'O'://å¶\rnew_termios.c_iflag |= (INPCK);//å¼€å¯è¾“å…¥å¥‡å¶æ£€éªŒæ£€æŸ¥\rnew_termios.c_cflag|= PARENB;//å¼€å¯å¥‡å¶ä½\rnew_termios.c_cflag |= PARODD;//å¼€å¯å¶ä½\rbreak;\rdefault:\rthis-\u0026gt;uart_close();\rstd::cerr\u0026lt;\u0026lt;\u0026quot;[err]:set parity failed!!!\\n\u0026quot;;\rreturn -1;\rbreak;\r}\r/*4. è®¾ç½®åœæ­¢ä½ */\rswitch (stopbits)\r{\rcase 1:\rnew_termios.c_cflag \u0026amp;= ~CSTOPB;\rbreak;\rcase 2:\rnew_termios.c_cflag |= CSTOPB;//æ¯ä¸ªå­—ç¬¦ä½¿ç”¨2bitåœæ­¢ä½ï¼Œå¦è€…å°±ä½¿ç”¨ä¸€ä¸ª\rbreak;\rdefault:\rthis-\u0026gt;uart_close();\rbreak;\r}\r/*5. è®¾ç½®éè§„èŒƒæ¨¡å¼(å³rawæ¨¡å¼)ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨cfmakeraw()å‡½æ•°*/\rnew_termios.c_lflag \u0026amp;= ~(ICANON | ECHO | ECHOE | ISIG);\rnew_termios.c_oflag \u0026amp;=~ OPOST; /* Raw output */\rnew_termios.c_cc[VMIN]=0;\rnew_termios.c_cc[VTIME]=1;\r/*6.other*/\rnew_termios.c_oflag \u0026amp;= ~OPOST; /* Raw output */\rnew_termios.c_iflag \u0026amp;= ~(IXON | IXOFF | IXANY); /* Software flow control is disabled */\rnew_termios.c_iflag \u0026amp;= ~(IUCLC|ICRNL|INLCR|IGNCR);/* 1.å…³é—­inputå¤§å°å†™è½¬æ¢ 2.ç¦æ­¢CRã€LFç›¸äº’è½¬æ¢ 3.ä¸å¿½ç•¥CRã€LF*/\rnew_termios.c_oflag \u0026amp;= ~(OLCUC|OCRNL|ONLCR);/* 1.å…³é—­outputå¤§å°å†™è½¬æ¢ 2.åŒä¸Š*/\r/*7.è®¾ç½®ç”Ÿæ•ˆ */\rif(tcsetattr(this-\u0026gt;fd,TCSANOW,\u0026amp;(new_termios))\u0026lt;0)\r{\rstd::cerr\u0026lt;\u0026lt;\u0026quot;[err]:function tcsetattr()--set attr failed!!!\\n\u0026quot;;\rthis-\u0026gt;uart_close();\rreturn -1;\r}\r éè§„èŒƒæ¨¡å¼ï¼šC_CC[]\u0026ndash;MIN TIME ä»£ç åŠå…¶æµ‹è¯• ä»£ç  [ä»£ç æ¡ˆä¾‹ click here](code/02c/uart at main Â· Getonechao/code (github.com))\næµ‹è¯• %å†™\rclear;\rdevice=serialport(\u0026quot;COM5\u0026quot;,115200,\u0026quot;Parity\u0026quot;,\u0026quot;even\u0026quot;,\u0026quot;DataBits\u0026quot;,8,\u0026quot;StopBits\u0026quot;,1);\rflush(device);\rfor i=1:10\rwrite(device,[0:255],\u0026quot;uint8\u0026quot;);\rend\r%è¯»\rclear;\rdevice=serialport(\u0026quot;COM5\u0026quot;,115200,\u0026quot;Parity\u0026quot;,\u0026quot;even\u0026quot;,\u0026quot;DataBits\u0026quot;,8,\u0026quot;StopBits\u0026quot;,1);\rflush(device);\rret=read(device,3,\u0026quot;uint8\u0026quot;)\r ","id":22,"section":"categories","summary":"LINUXä¸²å£ç¼–ç¨‹\u0026ndash;raw å‚è€ƒblog [ linux-ä¸²å£åº”ç”¨ç¼–ç¨‹_é‚»å±…å®¶çš„å°å—ç“œçš„åšå®¢-CSDNåšå®¢](https://blog","tags":[" c","project ","linux"],"title":"Linuxä¸²å£ç¼–ç¨‹","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/lang/c/linux%E4%B8%B2%E5%8F%A3%E7%BC%96%E7%A8%8B/","year":"2022"},{"content":"ubuntuç³»ç»Ÿåˆå§‹åŒ–å¸¸ç”¨ä¸€äº›æŒ‡ä»¤ æ¢æº sudo cp /etc/apt/sources.list /etc/apt/sources.list.bak\rsudo nano /etc/apt/sources.list\r æ¸…åæº  # æ¸…åæº\r18.04\rdeb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic main restricted universe multiverse\rdeb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic main restricted universe multiverse\rdeb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-updates main restricted universe multiverse\rdeb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-updates main restricted universe multiverse\rdeb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-backports main restricted universe multiverse\rdeb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-backports main restricted universe multiverse\rdeb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-security main restricted universe multiverse\rdeb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-security main restricted universe multiverse\rdeb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-proposed main restricted universe multiverse\rdeb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-proposed main restricted universe multiverse\r20.04\rdeb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse\rdeb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse\rdeb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse\rdeb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse\rdeb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse\rdeb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse\rdeb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-security main restricted universe multiverse\rdeb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-security main restricted universe multiverse multiverse\r é˜¿é‡Œæº 18.04\rdeb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic main restricted universe multiverse\rdeb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic main restricted universe multiverse\rdeb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-updates main restricted universe multiverse\rdeb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-updates main restricted universe multiverse\rdeb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-backports main restricted universe multiverse\rdeb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-backports main restricted universe multiverse\rdeb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-security main restricted universe multiverse\rdeb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-security main restricted universe multiverse\rdeb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-proposed main restricted universe multiverse\rdeb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-proposed main restricted universe multiverse\r20.04\rdeb http://mirrors.aliyun.com/ubuntu/ focal main restricted universe multiverse\rdeb-src http://mirrors.aliyun.com/ubuntu/ focal main restricted universe multiverse\rdeb http://mirrors.aliyun.com/ubuntu/ focal-security main restricted universe multiverse\rdeb-src http://mirrors.aliyun.com/ubuntu/ focal-security main restricted universe multiverse\rdeb http://mirrors.aliyun.com/ubuntu/ focal-updates main restricted universe multiverse\rdeb-src http://mirrors.aliyun.com/ubuntu/ focal-updates main restricted universe multiverse\rdeb http://mirrors.aliyun.com/ubuntu/ focal-proposed main restricted universe multiverse\rdeb-src http://mirrors.aliyun.com/ubuntu/ focal-proposed main restricted universe multiverse\rdeb http://mirrors.aliyun.com/ubuntu/ focal-backports main restricted universe multiverse\rdeb-src http://mirrors.aliyun.com/ubuntu/ focal-backports main restricted universe multiverse\r æ›´æ–°æº sudo apt-get update\r å®‰è£…å·¥å…· sudo apt install g++ cmake openssh-server libtool autoconf git\r  noteï¼šå¦‚æœvscodeæˆ–è€…sshåœ¨è£…æ–°ç³»ç»Ÿå¤±è´¥åï¼Œå¯èƒ½æ˜¯.ssh/known_hostsæ–‡ä»¶ä¸­ipå¯¹åº”çš„æŒ‡çº¹è¿˜æ˜¯æ—§çš„ã€‚\n git config --global user.email \u0026quot;1509670272@qq.com\u0026quot;\rgit config --global user.name \u0026quot;chao\u0026quot;\r SSH-å…¬é’¥ç”Ÿæˆ ssh-keygen -t rsa -C \u0026quot;chao\u0026quot;\rcat ~/.ssh/id_rsa.pub æ— å¯†ç sshç™»å…¥å…¶ä»–ubuntuç³»ç»Ÿ\r$ cat ~/.ssh/id_rsa.pub(æœ¬åœ°) \u0026gt;\u0026gt; ~/.ssh/authorized_keys(è¿œç¨‹)  åˆ›å»ºæ–°ç”¨æˆ· åˆ›å»ºç”¨æˆ·\ruseradd chao -p chao -m -G wheelï¼ˆæˆ–sudoï¼‰ -s /bin/bash -c \u0026quot;2021-6-3 create 'chao' username \u0026quot;\rä¿®æ”¹å¯†ç \rpasswd chao\r ","id":23,"section":"categories","summary":"ubuntuç³»ç»Ÿåˆå§‹åŒ–å¸¸ç”¨ä¸€äº›æŒ‡ä»¤ æ¢æº sudo cp /etc/apt/sources.list /etc/apt/sources.list.bak sudo nano /etc/apt/sources.list æ¸…åæº # æ¸…åæº 18.04 deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic main restricted universe multiverse deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic main restricted universe multiverse deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-updates main restricted universe multiverse deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-updates main restricted universe multiverse deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-backports main restricted universe multiverse deb-src","tags":[" ubuntu","command"],"title":"ubuntuç³»ç»Ÿåˆå§‹åŒ–å¸¸ç”¨ä¸€äº›æŒ‡ä»¤","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/os/ubuntu/ubuntu%E7%B3%BB%E7%BB%9F%E5%88%9D%E5%A7%8B%E5%8C%96%E9%85%8D%E7%BD%AE%E6%93%8D%E4%BD%9C/","year":"2022"},{"content":"libmodbusçš„ä½¿ç”¨ å®‰è£… wget https://github.com/stephane/libmodbus/archive/refs/tags/v3.1.7.zip\runzip v3.1.7.zip\rsudo apt install libtool\rsudo apt install autoconf\r./autoconf\r./configure --prefix=/usr/local/\rsudo make install\r æºç è§£æ å‚è€ƒç½‘å€\n ã€åµŒå…¥å¼ã€‘Libmodbusæºç åˆ†æ(ä¸€)-ç±»å‹å’Œç»“æ„ä½“_æ²§æµ·ä¸€ç¬‘-djçš„åšå®¢-CSDNåšå®¢_libmodbusæºç  ã€åµŒå…¥å¼ã€‘Libmodbusæºç åˆ†æ(äºŒ)-å¸¸ç”¨æ¥å£å‡½æ•°åˆ†æ_æ²§æµ·ä¸€ç¬‘-djçš„åšå®¢-CSDNåšå®¢_modbusæ¥å£å‡½æ•° ã€åµŒå…¥å¼ã€‘Libmodbusæºç åˆ†æ(ä¸‰)-modbusç›¸å…³å‡½æ•°åˆ†æ_æ²§æµ·ä¸€ç¬‘-djçš„åšå®¢-CSDNåšå®¢_libmodbusä»£ç ç¤ºä¾‹ ã€åµŒå…¥å¼ã€‘Libmodbusæºç åˆ†æ(å››)-RTUç›¸å…³å‡½æ•°åˆ†æ_æ²§æµ·ä¸€ç¬‘-djçš„åšå®¢-CSDNåšå®¢ ã€åµŒå…¥å¼ã€‘Libmodbusæºç åˆ†æ(äº”)-TCPç›¸å…³å‡½æ•°åˆ†æ_æ²§æµ·ä¸€ç¬‘-djçš„åšå®¢-CSDNåšå®¢ ã€åµŒå…¥å¼ã€‘åµŒå…¥å¼å¤©åœ°åšå®¢æ±‡æ€»_æ²§æµ·ä¸€ç¬‘-djçš„åšå®¢-CSDNåšå®¢ [libmodbuså®˜æ–¹æ‰‹å†Œä¸­æ–‡ç¿»è¯‘_è·ƒåŠ¨çš„é£çš„åšå®¢-CSDNåšå®¢_libmodbusä½¿ç”¨è¯´æ˜](https://blog.csdn.net/qq_23670601/article/details/82155378?ops_request_misc=\u0026amp;request_id=\u0026amp;biz_id=102\u0026amp;utm_term=libmodbus debug\u0026amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-1-82155378.142^v9^pc_search_result_control_group,157^v4^new_style\u0026amp;spm=1018.2226.3001.4187)   note: å¦‚æœä½¿ç”¨matlab modbus explorer,matlabä¸­çš„å¯„å­˜å™¨åœ°å€ä»1å¼€å¼€å§‹ç®—èµ·ï¼Œå®é™…åº”è¯¥libmodbusä¸­çš„åœ°å€0\n ","id":24,"section":"categories","summary":"libmodbusçš„ä½¿ç”¨ å®‰è£… wget https://github.com/stephane/libmodbus/archive/refs/tags/v3.1.7.zip unzip v3.1.7.zip sudo apt install libtool sudo apt install autoconf ./autoconf ./configure --prefix=/usr/local/ sudo make install æºç è§£æ å‚è€ƒç½‘å€ ã€åµŒå…¥å¼ã€‘Libmodbusæºç åˆ†æ(ä¸€)-ç±»å‹å’Œç»“æ„ä½“_æ²§","tags":[" project","c"],"title":"Libmodbus","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/lang/c/libmodbus/","year":"2022"},{"content":"Cmakeæ¨¡æ¿ cmake_minimum_required(VERSION 3.1)\rproject(PROJECT_XXX VERSION 0.0.0.0 )\r#C/C++æ ‡å‡†\rset(CMAKE_CXX_STANDARD 14)\rset(CMAKE_C_STANDARD 11)\r#è®¾ç½®ç¼–è¯‘å™¨\rset (CMAKE_C_COMPILER \u0026quot;/usr/bin/gcc\u0026quot;)\rset (CMAKE_CXX_COMPILER \u0026quot;/usr/bin/g++\u0026quot;)\r#lib\u0026amp;\u0026amp;bin\rset(LIBRARY_OUTPUT_PATH ${CMAKE_CURRENT_SOURCE_DIR}/lib)\rset(EXECUTABLE_OUTPUT_PATH ${CMAKE_CURRENT_SOURCE_DIR}/bin)\r#release debug\rset(CMAKE_BUILD_TYPE Debug#[[Release | Debug| RelWithDebInfo |MinSizeRel]])\r#add_compile_options()#ç­‰åŒCMAKE_CXXFLAGS_RELESE,å‰è€…å¯ä»¥å¯¹æ‰€æœ‰çš„ç¼–è¯‘å™¨è®¾ç½®ï¼Œåè€…åªèƒ½æ˜¯C++ç¼–è¯‘å™¨\rinclude_directories(\rç›®å½•\r)\raux_source_directory(ç›®å½• å˜é‡)\r#FIND_LIBRARY(#å˜é‡ libceres.so #ç›®å½•)\radd_executable(${PROJECT_NAME} )\r#target_link_libraries(${PROJECT_NAME} #/usr/local/lib/libmodbus.so)\r ","id":25,"section":"categories","summary":"Cmakeæ¨¡æ¿ cmake_minimum_required(VERSION 3.1) project(PROJECT_XXX VERSION 0.0.0.0 ) #C/C++æ ‡å‡† set(CMAKE_CXX_STANDARD 14) set(CMAKE_C_STANDARD 11) #è®¾ç½®ç¼–è¯‘å™¨ set (CMAKE_C_COMPILER \u0026quot;/usr/bin/gcc\u0026quot;) set (CMAKE_CXX_COMPILER \u0026quot;/usr/bin/g++\u0026quot;) #lib\u0026amp;\u0026amp;bin set(LIBRARY_OUTPUT_PATH ${CMAKE_CURRENT_SOURCE_DIR}/lib) set(EXECUTABLE_OUTPUT_PATH ${CMAKE_CURRENT_SOURCE_DIR}/bin) #release debug set(CMAKE_BUILD_TYPE Debug#[[Release | Debug| RelWithDebInfo |MinSizeRel]]) #add_compile_options","tags":[" project","cmake"],"title":"cmake æ¨¡æ¿","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/app/cmake/template/","year":"2022"},{"content":"ä½¿ç”¨vspdé…ç½®VMçš„è™šæ‹Ÿæœºçš„ä¸²å£è°ƒè¯• ä¸‹è½½vspd  é“¾æ¥ï¼šhttps://pan.baidu.com/s/15sQ3B3Ty4QGH8Rvl7yFz0g æå–ç ï¼škjdw\n åˆ›å»ºè™šæ‹Ÿä¸²å£ VMç»‘å®šç›¸åº”çš„ä¸²å£  note:\n å°†windowsçš„ä¸²å£com5ç»‘å®šåˆ°linuxçš„ä¸²å£/dev/ttyS1ä¸Š å¦‚æœVmæ²¡æœ‰æ£€æµ‹åˆ°è™šæ‹Ÿä¸²å£ï¼Œè¯·å…³é—­vmï¼Œé‡å¯vm å›¾ç‰‡ä¸­çš„\u0026quot;ä¸²è¡Œç«¯å£n\u0026quot;ï¼Œå®é™…å¯¹åº”linuxç³»ç»Ÿä¸­/dev/ttyS(n-1)   ","id":26,"section":"categories","summary":"ä½¿ç”¨vspdé…ç½®VMçš„è™šæ‹Ÿæœºçš„ä¸²å£è°ƒè¯• ä¸‹è½½vspd é“¾æ¥ï¼šhttps://pan.baidu.com/s/15sQ3B3Ty4QGH8Rvl7","tags":[" project"],"title":"vspd\u0026VM","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/app/vspd/","year":"2022"},{"content":"freemodus æºç  cwalter-at/freemodbus\narmink/FreeModbus_Slave-Master-RTT-STM32: Add master mode to FreeModbus. | åœ¨ FreeModbus ä¸­æ·»åŠ ä¸»æœºæ¨¡å¼ (github.com)\nmodbus          0x01 è¯»çº¿åœˆå¯„å­˜å™¨   0x02 è¯»ç¦»æ•£è¾“å…¥å¯„å­˜å™¨   0x03 è¯»ä¿æŒå¯„å­˜å™¨   0x04 è¯»è¾“å…¥å¯„å­˜å™¨   0x05 å†™å•ä¸ªçº¿åœˆå¯„å­˜å™¨   0x06 å†™å•ä¸ªä¿æŒå¯„å­˜å™¨   0x0f å†™å¤šä¸ªçº¿åœˆå¯„å­˜å™¨   0x10 å†™å¤šä¸ªä¿æŒå¯„å­˜å™¨    çº¿åœˆå¯„å­˜å™¨ï¼ˆ0x01ã€0x05ã€0x0fï¼‰  å¯„å­˜å™¨çš„å•ä½æ˜¯1bit,ç±»æ¯”ä¸ºå¼€å…³é‡ï¼Œæ¯ä¸€ä¸ªbitéƒ½å¯¹åº”ä¸€ä¸ªä¿¡å·çš„å¼€å…³çŠ¶æ€ï¼Œ1byteæœ‰8bit\n ç¦»æ•£è¾“å…¥å¯„å­˜å™¨ï¼ˆ0x02ï¼‰  ç¦»æ•£è¾“å…¥å¯„å­˜å™¨å°±ç›¸å½“äºçº¿åœˆå¯„å­˜å™¨çš„åªè¯»æ¨¡å¼\n ä¿æŒå¯„å­˜å™¨ï¼ˆ0x03ã€0x06ã€0x10ï¼‰  å¯„å­˜å™¨çš„å•ä½æ˜¯2byte,å³16bit\n è¾“å…¥å¯„å­˜å™¨ï¼ˆ0x04ï¼‰  å’Œä¿æŒå¯„å­˜å™¨ç±»ä¼¼ï¼Œä½†æ˜¯ä¹Ÿæ˜¯åªæ”¯æŒè¯»è€Œä¸èƒ½å†™\n modbusåœ°å€è§„èŒƒ 00001è‡³09999æ˜¯ç¦»æ•£è¾“å‡º(çº¿åœˆ)\u0026mdash;\u0026ndash;Coil status 10001è‡³19999æ˜¯ç¦»æ•£è¾“å…¥(è§¦ç‚¹)\u0026mdash;\u0026ndash;Input status 30001è‡³39999æ˜¯è¾“å…¥å¯„å­˜å™¨(é€šå¸¸æ˜¯æ¨¡æ‹Ÿé‡è¾“å…¥)\u0026mdash;\u0026mdash;Input register 40001è‡³49999æ˜¯ä¿æŒå¯„å­˜å™¨ \u0026mdash;\u0026mdash;-Holding register\nâ€ƒ0xä»£è¡¨çº¿åœˆï¼ˆDOï¼‰ç±»åœ°å€ï¼Œ1xä»£è¡¨è§¦ç‚¹ï¼ˆDIï¼‰ç±»åœ°å€ã€ 3xä»£è¡¨è¾“å…¥å¯„å­˜å™¨ï¼ˆAIï¼‰ç±»åœ°å€ã€4xä»£è¡¨è¾“å‡ºå¯„å­˜å™¨ï¼ˆAOï¼‰ç±»åœ°å€ã€‚åœ¨å®é™…ç¼–ç¨‹ä¸­ï¼Œç”±äºå‰ç¼€çš„åŒºåˆ†ä½œç”¨ï¼Œæ‰€ä»¥åªéœ€è¯´æ˜å4ä½æ•°ï¼Œè€Œä¸”éœ€è½¬æ¢ä¸º4ä½åå…­è¿›åˆ¶åœ°å€\nLinuxçš„ä½¿ç”¨ â€ƒå®˜æ–¹è§„å®šçš„æµç¨‹ï¼š\n * // Initialize protocol stack in RTU mode for a slave with address 10 = 0x0A\r* eMBInit( MB_RTU, 0x0A, 38400, MB_PAR_EVEN );\r* // Enable the Modbus Protocol Stack.\r* eMBEnable( );\r* for( ;; )\r* {\r* // Call the main polling loop of the Modbus protocol stack.\r* eMBPoll( );\r* ...\r* }\r RTU #include \u0026lt;iostream\u0026gt;\r#include \u0026quot;mb.h\u0026quot;\r#include \u0026quot;mbport.h\u0026quot;\r#define REG_INPUT_START 1000 /* è¾“å…¥å¯„å­˜å™¨å¼€å§‹åœ°å€ */\r#define REG_INPUT_NREGS 4 /* usRegInputBufæ•°ç»„å¤§å° */\r#define REG_HOLDING_START 2000 /* ä¿æŒå¯„å­˜å™¨å¼€å§‹åœ°å€ */\r#define REG_HOLDING_NREGS 130 /* usRegHoldingBufæ•°ç»„å¤§å° */\rint main()\r{\r/*RTUmæ¨¡å¼ ä»æœºåœ°å€ uart æ³¢ç‰¹ç‡ å¥‡å¶æ— æ ¡éªŒ */\reMBInit( MB_RTU, 0x05,0,115200, MB_PAR_NONE );\rif(eMBEnable( )== MB_ENOERR)\r{ for( ;; )\r{\r// Call the main polling loop of the Modbus protocol stack.\rif( eMBPoll( ) != MB_ENOERR )\rbreak;\r}\rstd::cerr\u0026lt;\u0026lt;\u0026quot;err: eMBPoll failed!\u0026quot;;\r}\relse\r{\rstd::cerr\u0026lt;\u0026lt;\u0026quot;err: eMBEnable failed!\u0026quot;;\r}\rreturn 0;\r}\r/* ----------------------- Static variables ---------------------------------*/\rstatic USHORT usRegInputStart = REG_INPUT_START;\rstatic USHORT usRegInputBuf[REG_INPUT_NREGS]={0x1,0x2,0x3,0x4}; //è¾“å…¥å¯„å­˜å™¨æ•°ç»„\rstatic USHORT usRegHoldingStart = REG_HOLDING_START;\rstatic USHORT usRegHoldingBuf[REG_HOLDING_NREGS];//ä¿æŒå¯„å­˜å™¨æ•°ç»„\r/* è¾“å…¥å¯„å­˜å™¨ */\reMBErrorCode eMBRegInputCB( UCHAR * pucRegBuffer, USHORT usAddress,USHORT usNRegs )\r{\reMBErrorCode eStatus = MB_ENOERR;\rint iRegIndex;\rstd::cout\u0026lt;\u0026lt;\u0026quot;enter\\n\u0026quot;;\r/**\r* æ»¡è¶³æ¡ä»¶ï¼š\r* 1. ä¸»æœºè¯·æ±‚åœ°å€å¤§äºREG_INPUT_START\r* 2. ä¸»æœºè¯·æ±‚æ•°æ®é‡ä¸è¶…è¿‡ usRegInputBufæ•°ç»„å¤§å°\r*/\rif( ( usAddress \u0026gt;= REG_INPUT_START )\r\u0026amp;\u0026amp; ( usAddress + usNRegs \u0026lt;= REG_INPUT_START + REG_INPUT_NREGS ) )\r{\riRegIndex = ( int )( usAddress - usRegInputStart );\rwhile( usNRegs \u0026gt; 0 )\r{\r*pucRegBuffer++ = ( unsigned char )( usRegInputBuf[iRegIndex] \u0026gt;\u0026gt; 8 );\r*pucRegBuffer++ = ( unsigned char )( usRegInputBuf[iRegIndex] \u0026amp; 0xFF );\riRegIndex++;\rusNRegs--;\r}\r}\relse\r{\reStatus = MB_ENOREG;\r}\rreturn eStatus;\r}\r/* ä¿æŒå¯„å­˜å™¨ */\reMBErrorCode eMBRegHoldingCB( UCHAR * pucRegBuffer, USHORT usAddress,USHORT usNRegs, eMBRegisterMode eMode )\r{\r}\r/* çº¿åœˆå¯„å­˜å™¨ */\reMBErrorCode eMBRegCoilsCB( UCHAR * pucRegBuffer, USHORT usAddress,USHORT usNCoils, eMBRegisterMode eMode )\r{\r}\r/* ç¦»æ•£è¾“å…¥å¯„å­˜å™¨ */\reMBErrorCode eMBRegDiscreteCB( UCHAR * pucRegBuffer, USHORT usAddress,USHORT usNDiscrete )\r{\r}\r ","id":27,"section":"categories","summary":"freemodus æºç  cwalter-at/freemodbus armink/FreeModbus_Slave-Master-RTT-STM32: Add master mode to FreeModbus. | åœ¨ FreeModbus ä¸­æ·»åŠ ä¸»æœºæ¨¡å¼ (github.com) modbus 0x01 è¯»çº¿åœˆå¯„å­˜å™¨ 0x02 è¯»ç¦»æ•£è¾“å…¥å¯„å­˜å™¨ 0x03 è¯»ä¿æŒå¯„å­˜å™¨ 0x04 è¯»è¾“å…¥å¯„å­˜å™¨ 0x05 å†™å•ä¸ªçº¿åœˆå¯„å­˜å™¨ 0x06 å†™å•ä¸ªä¿æŒå¯„å­˜å™¨","tags":["project","c"],"title":"Freemodbus","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/lang/c/freemodbus/","year":"2022"},{"content":"matlab\u0026ndash;ç¬¦å·è¡¨è¾¾å¼è½¬LaTeXã€Cã€mathmlä»£ç  ç½‘å€\u0026ndash;Code Generation - MATLAB \u0026amp; Simulink - MathWorks ä¸­å›½\nlatex syms f(t);\ry=f==5*exp(-0.8*t)*sin(pi*t);\rlatex(y)\r ans= \u0026lsquo;f\\left(t\\right)=5,{\\mathrm{e}}^{-\\frac{4,t}{5}},\\sin\\left(\\pi ,t\\right)\u0026rsquo;\nMathml syms f(t);\ry=f==5*exp(-0.8*t)*sin(pi*t);\rmathml(y)\r \r\rf\r\r(\r\rt\r\r)\r\r\r\u0026equals;\r\r5\r\u0026InvisibleTimes;\r\r\u0026ee;\r\r-\r\r\r4\r\u0026InvisibleTimes;\rt\r\r5\r\r\r\r\u0026InvisibleTimes;\r\rsin\r\r(\r\r\r\u0026pi;\r\u0026InvisibleTimes;\rt\r\r\r)\r\r\r\r\r\rC 1. å¾—åˆ°ä¸€ä¸ªå‡½æ•°è¡¨è¾¾å¼\rsyms f(t);\rf=5*exp(-0.8*t)*sin(pi*t);\rccode(f)\r2. çŸ©é˜µ\rI3 = sym(eye(3));\rI3code = ccode(I3)\r ç»“æœ\nans =' t0 = exp(t*(-4.0/5.0))*sin(t*3.141592653589793)*5.0;'\r I3code =\r' I3[0][0] = 1.0;\rI3[1][1] = 1.0;\rI3[2][2] = 1.0;'\r ","id":28,"section":"categories","summary":"matlab\u0026ndash;ç¬¦å·è¡¨è¾¾å¼è½¬LaTeXã€Cã€mathmlä»£ç  ç½‘å€\u0026ndash;Code Generation - MATLAB \u0026amp; Simulink - MathWorks ä¸­å›½ latex syms f(t); y=f==5*exp(-0.8*t)*sin(pi*t); latex(y) ans= \u0026lsquo;f\\left(t\\right)=5,{\\mathrm{e}}^{-\\frac{4,t}{5}},\\sin\\left(\\pi ,t\\right)\u0026rsquo; Mathml syms f(t); y=f==5*exp(-0.8*t)*sin(pi*t); mathml(y)","tags":[" matlab"],"title":"matlab--ç¬¦å·è¡¨è¾¾å¼è½¬LaTeXã€Cã€mathmlä»£ç ","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/lang/matlab/%E4%BB%A3%E7%A0%81%E7%94%9F%E6%88%90/","year":"2022"},{"content":"Matlabä¸­ä¸€äº›ç”»å›¾æ–¹å¼ ç¬¦å·è¡¨è¾¾å¼-ç”»å›¾          fimplicit éšå‡½æ•°   fimplicit3 Plot 3-D implicit equation or function   fmesh Plot 3-D mesh   fplot ä¸€èˆ¬å¼ã€å‚æ•°æ–¹ç¨‹   fplot3 Plot 3-D parametric curve   fsurf Plot 3-D surface   ezpolar æåæ ‡   fcontour 3ç»´ï¼Œç­‰é«˜çº¿    ä¾‹å­\nfigure(1);\rsyms f(t);\rf=5*exp(-0.8*t)*sin(pi*t);\rfplot(f,[0,5]);\r ç¬¦å·è¡¨è¾¾å¼-åŠ¨ç”»          fanimator Create stop-motion animation object(åˆ›é€ åŠ¨ç”»å¯¹è±¡)   playAnimation Play animation objects in a MATLAB figure window(æ’­æ”¾)   rewindAnimation Rewind previously played animation objectsï¼ˆå›æ”¾ï¼‰   writeAnimation Save animation as video file(ä¿å­˜)   animationToFrame Return structure of frames from animation objectsï¼ˆç”¨ä¸€ä¸ªæ•°ç»„å­˜å‚¨æ¯ä¸€å¸§ï¼‰    ä¾‹å­\nsyms y(x) t;\rfigure(1);\ry=sin(x);\rfanimator(@fplot,x,y,[0 t],\u0026quot;FrameRate\u0026quot;,2)%å¸§ç‡ä¸º2\raxis equal %xyè½´ç›¸ç­‰\rplayAnimation(figure(4),'AnimationRange',[0 15]);%tçš„å–å€¼èŒƒå›´å®šä¸º[0 15]\rwriteAnimation('wheel.gif')%ä¿å­˜ä¸ºGIF\r ","id":29,"section":"categories","summary":"Matlabä¸­ä¸€äº›ç”»å›¾æ–¹å¼ ç¬¦å·è¡¨è¾¾å¼-ç”»å›¾ fimplicit éšå‡½æ•° fimplicit3 Plot 3-D implicit equation or function fmesh Plot 3-D mesh fplot ä¸€èˆ¬å¼ã€å‚æ•°æ–¹ç¨‹ fplot3 Plot 3-D parametric curve fsurf Plot 3-D surface ezpolar æåæ ‡ fcontour 3ç»´ï¼Œç­‰é«˜çº¿ ä¾‹å­ figure(1); syms f(t);","tags":[" matlab"],"title":"matlab-ç”»å›¾","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/lang/matlab/%E7%94%BB%E5%9B%BE/","year":"2022"},{"content":"å‘¨æœŸä¿¡å·çš„å‚…é‡Œå¶çº§æ•°è¡¨ç¤º çŸ¥è¯†å›é¡¾ æ¬§æ‹‰å…¬å¼ å¤åˆ†æçš„æ¬§æ‹‰å…¬å¼ç‰¹ä¾‹\nå‡è®¾$z=r(cos(\\theta )+ isin(\\theta))$\nå¤æ•°çš„ä¹˜é™¤å…¬å¼ $$Z_{1}Z_{2}=(r_{1}r_{2})(cos(ArgZ_{1}+Arg Z_{2})+isin(ArgZ_{1}+ArgZ_{2}))$$\n$$\\frac{Z_{1}}{Z_{2}}=(\\frac{r_{1}}{r_{2}} )(cos(ArgZ_{1}-Arg Z_{2})+isin(ArgZ_{1}-ArgZ_{2}))$$\nå¤æ•°çš„ä¹˜å¹‚å…¬å¼ ","id":30,"section":"categories","summary":"å‘¨æœŸä¿¡å·çš„å‚…é‡Œå¶çº§æ•°è¡¨ç¤º çŸ¥è¯†å›é¡¾ æ¬§æ‹‰å…¬å¼ å¤åˆ†æçš„æ¬§æ‹‰å…¬å¼ç‰¹ä¾‹ å‡è®¾$z=r(cos(\\theta )+ isin(\\theta))$ å¤æ•°çš„ä¹˜é™¤å…¬å¼ $$Z_{1}Z_{2}=(r_{1}r_{2})(cos(ArgZ_{1}+Arg Z_{2})+isin(ArgZ_{1}+ArgZ_{2}))$$ $$\\frac{Z_{1}}{Z_{2}}=(\\frac{r_{1}}{r_{2}} )(cos(ArgZ_{1}-Arg Z_{2})+isin(ArgZ_{1}-ArgZ_{2}))$$ å¤æ•°çš„ä¹˜å¹‚å…¬å¼","tags":[],"title":"ã€Šä¿¡å·ä¸ç³»ç»Ÿã€‹è¯»ä¹¦ç¬”è®°2","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/math/signalsandsystems/bookmark2/","year":"2022"},{"content":"LTS å·ç§¯çš„æ¦‚å¿µ  è¿ç»­ç³»ç»Ÿ:\n$$(f * g)(n)=\\int_{-\\infty}^{\\infty} f(\\tau) g(n-\\tau) d \\tau$$\nç¦»æ•£ç³»ç»Ÿ:\n$$(f * g)(n)=\\sum_{\\tau=-\\infty}^{\\infty} f(\\tau) g(n-\\tau)$$\n â€ƒå·ç§¯è¿™ä¸ªåè¯çš„ç†è§£ï¼š**æ‰€è°“ä¸¤ä¸ªå‡½æ•°çš„å·ç§¯ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯å…ˆå°†ä¸€ä¸ªå‡½æ•°ç¿»è½¬ï¼Œç„¶åè¿›è¡Œæ»‘åŠ¨å åŠ ã€‚**åœ¨è¿ç»­æƒ…å†µä¸‹ï¼Œå åŠ æŒ‡çš„æ˜¯å¯¹ä¸¤ä¸ªå‡½æ•°çš„ä¹˜ç§¯æ±‚ç§¯åˆ†ã€‚åœ¨ç¦»æ•£æƒ…å†µä¸‹å°±æ˜¯åŠ æƒæ±‚å’Œï¼Œä¸ºç®€å•èµ·è§å°±ç»Ÿä¸€ç§°ä¸ºå åŠ ã€‚\n\r.aspect-ratio {\rposition: relative;\rwidth: 100%;\rheight: 0;\rpadding-bottom: 75%;\r}\r.aspect-ratio iframe {\rposition: absolute;\rwidth: 100%;\rheight: 100%;\rleft: 0;\rtop: 0;\r}\r\r\r ç¦»æ•£æ—¶é—´çº¿æ€§æ—¶ä¸å˜(LTS)ç³»ç»Ÿï¼šå·ç§¯å’Œ  $x[n]=\\sum_{k=-\\infty}^{+\\infty}x[k]\\delta [n-k]$\u0026mdash;\u0026mdash;$x[k]$æ˜¯çº¿æ€§ç»„åˆå¼ä¸­çš„æƒå› å­ $y[n]=\\sum_{k=-\\infty}^{+\\infty}x[k]h_{k} [n]$ï¼Œä»¤$h_{k}[n]$(å³$h_{0}[n-k]$)ä¸ºçº¿æ€§ç³»ç»Ÿå¯¹ç§»åŠ¨å•ä½è„‰å†²$\\delta[n-k]$çš„å“åº” LTSç³»ç»Ÿçš„å•ä½è„‰å†²å“åº”å¯ä»¥å®Œå…¨åˆ»ç”»ç³»ç»Ÿçš„ç‰¹å¾ã€‚  ","id":31,"section":"categories","summary":"LTS å·ç§¯çš„æ¦‚å¿µ è¿ç»­ç³»ç»Ÿ: $$(f * g)(n)=\\int_{-\\infty}^{\\infty} f(\\tau) g(n-\\tau) d \\tau$$ ç¦»æ•£ç³»ç»Ÿ: $$(f * g)(n)=\\sum_{\\tau=-\\infty}^{\\infty} f(\\tau) g(n-\\tau)$$ å·ç§¯è¿™ä¸ªåè¯çš„ç†è§£ï¼š**æ‰€è°“ä¸¤ä¸ªå‡½æ•°çš„å·ç§¯ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯å…ˆå°†ä¸€ä¸ªå‡½æ•°ç¿»è½¬ï¼Œç„¶åè¿›è¡Œæ»‘åŠ¨","tags":[],"title":"ã€Šä¿¡å·ä¸ç³»ç»Ÿã€‹è¯»ä¹¦ç¬”è®°1--LTS","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/math/signalsandsystems/bookmark1/","year":"2022"},{"content":"command 1. å¸¸ç”¨å‘½ä»¤ 1.1 æ–°å»ºæ–‡æ¡£ mathç±»\rhugo new categories/math/\r--\u0026gt; hugo new categories/math/signalsAndSystems/\rappç±»\rhugo new categories/app/\rosç±»\rhugo new categories/os/\rrobatç±»\rhugo new categories/robat/\rlangç±»\rhugo new categories/lang/\rotherç±»\rhugo new categories/other/\r 1.2 ä¸Šä¼ å‘½ä»¤ hugo -D \u0026amp;\u0026amp; git add .\u0026amp;\u0026amp;git commit -m \u0026quot;\u0026quot;\rgit push github \u0026amp;\u0026amp;git push gitee \u0026amp;\u0026amp;cloudbase hosting deploy ./public -e blog-0g8860131649bb29\r 1.3 markdownæŠ€å·§  æ‰“å¼€è°ƒè¯•ï¼Œè·å–bilibiliçš„aid  console.log(playerInfo.aid)\rnoteï¼šå»é™¤'\\'\r{\\{\u0026lt; bilibili aid \u0026gt;}\\}\r  è·³è½¬  []({\\{\u0026lt; ref \u0026quot;blog/neat.md\u0026quot; \u0026gt;}\\})\r 2. è…¾è®¯äº‘éƒ¨ç½² é™æ€ç½‘ç«™æ‰˜ç®¡ éƒ¨ç½² Hugo - æœ€ä½³å®è·µ - æ–‡æ¡£ä¸­å¿ƒ - è…¾è®¯äº‘ (tencent.com)\n","id":32,"section":"categories","summary":"command 1. å¸¸ç”¨å‘½ä»¤ 1.1 æ–°å»ºæ–‡æ¡£ mathç±» hugo new categories/math/ --\u0026gt; hugo new categories/math/signalsAndSystems/ appç±» hugo new categories/app/ osç±» hugo new categories/os/ robatç±» hugo new categories/robat/ langç±» hugo new categories/lang/ otherç±» hugo new categories/other/ 1.2 ä¸Šä¼ å‘½ä»¤ hugo -D \u0026amp;\u0026amp;","tags":["blog","command"],"title":"ä¸€äº›éƒ¨ç½²åšå®¢çš„å¸¸ç”¨æŒ‡ä»¤","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/other/blog/command/","year":"2022"},{"content":"å¸Œè…Šå­—æ¯ ","id":33,"section":"categories","summary":"å¸Œè…Šå­—æ¯","tags":[" math"],"title":"å¸Œè…Šå­—æ¯","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/math/other/%E5%B8%8C%E8%85%8A%E5%AD%97%E6%AF%8D/","year":"2022"},{"content":"win10å®‰è£…clash 1.ä¸‹è½½ clash for winè½¯ä»¶æ˜¯ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œè¢«å¼€æºåœ¨githubä¸Šï¼Œå®ƒæ˜¯å…·æœ‰windows,mac,linux(x86å’Œarm)å¤šç‰ˆæœ¬çš„guiè½¯ä»¶ã€‚\nç‚¹å‡»è·³è½¬ï¼šå¼€æºåœ°å€\n ç”±äºgithubçš„ç½‘ç«™ä½äºå›½å¤–ï¼Œå¯èƒ½æ‰“ä¸å¼€ï¼Œä¸‹è½½åœ°å€å¦‚ä¸‹ï¼š\nç‚¹å‡»ä¸‹è½½:clashä¸‹è½½åœ°å€\n2.å®‰è£…  è§£å‹è½¯ä»¶åŒ…\n  è½¯ä»¶åŒ…æ˜¯å®‰è£…çš„ï¼Œå¯ä»¥ç›´æ¥è¿è¡Œ\n   3.æ±‰åŒ– ç”±äºè½¯ä»¶æ˜¯å›½å¤–å¼€å‘çš„ï¼Œæ‰€ä»¥guiç•Œé¢æ–‡å­—æ˜¯è‹±è¯­ï¼Œæˆ‘ä»¬éœ€è¦å°†å®ƒæ±‰åŒ–ã€‚\n æ±‰åŒ–æ•™ç¨‹åœ¨githubä¸Šå¼€æºçš„ ç‚¹å‡»è·³è½¬ï¼šå¼€æºåœ°å€    ç‚¹å‡»ä¸‹è½½ï¼šæ±‰åŒ–åŒ…ä¸‹è½½åœ°å€  \r- è§£å‹æ±‰åŒ–åŒ…ï¼Œå¾—åˆ°ä¸€ä¸ªapp.asaræ–‡ä»¶ï¼Œç”¨æ±‰åŒ–åŒ…ä¸­çš„app.asaræ›¿æ¢resources/app.asar \r\rå¯åŠ¨clash\r4.èŠ‚ç‚¹å¯¼å…¥ å¯¼å…¥yamlé…ç½®æ–‡ä»¶\n4.1 åœ¨çº¿è½¬æ¢ v2rayè½¬æ¢åˆ°clash,å°†vmessåè®®è½¬æ¢ä¸ºyamlé…ç½®æ–‡ä»¶åœ¨çº¿å°å·¥å…· ç‚¹å‡»è·³è½¬\nç”±äºæ˜¯çº¯å‰ç«¯çš„è½¬æ¢å·¥å…·ï¼Œæ‰€ä»¥åŠ è½½å¯èƒ½æœ‰ç‚¹æ…¢ï¼Œè€å¿ƒç­‰å¾…ä¸€ä¸‹ è½¬æ¢å®Œæˆåï¼Œä¸‹è½½yamlæ–‡ä»¶ï¼Œç„¶åè§ä¸Šå›¾ï¼Œå¯¼å…¥yamlæ–‡ä»¶ 4.2 è‡ªå·±é…ç½®yamlæ–‡ä»¶æ¨¡æ¿ â€‹\tClashæ”¯æŒSSã€V2rayå’Œtrojanåè®®\næ·±å…¥ç†è§£Clashé…ç½®æ–‡ä»¶ - VPSæ”»ç•¥ (vpsgongyi.com)\n  å¼€å¯ç³»ç»Ÿä»£ç†\n  \r æ£€æµ‹ç½‘ç»œæ˜¯å¦é€š\n  å¤§åŠŸå‘Šæˆï¼ï¼ï¼\n","id":34,"section":"categories","summary":"win10å®‰è£…clash 1.ä¸‹è½½ clash for winè½¯ä»¶æ˜¯ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œè¢«å¼€æºåœ¨githubä¸Šï¼Œå®ƒæ˜¯å…·æœ‰windows,mac,linux(x86å’Œa","tags":["net"],"title":"å®‰è£…clash","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/app/clash/%E5%AE%89%E8%A3%85clash/","year":"2022"},{"content":"æ¦‚ç‡è®ºä¸æ•°ç†ç»Ÿè®¡ å¤å…¸æ¦‚å‹  è¯•éªŒä¸­æ‰€æœ‰å¯èƒ½å‡ºç°çš„åŸºæœ¬äº‹ä»¶åªæœ‰æœ‰é™ä¸ª è¯•éªŒä¸­æ¯ä¸ªåŸºæœ¬äº‹ä»¶å‡ºç°çš„å¯èƒ½æ€§ç›¸ç­‰ã€‚  å…·æœ‰ä»¥ä¸Šä¸¤ä¸ªç‰¹ç‚¹çš„æ¦‚ç‡æ¨¡å‹æ˜¯å¤§é‡å­˜åœ¨çš„ï¼Œè¿™ç§æ¦‚ç‡æ¨¡å‹ç§°ä¸ºå¤å…¸æ¦‚ç‡æ¨¡å‹ï¼Œç®€ç§°å¤å…¸æ¦‚å‹ï¼Œä¹Ÿå«ç­‰å¯èƒ½æ¦‚å‹\n å‡ ä½•æ¦‚å‹ï¼š  æ— é™æ€§ï¼šè¯•éªŒä¸­æ‰€æœ‰å¯èƒ½å‡ºç°çš„åŸºæœ¬äº‹ä»¶ï¼ˆç»“æœï¼‰æœ‰æ— é™å¤šä¸ª. ç­‰å¯èƒ½æ€§ï¼šæ¯ä¸ªåŸºæœ¬äº‹ä»¶å‡ºç°çš„å¯èƒ½æ€§ç›¸ç­‰.  â€ƒå¦‚æœæ¯ä¸ªäº‹ä»¶å‘ç”Ÿçš„æ¦‚ç‡åªä¸æ„æˆè¯¥äº‹ä»¶åŒºåŸŸçš„é•¿åº¦(é¢ç§¯æˆ–ä½“ç§¯æˆ–åº¦æ•°)æˆæ¯”ä¾‹ï¼Œåˆ™ç§°è¿™æ ·çš„æ¦‚ç‡æ¨¡å‹ä¸ºå‡ ä½•æ¦‚ç‡æ¨¡å‹ï¼Œç®€ç§°ä¸ºå‡ ä½•æ¦‚å‹ã€‚å¤å…¸æ¦‚å‹ä¸å‡ ä½•æ¦‚å‹çš„ä¸»è¦åŒºåˆ«åœ¨äºï¼šå‡ ä½•æ¦‚å‹æ˜¯å¦ä¸€ç±»ç­‰å¯èƒ½æ¦‚å‹ï¼Œå®ƒä¸å¤å…¸æ¦‚å‹çš„åŒºåˆ«åœ¨äºè¯•éªŒçš„ç»“æœæ˜¯æ— é™ä¸ªã€‚\n å…¨æ¦‚ç‡å…¬å¼ â€ƒæ„ä¹‰ï¼šå…¨æ¦‚ç‡å…¬å¼ä¸ºæ¦‚ç‡è®ºä¸­çš„é‡è¦å…¬å¼ï¼Œå®ƒå°†å¯¹ä¸€å¤æ‚äº‹ä»¶Açš„æ¦‚ç‡æ±‚è§£é—®é¢˜è½¬åŒ–ä¸ºäº†åœ¨ä¸åŒæƒ…å†µä¸‹å‘ç”Ÿçš„ç®€å•äº‹ä»¶çš„æ¦‚ç‡çš„æ±‚å’Œé—®é¢˜ã€‚\nå†…å®¹ï¼šå¦‚æœäº‹ä»¶B1ã€B2ã€B3â€¦Biæ„æˆä¸€ä¸ªå®Œå¤‡äº‹ä»¶ç»„ï¼Œå³å®ƒä»¬ä¸¤ä¸¤äº’ä¸ç›¸å®¹ï¼Œå…¶å’Œä¸ºå…¨é›†ï¼›å¹¶ä¸”Pï¼ˆBi)å¤§äº0ï¼Œåˆ™å¯¹ä»»ä¸€äº‹ä»¶Aæœ‰\nP(A)=P(A|B1)P(B1) + P(A|B2)P(B2) + ... + P(A|Bi)P(Bi)\r\u0026emsp;\u0026emsp;æ¦‚ç‡è®ºçš„ä¸€ä¸ªé‡è¦å†…å®¹æ˜¯ç ”ç©¶æ€æ ·ä»ä¸€äº›è¾ƒç®€å•äº‹ä»¶æ¦‚ç‡çš„è®¡ç®—æ¥æ¨ç®—è¾ƒå¤æ‚äº‹ä»¶çš„æ¦‚ç‡ï¼Œå…¨æ¦‚ç‡å…¬å¼å’ŒBayeså…¬å¼æ­£å¥½èµ·åˆ°äº†è¿™æ ·çš„ä½œç”¨ã€‚\r è´å¶æ–¯å…¬å¼ $$ P(A|B)=\\frac{P(B|A)P(A)}{P(B)} $$ è´å¶æ–¯å…¬å¼ç”¨æ¥æè¿°ä¸¤ä¸ªæ¡ä»¶æ¦‚ç‡ä¹‹é—´çš„å…³ç³»ã€‚å³é€šå¸¸ï¼Œäº‹ä»¶Aåœ¨äº‹ä»¶B(å‘ç”Ÿ)çš„æ¡ä»¶ä¸‹çš„æ¦‚ç‡ï¼Œä¸äº‹ä»¶Båœ¨äº‹ä»¶Açš„æ¡ä»¶ä¸‹çš„æ¦‚ç‡æ˜¯ä¸ä¸€æ ·çš„ï¼›ç„¶è€Œï¼Œè¿™ä¸¤è€…æ˜¯æœ‰ç¡®å®šçš„å…³ç³»,è´å¶æ–¯æ³•åˆ™å°±æ˜¯è¿™ç§å…³ç³»çš„é™ˆè¿°ã€‚\nåœ¨è´å¶æ–¯æ³•åˆ™ä¸­ï¼Œæ¯ä¸ªåè¯éƒ½æœ‰çº¦å®šä¿—æˆçš„åç§°ï¼š\n P(A)æ˜¯Açš„å…ˆéªŒæ¦‚ç‡æˆ–è¾¹ç¼˜æ¦‚ç‡ã€‚ä¹‹æ‰€ä»¥ç§°ä¸º\u0026quot;å…ˆéªŒ\u0026quot;æ˜¯å› ä¸ºå®ƒä¸è€ƒè™‘ä»»ä½•Bæ–¹é¢çš„å› ç´ ã€‚ P(A|B)æ˜¯å·²çŸ¥Bå‘ç”ŸåAçš„æ¡ä»¶æ¦‚ç‡ï¼Œä¹Ÿç”±äºå¾—è‡ªBçš„å–å€¼è€Œè¢«ç§°ä½œAçš„åéªŒæ¦‚ç‡ã€‚ P(B|A)æ˜¯å·²çŸ¥Aå‘ç”ŸåBçš„æ¡ä»¶æ¦‚ç‡ï¼Œä¹Ÿç”±äºå¾—è‡ªAçš„å–å€¼è€Œè¢«ç§°ä½œBçš„åéªŒæ¦‚ç‡ã€‚ P(B)æ˜¯Bçš„å…ˆéªŒæ¦‚ç‡æˆ–è¾¹ç¼˜æ¦‚ç‡ï¼Œä¹Ÿä½œæ ‡å‡†åŒ–å¸¸é‡ï¼ˆnormalized constantï¼‰ã€‚  æŒ‰è¿™äº›æœ¯è¯­ï¼ŒBayesæ³•åˆ™å¯è¡¨è¿°ä¸ºï¼š\nåéªŒæ¦‚ç‡ = (ä¼¼ç„¶åº¦ * å…ˆéªŒæ¦‚ç‡)/æ ‡å‡†åŒ–å¸¸é‡\nä¹Ÿå°±æ˜¯è¯´ï¼ŒåéªŒæ¦‚ç‡ä¸å…ˆéªŒæ¦‚ç‡å’Œä¼¼ç„¶åº¦çš„ä¹˜ç§¯æˆæ­£æ¯”ã€‚\nå¦å¤–ï¼Œæ¯”ä¾‹Pr(B|A)/Pr(B)ä¹Ÿæœ‰æ—¶è¢«ç§°ä½œæ ‡å‡†ä¼¼ç„¶åº¦ï¼ˆstandardised likelihoodï¼‰ï¼ŒBayesæ³•åˆ™å¯è¡¨è¿°ä¸ºï¼š åéªŒæ¦‚ç‡ = æ ‡å‡†ä¼¼ç„¶åº¦ * å…ˆéªŒæ¦‚ç‡ã€‚ [1]\n1.å¯æµ‹ç©ºé—´\n2.å¸¸ç”¨çš„ä¸€ç»´åˆ†å¸ƒ\né“¾æ¥\n","id":35,"section":"categories","summary":"æ¦‚ç‡è®ºä¸æ•°ç†ç»Ÿè®¡ å¤å…¸æ¦‚å‹ è¯•éªŒä¸­æ‰€æœ‰å¯èƒ½å‡ºç°çš„åŸºæœ¬äº‹ä»¶åªæœ‰æœ‰é™ä¸ª è¯•éªŒä¸­æ¯ä¸ªåŸºæœ¬äº‹ä»¶å‡ºç°çš„å¯èƒ½æ€§ç›¸ç­‰ã€‚ å…·æœ‰ä»¥ä¸Šä¸¤ä¸ªç‰¹ç‚¹çš„æ¦‚ç‡æ¨¡å‹æ˜¯å¤§é‡å­˜åœ¨çš„ï¼Œè¿™","tags":["æ¦‚ç‡è®º"],"title":"æ¦‚ç‡è®ºå­¦ä¹ ä¹‹æ—…1","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/math/probability/%E6%A6%82%E7%8E%87%E8%AE%BA%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%851/","year":"2022"},{"content":"å¦‚ä½•å®‰è£…ros è„šæœ¬å®‰è£… wget http://fishros.com/install -O fishros \u0026amp;\u0026amp; sudo bash fishros\r åŸæ–‡ç« é“¾æ¥ï¼šé±¼é¦™ros\nrosdep å®‰è£…  note: æ³¨æ„å®‰è£…rosè¿‡ç¨‹ä¸­ï¼Œå¯ä»¥ä¸å®‰è£…rosdepï¼Œå®ƒä¸æ˜¯rosç³»ç»Ÿå¿…é¡»å®‰è£…çš„ï¼Œå®ƒçš„åŠŸèƒ½ç±»ä¼¼äºubuntuä¸­çš„apt\nï¼Œå½“æˆ‘ä»¬å®‰è£…rosçš„ä¸€äº›åŠŸèƒ½åŒ…çš„æ—¶å€™ï¼Œä¹Ÿå¯ä»¥ç”¨aptå®‰è£…ï¼Œå¯ä»¥ä¸ç”¨rosdep\n å‚è€ƒè§†é¢‘ï¼šå°é±¼åœ¨å¤æœˆå±…å¼€è¯¾è§†é¢‘\u0026ndash;èŠèŠROSå®‰è£…è¿‡ç¨‹ä¸­çš„é‚£äº›å‘\n","id":36,"section":"categories","summary":"å¦‚ä½•å®‰è£…ros è„šæœ¬å®‰è£… wget http://fishros.com/install -O fishros \u0026amp;\u0026amp; sudo bash fishros åŸæ–‡ç« é“¾æ¥ï¼šé±¼é¦™ros rosdep å®‰è£… note: æ³¨æ„å®‰è£…rosè¿‡ç¨‹ä¸­ï¼Œå¯ä»¥ä¸å®‰è£…rosdepï¼Œå®ƒä¸æ˜¯rosç³»ç»Ÿå¿…é¡»å®‰è£…çš„","tags":["ros"],"title":"3.å¦‚ä½•å®‰è£…ros","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/os/ros/3_%E5%AE%89%E8%A3%85ros/","year":"2022"},{"content":"ç½‘ç»œé…ç½® ubuntu18.04é…ç½®IP ä½¿ç”¨ip addr åªé™äºä»¥å¤ªç½‘é…ç½®(ä¸´æ—¶)\rip addr add 192.168.8.30/24 dev eth0\r /etc/netplan/*é…ç½®æ–‡ä»¶ æœåŠ¡å™¨ä¸­æ˜¯50-cloud-init.yaml,æ¡Œé¢ç‰ˆ01-network-manager-all.yaml\nä¿¡æ¯æ ¼å¼å¦‚ä¸‹ï¼š\nnetwork:\rethernets:\reth0:\rdhcp4: no\raddresses: [192.168.30.201/24]\roptional: true\reth1:\rdhcp4: no\raddresses: [192.168.30.202/24]\roptional: true\rversion: 2\rwifis:\rwlan0:\raccess-points:\rchao:\rpassword: '88888888'\rdhcp4: true\roptional: true\r ","id":37,"section":"categories","summary":"ç½‘ç»œé…ç½® ubuntu18.04é…ç½®IP ä½¿ç”¨ip addr åªé™äºä»¥å¤ªç½‘é…ç½®(ä¸´æ—¶) ip addr add 192.168.8.30/24 dev eth0 /etc/netplan/*é…ç½®æ–‡ä»¶ æœåŠ¡å™¨ä¸­æ˜¯50-cl","tags":["linux","net"],"title":"eth wifi ç½‘ç»œé…ç½®","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/os/linux/etc/eth_wifi%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE/","year":"2022"},{"content":"æ¿€å…‰æœ‰å æ¿€å…‰æœ‰å..............\nå¼•ç”¨\n","id":38,"section":"categories","summary":"æ¿€å…‰æœ‰å æ¿€å…‰æœ‰å.............. å¼•ç”¨","tags":["å¯¼èˆª"],"title":"æ¿€å…‰æœ‰å","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/robat/%E6%BF%80%E5%85%89%E6%9C%89%E5%8F%8D/","year":"2022"},{"content":"","id":39,"section":"categories","summary":"","tags":["project"],"title":"çº¯è¿½è¸ª","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/robat/carcontrol/%E5%AF%BB%E8%BF%B9/%E7%BA%AF%E8%BF%BD%E8%B8%AA/","year":"2022"},{"content":"æ¦‚ç‡æœºå™¨äºº 1. åŸºç¡€è¯¾ç¨‹ 1.1 æ¦‚ç‡è®ºåŸºç¡€  æ¦‚ç‡è®ºä¸æ•°ç†ç»Ÿè®¡åŸºæœ¬æ¦‚å¿µ  1.2 éšæœºè¿‡ç¨‹ â€ƒéšæœºè¿‡ç¨‹å¯ä¾å…¶åœ¨ä»»ä¸€æ—¶åˆ»çš„çŠ¶æ€æ˜¯è¿ç»­å‹éšæœºå˜é‡æˆ–ç¦»æ•£å‹éšæœºå˜é‡è€Œåˆ†æˆè¿ç»­å‹éšæœºè¿‡ç¨‹å’Œç¦»æ•£å‹éšæœºè¿‡ç¨‹.\nå®šä¹‰ï¼šå°±æ˜¯ä¸€ä¸ªéš\u0026quot;æ—¶é—´\u0026quot;æ¼”åŒ–çš„éšæœºç³»ç»Ÿ\nå­¦ä¹ å‚è€ƒè¯¾ç¨‹å’Œæ•™æ  éšæœºè¿‡ç¨‹-åä¸­ç§‘æŠ€å¤§å­¦   2. è´å¶æ–¯æ»¤æ³¢ \u0026amp; emsp;â€ƒè´å¶æ–¯æ»¤æ³¢æ˜¯å¡å°”æ›¼æ»¤æ³¢ã€ç²’å­æ»¤æ³¢çš„åŸºç¡€ï¼Œåº”ç”¨åˆ°æ±½è½¦ã€é‡‘èã€èˆªç©ºèˆªå¤©ã€æœºå™¨å­¦ä¹ ç­‰è¡Œä¸šã€‚\n â€ƒåéªŒæ¦‚ç‡ = æ ‡å‡†ä¼¼ç„¶åº¦ *å…ˆéªŒæ¦‚ç‡\n å­¦ä¹ èµ„æ–™\n ç†è§£è´å¶æ–¯æ»¤æ³¢  2.1 æ¦‚ç‡ç”Ÿæˆæ³•åˆ™   åˆå§‹ç½®ä¿¡åº¦$p(x_{0})$\n  çŠ¶æ€è½¬ç§»æ¦‚ç‡ï¼š$p(x_{t} |z_{t-1},u_{t})$\n  æµ‹é‡æ¦‚ç‡ï¼š$p(z_{t} |x_{t})$\n  çŠ¶æ€è½¬ç§»æ¦‚ç‡å’Œæµ‹é‡æ¦‚ç‡ä¸€èµ·æè¿°æœºå™¨äººåŠå…¶ç¯å¢ƒç»„æˆçš„åŠ¨æ€ç³»ç»Ÿ\n  2.2 ç½®ä¿¡åº¦  ç½®ä¿¡åº¦ï¼šåæ˜ æœºå™¨äººæœ‰å…³ç¯å¢ƒçŠ¶æ€çš„å†…éƒ¨ä¿¡æ¯ã€‚ã€‚ ç½®ä¿¡åº¦ç”¨$bel(x_{t} )$è¡¨è¾¾ï¼Œå…¶ä¸ºæ—¶åˆ»tä¸‹çŠ¶æ€$x_{t}$çš„æ¦‚ç‡åˆ†å¸ƒçš„åéªŒçš„ç¼©å†™ï¼š$bel(x_{t} )=p(x_{t} |z_{1:t},u_{1:t})$è¡¨è¾¾ï¼Œxè¡¨ç¤ºçŠ¶æ€ã€‚ é¢„æµ‹ï¼š$\\overline{bel(x_{t})}=p(x_{t} |z_{1: t-1},u_{1:t})$ ä¿®æ­£ï¼šç”±$\\overline{bel(x_{t})}$è®¡ç®—$bel(x_{t})$çš„è¿‡ç¨‹ã€‚  2.3 è´å¶æ–¯æ»¤æ³¢çš„è¿‡ç¨‹  é¢„æµ‹ ä¿®æ­£   3.é«˜æ–¯æ»¤æ³¢   é«˜æ–¯æ»¤æ³¢æ˜¯é€’å½’çŠ¶æ€ä¼°è®¡å™¨å®¶æ—çš„ç»Ÿç§°ã€‚\n  é«˜æ–¯æ»¤æ³¢ä¸­çš„å‚æ•°å‡å€¼ï¼ˆä¸€é˜¶çŸ©ï¼‰å’Œæ–¹å·®ï¼ˆäºŒé˜¶çŸ©ï¼‰ç§°ä¸ºçŸ©å‚æ•°ã€‚\n  3.1 å¡å°”æ›¼æ»¤æ³¢KF  KFæ˜¯ç”±swerlingå’ŒKalmanä½œä¸ºçº¿æ€§é«˜æ–¯ç³»ç»Ÿä¸­çš„é¢„æµ‹å’Œæ»¤æ³¢æŠ€æœ¯è€Œå‘æ˜çš„ï¼Œæ˜¯ç”¨çŸ©æ¥å®šä¹‰çš„,å®ƒä¸é€‚ç”¨äºç¦»æ•£æˆ–æ··åˆçŠ¶æ€ç©ºé—´ã€‚ KFç”¨çŸ©å‚æ•°è¡¨è¾¾ç½®ä¿¡åº¦ï¼šåœ¨æ—¶åˆ»tï¼Œç½®ä¿¡åº¦ç”¨å‡å€¼$\\mu_{t} $ å’Œæ–¹å·®$\\Sigma_{t}$è¡¨è¾¾ã€‚  æ¡ä»¶ï¼šé™¤äº†è´å¶æ–¯æ»¤æ³¢çš„é©¬å°”å¯å¤«å‡è®¾ï¼Œå®ƒè¿˜å…·æœ‰ä»¥ä¸‹çš„ä¸‰ä¸ªç‰¹æ€§ï¼Œåˆ™åéªŒå°±æ˜¯é«˜æ–¯çš„\n  çŠ¶æ€è½¬ç§»æ¦‚ç‡å¿…é¡»æ˜¯å¸¦æœ‰éšæœºé«˜æ–¯å™ªå£°çš„å‚æ•°çš„çº¿æ€§å‡½æ•°ï¼Œå¦‚ä¸‹å¼ï¼š\n$$ x_{t}=A_{t}x_{t-1}+B_{t}u{t}+\\varepsilon_{t}$$\n  æµ‹é‡æ¦‚ç‡ä¹Ÿä¸å¸¦æœ‰é«˜æ–¯å™ªå£°çš„è‡ªå˜é‡å‘ˆçº¿æ€§å…³ç³»\n$$z_{t}=C_{t}x_{t}+\\delta_{t}$$\n  åˆå§‹ç½®ä¿¡åº¦$bel(x_{0})$å¿…é¡»æ˜¯æ­£æ€åˆ†å¸ƒçš„ã€‚\n$$bel(x_{0})=p(x_{0})\u0026mdash;-x_{0}\\sim N(\\mu ,\\Sigma _{0})$$\n  å¡å°”æ›¼æ»¤æ³¢è¿‡ç¨‹å¦‚ä¸‹ï¼š\n 4.éå‚æ•°æ»¤æ³¢ 4.2 ç›´æ–¹å›¾æ»¤æ³¢ 4.2 é™æ€äºŒå€¼è´å¶æ–¯æ»¤æ³¢ 4.3 ç²’å­æ»¤æ³¢(pf)   ç²’å­æ»¤æ³¢(particle filter)æ˜¯è´å¶æ–¯æ»¤æ³¢çš„å¦ä¸€ç§éå‚æ•°å®ç°ã€‚\n  ç²’å­æ»¤æ³¢ä»¥æœ‰é™ä¸ªå‚æ•°æ¥è¿‘ä¼¼åéªŒ\n  ä¸»è¦æ€æƒ³ï¼šç”¨ä¸€ç³»åˆ—ä»åéªŒå¾—åˆ°çš„éšæœºçŠ¶æ€é‡‡æ ·è¡¨ç¤º$bel(x_{t})$\n  ä¸€ä¸ªç²’å­å°±æ˜¯æ ¹æ®çœŸå®ä¸–ç•ŒçŠ¶æ€åœ¨æ—¶åˆ»tçš„ä¸€ä¸ªå¯èƒ½å‡è®¾ã€‚\n  ç²’å­æ»¤æ³¢çš„ç›´è§‚æ„Ÿè§‰å°±æ˜¯ç”¨ç²’å­ç¾¤$X_{t}$æ¥è¿‘ä¼¼ç½®ä¿¡åº¦$bel(x_{t})$\n ç†æƒ³æƒ…å†µä¸‹ï¼ŒçŠ¶æ€å‡è®¾$x_{t}$åŒ…å«åœ¨ç²’å­é›†$X_{t}$ä¸­çš„å¯èƒ½æ€§ä¸å…¶è´å¶æ–¯æ»¤æ³¢çš„åéªŒ$bel(x_{t})$æˆæ¯”ä¾‹ï¼š\n$$x_{t}^{m}\\sim p(x_{t}|z_{1:t},u_{1:t}) $$\nçŠ¶æ€ç©ºé—´çš„ä¸€ä¸ªå­åŒºåŸŸè¢«æ ·æœ¬å¡«å……å¾—è¶Šå¯†é›†ï¼ŒçœŸå®çŠ¶æ€è½å…¥è¯¥åŒºåŸŸçš„å¯èƒ½æ€§è¶Šå¤§\n   â€ƒç²’å­æ»¤æ³¢ç®—æ³•ç”±ä¸Šä¸€ä¸ªæ—¶é—´æ­¥é•¿çš„ç½®ä¿¡åº¦$bel(x_{t-1})$é€’å½’åœ°æ„å»ºç½®ä¿¡åº¦$bel(x_{t})$,å› ä¸ºç½®ä¿¡åº¦ç”±ç²’å­é›†è¡¨ç¤ºï¼Œè¿™å°±æ„å‘³ç²’å­æ»¤æ³¢å¯ç”±ç²’å­é›†$X_{t-1}$é€’å½’åœ°æ„å»ºç²’å­é›†$X_{t}$\nç†è§£ç²’å­æ»¤æ³¢\u0026ndash;èµ„æ–™è§†é¢‘ \r.aspect-ratio {\rposition: relative;\rwidth: 100%;\rheight: 0;\rpadding-bottom: 75%;\r}\r.aspect-ratio iframe {\rposition: absolute;\rwidth: 100%;\rheight: 100%;\rleft: 0;\rtop: 0;\r}\r\r\r\n \r.aspect-ratio {\rposition: relative;\rwidth: 100%;\rheight: 0;\rpadding-bottom: 75%;\r}\r.aspect-ratio iframe {\rposition: absolute;\rwidth: 100%;\rheight: 100%;\rleft: 0;\rtop: 0;\r}\r\r\r  ","id":40,"section":"categories","summary":"æ¦‚ç‡æœºå™¨äºº 1. åŸºç¡€è¯¾ç¨‹ 1.1 æ¦‚ç‡è®ºåŸºç¡€ æ¦‚ç‡è®ºä¸æ•°ç†ç»Ÿè®¡åŸºæœ¬æ¦‚å¿µ 1.2 éšæœºè¿‡ç¨‹ éšæœºè¿‡ç¨‹å¯ä¾å…¶åœ¨ä»»ä¸€æ—¶åˆ»çš„çŠ¶æ€æ˜¯è¿ç»­å‹éšæœºå˜é‡æˆ–ç¦»æ•£å‹éšæœºå˜é‡è€Œåˆ†æˆè¿ç»­å‹","tags":["slam","å¯¼èˆª","book"],"title":"ã€Šæ¦‚ç‡æœºå™¨äººã€‹-è¯»ä¹¦ç¬”è®°","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/robat/slam/%E6%A6%82%E7%8E%87%E6%9C%BA%E5%99%A8%E4%BA%BA/","year":"2022"},{"content":"ROSå­¦ä¹ ä¹‹æ—…2 æœºå™¨äººç§ç±» AGVçš„æ¡†æ¶(æ¬è¿æœºå™¨äºº) ç©¿æ¢­è½¦ ","id":41,"section":"categories","summary":"ROSå­¦ä¹ ä¹‹æ—…2 æœºå™¨äººç§ç±» AGVçš„æ¡†æ¶(æ¬è¿æœºå™¨äºº) ç©¿æ¢­è½¦","tags":["ros"],"title":"2æœºå™¨äººç§ç±»","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/os/ros/2_%E6%9C%BA%E5%99%A8%E4%BA%BA%E7%A7%8D%E7%B1%BB/","year":"2022"},{"content":"roså­¦ä¹ ä¹‹æ—…1 roså­¦ä¹ ç½‘ç«™æ”¶é›†  Roså®˜ç½‘ wiki.ros.org ä¸­å›½å¤§å­¦MOOC\u0026mdash;ã€Šæœºå™¨äººæ“ä½œç³»ç»Ÿå…¥é—¨ã€‹è¯¾ç¨‹è®²ä¹‰ ä¸­å›½å¤§å­¦MOOC\u0026mdash;ã€Šæ™ºèƒ½æœºå™¨äººç³»ç»Ÿã€‹ åˆ›å®¢æ™ºé€  zhangrelayçš„ä¸“æ  å¤æœˆå±… æ˜“ç§‘æœºå™¨äººå®éªŒå®¤ ROBOTIS çŸ¥ä¹\u0026ndash;SLAMå¼€å‘æœ€å¼ºæœ€å…¨èµ„æºæ±‡æ€» ing\u0026hellip;.  ä»£ç ç¤ºä¾‹  ä¸­å›½å¤§å­¦MOOC\u0026mdash;ã€Šæœºå™¨äººæ“ä½œç³»ç»Ÿå…¥é—¨ã€‹è¯¾ç¨‹è®²ä¹‰\u0026ndash;ä»£ç ç¤ºä¾‹ hector slam gmapping  ä¹¦ç±  æœºå™¨äººå¯¼è®º  ","id":42,"section":"categories","summary":"roså­¦ä¹ ä¹‹æ—…1 roså­¦ä¹ ç½‘ç«™æ”¶é›† Roså®˜ç½‘ wiki.ros.org ä¸­å›½å¤§å­¦MOOC\u0026mdash;ã€Šæœºå™¨äººæ“ä½œç³»ç»Ÿå…¥é—¨ã€‹è¯¾ç¨‹è®²ä¹‰ ä¸­å›½å¤§å­¦MOOC\u0026mdash;ã€Šæ™º","tags":["ros"],"title":"1.rosèµ„æº","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/os/ros/1_ros%E8%B5%84%E6%BA%90/","year":"2022"},{"content":"å¦‚ä½•åœ¨wsl1ä¸­ä½¿ç”¨ç½‘ç»œä»£ç†ï¼Ÿ ä»£ç†å·¥å…·   polipo   proxychain\n  å‰ææ¡ä»¶ v2rayä¸­å¼€å¯å…è®¸å±€åŸŸç½‘è¿æ¥\nè®°ä½ä»¥ä¸‹ip:port\nå¼€å§‹ä»£ç† polipo å‚è€ƒåšå®¢ï¼šä¸º windows wsl é…ç½® socks5 ä»£ç† (github.com)\næ­¥éª¤æ€»ç»“ï¼š\nä¸‹è½½\rsudo apt install polipo\ræ‰“å¼€é…ç½®æ–‡ä»¶\rsudo nano /etc/polipo/config\rå†™å…¥\rsocksParentProxy = \u0026quot;localhost:10808\u0026quot;\rsocksProxyType = socks5\rproxyPort = 8123\rç¯å¢ƒè®¾ç½®\rnano ~/.bashrc\rå†™å…¥\rexport https_proxy=http://127.0.0.1:8123\rexport http_proxy=http://127.0.0.1:8123 export all_proxy=socks5://127.0.0.1:8123\rå¯åŠ¨\rsudo service polipo stop sudo service polipo start æµ‹è¯•\rcurl www.google.com\r proxychain å‚è€ƒåšå®¢ï¼šlinuxä¸‹çš„å…¨å±€ä»£ç†å·¥å…·proxychain | MonkeyWie\u0026rsquo;s Blog\n","id":43,"section":"categories","summary":"å¦‚ä½•åœ¨wsl1ä¸­ä½¿ç”¨ç½‘ç»œä»£ç†ï¼Ÿ ä»£ç†å·¥å…· polipo proxychain å‰ææ¡ä»¶ v2rayä¸­å¼€å¯å…è®¸å±€åŸŸç½‘è¿æ¥ è®°ä½ä»¥ä¸‹ip:port å¼€å§‹ä»£ç† polipo å‚è€ƒåšå®¢ï¼šä¸º windows wsl é…ç½® socks5 ä»£ç† (github.com)","tags":[" wsl1"],"title":"å¦‚ä½•åœ¨wsl1ä¸­ä½¿ç”¨ç½‘ç»œä»£ç†ï¼Ÿ","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/app/wsl1/test-post/","year":"2022"},{"content":"çŸ©é˜µè®ºä¹‹äºŒ ","id":44,"section":"categories","summary":"çŸ©é˜µè®ºä¹‹äºŒ","tags":["çŸ©é˜µ","çº¿æ€§ä»£æ•°"],"title":"çŸ©é˜µè®ºä¹‹äºŒ","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/math/matrix/%E7%9F%A9%E9%98%B5%E8%AE%BA%E4%B9%8B%E4%BA%8C/","year":"2022"},{"content":"çŸ©é˜µè®ºä¹‹ä¸€ çº¿æ€§ç©ºé—´ â€ƒçº¿æ€§ç©ºé—´ä¹Ÿç§°\u0026quot;å‘é‡ç©ºé—´\u0026quot;ã€‚\\( \\sqrt{x} \\)\n$$ \\sqrt{x} $$\n","id":45,"section":"categories","summary":"çŸ©é˜µè®ºä¹‹ä¸€ çº¿æ€§ç©ºé—´ çº¿æ€§ç©ºé—´ä¹Ÿç§°\u0026quot;å‘é‡ç©ºé—´\u0026quot;ã€‚\\( \\sqrt{x} \\) $$ \\sqrt{x} $$","tags":["çŸ©é˜µ","çº¿æ€§ä»£æ•°"],"title":"çŸ©é˜µè®ºä¹‹ä¸€","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/math/matrix/%E7%9F%A9%E9%98%B5%E8%AE%BA%E4%B9%8B%E4%B8%80/","year":"2022"},{"content":"#ã€€ä½¿ç”¨ xmake å¼€å‘ Qt ç¨‹åº\nåœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬å°†ä¼šå­¦ä¹ åˆ°å¦‚ä½•ä½¿ç”¨ vscode ç»“åˆ xmake-vscode æ’ä»¶å»ç¼–è¯‘å¼€å‘ Qt åº”ç”¨ç¨‹åºï¼Œå¹¶ä¸”ä¹Ÿä¼šå­¦ä¹ åˆ°ä¸€äº› Qt ç›¸å…³çš„åŸºç¡€æ¦‚å¿µï¼Œä»¥åŠ Qt Widgets å’Œ Quick App ä¸¤ç§ Qt æ¡†æ¶çš„åº”ç”¨ç¨‹åºå¼€å‘ã€‚\nçŸ¥è¯†ç‚¹  Qt çš„åŸºæœ¬æ¦‚å¿µ Qt Widgets å’Œ Quick App çš„åŸºæœ¬æ¦‚å¿µ ä½¿ç”¨ vscode å¼€å‘ Qt åº”ç”¨ç¨‹åº  ##ã€€Qt ä»‹ç»\nQt æ˜¯ä¸€ä¸ªè·¨å¹³å°çš„ C++ åº”ç”¨ç¨‹åºå¼€å‘æ¡†æ¶ã€‚å®ƒæä¾›ç»™å¼€å‘è€…å»ºç«‹å›¾å½¢ç”¨æˆ·ç•Œé¢æ‰€éœ€çš„åŠŸèƒ½ï¼Œå¹¿æ³›ç”¨äºå¼€å‘ GUI ç¨‹åºï¼Œä¹Ÿå¯ç”¨äºå¼€å‘é GUI ç¨‹åºã€‚ä½¿ç”¨ Qt å¼€å‘çš„è½¯ä»¶ï¼Œç›¸åŒçš„ä»£ç å¯ä»¥åœ¨ä»»ä½•æ”¯æŒçš„å¹³å°ä¸Šç¼–è¯‘ä¸è¿è¡Œï¼Œè€Œä¸éœ€è¦ä¿®æ”¹æºä»£ç ã€‚ä¼šè‡ªåŠ¨ä¾å¹³å°çš„ä¸åŒï¼Œè¡¨ç°å¹³å°ç‰¹æœ‰çš„å›¾å½¢ç•Œé¢é£æ ¼ã€‚\nå¹¶ä¸” Qt å®˜æ–¹æä¾›äº† QtCreator æ¥åˆ›å»ºå’Œç¼–è¯‘ Qt ç¨‹åºï¼Œé€šè¿‡ .pro å·¥ç¨‹æè¿°æ–‡ä»¶æ¥ç»´æŠ¤é¡¹ç›®ï¼Œå®é™…ç¼–è¯‘æ—¶ï¼ŒQtCreator å†…éƒ¨ä¼šå»è°ƒç”¨ qmake æˆ–è€…æ˜¯ cmake æ¥è¿›è¡Œå·¥ç¨‹çš„æ„å»ºã€‚\nä¸è¿‡ xmake ä¹Ÿå®Œå…¨æ”¯æŒ Qt å„ç§å·¥ç¨‹é¡¹ç›®çš„æ„å»ºç¼–è¯‘ï¼Œç»“åˆ xmake-vscode æ’ä»¶å¯ä»¥è®©å¼€å‘è€…è„±ç¦» QtCreator ä½¿ç”¨ vscode æ¥ç¼–è¯‘å¼€å‘ Qt ç¨‹åºï¼Œå¦å¤– xmake ä¹Ÿæä¾›äº†å…¶å®ƒå„ç§ç¼–è¾‘å™¨çš„æ’ä»¶ï¼Œä¾‹å¦‚ IntelliJ IDEAã€Visual Studioã€Sublime Text ç”šè‡³ VIM ç­‰ç­‰ï¼Œä½¿å¤§å®¶å¯ä»¥ä½¿ç”¨è‡ªå·±æœ€ä¹ æƒ¯çš„ç¼–è¾‘å™¨æ¥å¼€å‘ Qt ç¨‹åºã€‚\nå®‰è£… Qt å¼€å‘åº“ é¦–å…ˆåœ¨ç¯å¢ƒä¸­å®‰è£… xmakeï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š\nbash \u0026lt;(curl -fsSL https://xmake.io/shget.text) v2.3.7\rsource ~/.xmake/profile\r# æ£€æŸ¥ç‰ˆæœ¬ï¼ŒéªŒè¯å®‰è£…æˆåŠŸ\rxmake --version\r åœ¨è¿›ä¸€æ­¥è®²è§£å¦‚ä½•ä½¿ç”¨ xmake å»ç¼–è¯‘å¼€å‘ Qt ç¨‹åºä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆæ¥å®‰è£… Qt å¼€å‘è¿‡ç¨‹ä¸­éœ€è¦çš„ä¸€äº›åŸºç¡€ç¯å¢ƒå’Œä¾èµ–åº“ã€‚æ‰“å¼€ Xfce ç»ˆç«¯ï¼Œè¾“å…¥å¦‚ä¸‹å‘½ä»¤å°±å¯ä»¥å®Œæˆå®‰è£…ã€‚\nsudo apt update\rsudo apt install -y qtcreator qt-default qtdeclarative5-private-dev\r Qt WidgetApp ç¨‹åº Qt SDK ç¯å¢ƒå®‰è£…å®Œæˆåï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ xmake çš„å‘½ä»¤è¡Œç¨‹åºåˆ›å»ºä¸€ä¸ªåŸºäº Qt çš„ Widget App ç¨‹åºç©ºå·¥ç¨‹ï¼Œæ‰§è¡Œå‘½ä»¤å¦‚ä¸‹ã€‚\ncd ~/Code\rxmake create -t qt.widgetapp widgetapp\r å¦‚æœåˆ›å»ºæˆåŠŸï¼Œå°±ä¼šçœ‹åˆ°ä¸‹å›¾çš„è¾“å‡ºï¼Œé‡Œé¢é™¤äº† xmake.lua æ–‡ä»¶ï¼Œè¿˜ç”Ÿæˆäº†ä¸€äº›åŸºæœ¬çš„ Qt ä»£ç æ–‡ä»¶ï¼Œ*.ui æ˜¯ç”¨æˆ·æè¿° ui ç•Œé¢ï¼Œè¿™ä¹Ÿæ˜¯ Qt Widget åº”ç”¨ç¨‹åºæ‰€å¿…å¤‡çš„ï¼Œè€Œ mainwindow.cpp æ–‡ä»¶ç”¨æ¥å®šä¹‰ä¸»çª—å£ç±»ã€‚\næ¥ç€ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹ xmake.lua é‡Œé¢çš„é…ç½®å†…å®¹ï¼Œé€šè¿‡è¿™ä¸ªé…ç½®æ‰èƒ½å¤Ÿæ­£å¸¸ä½¿ç”¨ xmake å®Œæˆ Qt é¡¹ç›®çš„ç¼–è¯‘ã€‚\nadd_rules(\u0026quot;mode.debug\u0026quot;, \u0026quot;mode.release\u0026quot;)\rtarget(\u0026quot;widgetapp\u0026quot;)\radd_rules(\u0026quot;qt.widgetapp\u0026quot;)\radd_headerfiles(\u0026quot;src/*.h\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\radd_files(\u0026quot;src/mainwindow.ui\u0026quot;)\r-- add files with Q_OBJECT meta (only for qt.moc)\radd_files(\u0026quot;src/mainwindow.h\u0026quot;)\r ä»ä¸Šé¢çš„é…ç½®ä¸­å¯ä»¥çœ‹åˆ°ï¼Œé™¤äº†ä¸€äº›åŸºæœ¬çš„ C/C++ é…ç½®ä»¥å¤–ï¼Œè¿˜æœ‰ä¸€äº›ç‰¹æ®Šçš„é…ç½®ã€‚æ¯”å¦‚æˆ‘ä»¬å°† mainwindow.ui å’Œ mainwindows.h ä¹Ÿæ·»åŠ åˆ°äº† add_files å‚ä¸ç¼–è¯‘ï¼Œè¿™ä¸¤ä¸ªç±»å‹çš„æ–‡ä»¶ï¼ŒåŸç”Ÿ C/C++ ç¨‹åºæ˜¯ä¸éœ€è¦çš„ï¼Œä½†æ˜¯ç”±äºæˆ‘ä»¬é€šè¿‡ add_rules(\u0026quot;qt.widgetapp\u0026quot;) é’ˆå¯¹å½“å‰ç›®æ ‡ç”Ÿæ•ˆäº† qt.widgetapp è§„åˆ™ã€‚\nè¿™ä¸ªæ—¶å€™ï¼Œadd_files å°±èƒ½è‡ªåŠ¨å¤„ç† *.ui æ–‡ä»¶çš„ç¼–è¯‘ï¼Œä»¥åŠå¯¹ mainwindows.h æ–‡ä»¶çš„ç¼–è¯‘ã€‚\næ³¨ï¼šåªæœ‰ä»£ç å†…åŒ…å« Q_OBJECT å®çš„å¤´æ–‡ä»¶æ‰éœ€è¦æ·»åŠ åˆ° add_filesï¼Œå› ä¸ºå¸¦æœ‰ Q_OBJECT çš„å¤´æ–‡ä»¶é‡Œé¢å®šä¹‰äº† QObject çš„ä¸€äº› meta ä¿¡æ¯ï¼Œå¯ä»¥æ”¯æŒ Qt çš„ä¿¡å·æ§½æœºåˆ¶ï¼Œå¹¶ä¸”é€šè¿‡è¿™äº›å¤´æ–‡ä»¶ï¼ŒQtCreator å’Œ xmake ä¼šè‡ªåŠ¨ç”Ÿæˆå¯¹åº”çš„ moc_mainwindow.cpp æ–‡ä»¶å‚ä¸ç¼–è¯‘ï¼Œå¹¶ä¸æ˜¯å•çº¯çš„å¤´æ–‡ä»¶ã€‚\nå¦å¤–ï¼Œxmake ä¼šå°†è¿™ä¸¤ä¸ªç±»å‹çš„æ–‡ä»¶ä¼˜å…ˆåœ¨æœ€å¼€å¤´å‚ä¸ç¼–è¯‘ï¼Œå› ä¸ºå®ƒä»¬è¿˜ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€äº›ä»£ç æ–‡ä»¶ç»™å…¶å®ƒæºç å¼•ç”¨ï¼Œæ‰§è¡Œ xmake ç¼–è¯‘è¿™ä¸ª Qt å·¥ç¨‹ï¼Œç¼–è¯‘é€šè¿‡åä¼šæ˜¾ç¤ºä¸‹å›¾ä¿¡æ¯ã€‚\nç„¶åæ‰§è¡Œ xmake run å‘½ä»¤è¿è¡Œç¼–è¯‘ç”Ÿæˆçš„ç›®æ ‡ç¨‹åºï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä¸€ä¸ªå¯è§†åŒ–çš„ç©ºç™½çª—å£è¢«æ˜¾ç¤ºå‡ºæ¥ï¼Œè¯´æ˜æˆ‘ä»¬ç¬¬ä¸€ä¸ª Qt Gui ç¨‹åºå·²ç»æ„å»ºè¿è¡Œå®Œæˆã€‚\næˆ‘ä»¬å†æ¥æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œå¼€å¯è¯¦ç»†è¾“å‡ºç¼–è¯‘ï¼Œçœ‹ä¸‹ xmake å®é™…ä¼ äº†å“ªäº›ç¼–è¯‘é€‰é¡¹ã€é“¾æ¥é€‰é¡¹ç»™ gccã€‚\nxmake -rv\r ä»ä¸‹å›¾çš„çº¢çº¿éƒ¨åˆ†å¯ä»¥çœ‹å‡ºï¼Œé’ˆå¯¹ Qt Widget çš„åº”ç”¨ç¨‹åºï¼Œxmake ä¼šè‡ªåŠ¨å°† QtGuiã€QtWidgetã€QtCore ç­‰åŸºç¡€åº“ä¼ å…¥è¿›å»å‚ä¸é“¾æ¥ï¼Œå…¶ä¸­ QtCore æ˜¯æ‰€æœ‰ Qt ç¨‹åºå¿…é¡»è¦ç”¨åˆ°çš„ï¼Œå†…ç½®ä¸€äº›å¸¸ç”¨åŸºç¡€ç±»åº“ï¼Œè€Œ QtWidget å’Œ QtGui åœ¨å†™ä¸€äº›å¯è§†åŒ– ui ç¨‹åºçš„æ—¶å€™éƒ½æ˜¯éœ€è¦çš„ã€‚\nåœ¨ vscode ä¸­å¼€å‘ Qt ç¨‹åº åˆšåˆšæˆ‘ä»¬æ˜¯åœ¨ç»ˆç«¯ä¸‹é€šè¿‡ xmake çš„å‘½ä»¤è¡Œç¨‹åºæ¥ç¼–è¯‘è¿è¡Œçš„ Qt å·¥ç¨‹ï¼Œæ—¢ç„¶ä¸ŠèŠ‚å®éªŒå·²ç»å­¦ä¹ åˆ°äº†ä½¿ç”¨ vscode å’Œ xmake-vscode æ’ä»¶åœ¨ vscode çš„ç¼–è¾‘å™¨ç¯å¢ƒæ¥å¼€å‘è°ƒè¯• C/C++ ç¨‹åºï¼Œé‚£ä¹ˆåŒæ ·å¯ä»¥ç”¨æ¥ç¼–è¯‘è¿è¡Œ Qt ç¨‹åºã€‚\næˆ‘ä»¬é¦–å…ˆæ‰“å¼€ vscode ç¼–è¾‘å™¨ï¼Œç„¶åç»§ç»­æ‰“å¼€åˆšåˆšåˆ›å»ºçš„ widgetapp å·¥ç¨‹æ ¹ç›®å½• /home/shiyanlou/Code/widgetappã€‚\nåœ¨ä½¿ç”¨ xmake-vscode æ’ä»¶ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å®‰è£…å®ƒï¼Œå®‰è£…è¿‡ç¨‹å¾ˆç®€å•ï¼Œåªéœ€è¦åˆ‡æ¢åˆ° vscode çš„æ’ä»¶æ‰©å±• tab é¡µï¼Œç„¶åè¾“å…¥ xmake æœç´¢ç›¸å…³æ’ä»¶ã€‚\nå¦‚æœçœ‹åˆ°ä¸‹å›¾æ‰€ç¤ºå†…å®¹ï¼Œè¯´æ˜æˆ‘ä»¬å·²ç»æˆåŠŸæ‰¾åˆ°äº† xmake-vscode æ’ä»¶ï¼Œç„¶åç‚¹å‡»æ—è¾¹çš„ Install å­—æ ·æŒ‰é’®å°±å¯ä»¥å®Œæˆå®‰è£…äº†ã€‚\nå®‰è£…å®Œæˆåè¿™ä¸ªæ’ä»¶æ£€æµ‹åˆ°å½“å‰æ‰“å¼€çš„ç›®å½•é‡Œé¢å­˜åœ¨ xmake.lua æ–‡ä»¶ï¼Œå°±ä¼šè‡ªåŠ¨æ¿€æ´» xmake çš„æ’ä»¶ç¨‹åºï¼Œåœ¨åº•ä¸‹æ˜¾ç¤ºä¸€æ’å¯¹åº”çš„æ’ä»¶æ“ä½œæŒ‰é’®ã€‚\nç‚¹å‡» Build æŒ‰é’®å®Œæˆç¼–è¯‘ï¼Œç„¶åç‚¹å‡»ä¸‰è§’å½¢ç®­å¤´çš„æŒ‰é’®è¿è¡Œæˆ‘ä»¬ç¼–è¯‘å¥½çš„ Qt ç¨‹åºï¼Œå°±å¯ä»¥åœ¨ vscode ä¸­è¿è¡Œå®ƒäº†ï¼Œå…·ä½“æ“ä½œæ­¥éª¤å’Œè¿è¡Œæ•ˆæœå¦‚ä¸‹å›¾ã€‚\nåœ¨ vscode ä¸­è°ƒè¯• Qt ç¨‹åº åœ¨ vscode ä¸­è°ƒè¯• Qt ç¨‹åºçš„è¿‡ç¨‹ï¼Œä¹Ÿè·Ÿä¸ŠèŠ‚å®éªŒä¸­çš„æ“ä½œæ–¹å¼å®Œå…¨ä¸€è‡´ï¼šå°† release æŒ‰é’®ä¿®æ”¹æˆ debug å­—æ ·ï¼Œç„¶åç‚¹å‡» build æŒ‰é’®é‡æ–°ç¼–è¯‘å¸¦æœ‰è°ƒè¯•ç¬¦å·çš„ç›®æ ‡ç¨‹åºï¼Œæ¥ä¸‹æ¥å®‰è£… C/C++ æ’ä»¶ï¼ŒåŒæ—¶ä½¿ç”¨å‘½ä»¤ sudo apt install -y gdb å®‰è£… gdbã€‚\næ¥ä¸‹æ¥å°±åªéœ€è¦åœ¨æˆ‘ä»¬éœ€è¦å…³æ³¨çš„åœ°æ–¹ä¸‹æ–­ç‚¹ã€‚\næˆ‘ä»¬ç‚¹å‡»è°ƒè¯•æŒ‰é’®ï¼Œå¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œå°±ä¼šå‡ºç°ä¸‹å›¾çš„ç•Œé¢ï¼Œè¯´æ˜æ–­ç‚¹å·²ç»è¢«æ­£å¸¸è§¦å‘äº†ï¼Œå¯ä»¥å•æ­¥è°ƒè¯•äº†ã€‚\nQt QuickApp ç¨‹åº ä¸‹é¢ï¼Œæˆ‘ä»¬å†æ¥è®²è§£ Qt Quick åº”ç”¨ç¨‹åºçš„å¼€å‘ï¼Œå®ƒä¹Ÿæ˜¯ Qt æä¾›çš„ä¸€ç§ Gui å¯è§†åŒ–ç¨‹åºæ¡†æ¶ç±»å‹ï¼Œè·Ÿ Qt Widgets ç¨‹åºçš„åŒºåˆ«åœ¨äºï¼š\n Qt Widgets æ›´è€æ›´æˆç†Ÿï¼Œä½† Qt Quick æ›´æ–°æ›´åŠ çš„ç°ä»£åŒ–ã€‚ Qt Widgets é‡‡ç”¨ .ui æ–‡ä»¶æ¥ç»´æŠ¤ UI ç•Œé¢ï¼Œè€Œ Qt Quick é‡‡ç”¨æ–°çš„ QML æ ‡è®°è¯­è¨€æ¥æè¿° UI ç•Œé¢ã€‚  æ€»ä½“æ¯”èµ·æ¥ï¼ŒQt Quick ä¼šä½¿å¾—å¼€å‘æ›´åŠ çš„é«˜æ•ˆæ˜“ç»´æŠ¤ï¼Œè‹¥è¦å¼€å‘ä¸€äº›ç°ä»£åŒ–çš„ UI ç¨‹åºæˆ–è€…ç§»åŠ¨ç«¯ç¨‹åºï¼Œé¦–é€‰ Qt Quickï¼Œè€Œå¯¹äºä¸€äº›ä¼ ç»Ÿçš„æ¡Œé¢ç¨‹åºå°±å€¾å‘äºä½¿ç”¨ Qt Widgets æ¥å¼€å‘ã€‚\næ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¯¦ç»†è®²è§£ Qt QuickApp ç¨‹åºæ˜¯å¦‚ä½•å¼€å‘çš„ï¼Œè¿™é‡Œæˆ‘ä»¬è¿˜æ˜¯ä»¥ vscode ç¼–è¾‘å™¨ä½œä¸º Qt å¼€å‘ç¯å¢ƒã€‚\næ‰§è¡Œå¦‚ä¸‹å‘½ä»¤åˆ›å»ºä¸€ä¸ª ~/Code/quickapp ç©ºç›®å½•ã€‚\nmkdir ~/Code/quickapp\r ç„¶åï¼Œåœ¨ vscode ä¸­æ‰“å¼€è¿™ä¸ªç©ºç›®å½•ï¼Œå¦‚æœä¹‹å‰çš„å·¥ç¨‹è¿˜æ²¡å…³é—­ï¼Œå¯ä»¥å…ˆå…³æ‰å®ƒåå†æ‰“å¼€ï¼Œå¦‚ä¸‹å›¾ã€‚\næ¥ç€æˆ‘ä»¬åœ¨è¿™ä¸ªç©ºå·¥ç¨‹ä¸­åˆ›å»º Qt QuickApp çš„å·¥ç¨‹æ–‡ä»¶ï¼Œè¿˜æ˜¯æ ¹æ®ä¸ŠèŠ‚å®éªŒä¸­æ‰€è®²çš„æ–¹å¼ï¼Œä» View èœå•ä¸­æ‰“å¼€å‘½ä»¤é¢æ¿ï¼Œè¾“å…¥ xmake æ‰¾åˆ°å¹¶ç‚¹å‡» XMake: Create Project èœå•é¡¹ï¼Œå¦‚ä¸‹å›¾ã€‚\nè¿™ä¸ªæ—¶å€™ï¼Œç”±äºå½“å‰è¿˜æ²¡æœ‰ xmake.lua æ–‡ä»¶ï¼Œä¼šåœ¨åº•ä¸‹å¼¹å‡ºä¸€ä¸ªæç¤ºæ¡†ï¼Œç»§ç»­ç‚¹å‡»é‡Œé¢çš„è“è‰²æŒ‰é’®ã€‚\nç„¶åï¼Œæˆ‘ä»¬åœ¨æ˜¾ç¤ºçš„é¡¹ç›®è¯­è¨€ç±»å‹åˆ—è¡¨é¡¹ä¸­ï¼Œé€‰æ‹© c++ é¡¹ç›®ç±»å‹å¹¶ç‚¹å‡»å®ƒï¼ˆå› ä¸º Qt åªèƒ½æ˜¯ C++ å·¥ç¨‹ï¼‰ã€‚\næ¥ç€ï¼Œä¼šçœ‹åˆ°å·¥ç¨‹æ¨¡æ¿ç±»å‹åˆ—è¡¨ï¼Œæˆ‘ä»¬ä»ä¸­é€‰æ‹© qt.quickapp å·¥ç¨‹æ¨¡æ¿ï¼Œå¹¶ç‚¹å‡»å®ƒï¼Œå¦‚ä¸‹å›¾ã€‚\nè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬æ•´ä¸ª Qt Quick å·¥ç¨‹å°±åˆ›å»ºå¥½äº†ï¼Œå…¶è·Ÿç›´æ¥æ‰§è¡Œ xmake create -t qt.quickapp quickapp å‘½ä»¤æ˜¯åŒæ ·çš„æ•ˆæœï¼Œåªä¸è¿‡è¿™å›æˆ‘ä»¬æ˜¯åœ¨ vscode ä¸­å»åˆ›å»ºå®ƒï¼Œåˆ›å»ºå®Œæˆåçš„æ•ˆæœå¦‚ä¸‹å›¾ã€‚\nä»ä¸Šå›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç”Ÿæˆçš„å·¥ç¨‹æ–‡ä»¶å…¶å®è·Ÿä¹‹å‰çš„ Qt Widgets ç¨‹åºè¿˜æ˜¯æœ‰å¾ˆå¤šä¸åŒçš„åœ°æ–¹ï¼Œä¾‹å¦‚æ²¡æœ‰äº† .ui æ–‡ä»¶ï¼Œè€Œæ˜¯æ”¹ç”¨ qml.qrc æ¥æ„å»º uiï¼Œå…¶æœ€ç»ˆæ˜¯åœ¨ main.qml ä¸­æè¿°æ‰€æœ‰çš„ ui å¸ƒå±€å’Œäº‹ä»¶å¤„ç†ã€‚\nå¯ä»¥ä» xmake.lua é…ç½®ä¸­çœ‹åˆ°ï¼Œè¿™å›æ”¹ç”¨ qt.quickapp è§„åˆ™æ¥æ”¯æŒ .qrc æ–‡ä»¶çš„æ„å»ºï¼Œè€Œä¸æ˜¯ qt.widgetapp è§„åˆ™ã€‚\nadd_rules(\u0026quot;mode.debug\u0026quot;, \u0026quot;mode.release\u0026quot;)\rtarget(\u0026quot;quickapp\u0026quot;)\radd_rules(\u0026quot;qt.quickapp\u0026quot;)\radd_headerfiles(\u0026quot;src/*.h\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\radd_files(\u0026quot;src/qml.qrc\u0026quot;)\r Qt Quick çš„ç‰¹ç‚¹ä¹‹ä¸€å°±æ˜¯æ”¹ç”¨ .qml æ¥æè¿° Qt ç¨‹åºçš„ ui å¸ƒå±€ï¼Œç®€å•æ¥è¯´ï¼ŒQML å°±æ˜¯ä¸€ç§ç”¨æˆ·ç•Œé¢è§„èŒƒå’Œæ ‡è®°è¯­è¨€ï¼Œå…è®¸å¼€å‘äººå‘˜å’Œè®¾è®¡å¸ˆåˆ›å»ºé«˜æ€§èƒ½ã€æµç•…çš„åŠ¨ç”»å’Œè§†è§‰å¸å¼•äººçš„åº”ç”¨ç¨‹åºã€‚\næˆ‘ä»¬å†æ¥çœ‹ä¸‹ç”Ÿæˆçš„ main.qml é‡Œé¢çš„å†…å®¹ã€‚\nimport QtQuick 2.9\rimport QtQuick.Window 2.2\rWindow {\rvisible: true\rwidth: 640\rheight: 480\rtitle: qsTr(\u0026quot;Hello World\u0026quot;)\r}\r é‡Œé¢çš„é…ç½®ä¸»è¦ç”¨äºå®šä¹‰ ui å¸ƒå±€ï¼Œæœ€å¼€å¤´é€šè¿‡ import å¼•å…¥ qml çš„ä¸€äº›åœ¨å¸ƒå±€ä¸­ä¼šä½¿ç”¨åˆ°çš„æ¨¡å—ã€‚\nè™½ç„¶ç”Ÿæˆäº†å·¥ç¨‹ï¼Œä¸è¿‡å¦‚æœæˆ‘ä»¬ç°åœ¨å°±ç¼–è¯‘è¿è¡Œè¿™ä¸ªé¡¹ç›®ï¼Œå¤šåŠä¼šé‡åˆ°å¦‚ä¸‹é”™è¯¯ã€‚\nQQmlApplicationEngine failed to load component\rqrc:/main.qml:1 module \u0026quot;QtQuick\u0026quot; version 2.9 is not installed\r è¿™æ˜¯ç”±äºå®éªŒç¯å¢ƒå®‰è£…çš„ Qt ç‰ˆæœ¬æ˜¯ 5.5ï¼Œç®—æ˜¯ä¸€ä¸ªç›¸å¯¹æ¯”è¾ƒè€çš„ç‰ˆæœ¬ï¼Œè€Œ xmake é»˜è®¤ç”Ÿæˆçš„æ¨¡æ¿å·¥ç¨‹ main.qml ä¸­ï¼Œimport å¯¼å…¥çš„æ˜¯ 2.9 é«˜ç‰ˆæœ¬çš„ QtQuickï¼Œä¹Ÿå°±æ˜¯å¯¹åº” Qt 5.9 çš„ç‰ˆæœ¬ã€‚\nä¸ºäº†èƒ½å¤Ÿè®©ç¨‹åºæ­£å¸¸ç¼–è¯‘é€šè¿‡ï¼Œæˆ‘ä»¬éœ€è¦æ”¹ä¸‹ main.qml å°† 2.9 æ”¹æˆ 2.5 å³å¯ï¼Œå¦‚ä¸‹å›¾ã€‚\næ”¹å®Œåï¼Œæˆ‘ä»¬å°±å¯ä»¥ç‚¹å‡» Build æŒ‰é’®ç¼–è¯‘è¿™ä¸ª Qt Quick ç¨‹åºäº†ï¼Œå¦‚æœç¼–è¯‘é€šè¿‡ï¼Œä¼šæ˜¾ç¤ºä¸‹å›¾çš„ç»“æœã€‚\nç¼–è¯‘é€šè¿‡åï¼Œæˆ‘ä»¬å†æ¥ç‚¹å‡»è¿è¡ŒæŒ‰é’®è¿è¡Œæ­¤ç¨‹åºï¼Œå¦‚æœæˆåŠŸï¼Œä¼šçœ‹åˆ°ä¸€ä¸ªç©ºç™½çš„çª—å£æ˜¾ç¤ºå‡ºæ¥ï¼Œå°±è·Ÿ Qt Widgets çš„æ•ˆæœå·®ä¸å¤šã€‚\nå¦å¤–ï¼Œè‡³äºåˆšåˆšè¯´çš„ main.qml ä¸­ Qt Quick ç‰ˆæœ¬ä¸ Qt ç‰ˆæœ¬å¦‚ä½•å¯¹åº”ï¼Œæˆ‘ä»¬å¯ä»¥å‚è€ƒ Qt çš„å®˜æ–¹æ–‡æ¡£ Qt å’Œ Qt Quick å†å²ç‰ˆæœ¬å¯¹ç…§è¡¨ï¼Œä¹Ÿå°±æ˜¯ä¸‹å›¾æ‰€ç¤ºã€‚\nè™½ç„¶ï¼Œä¸Šé¢æ²¡æœ‰æˆ‘ä»¬å½“å‰ Qt 5.5 çš„ç‰ˆæœ¬ï¼Œä½†æ˜¯ä¾æ¬¡ä»ä¸Šå¾€ä¸‹æ¨ç®—ï¼ŒQt 5.5 å·®ä¸å¤šå°±æ˜¯å¯¹åº” Qt Quick 2.5 ç‰ˆæœ¬ã€‚\nQuick QML å¸ƒå±€é…ç½®ä¿®æ”¹ è™½ç„¶æˆ‘ä»¬çš„å®éªŒè¯¾ç¨‹åªè¦è®²è§£ xmake çš„ä½¿ç”¨ï¼Œä¸è¿‡ä¸ºäº†æ›´åŠ æ·±åˆ»çš„ä½“éªŒä½¿ç”¨ xmake æ¥å¼€å‘æ„å»º Qt ç¨‹åºï¼Œæˆ‘ä»¬æœ€åä»¥ä¸€ä¸ªå®é™…çš„ä¾‹å­ä¸ºä¾‹ï¼Œåœ¨ä¹‹å‰çš„ quickapp å·¥ç¨‹çš„åŸºç¡€ä¸Šï¼Œå¢åŠ ä¸€ä¸ª Button æŒ‰é’®éƒ¨ä»¶å“åº”ç‚¹å‡»äº‹ä»¶ï¼Œå»éšæœºæ”¹åŠ¨çª—å£çš„èƒŒæ™¯è‰²ã€‚\nå…¶å®æˆ‘ä»¬åªéœ€è¦æ”¹åŠ¨ main.qml é‡Œé¢çš„ ui å¸ƒå±€ä»£ç ï¼Œå°±èƒ½å®Œæˆæ‰€éœ€åŠŸèƒ½ï¼Œä¿®æ”¹åçš„å†…å®¹å¦‚ä¸‹ã€‚\nimport QtQuick 2.5\rimport QtQuick.Window 2.2\rimport QtQuick.Controls 1.2\rWindow {\rid: root\rvisible: true\rwidth: 640\rheight: 480\rtitle: qsTr(\u0026quot;Hello World\u0026quot;)\rButton {\rtext: \u0026quot;Ok\u0026quot;\ronClicked: {\rroot.color = Qt.rgba(Math.random(), Math.random(), Math.random(), 1);\r}\r}\r}\r é€šè¿‡å¼•å…¥ Button éƒ¨ä»¶åˆ°å½“å‰çš„çª—å£ä¸­ï¼Œç„¶åå®šä¹‰ onClicked äº‹ä»¶å»ä¿®æ”¹ root çª—å£çš„èƒŒæ™¯è‰²ï¼Œä¿®æ”¹å®Œæˆåã€‚\næ¯æ¬¡æ”¹å®Œä»»ä½•ä»£ç å’Œ qml é…ç½®åï¼Œéƒ½éœ€è¦é‡æ–°ç¼–è¯‘ã€‚ä¸ºäº†æ‰§è¡Œé‡æ–°ç¼–è¯‘ï¼Œæˆ‘ä»¬éœ€è¦ä»èœå•é‡Œé¢çš„å‘½ä»¤é¢æ¿ä¸­ï¼Œæ‰¾åˆ° xmake çš„ Rebuild å‘½ä»¤ï¼Œç‚¹å‡»æ‰§è¡Œæ‰è¡Œã€‚\nä»ä¸‹å›¾çš„çº¢è‰²ç®­å¤´ä½ç½®æ‰¾åˆ°å¯¹åº”çš„å‘½ä»¤é¢æ¿ã€‚\nç„¶åå†æ‰“å¼€çš„å‘½ä»¤é¢æ¿ä¸­è¾“å…¥ xmake è¿‡æ»¤å‡ºæ‰€æœ‰è·Ÿ xmake ç›¸å…³çš„å‘½ä»¤åˆ—è¡¨ï¼Œæ‰¾åˆ° Rebuild å‘½ä»¤åç‚¹å‡»ç¼–è¯‘å³å¯ï¼Œå¦‚ä¸‹å›¾ã€‚\næœ€åç‚¹å‡»è¿è¡Œï¼Œé¦–æ¬¡è¿è¡Œçš„æ•ˆæœå¦‚ä¸‹ï¼Œæˆ‘ä»¬ä¼šé¢å¤–çœ‹åˆ°ä¸€ä¸ª Button æŒ‰é’®åœ¨çª—å£ä¸­ã€‚\nç‚¹å‡»è¿™ä¸ª Button æŒ‰é’®ï¼Œå°±ä¼šçœ‹åˆ°çª—å£çš„é¢œè‰²å¼€å§‹éšæœºå˜åŠ¨äº†ï¼Œå¦‚ä¸‹å›¾ã€‚\næ‰€ä»¥ï¼Œæˆ‘ä»¬ä¹Ÿèƒ½é€šè¿‡æ­¤å®éªŒç¡®å®šå³ä½¿ä¸ä½¿ç”¨ Qt Creatorï¼Œä»…ä»…ä½¿ç”¨ vscode å’Œ xmake ä¹Ÿæ˜¯å¯ä»¥æ­£å¸¸å¼€å‘å’Œæ„å»º Qt åº”ç”¨ç¨‹åºçš„ï¼Œå¹¶æ²¡æœ‰å¤ªå¤§çš„åŒºåˆ«ã€‚\næ·»åŠ  Qt ä¾èµ–åº“ é™¤äº† QtGuiã€QtCore ç­‰åŸºç¡€ Qt åº“ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡ add_frameworks æ¥å£å»é…ç½®ä¸€äº›é¢å¤–çš„ Qt ä¾èµ–åº“ã€‚\nå®ƒè·Ÿ add_links çš„åŒºåˆ«åœ¨äºï¼šadd_links ä»…ä»…åªä¼šç®€å•åœ°å°†åº“ä½œä¸º -lQtGui æ–¹å¼æ¥é“¾æ¥ï¼›è€Œ add_frameworks ä¸»è¦ç”¨äºæ·»åŠ  QT ç›¸å…³åº“ï¼Œé™¤äº†ä¼šæ·»åŠ  -lQtGui ä¹‹å¤–ï¼Œè¿˜ä¼šæ·»åŠ  -I/xxx/QtGui ç­‰å¤´æ–‡ä»¶æœç´¢è·¯å¾„ï¼Œä»¥åŠé“¾æ¥æœç´¢è·¯å¾„ï¼Œå¦å¤–è¿˜ä¼šæ·»åŠ å¯¹åº”çš„ -DQT_XML_LIB å®å®šä¹‰ã€‚\næˆ‘ä»¬ä¿®æ”¹åˆšåˆšç”Ÿæˆçš„ Qt Quick é¡¹ç›®ä¸­çš„ xmake.lua æ–‡ä»¶å†…å®¹ï¼Œé€šè¿‡ add_frameworks(\u0026quot;QtXml\u0026quot;) æ·»åŠ  QtXml ä¾èµ–åº“ï¼Œè¯¦ç»†é…ç½®å¦‚ä¸‹ã€‚\nadd_rules(\u0026quot;mode.debug\u0026quot;, \u0026quot;mode.release\u0026quot;)\rtarget(\u0026quot;quickapp\u0026quot;)\radd_rules(\u0026quot;qt.quickapp\u0026quot;)\radd_headerfiles(\u0026quot;src/*.h\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\radd_files(\u0026quot;src/qml.qrc\u0026quot;)\radd_frameworks(\u0026quot;QtXml\u0026quot;) -- æ·»åŠ  QtXml ä¾èµ–åº“\r è¿™å›ï¼Œæˆ‘ä»¬åœ¨å‘½ä»¤è¡Œä¸‹è¿è¡Œ xmake -rv å‘½ä»¤ï¼ŒæŸ¥çœ‹è¯¦ç»†çš„ç¼–è¯‘å‘½ä»¤å‚æ•°ã€‚\ncd ~/Code/quickapp\rxmake -rv\r å¯ä»¥çœ‹åˆ°ï¼Œè™½ç„¶æˆ‘ä»¬ä»…ä»…åªæ˜¯æ·»åŠ äº† add_frameworks(\u0026quot;QtXml\u0026quot;) é…ç½®ï¼Œä½†æ˜¯ xmake ä¼šè‡ªåŠ¨è¿½åŠ ä¸ä½¿ç”¨ QtXml åº“ç›¸å…³çš„æ‰€æœ‰ç¼–è¯‘é“¾æ¥é€‰é¡¹ï¼Œä¹Ÿå°±æ˜¯ä¸‹å›¾çš„çº¢çº¿ä½ç½®éƒ¨åˆ†ï¼Œè¿™æ¯”èµ·æ‰‹åŠ¨ä½¿ç”¨ add_linksã€add_includedirs ç­‰æŒ¨ä¸ªè®¾ç½®æ¯”èµ·æ¥æ›´åŠ çš„æ–¹ä¾¿ï¼Œä¹Ÿæ›´åŠ çš„è·¨å¹³å°ã€‚\nå®éªŒæ€»ç»“ åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬äº†è§£äº† Qt çš„ä¸€äº›åŸºæœ¬æ¦‚å¿µï¼Œä¹Ÿå­¦ä¹ äº†å¦‚ä½•å»å¼€å‘ç¼–è¯‘ Qt Widget å’Œ Qt Quick åº”ç”¨ç¨‹åºï¼Œå¦å¤–æˆ‘ä»¬è¿˜å­¦ä¼šäº†ä½¿ç”¨ vscode ç¼–è¾‘ç¯å¢ƒå»å¼€å‘ Qt ç¨‹åºã€‚\næœ¬å®éªŒçš„å‚è€ƒä»£ç å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ä¸‹è½½ï¼š\nwget https://labfile.oss.aliyuncs.com/courses/2764/code21.zip\r ","id":46,"section":"categories","summary":"# ä½¿ç”¨ xmake å¼€å‘ Qt ç¨‹åº åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬å°†ä¼šå­¦ä¹ åˆ°å¦‚ä½•ä½¿ç”¨ vscode ç»“åˆ xmake-vscode æ’ä»¶å»ç¼–è¯‘å¼€å‘ Qt åº”ç”¨ç¨‹åºï¼Œå¹¶ä¸”ä¹Ÿä¼šå­¦ä¹ åˆ°ä¸€äº› Qt ç›¸å…³çš„åŸºç¡€æ¦‚å¿µï¼Œä»¥åŠ Qt Widgets å’Œ Quick App ä¸¤","tags":["xmake"],"title":"å®éªŒ21ä½¿ç”¨ xmake å¼€å‘ Qt ç¨‹åº","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/app/xmake/%E8%93%9D%E6%A1%A5%E7%BD%91%E8%AF%BE/4xmake%E5%AE%9E%E6%88%98/%E5%AE%9E%E9%AA%8C21%E4%BD%BF%E7%94%A8xmake%E5%BC%80%E5%8F%91qt%E7%A8%8B%E5%BA%8F/","year":"2021"},{"content":"åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•åœ¨ vscode ä¸­ä½¿ç”¨ xmake ç¼–è¯‘å¼€å‘ C/C++ ç¨‹åºï¼Œå¦‚ä½•è¿›è¡Œæ–­ç‚¹è°ƒè¯•ä»¥åŠ xmake-vscode æ’ä»¶çš„ä¸€äº›åŸºæœ¬æ“ä½œå’Œä½¿ç”¨ã€‚\nçŸ¥è¯†ç‚¹  xmake-vscode æ’ä»¶åŸºæœ¬ä½¿ç”¨ ä½¿ç”¨æ’ä»¶è¿›è¡Œæ–­ç‚¹è°ƒè¯• å‘½ä»¤é¢æ¿çš„ä½¿ç”¨ æ’ä»¶çš„å‚æ•°é…ç½®å’Œä¿®æ”¹  xmake-vscode æ’ä»¶ä»‹ç» æˆ‘ä»¬ä¹‹å‰çš„æ‰€æœ‰å®éªŒï¼Œéƒ½æ˜¯ä½¿ç”¨ xmake çš„å‘½ä»¤è¡Œç¨‹åºåœ¨ç»ˆç«¯ä¸‹æ“ä½œå®Œæˆçš„ï¼Œè¿™å¯¹äºä¸€äº›åˆå­¦è€…æ¥è¯´è¿˜æ˜¯æœ‰ä¸å°‘é—¨æ§›çš„ï¼Œå¹¶ä¸”æ“ä½œèµ·æ¥ä¹Ÿä¸èƒ½å¤Ÿåƒå…¶å®ƒ IDE ç­‰å¸¦æœ‰å¯è§†åŒ–ç•Œé¢çš„å¼€å‘ç¯å¢ƒé‚£æ ·é¡ºæ‰‹ï¼Œå°¤å…¶æ˜¯ä»£ç çš„ç¼–è¾‘ã€ç¼–è¯‘å’Œæ–­ç‚¹è°ƒè¯•éƒ½éœ€è¦ä¸åœçš„åˆ‡æ¢å„ç§ç»ˆç«¯ã€ç¼–è¾‘å™¨ç¯å¢ƒæ‰èƒ½å®Œæˆã€‚\nä¸ºäº†æ–¹ä¾¿æˆ‘ä»¬çš„æ—¥å¸¸å¼€å‘ï¼Œxmake å®˜æ–¹æä¾›äº†å¯ä»¥å¿«é€Ÿæ— ç¼é›†æˆåˆ° Visual Studio Code ç¼–è¾‘å™¨çš„ xmake-vscode æ’ä»¶ï¼Œä½¿ç”¨è¿™ä¸ªæ’ä»¶æˆ‘ä»¬å¯ä»¥é€šè¿‡ vscode ç¼–è¾‘å™¨ç¯å¢ƒæ¥ä¸€ç«™å¼è¿›è¡Œ C/C++ ç¨‹åºå¼€å‘ï¼Œå†…ç½® xmake ç¼–è¯‘ã€æ–­ç‚¹è°ƒè¯•ã€ç¼–è¯‘é”™è¯¯åˆ†æå®šä½ã€ç¼–è¯‘é…ç½®çš„å¿«é€Ÿåˆ‡æ¢ç­‰å„ç§å®ç”¨åŠŸèƒ½ã€‚\nè€Œ Visual Studio Code ç¼–è¾‘å™¨æ˜¯å¾®è½¯æ¨å‡ºçš„ä¸€æ¬¾è½»é‡çº§è·¨å¹³å°çš„ç¼–è¾‘å™¨ï¼Œå…·æœ‰éå¸¸å¥½çš„è·¨å¹³å°æ€§ã€å¯æ‰©å±•æ€§ï¼Œæˆ‘ä»¬åœ¨å®éªŒç¯å¢ƒçš„æ¡Œé¢ä¸Šï¼Œå°±èƒ½æ‰¾åˆ°å¸¦æœ‰ Visual Studio Code å­—æ ·çš„å›¾æ ‡ï¼ŒåŒå‡»è¿è¡Œå°±å¯ä»¥æ‰“å¼€å®ƒã€‚\nå®‰è£… xmake-vscode æ’ä»¶ é¦–å…ˆåœ¨ç¯å¢ƒä¸­å®‰è£… xmakeï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š\nbash \u0026lt;(curl -fsSL https://xmake.io/shget.text) v2.3.7\rsource ~/.xmake/profile\r# æ£€æŸ¥ç‰ˆæœ¬ï¼ŒéªŒè¯å®‰è£…æˆåŠŸ\rxmake --version\r åœ¨ä½¿ç”¨ xmake-vscode æ’ä»¶ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å®‰è£…å®ƒï¼Œå®‰è£…è¿‡ç¨‹å¾ˆç®€å•ï¼Œåªéœ€è¦åˆ‡æ¢åˆ° vscode çš„æ’ä»¶æ‰©å±• tab é¡µï¼Œç„¶åè¾“å…¥ xmake æœç´¢ç›¸å…³æ’ä»¶ã€‚\nå¦‚æœçœ‹åˆ°ä¸‹å›¾æ‰€ç¤ºå†…å®¹ï¼Œè¯´æ˜æˆ‘ä»¬å·²ç»æˆåŠŸæ‰¾åˆ°äº† xmake-vscode æ’ä»¶ï¼Œç„¶åç‚¹å‡»æ—è¾¹çš„ Install å­—æ ·æŒ‰é’®å°±å¯ä»¥å®Œæˆå®‰è£…äº†ã€‚\nåˆ›å»ºå’Œæ‰“å¼€ C/C++ å·¥ç¨‹ æ’ä»¶å®‰è£…å®Œæˆåï¼Œæˆ‘ä»¬å¯ä»¥å…ˆæ¥åˆ›å»ºä¸€ä¸ªç©ºçš„ C å·¥ç¨‹ï¼Œä¹‹å‰ä»‹ç»è¿‡å¯ä»¥ä½¿ç”¨ xmake create å‘½ä»¤æ¥åˆ›å»ºå·¥ç¨‹ã€‚ä½†æ˜¯è¿™é‡Œæˆ‘ä»¬æ‰“ç®—ç›´æ¥ä½¿ç”¨ xmake-vscode æ’ä»¶æä¾›çš„å·¥ç¨‹åˆ›å»ºåŠŸèƒ½æ¥å®Œæˆ C/C++ å·¥ç¨‹çš„åˆ›å»ºã€‚\nåœ¨åˆ›å»ºä¹‹å‰ï¼Œéœ€è¦å…ˆå‡†å¤‡ä¸€ä¸ªç©ºç›®å½•ç”¨æ¥å­˜æ”¾å·¥ç¨‹æ–‡ä»¶ï¼Œä¾‹å¦‚å°†å·¥ç¨‹æ”¾ç½®åœ¨ ~/Code/vscode_test ç›®å½•ä¸‹ï¼Œå¦‚æœè¿˜ä¸å­˜åœ¨æ­¤ç›®å½•ï¼Œå¯ä»¥å…ˆæ‰‹åŠ¨åˆ›å»ºä¸‹ã€‚\nç„¶åï¼Œæˆ‘ä»¬ç›´æ¥åœ¨ vscode é‡Œé¢æ‰“å¼€è¿™ä¸ªç©ºç›®å½•ï¼Œåªéœ€è¦é€šè¿‡ç‚¹å‡»ä¸‹å›¾çº¢æ¡†ä½ç½®çš„æŒ‰é’®ã€‚\nç‚¹å‡»åï¼Œæˆ‘ä»¬è¿›å…¥åˆšåˆšåˆ›å»ºçš„ vscode_test ç›®å½•ï¼Œé€‰ä¸­å¹¶æ‰“å¼€å®ƒã€‚\næ‰“å¼€ç›®å½•åï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹åˆ›å»ºå·¥ç¨‹æ–‡ä»¶äº†ï¼Œç»§ç»­è¿›å…¥èœå•çš„ view å­èœå•æ‰“å¼€ vscode é‡Œé¢çš„å‘½ä»¤é¢æ¿ï¼Œå¦‚ä¸‹å›¾ã€‚\nå‘½ä»¤é¢æ¿æ‰“å¼€åï¼Œæˆ‘ä»¬è¾“å…¥ xmake å­—ç¬¦ä¸²ï¼Œå°±ä¼šçœ‹åˆ°ä¸€ç³»åˆ—è·Ÿ xmake æ’ä»¶ç›¸å…³çš„å‘½ä»¤ï¼Œç„¶åä»å…¶ä¸­æ‰¾åˆ°å¸¦ Create Project å­—æ ·çš„å‘½ä»¤ï¼Œå¦‚å›¾ã€‚\nè¿™ä¸ªæ—¶å€™ï¼Œç”±äºå½“å‰è¿˜æ²¡æœ‰ xmake.lua æ–‡ä»¶ï¼Œä¼šåœ¨åº•ä¸‹å¼¹å‡ºä¸€ä¸ªæç¤ºæ¡†ï¼Œç»§ç»­ç‚¹å‡»é‡Œé¢çš„è“è‰²æŒ‰é’®ã€‚\næ¥ç€å°±ä¼šå¼¹å‡ºç¼–ç¨‹è¯­è¨€çš„é€‰æ‹©åˆ—è¡¨ï¼Œè¿™é‡Œé€‰æ‹©ç¬¬äºŒé¡¹ï¼Œä¹Ÿå°±æ˜¯ C++ è¯­è¨€ã€‚\né€‰æ‹©å®Œè¯­è¨€åï¼Œè¿˜ä¼šæç¤ºé€‰æ‹©å·¥ç¨‹ç±»å‹ï¼Œè¿™é‡Œé€‰æ‹© console ç»ˆç«¯ç¨‹åºç±»å‹ã€‚\né€‰æ‹©å®Œæˆåï¼Œæ•´ä¸ªé¡¹ç›®å°±åˆ›å»ºå¥½äº†ï¼Œä¸‹å›¾å·¦è¾¹å°±æ˜¯æ–°åˆ›å»ºçš„å·¥ç¨‹æ–‡ä»¶ï¼Œæ ¹ç›®å½•ä¸‹æœ‰ xmake.luaï¼Œè€Œå›¾æœ€åº•ä¸‹çš„å·¥å…·æ å°±æ˜¯ xmake æ’ä»¶çš„æ“ä½œé¢æ¿äº†ï¼Œæˆ‘ä»¬çš„å¤§éƒ¨åˆ†æ“ä½œéƒ½å¯ä»¥é€šè¿‡è¿™ä¸ªé¢æ¿å¿«é€Ÿå®Œæˆï¼ŒåŒ…æ‹¬ï¼šç¼–è¯‘ã€è¿è¡Œã€è°ƒè¯•ä»¥åŠé…ç½®åˆ‡æ¢ç­‰ç­‰ã€‚\nå·¥å…·æ é¢æ¿ä»‹ç» åˆ›å»ºå®Œæˆå·¥ç¨‹åï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ° vscode åº•éƒ¨å·¥å…·é“¾å‡ºç°äº†ä¸€æ’è·Ÿ xmake ç›¸å…³çš„æ“ä½œé¢æ¿ï¼Œxmake çš„å¤§éƒ¨åˆ†æ“ä½œéƒ½å¯ä»¥é€šè¿‡è¿™ä¸ªé¢æ¿ä¸Šçš„å·¥å…·æŒ‰é’®æ¥å¿«é€Ÿå®Œæˆï¼Œå¦‚ä¸‹å›¾ã€‚\nå¦å¤–ï¼Œä¸ä»…ä»…æ˜¯åˆ›å»ºå·¥ç¨‹ï¼Œå¦‚æœå®‰è£… xmake-vscode æ’ä»¶åï¼Œä½¿ç”¨ vscode æ‰“å¼€ä¸€ä¸ªå¸¦æœ‰ xmake.lua æ–‡ä»¶çš„ C/C++ å·¥ç¨‹æ ¹ç›®å½•ï¼Œé‚£ä¹ˆ vscode åº•éƒ¨çš„ xmake å·¥å…·æ é¢æ¿ä¹Ÿä¼šè¢«è‡ªåŠ¨æ¿€æ´»ã€‚\né€šè¿‡ä¸Šå›¾ï¼Œæˆ‘ä»¬å¤§æ¦‚èƒ½çŸ¥é“æ¯ä¸ªæŒ‰é’®çš„å…·ä½“åŠŸèƒ½ï¼Œå…·ä½“æ›´è¿›ä¸€æ­¥çš„ä½¿ç”¨æ–¹å¼ï¼Œæˆ‘ä»¬ä¼šæ¥ä¸‹æ¥ä¼šæŒ¨ä¸ªè®²è§£ã€‚\nç¼–è¯‘ C/C++ ç¨‹åº åˆšåˆšæˆ‘ä»¬é€šè¿‡ vscode åˆ›å»ºçš„ä¸€ä¸ª C++ é¡¹ç›®å·¥ç¨‹ï¼Œå…¶å†…éƒ¨å°±æ˜¯æ‰§è¡Œäº† xmake çš„ xmake create vscode_test å‘½ä»¤æ¥å®Œæˆçš„ï¼Œæ•´ä¸ªå·¥ç¨‹æ–‡ä»¶ç»“æ„å¦‚ä¸‹ã€‚\n.\râ”œâ”€â”€ src\râ”‚ â””â”€â”€ main.cpp\râ””â”€â”€ xmake.lua\r åœ¨ç¼–è¯‘ä¹‹å‰ï¼Œå…ˆè°ƒæ•´ä¸‹ç”Ÿæˆçš„ xmake.lua æ–‡ä»¶ï¼Œä¿®æ”¹æˆå¦‚ä¸‹é…ç½®ã€‚\nadd_rules(\u0026quot;mode.debug\u0026quot;, \u0026quot;mode.release\u0026quot;)\rtarget(\u0026quot;test\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\r å…¶å®ï¼Œä¹Ÿå°±æ˜¯å°†ç¨‹åºç›®æ ‡åæ”¹æˆ testï¼Œç„¶åç‚¹å‡» vscode åº•ä¸‹çš„ xmake å·¥å…·æ é‡Œé¢çš„ Build æŒ‰é’®ï¼Œæ¥ç¼–è¯‘æˆ‘ä»¬æ–°åˆ›å»ºçš„ C++ å·¥ç¨‹ï¼Œç¼–è¯‘æ•ˆæœå¦‚ä¸‹å›¾ã€‚\nè¿è¡Œç¨‹åº ç¼–è¯‘å®Œæˆåå°±å¯ä»¥å°è¯•è¿è¡Œç¨‹åºäº†ï¼Œè¿˜æ˜¯ä½¿ç”¨åº•ä¸‹çš„å·¥å…·æ æŒ‰é’®ï¼Œç‚¹å‡»è¿è¡Œå›¾æ ‡ï¼Œä¹Ÿå°±æ˜¯ä¸‹å›¾çº¢æ¡†ä¸­çš„æŒ‰é’®ã€‚\nå¦‚æœè¿è¡ŒæˆåŠŸï¼Œå°±ä¼šçœ‹åˆ°å®é™…çš„è¿è¡Œè¾“å‡ºä¿¡æ¯ï¼šHello world!ã€‚\nè°ƒè¯•ç¨‹åº æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬é‡ç‚¹è®²è§£å¦‚ä½•é€šè¿‡ vscode é…åˆ xmake-vscode æ’ä»¶æ¥å®ç°æ–­ç‚¹è°ƒè¯• C/C++ ç¨‹åºã€‚\nä¸è¿‡åœ¨è°ƒè¯•å‰è¿˜éœ€è¦åšä¸€äº›å‡†å¤‡å·¥ä½œï¼Œç”±äºé»˜è®¤ xmake é‡‡ç”¨ release æ¨¡å¼ç¼–è¯‘çš„ç›®æ ‡ç¨‹åºï¼Œæ˜¯ä¸å¸¦è°ƒè¯•ç¬¦å·ä¿¡æ¯çš„ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å…ˆå°†ç¼–è¯‘æ¨¡å¼åˆ‡æ¢åˆ° debug è°ƒå¼ç¼–è¯‘æ¨¡å¼å»é‡æ–°ç¼–è¯‘å®ƒï¼Œä½¿å…¶å¸¦ä¸Šè°ƒè¯•ç¬¦å·ä¿¡æ¯ã€‚\nå…·ä½“å¦‚ä½•åˆ‡æ¢åˆ° debug æ¨¡å¼ï¼Œå¯ä»¥å‚è€ƒä¸‹å›¾çš„æ“ä½œï¼Œç‚¹å‡»åº•ä¸‹ release æ–‡æœ¬æ‰€åœ¨çš„æŒ‰é’®ï¼Œç„¶ååœ¨ä¸Šé¢åˆ—å‡ºçš„åˆ—è¡¨ä¸­ï¼Œé€‰æ‹© debug é¡¹å³å¯ã€‚\nå®Œæˆåˆ‡æ¢åå¯ä»¥çœ‹åˆ°åº•ä¸‹çš„ release æŒ‰é’®å·²ç»å˜æˆäº† debug å­—æ ·ï¼Œç„¶åç‚¹å‡» build æŒ‰é’®ï¼Œå°±å¯ä»¥é‡æ–°ç¼–è¯‘å¸¦æœ‰è°ƒè¯•ç¬¦å·çš„ç›®æ ‡ç¨‹åºäº†ã€‚\nè°ƒè¯•ç‰ˆæœ¬ç¨‹åºç¼–è¯‘å®Œæˆåï¼Œè¿˜éœ€è¦é¢å¤–åšä¸€ä»¶äº‹ï¼Œé‚£å°±æ˜¯å®‰è£… vscode çš„ C/C++ æ’ä»¶ï¼Œå› ä¸º xmake-vscode æ’ä»¶çš„è°ƒè¯•åŠŸèƒ½æ˜¯åŸºäºè¿™ä¸ªæ’ä»¶çš„ï¼Œæˆ‘ä»¬ä»…ä»…åªéœ€è¦é¦–æ¬¡ä½¿ç”¨æ—¶å®‰è£…å®ƒå³å¯ã€‚\né‡æ–°åˆ‡åˆ°æ’ä»¶å¸‚åœºé¡µé¢ï¼Œæœç´¢ C/C++ï¼Œæ˜¾ç¤ºå‡ºæ¥çš„ç¬¬ä¸€é¡¹å°±æ˜¯ï¼Œç‚¹å‡» Install å®‰è£…å³å¯ï¼Œå¦‚ä¸‹å›¾ã€‚\nå®‰è£…å¥½ C/C++ æ’ä»¶ï¼Œå°±å¯ä»¥å¼€å§‹è°ƒè¯•æ“ä½œäº†ã€‚é¦–å…ˆç‚¹å‡» main.cpp æ‰“å¼€æºæ–‡ä»¶ï¼Œç„¶ååœ¨éœ€è¦ä¸‹æ–­ç‚¹çš„ä»£ç è¡Œå·¦ä¾§ä½ç½®ç‚¹å‡»ä¸‹æ–­ç‚¹ï¼Œå¦‚æœå‡ºç°å°çº¢ç‚¹ï¼Œè¯´æ˜å·²ç»æˆåŠŸä¸‹å¥½äº†è°ƒè¯•æ–­ç‚¹ï¼Œå¦‚ä¸‹å›¾ã€‚\næ–­ç‚¹ä¸‹å¥½åï¼Œå°±å¯ä»¥ç‚¹å‡»åº•ä¸‹çš„è°ƒè¯•æŒ‰é’®ï¼Œå¼€å¯æ–­ç‚¹è°ƒè¯•äº†ï¼Œå¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œç¨‹åºè¿è¡Œèµ·æ¥åå°±ä¼šå‘½ä¸­åˆšåˆšè®¾ç½®çš„æ–­ç‚¹ï¼Œå¦‚ä¸‹å›¾ã€‚\n# éœ€è¦å…ˆåœ¨ç¯å¢ƒä¸­å®‰è£… gdb\rsudo apt install -y gdb\r ç›®æ ‡ç¨‹åºåˆ‡æ¢ æ¥ä¸‹æ¥å†æ¥è¯¦ç»†è®²è§£ç¼–è¯‘ï¼Œä¹‹å‰æˆ‘ä»¬å·²ç»ä½¿ç”¨è¿‡ build æŒ‰é’®æ¥ç¼–è¯‘å·¥ç¨‹ï¼Œä½†å¦‚æœä¸€ä¸ªé¡¹ç›®ä¸­å­˜åœ¨å¤šä¸ªç›®æ ‡ç¨‹åºåˆä¸æƒ³å…¨éƒ¨ç¼–è¯‘ï¼Œæˆ‘ä»¬å°±éœ€è¦æŒ‡å®šç¼–è¯‘å“ªä¸ªç›®æ ‡ç¨‹åºã€‚\nåœ¨å‘½ä»¤è¡Œä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ xmake build test å‘½ä»¤æ¥æ˜¾ç¤ºçš„æŒ‡å®šç¼–è¯‘å“ªä¸ªç›®æ ‡ï¼Œè€Œåœ¨ vscode ä¸­ï¼Œxmake æ’ä»¶ä¹Ÿæä¾›äº†å¾ˆæ–¹ä¾¿çš„ç›®æ ‡åˆ‡æ¢æ“ä½œï¼Œæ¥å¿«é€Ÿåˆ‡æ¢ç¼–è¯‘ã€‚\né¦–å…ˆä¿®æ”¹ xmake.lua æ–‡ä»¶ï¼Œæ–°å¢ä¸€ä¸ªåä¸º test2 çš„ç›®æ ‡ç¨‹åºï¼Œç”¨äºä¹‹åçš„ç›®æ ‡åˆ‡æ¢æµ‹è¯•ï¼Œä¾‹å¦‚ã€‚\nadd_rules(\u0026quot;mode.debug\u0026quot;, \u0026quot;mode.release\u0026quot;)\rtarget(\u0026quot;test\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\rtarget(\u0026quot;test2\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\r ç„¶åç‚¹å‡»åº•ä¸‹ default å­—æ ·çš„æŒ‰é’®ï¼Œä¹‹åä¼šåœ¨é¡¶éƒ¨æ˜¾ç¤ºæ•´ä¸ªé¡¹ç›®æ‰€æœ‰ç›®æ ‡ç¨‹åºåçš„åˆ—è¡¨ï¼Œæˆ‘ä»¬ç‚¹å‡»å…¶ä¸­çš„ test2 ç›®æ ‡ç¨‹åºï¼Œå°±å¯ä»¥å®Œæˆåˆ‡æ¢ã€‚\nå¦‚æœåˆ‡æ¢æˆåŠŸï¼Œåº•ä¸‹çš„ default æ–‡æœ¬å°±ä¼šå˜æˆ test2ï¼Œç”±äºé»˜è®¤ç¼–è¯‘ xmake ä¼šè‡ªåŠ¨ç¼–è¯‘æ‰€æœ‰ç›®æ ‡ç¨‹åºï¼Œæ‰€ä»¥æœ€åˆæ˜¾ç¤ºçš„æ˜¯ default æ–‡æœ¬ã€‚ è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å†æ‰§è¡Œç¼–è¯‘ï¼Œå°±èƒ½çœ‹åˆ°å®é™…ä»…ä»…åªç¼–è¯‘äº†æˆ‘ä»¬æŒ‡å®šçš„ test2 ç›®æ ‡ç¨‹åºã€‚ ç¼–è¯‘é”™è¯¯ä¿¡æ¯ å¦‚æœæˆ‘ä»¬çš„å·¥ç¨‹ä»£ç æ²¡å†™å¯¹å¯¼è‡´ç¼–è¯‘å‡ºé”™ï¼Œå¯ä»¥ç›´æ¥ä»ç¼–è¯‘è¾“å‡ºä¸­çœ‹åˆ°é”™è¯¯ä¿¡æ¯ï¼Œä¾‹å¦‚ä¸‹å›¾ã€‚ è€Œ xmake-vscode æ’ä»¶è¿˜ä¼šè‡ªåŠ¨è§£æç¼–è¯‘é”™è¯¯è¾“å‡ºä¿¡æ¯ï¼Œåˆ†ç±»æ¯ä¸ªç¼–è¯‘é”™è¯¯ï¼Œå¹¶å¯é€šè¿‡åŒå‡»æŒ‡å®šé”™è¯¯ï¼Œè·³è½¬å®šä½åˆ°æŒ‡å®šçš„é”™è¯¯ä»£ç ä½ç½®ï¼Œä¹Ÿå°±æ˜¯ä¸‹å›¾æ‰€ç¤ºä½ç½®ã€‚ æŸ¥çœ‹ç¼–è¯‘è¯¦ç»†ä¿¡æ¯ åœ¨å‘½ä»¤è¡Œä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ xmake -v æ¥æŸ¥çœ‹ç¼–è¯‘è¿‡ç¨‹ä¸­çš„è¯¦ç»†å‘½ä»¤å‚æ•°ä¿¡æ¯ï¼Œè€Œåœ¨ vscode ä¸­åŒæ ·å¯ä»¥é€šè¿‡é…ç½®å¼€å¯è¯¦ç»†è¾“å‡ºã€‚\né¦–å…ˆæ‰“å¼€èœå•ï¼Œç‚¹å‡» File -\u0026gt; Preferences -\u0026gt; Settings å­èœå•ï¼Œå¦‚ä¸‹å›¾ã€‚ ç„¶ååœ¨æ‰“å¼€çš„ Setting é…ç½®é¡µé¢ï¼Œè¾“å…¥ xmake æ‰¾åˆ°æ‰€æœ‰è·Ÿ xmake æ’ä»¶ç›¸å…³çš„é…ç½®é¡¹ï¼Œå…¶ä¸­æœ‰ä¸€é¡¹æ˜¯ BuildLevelï¼Œå®ƒå°±æ˜¯ç”¨äºè®¾ç½®ç¼–è¯‘è¿‡ç¨‹ä¸­çš„è¾“å‡ºä¿¡æ¯çº§åˆ«ã€‚\né»˜è®¤æ˜¯ warnings çº§åˆ«ï¼Œä»…ä»…è¾“å‡ºç¼–è¯‘è­¦å‘Šä¿¡æ¯ä»¥åŠæ­£å¸¸ä¿¡æ¯ï¼Œæˆ‘ä»¬æŠŠå®ƒæ”¹ä¸º verbose çº§åˆ«ï¼Œå°±å¯ä»¥è¾“å‡ºå®Œæ•´çš„ç¼–è¯‘å‘½ä»¤è¡Œå‚æ•°äº†ã€‚ è‡³äº debug çº§åˆ«å¯¹åº”çš„å°±æ˜¯ xmake -vD çš„è¯Šæ–­ä¿¡æ¯ï¼Œè¿˜ä¼šè¿›ä¸€æ­¥æ‰“å°å‡ºé”™çš„æ ˆä¿¡æ¯ã€‚\næˆ‘ä»¬è¿™é‡Œå°†é…ç½®åˆ‡æ¢æˆ verbose çº§åˆ«åï¼Œå†é‡æ–°æ„å»ºä¸‹ç¨‹åºï¼Œçœ‹çœ‹å®é™…çš„è¾“å‡ºæ˜¯æ€æ ·çš„ã€‚ä¸è¿‡ç”±äºåº•éƒ¨åªæä¾›äº† build æŒ‰é’®ï¼Œæ²¡æœ‰ rebuild æŒ‰é’®ï¼Œä¸ºäº†æ‰§è¡Œé‡æ–°ç¼–è¯‘ï¼Œæˆ‘ä»¬éœ€è¦ä»èœå•é‡Œé¢çš„å‘½ä»¤é¢æ¿ä¸­ï¼Œæ‰¾åˆ° xmake çš„ Rebuild å‘½ä»¤ï¼Œç‚¹å‡»æ‰§è¡Œæ‰è¡Œã€‚\nä»ä¸‹å›¾çš„çº¢è‰²ç®­å¤´ä½ç½®æ‰¾åˆ°å¯¹åº”çš„å‘½ä»¤é¢æ¿ã€‚ ç„¶åå†æ‰“å¼€çš„å‘½ä»¤é¢æ¿ä¸­è¾“å…¥ xmake è¿‡æ»¤å‡ºæ‰€æœ‰è·Ÿ xmake ç›¸å…³çš„å‘½ä»¤åˆ—è¡¨ï¼Œæ‰¾åˆ° Rebuild å‘½ä»¤åç‚¹å‡»ç¼–è¯‘å³å¯ï¼Œå¦‚ä¸‹å›¾ã€‚ å¼€å¯ verbose çº§åˆ«åï¼Œæˆ‘ä»¬å°±èƒ½çœ‹åˆ°ç¼–è¯‘è¾“å‡ºä¸­å®Œæ•´çš„å‘½ä»¤å‚æ•°äº†ï¼Œå¦‚ä¸‹å›¾ã€‚ xmake.lua ç¼–è¾‘å’Œè‡ªåŠ¨è¡¥å…¨ xmake-vscode æ’ä»¶è¿˜å†…ç½®äº†å¯¹ xmake.lua æ–‡ä»¶ç¼–å†™æ—¶çš„è‡ªåŠ¨æç¤ºå’Œè¡¥å…¨æ”¯æŒï¼Œæˆ‘ä»¬åªéœ€è¦è¾“å…¥ add_ã€set_ ç­‰å­—æ ·çš„æ–‡æœ¬ï¼Œå°±ä¼šè‡ªåŠ¨åˆ—ä¸¾å‡ºä¸å…¶ç›¸å…³çš„æ‰€æœ‰ api ä¾›æˆ‘ä»¬ä½¿ç”¨ï¼Œæ¥æ–¹ä¾¿å¿«é€Ÿé…ç½® xmake.luaã€‚\næˆ‘ä»¬å¯ä»¥é€šè¿‡ç¼–è¾‘ xmake.lua æ–‡ä»¶å¯¹é‡Œé¢ test2 ç›®æ ‡ç¨‹åºæ·»åŠ ä¸€ä¸ª add_defines(\u0026quot;TEST2\u0026quot;) æ¥ä½“éªŒä¸‹è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½ã€‚\næœ€ç»ˆçš„å®Œæ•´é…ç½®å†…å®¹å¦‚ä¸‹ã€‚\nadd_rules(\u0026quot;mode.debug\u0026quot;, \u0026quot;mode.release\u0026quot;)\rtarget(\u0026quot;test\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\rtarget(\u0026quot;test2\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\radd_defines(\u0026quot;TEST2\u0026quot;)\r è€Œæˆ‘ä»¬è¾“å…¥æ—¶çš„è¡¥å…¨ç‰¹æ€§å¯ä»¥é€šè¿‡ä¸‹é¢çš„å›¾ç‰‡ä½“ä¼šåˆ°ã€‚ å®Œæˆé…ç½®åï¼Œæˆ‘ä»¬å†æ¥ç‚¹å‡»åº•ä¸‹çš„ Build æŒ‰é’®æ‰§è¡Œç¼–è¯‘ï¼Œçœ‹ä¸‹è¯¦ç»†å‘½ä»¤è¾“å‡ºï¼Œåº”è¯¥èƒ½å¤Ÿæ­£å¸¸çœ‹åˆ°æ–°åŠ ä¸Šçš„ -DTEST2 å®å®šä¹‰äº†ã€‚ å®éªŒæ€»ç»“ åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•åœ¨ vscode ä¸­ä½¿ç”¨ xmake-vscode æ’ä»¶æ¥ç¼–è¯‘å¼€å‘ C/C++ ç¨‹åºï¼Œä»¥åŠå¦‚ä½•è¿›è¡Œæ–­ç‚¹è°ƒè¯•ï¼Œå¹¶ä¸”å­¦ä¹ äº† xmake å·¥å…·æ å’Œå‘½ä»¤é¢æ¿çš„ä½¿ç”¨ä»¥åŠå¦‚ä½•è¿›è¡Œå‚æ•°é…ç½®ã€‚\næœ¬å®éªŒçš„å‚è€ƒä»£ç å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ä¸‹è½½ï¼š\nwget https://labfile.oss.aliyuncs.com/courses/2764/code20.zip\r ","id":47,"section":"categories","summary":"åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•åœ¨ vscode ä¸­ä½¿ç”¨ xmake ç¼–è¯‘å¼€å‘ C/C++ ç¨‹åºï¼Œå¦‚ä½•è¿›è¡Œæ–­ç‚¹è°ƒè¯•ä»¥åŠ xmake-vscode æ’ä»¶çš„ä¸€äº›åŸºæœ¬æ“ä½œå’Œä½¿ç”¨ã€‚ çŸ¥è¯†ç‚¹ xmake-vscode æ’ä»¶åŸºæœ¬ä½¿ç”¨ ä½¿ç”¨æ’ä»¶è¿›è¡Œæ–­ç‚¹","tags":["xmake"],"title":"å®éªŒ20xmake-vscode æ’ä»¶ä»‹ç»","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/app/xmake/%E8%93%9D%E6%A1%A5%E7%BD%91%E8%AF%BE/4xmake%E5%AE%9E%E6%88%98/%E5%AE%9E%E9%AA%8C20xmake-%E4%B8%8E-vscode-%E9%9B%86%E6%88%90%E7%8E%AF%E5%A2%83%E4%BD%BF%E7%94%A8/","year":"2021"},{"content":"libjpeg å¼€æºåº“ç§»æ¤ åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬ä¼šå­¦ä¹ åˆ°å¦‚ä½•ä½¿ç”¨ xmake å»ç§»æ¤ç¼–è¯‘ç¬¬ä¸‰æ–¹åº“ libjpeg æºç ï¼Œä»¥åŠå¦‚ä½•å°†ç§»æ¤å¥½çš„åº“å¿«é€Ÿé›†æˆè¿›è‡ªå·±çš„ C/C++ å·¥ç¨‹ä¸­å»ä½¿ç”¨ã€‚\nçŸ¥è¯†ç‚¹  autotools ä»‹ç»å’Œä½¿ç”¨ xmake çš„è‡ªåŠ¨æ‰«æå’Œç”Ÿæˆ libjpeg åº“æºç ç§»æ¤ç¼–è¯‘çš„è¯¦ç»†æµç¨‹ libjpeg åº“çš„å¿«é€Ÿé›†æˆ  ç¬¬ä¸‰æ–¹ä»£ç åº“çš„ç§»æ¤ç¼–è¯‘ é€šè¿‡ä¹‹å‰çš„å®éªŒï¼Œæˆ‘ä»¬å·²ç»åŸºæœ¬å­¦ä¹ äº†è§£äº† xmake.lua çš„é…ç½®è¯­æ³•ï¼Œä¹Ÿå­¦ä¹ äº†å¦‚ä½•é€šè¿‡è¿™ä¸ªæ–‡ä»¶é…ç½®æ„å»º C/C++ é¡¹ç›®ã€‚å› æ­¤ï¼Œåœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬é€šè¿‡å®æˆ˜çš„æ–¹å¼ï¼Œä»¥ä¸€ä¸ªå®é™…çš„ç¬¬ä¸‰æ–¹å¼€æºåŸºç¡€åº“ libjpeg ä¸ºä¾‹ï¼Œè®²è§£å¦‚ä½•é€šè¿‡ä½¿ç”¨ xmake å»å¯¹å®ƒè¿›è¡Œç§»æ¤å’Œç¼–è¯‘ã€‚\nlibjpeg æ˜¯ä¸€ä¸ªç”¨äº jpeg å›¾ç‰‡æ–‡ä»¶è§£ç çš„å¼€æºåŸºç¡€åº“ï¼Œå…¶ä»£ç æœ¬èº«æ˜¯å®Œå…¨è·¨å¹³å°çš„ï¼Œä½†æ˜¯å…¶å†…éƒ¨çš„æ„å»ºç³»ç»Ÿå´éå¸¸çš„æ··ä¹±ï¼Œæœ‰æä¾›å¯¹äº Linux ç³»ç»Ÿçš„ autotoolsï¼Œä¹Ÿæœ‰å¯¹äº msvc ç¼–è¯‘å™¨çš„ bat æ„å»ºè„šæœ¬ã€‚ä¸åŒçš„å¹³å°ï¼Œæ„å»ºæ–¹å¼å·®å¼‚å¾ˆå¤§ï¼Œå¤§å®¶å¦‚æœæƒ³ç¼–è¯‘ä¸åŒå¹³å°çš„åº“ï¼Œéƒ½éœ€è¦èŠ±ä¸Šä¸€å®šçš„æ—¶é—´å»ç ”ç©¶å„ç§å¹³å°ä¸‹å¯¹ libjpeg çš„ç¼–è¯‘è¿‡ç¨‹ã€‚\nè€Œä½¿ç”¨ xmake å°±å¯ä»¥è¿›ä¸€æ­¥ç®€åŒ–å¯¹äºè¿™ä¸ªåº“çš„ç¼–è¯‘ï¼Œå¹¶ä¸”è¿˜æä¾›äº†å¦‚ä½•å»å¿«é€Ÿé›†æˆçš„æ–¹æ³•ã€‚ä¸è¿‡ï¼Œåœ¨å®é™…çš„è®²è§£å‰ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å…ˆä»å®˜ç½‘ä¸‹è½½ libjpeg çš„æºç ï¼Œå¹¶é€šè¿‡ tar å‘½ä»¤è§£å‹åˆ° jpeg-9d ç›®å½•ä¸‹ã€‚\næ•´ä¸ªä¸‹è½½å’Œè§£å‹è¿‡ç¨‹å¦‚ä¸‹ã€‚\ncd ~/Code\rwget http://www.ijg.org/files/jpegsrc.v9d.tar.gz\rtar -xvf jpegsrc.v9d.tar.gz\r ä½¿ç”¨ xmake è°ƒç”¨ autotools ç›´æ¥ç¼–è¯‘ è§£å‹å®Œæˆåï¼Œæ‰§è¡Œ ls å…ˆçœ‹ä¸‹è¿™ä¸ªé¡¹ç›®çš„æ ¹ç›®å½•ä¸‹æœ‰å“ªäº›è·Ÿæ„å»ºç³»ç»Ÿç›¸å…³çš„æ–‡ä»¶ï¼Œæˆ‘ä»¬å‘ç°ï¼Œlibjpeg å…¶å®å­˜åœ¨ ./configure é…ç½®è„šæœ¬ï¼Œè¿™æ˜¯ autotools æ„å»ºå·¥å…·çš„ä¸»è¦é…ç½®å·¥å…·ã€‚è¿™å°±è¯´æ˜ libjpeg å…¶å®å¯ä»¥ç›´æ¥ç”¨ autotools æ¥ç¼–è¯‘çš„ï¼Œåªä¸è¿‡ autotools å¹¶ä¸æ”¯æŒ windows ä»¥åŠ msvc ç¼–è¯‘å™¨ã€‚\næ—¢ç„¶å­˜åœ¨ ./configureï¼Œé‚£ä¹ˆ xmake ä¹Ÿå¯ä»¥ç›´æ¥è°ƒç”¨å®ƒæ¥å®Œæˆæ•´ä¸ªé¡¹ç›®çš„æ„å»ºï¼Œä¾‹å¦‚æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ã€‚\n$ cd jpeg-9d\r$ xmake\rnote: configure found, try building it or you can run `xmake f --trybuild=` to set buildsystem (pass -y or --confirm=y/n/d to skip confirm)?\rplease input: y (y/n)\r åªéœ€è¦æ‰§è¡Œä¸€ä¸ª xmake å‘½ä»¤ï¼Œxmake å°±èƒ½è‡ªåŠ¨æ¢æµ‹å½“å‰çš„é¡¹ç›®æ”¯æŒå“ªäº›æ„å»ºç³»ç»Ÿï¼Œå¦‚æœæœ‰ xmake.lua æ–‡ä»¶ï¼Œé‚£å°±ç›´æ¥æŒ‰ xmake çš„é…ç½®ç¼–è¯‘ï¼Œå¦‚æœæœ‰ ./configure é‚£å°±æç¤ºç”¨æˆ·æ˜¯å¦ä½¿ç”¨ autotools æ„å»ºç³»ç»Ÿå»å¸¸è¯†æ€§ç¼–è¯‘å®ƒï¼ˆå¦å¤– xmake è¿˜æ”¯æŒ cmakeã€meson ç­‰æ„å»ºç³»ç»Ÿæ–‡ä»¶çš„æ¢æµ‹å’Œå°è¯•ç¼–è¯‘ï¼‰ã€‚\nçœ‹åˆ°ä¸‹å›¾æç¤ºåï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰ y æˆ–è€…é»˜è®¤å›è½¦ï¼Œæ¥å‘Šè¯‰ xmake è¯·å°è¯•ç›´æ¥è°ƒç”¨ autotools æ¥ç¼–è¯‘å®ƒã€‚\nç¼–è¯‘æˆåŠŸå®Œæˆåï¼Œxmake ä¼šæŠŠæ„å»ºç”Ÿæˆäº§ç‰©æ”¾ç½®åœ¨ build/artifacts ç›®å½•ä¸‹ï¼Œå®é™…è¾“å‡ºå†…å®¹ï¼Œå¦‚ä¸‹å›¾ã€‚\nè‡ªåŠ¨ç”Ÿæˆ xmake.lua ç§»æ¤ç¼–è¯‘ libjpeg åˆšåˆšæˆ‘ä»¬ä»‹ç»äº†ä½¿ç”¨ xmake ç›´æ¥å»è°ƒç”¨ autotools æ¥ç¼–è¯‘ï¼Œä½†è¿™ç§æ–¹å¼æ¯•ç«Ÿä¾èµ–ç¬¬ä¸‰æ–¹çš„æ„å»ºç³»ç»Ÿï¼Œæœ‰å¾ˆå¤šå±€é™æ€§ï¼Œæ¯”å¦‚ autotools ä¸æ”¯æŒ windowsï¼Œé‚£å°±æ— æ³•åšåˆ°è·¨å¹³å°ç¼–è¯‘äº†ã€‚\nè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘å°† libjpeg çš„æ‰€æœ‰æºç ç§»æ¤åˆ° xmake.lua çš„é…ç½®æ–‡ä»¶ä¸­ï¼Œç„¶ååˆ©ç”¨ xmake å†…éƒ¨çš„æ„å»ºç³»ç»Ÿç›´æ¥å»ç¼–è¯‘å®ƒï¼Œè¿™æ ·å°±èƒ½åšåˆ°ä¸€æ¬¡ç§»æ¤ï¼Œå¤šå¹³å°ç¼–è¯‘æ”¯æŒã€‚\nä¸è¿‡ä»ç°æœ‰çš„æ„å»ºç³»ç»Ÿç§»æ¤åˆ° xmake.lua è¿˜æ˜¯æ¯”è¾ƒè´¹ä½“åŠ›çš„ï¼Œä¸ºæ­¤ xmake æä¾›äº†ä¸€ä¸ªè¾…åŠ©åŠŸèƒ½ï¼Œå®ƒå¯ä»¥æ‰«æå½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æºä»£ç ï¼Œç„¶åè‡ªåŠ¨å¸®æˆ‘ä»¬ç”Ÿæˆä¸€ä¸ªåŸºæœ¬å¯ç”¨çš„ xmake.lua å‡ºæ¥ï¼Œå½“ç„¶è‡ªåŠ¨ç”Ÿæˆçš„é…ç½®æ–‡ä»¶ï¼Œå¤šå°‘ä¼šå­˜åœ¨ä¸€äº›å°é—®é¢˜ï¼Œä½†æ—¢ç„¶æœ‰ä¸ªèŒƒæœ¬ï¼Œæˆ‘ä»¬åœ¨ä¸Šé¢åšäº›å°æ”¹åŠ¨è°ƒæ•´ï¼Œå°±èƒ½å®Œæˆæ•´ä¸ªæ„å»ºç§»æ¤å·¥ä½œã€‚ç›¸æ¯”èµ·å®Œå…¨æ‰‹åŠ¨é…ç½®è¿˜æ˜¯çœäº‹ä¸å°‘çš„ã€‚\nä¸ºäº†å¯ç”¨ xmake çš„è‡ªåŠ¨æ‰«æç‰¹æ€§ï¼Œé¦–å…ˆå¾—ç¡®ä¿å½“å‰ç›®å½•ä¸‹æ²¡æœ‰å…¶å®ƒçš„ç¬¬ä¸‰æ–¹æ„å»ºç³»ç»Ÿæ–‡ä»¶ï¼Œå¦åˆ™ xmake æ£€æµ‹åˆ°åï¼Œä¼šä¼˜å…ˆèµ°å°è¯•è°ƒç”¨ç¬¬ä¸‰æ–¹æ„å»ºç³»ç»Ÿæ¥ç¼–è¯‘çš„é€»è¾‘ã€‚\næ‰€ä»¥æˆ‘ä»¬å…ˆæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œåˆ é™¤ libjpeg è‡ªå¸¦çš„ autotools ç›¸å…³é…ç½®æ–‡ä»¶ã€‚\nrm ./config*\r åˆ é™¤åæ‰§è¡Œ xmake å‘½ä»¤ï¼Œè§¦å‘æºæ–‡ä»¶çš„æ‰«ææç¤ºï¼Œæˆ‘ä»¬åªéœ€è¦æŒ‰ y åå›è½¦ï¼Œç¡®è®¤ç”Ÿæˆå³å¯ã€‚\n$ xmake\rnote: xmake.lua not found, try generating it (pass -y or --confirm=y/n/d to skip confirm)?\rplease input: n (y/n)\r æç¤ºå†…å®¹å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚\næˆ‘ä»¬æ ¹æ®æç¤ºï¼ŒæŒ‰ä¸‹ y å’Œå›è½¦åï¼Œxmake å°±ä¼šå¼€å§‹è‡ªåŠ¨æ‰«æ libjpeg åº“ä¸‹çš„æ‰€æœ‰æºæ–‡ä»¶ï¼Œå¦‚å›¾ã€‚\nè¿˜ä¼šæ‰«æç”¨åˆ° libjpeg åº“çš„ä¸€äº›å¯æ‰§è¡Œç¨‹åºï¼Œå¦‚ä¸‹å›¾ã€‚\nç„¶åç»§ç»­ç¼–è¯‘ï¼Œç¼–è¯‘åˆ°ä¸€åŠçš„æ—¶å€™ï¼Œè§¦å‘äº†ç¼–è¯‘é”™è¯¯ï¼Œçœ‹ä¸‹å›¾çš„é”™è¯¯ä¿¡æ¯ï¼Œåº”è¯¥æ˜¯ç¼–è¯‘ jmemmac.c æ–‡ä»¶å¤±è´¥äº†ã€‚\næ¯•ç«Ÿï¼Œè‡ªåŠ¨æ‰«æå†æ€ä¹ˆæ™ºèƒ½ï¼Œä¹Ÿä¸å¯èƒ½å®Œå…¨å¯é ï¼Œè¿™é‡Œåªæ˜¯ä¸ºäº†æé«˜ä¸€äº›ç§»æ¤æ•ˆç‡ï¼Œå¦‚æœç¼–è¯‘å‘ç”Ÿé”™è¯¯ï¼Œåªéœ€è¦åˆ†æä¸‹é”™è¯¯åŸå› ï¼Œå¯¹ xmake.lua é‡Œé¢çš„é…ç½®ç¨ä½œä¿®æ”¹å°±è¡Œäº†ã€‚\nçœ‹è¿™é‡Œçš„é”™è¯¯ï¼Œæ—¢ç„¶æ˜¯ jmemmac.c å¤±è´¥äº†ï¼Œçœ‹æ–‡ä»¶åï¼Œåº”è¯¥æ˜¯ mac å¹³å°ç›¸å…³çš„ï¼Œè€Œæˆ‘ä»¬ç°åœ¨æ˜¯åœ¨ Linux ä¸‹ï¼Œé‚£è¯´æ˜è¿™ä¸ªæºæ–‡ä»¶ä¸åº”è¯¥å‚ä¸ç¼–è¯‘ã€‚\nå› æ­¤ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨ xmake.lua ä¸­åˆ é™¤å¯¹è¿™ä¸ªæ–‡ä»¶çš„é…ç½®å°±è¡Œäº†ã€‚\nåˆ é™¤åï¼Œæˆ‘ä»¬ç»§ç»­æ‰§è¡Œ xmake ç¼–è¯‘ libjpeg é¡¹ç›®ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬åˆå‘ç°äº†å…¶å®ƒç±»ä¼¼çš„ç¼–è¯‘é”™è¯¯ï¼Œè¿™å›æ˜¯ jmemdos.c æ–‡ä»¶ï¼Œä¼¼ä¹ä¹Ÿæ˜¯è·Ÿ libjpeg çš„å†…å­˜åˆ†é…ç›¸å…³ä»£ç ã€‚\nè¿ç»­ç¢°åˆ° jmemmac.c å’Œ jmemdos.c çš„ç¼–è¯‘å¤±è´¥ï¼Œæˆ‘ä»¬å¤§ä½“èƒ½çŸ¥é“ libjpeg æä¾›äº†ä¸åŒå¹³å°å¯¹åº”çš„ jmemxxx.c å†…å­˜åˆ†é…å®ç°ã€‚æ—¢ç„¶å¦‚æ­¤ï¼Œæˆ‘ä»¬å†æ‰¾ä¸‹å…¶å®ƒè·Ÿå†…å­˜ç›¸å…³çš„å¹³å°ä»£ç æ–‡ä»¶ï¼Œå‘ç°è¿˜æœ‰ä¸€ä¸ª jmemdosa.asm ä¹Ÿæ˜¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ä¸€å¹¶æ³¨é‡Šæ‰è¿™ä¸¤ä¸ªæ–‡ä»¶ã€‚\næ³¨é‡Šæ‰è¿™ä¸‰ä¸ªä¸ç›¸å…³çš„æ–‡ä»¶åï¼Œç»§ç»­æ‰§è¡Œ xmake å‘½ä»¤å°±èƒ½é¡ºåˆ©é€šè¿‡ç¼–è¯‘äº†ï¼Œå¦‚ä¸‹å›¾ã€‚\næ‰‹åŠ¨é…ç½® xmake.lua ç§»æ¤ç¼–è¯‘ åˆšåˆšæˆ‘ä»¬é€šè¿‡è‡ªåŠ¨ç”Ÿæˆ xmake.lua æ–‡ä»¶çš„æ–¹å¼ï¼Œä¹Ÿå·²ç»å®Œæˆäº† libjpeg åº“çš„ç§»æ¤ç¼–è¯‘ï¼Œä½†æ˜¯ç”Ÿæˆçš„ xmake.lua æ–‡ä»¶å†…å®¹è¿˜æ¯”è¾ƒå†—ä½™å’Œç²—ç³™ï¼Œä¸å¤Ÿç²¾ç®€ã€‚\næ—¢ç„¶æˆ‘ä»¬ç°åœ¨å·²ç»å¤§æ¦‚äº†è§£ libjpeg åº“çš„æºç ç»“æ„ï¼Œå…¶ Linux ä¸‹å®é™…ä»…ä»…ä½¿ç”¨äº† jmemansi.c æ–‡ä»¶å‚ä¸ç¼–è¯‘ï¼Œå…¶å®ƒ jmem*.c ä»£ç æ–‡ä»¶æˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨é…ç½®å»æ’é™¤å®ƒã€‚\nå› æ­¤ä¿®æ”¹å¹¶ç²¾ç®€ xmake.lua é…ç½®å¦‚ä¸‹ã€‚\nadd_rules(\u0026quot;mode.debug\u0026quot;, \u0026quot;mode.release\u0026quot;)\rtarget(\u0026quot;jpeg\u0026quot;)\rset_kind(\u0026quot;static\u0026quot;)\radd_files(\u0026quot;*.c|jmem*|wrjpgcom.c|cjpeg.c|rdjpgcom.c|ckconfig.c|djpeg.c|jpegtran.c\u0026quot;)\radd_files(\u0026quot;jmemansi.c\u0026quot;, \u0026quot;jmemmgr.c\u0026quot;)\r é€šè¿‡ add_files(\u0026quot;*.c|jmem*\u0026quot;) çš„æ–¹å¼ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨æ·»åŠ åŒ¹é…å¤§éƒ¨åˆ†ä»£ç æ–‡ä»¶çš„åŒæ—¶ï¼Œå¿½ç•¥æ‰å…¶å®ƒå†…å­˜åˆ†é…ä»£ç æ–‡ä»¶çš„ç¼–è¯‘ã€‚å¦å¤–ï¼Œæˆ‘ä»¬ä¹ŸçŸ¥é“ wrjpgcom.cã€cjpeg.c å’Œ rdjpgcom.c è¿™äº›æ–‡ä»¶ï¼Œå…¶å®åªæ˜¯å¯æ‰§è¡Œç¨‹åºçš„ä¸»æ–‡ä»¶ï¼Œå¹¶ä¸æ˜¯ libjpeg åº“çš„å†…éƒ¨æ–‡ä»¶ï¼Œç¼–è¯‘é™æ€åº“ä¸éœ€è¦å‚ä¸è¿›æ¥ï¼Œé‚£ä¹ˆä¹Ÿå¯ä»¥ä¸€å¹¶æ’é™¤æ‰ï¼Œå°±å¦‚ä¸Šé¢çš„é…ç½®æ‰€ç¤ºã€‚\næ‰‹åŠ¨ç²¾ç®€åçš„é…ç½®ä»…ä»…åªæœ‰ç®€å•çš„å‡ è¡Œï¼Œå°±èƒ½åšåˆ°ç›¸åŒçš„ç¼–è¯‘æ•ˆæœï¼Œæˆ‘ä»¬é‡æ–°æ‰§è¡Œä¸‹ xmake -r å‘½ä»¤ï¼Œçœ‹çœ‹æ˜¯å¦èƒ½å¤Ÿæ­£å¸¸å®Œæˆæ•´ä¸ªåº“çš„ç¼–è¯‘ï¼Œå¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œå°±ä¼šå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚\nè¿œç¨‹åŒ…çš„ä¾èµ–é›†æˆ é€šè¿‡æ‰‹åŠ¨ç§»æ¤çš„æ–¹å¼ï¼Œæˆ‘ä»¬è™½ç„¶èƒ½å¤Ÿå¾ˆå¥½çš„å®Œæˆç¬¬ä¸‰æ–¹åº“çš„ç¼–è¯‘ï¼Œä½†æ˜¯é›†æˆèµ·æ¥è¿˜æ˜¯æ¯”è¾ƒç¹ççš„ï¼Œå¦‚æœæŠŠ libjpeg åº“ä»£ç å†…ç½®åˆ°é¡¹ç›®ä¸­å»ï¼Œå°±ä¼šéå¸¸çš„è‡ƒè‚¿ã€‚è€Œå¦‚æœä»…ä»…æä¾›ç¼–è¯‘åçš„åº“ç»™å…¶å®ƒé¡¹ç›®é“¾æ¥ä½¿ç”¨ï¼Œç¼–è¯‘å’Œç‰ˆæœ¬ç»´æŠ¤åˆéå¸¸çš„éº»çƒ¦ã€‚\nç„¶åæˆ‘ä»¬å·²ç»å®Œæˆäº†ç¼–è¯‘ï¼Œå°±å¯ä»¥æŠŠæ•´ä¸ªç¼–è¯‘ç§»æ¤è¿‡ç¨‹è®°å½•ä¸‹æ¥ï¼Œé€šè¿‡ package(\u0026quot;libjpeg\u0026quot;) æ–¹å¼å®šä¹‰ä¸€ä¸ªç¬¬ä¸‰æ–¹åŒ…ï¼Œå†…éƒ¨æè¿°æ•´ä¸ªåº“çš„ç¼–è¯‘è¿‡ç¨‹ã€‚\nè€Œå¤§å®¶åªéœ€è¦åœ¨è‡ªå·±çš„é¡¹ç›®ä¸­é€šè¿‡ add_requires(\u0026quot;libjpeg\u0026quot;) å¼•ç”¨è¿›æ¥ï¼Œå°±å¯ä»¥å®ç°è¿œç¨‹åº“çš„è‡ªåŠ¨ä¸‹è½½ã€è‡ªåŠ¨ç¼–è¯‘ä»¥åŠæ— ç¼é›†æˆã€‚\nä¸‹é¢ï¼Œæˆ‘ä»¬å…ˆæ¥åˆ›å»ºä¸€ä¸ªæ–°çš„ç©ºå·¥ç¨‹ï¼Œç”¨äºæµ‹è¯• jpeg åº“çš„è‡ªåŠ¨ç§»æ¤å’Œé›†æˆã€‚\ncd ~/Code\rxmake create jpegtest\r åˆ›å»ºå®Œæˆåè¿›å…¥ jpegtest ç›®å½•ï¼Œæˆ‘ä»¬å…ˆæ¥ä¿®æ”¹ src/main.cpp åŠ ä¸Šå¯¹ jpeglib.h åº“å¤´æ–‡ä»¶çš„å¼•ç”¨ï¼Œä»¥åŠå¯¹åº” c æ¥å£çš„è°ƒç”¨ã€‚\n#include \u0026quot;stdio.h\u0026quot;\r#include \u0026quot;jpeglib.h\u0026quot;\rint main(int argc, char** argv)\r{\rjpeg_create_compress(0);\rreturn 0;\r}\r ç„¶åå¼€å§‹ç¼–è¾‘ xmake.lua æ–‡ä»¶ï¼Œåœ¨é‡Œé¢å®šä¹‰ä¸€ä¸ª package(\u0026quot;myjpeg\u0026quot;) çš„ç¬¬ä¸‰æ–¹åŒ…ï¼Œå†…éƒ¨ä½¿ç”¨ autotools æ„å»ºç³»ç»Ÿå»æ„å»ºå®‰è£… jpeg åº“ï¼Œç„¶åé€šè¿‡ add_requires(\u0026quot;myjpeg\u0026quot;) å¼•å…¥åˆ°å·¥ç¨‹ä¸­æ¥ï¼Œå¹¶ä¸”é€šè¿‡ add_packages(\u0026quot;myjpeg\u0026quot;) çš„æ–¹å¼æ·»åŠ åˆ°å¯¹åº”çš„ jpegtest ç›®æ ‡ç¨‹åºä¸­å»è¿›è¡Œé›†æˆå’Œä½¿ç”¨ã€‚\nç›¸å…³é…ç½®å†…å®¹å¦‚ä¸‹ã€‚\nadd_rules(\u0026quot;mode.debug\u0026quot;, \u0026quot;mode.release\u0026quot;)\rpackage(\u0026quot;myjpeg\u0026quot;)\rset_urls(\u0026quot;http://www.ijg.org/files/jpegsrc.$(version).tar.gz\u0026quot;)\radd_versions(\u0026quot;v9d\u0026quot;, \u0026quot;99cb50e48a4556bc571dadd27931955ff458aae32f68c4d9c39d624693f69c32\u0026quot;)\ron_install(function (package)\rimport(\u0026quot;package.tools.autoconf\u0026quot;).install(package)\rend)\rpackage_end()\radd_requires(\u0026quot;myjpeg\u0026quot;)\rtarget(\u0026quot;jpegtest\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\radd_packages(\u0026quot;myjpeg\u0026quot;)\r æ•´ä¸ªé…ç½®éå¸¸çš„ç®€å•ï¼Œæˆ‘ä»¬é€šè¿‡ add_versions å°† jpeg v9d ç‰ˆæœ¬çš„å¯¹åº”æºç åŒ…çš„ sha256 å“ˆå¸Œå€¼é…ç½®ä¸Šï¼Œä¸ºäº†ç¡®ä¿ä¸‹è½½æ–‡ä»¶çš„å®Œæ•´æ€§ã€‚\nåªéœ€ sha256 çš„è®¡ç®—å’Œè·å–ï¼Œå¯ä»¥é€šè¿‡ xmake æä¾›çš„ xmake l hash.sha256 jpegsrc.v9d.tar.gz å‘½ä»¤æ¥è·å–ã€‚\næ³¨ï¼šè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ add_requires(\u0026quot;myjpeg\u0026quot;) è€Œä¸æ˜¯ libjpeg æˆ–è€… jpegï¼Œæ˜¯ä¸ºäº†ç¡®ä¿ xmake èƒ½å¤Ÿä½¿ç”¨æˆ‘ä»¬å®šä¹‰çš„ package(\u0026quot;myjpeg\u0026quot;) åŒ…ï¼Œå› ä¸º libjpeg åŒ…å·²ç»è¢«æ”¶å½•åˆ° xmake çš„å®˜æ–¹ä»“åº“ ä¸­ï¼Œè¿™ä¼šå¯¼è‡´å‘½åå†²çªã€‚\nè€Œä¸ç”¨ jpeg è¿™ä¸ªåç§°ï¼Œæ˜¯å› ä¸ºç³»ç»Ÿçš„ pkg-config é»˜è®¤ä¼šæ£€æµ‹åˆ° jpeg åº“ï¼Œæ‰€ä»¥ add_requires(\u0026quot;jpeg\u0026quot;) ä¼šä¼˜å…ˆä½¿ç”¨ç³»ç»Ÿå®‰è£…çš„ jpeg åº“ã€‚\næœ€åï¼Œæ‰§è¡Œ xmake çš„ç¼–è¯‘æ•ˆæœå¦‚ä¸‹å›¾ï¼Œæˆ‘ä»¬å®Œå…¨å¤ç”¨äº†æ•´ä¸ª jpeg åº“çš„ç§»æ¤è¿‡ç¨‹ï¼Œä¸ç”¨æ¯æ¬¡éƒ½å»æ‰‹åŠ¨ç§»æ¤ä¸€éï¼Œä¹Ÿå¯ä»¥å¿«é€Ÿé›†æˆã€‚\nå¦å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥æ”¹è¿›ä¸‹ package(\u0026quot;mytest\u0026quot;) åŒ…å®šä¹‰ï¼Œå†…éƒ¨ä¸ä½¿ç”¨ autotools è€Œæ˜¯ç›´æ¥ä½¿ç”¨åˆšåˆšæˆ‘ä»¬ç§»æ¤çš„ xmake.lua æ¥æ„å»ºå®ƒï¼Œè¿™æ ·å°±èƒ½åœ¨ä¸åŒå¹³å°ä¸‹é›†æˆ jpeg åº“äº†ï¼Œä¿®æ”¹ xmake.lua å¦‚ä¸‹ã€‚\nadd_rules(\u0026quot;mode.debug\u0026quot;, \u0026quot;mode.release\u0026quot;)\rpackage(\u0026quot;myjpeg\u0026quot;)\rset_urls(\u0026quot;http://www.ijg.org/files/jpegsrc.$(version).tar.gz\u0026quot;)\radd_versions(\u0026quot;v9d\u0026quot;, \u0026quot;99cb50e48a4556bc571dadd27931955ff458aae32f68c4d9c39d624693f69c32\u0026quot;)\ron_install(function (package)\rio.writefile(\u0026quot;xmake.lua\u0026quot;, [[\radd_rules(\u0026quot;mode.debug\u0026quot;, \u0026quot;mode.release\u0026quot;)\rtarget(\u0026quot;jpeg\u0026quot;)\rset_kind(\u0026quot;static\u0026quot;)\rset_kind(\u0026quot;static\u0026quot;)\radd_files(\u0026quot;*.c|jmem*|wrjpgcom.c|cjpeg.c|rdjpgcom.c|ckconfig.c|djpeg.c|jpegtran.c\u0026quot;)\radd_files(\u0026quot;jmemansi.c\u0026quot;, \u0026quot;jmemmgr.c\u0026quot;)\radd_configfiles(\u0026quot;jconfig.txt\u0026quot;, {filename = \u0026quot;jconfig.h\u0026quot;})\radd_headerfiles(\u0026quot;jerror.h\u0026quot;, \u0026quot;jmorecfg.h\u0026quot;, \u0026quot;jpeglib.h\u0026quot;, \u0026quot;$(buildir)/jconfig.h\u0026quot;)\r]])\rimport(\u0026quot;package.tools.xmake\u0026quot;).install(package)\rend)\ron_test(function (package)\rassert(package:has_cfuncs(\u0026quot;jpeg_create_compress(0)\u0026quot;, {includes = {\u0026quot;stdio.h\u0026quot;, \u0026quot;jpeglib.h\u0026quot;}}))\rend)\rpackage_end()\radd_requires(\u0026quot;myjpeg\u0026quot;)\rtarget(\u0026quot;jpegtest\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\radd_packages(\u0026quot;myjpeg\u0026quot;)\r è¿™æ¬¡æˆ‘ä»¬åœ¨ package(\u0026quot;myjpeg\u0026quot;) çš„ on_install é‡Œé¢ï¼Œå†™å…¥ç§»æ¤åçš„ xmake.lua æ–‡ä»¶ï¼Œç„¶åé€šè¿‡ xmake æ¥ç¼–è¯‘å®ƒã€‚\nåœ¨é‡æ–°æ‰§è¡Œ xmake ç¼–è¯‘å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œç§»é™¤ä¹‹å‰å·²ç»å®‰è£…çš„ myjpeg åŒ…ï¼Œè¿™æ ·æ‰èƒ½é‡æ–°å‘å‡º myjpeg åº“çš„ç¼–è¯‘å®‰è£…é€»è¾‘ã€‚\nxmake require --uninstall myjpeg\r ç§»é™¤æ‰ä¹‹å‰å®‰è£…çš„ myjpeg åŒ…åï¼Œæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤é‡æ–°è§¦å‘ myjpeg åŒ…çš„å®‰è£…å’Œç¼–è¯‘é›†æˆã€‚\nxmake f -c\rxmake -r\r æ•´ä¸ªæ‰§è¡Œè¿‡ç¨‹å¦‚ä¸‹å›¾ï¼Œå¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œåˆ™ä¼šå®Œæˆæ•´ä¸ªå·¥ç¨‹çš„ç¼–è¯‘ã€‚\né…ç½®æ–‡ä»¶çš„è‡ªåŠ¨ç”Ÿæˆ åœ¨ä¸Šé¢çš„ package(\u0026quot;myjpeg\u0026quot;) åŒ…ç§»æ¤ä¸­ï¼Œæˆ‘ä»¬è¿˜é¢å¤–åŠ å…¥äº†ä¸€è¡Œé…ç½®ã€‚\nadd_configfiles(\u0026quot;jconfig.txt\u0026quot;, {filename = \u0026quot;jconfig.h\u0026quot;})\r è¿™æ˜¯ç”±äº jpeg åº“å¯¹å¤–æä¾›çš„å¤´æ–‡ä»¶ï¼Œéœ€è¦æœ‰ä¸€ä¸ª jconfig.h çš„é…ç½®å¤´æ–‡ä»¶ï¼Œä½†æ˜¯å…¶æºç ä¸­é»˜è®¤æ˜¯æ²¡æœ‰çš„ï¼Œåªæœ‰ä¸€ä¸ª jconfig.vc çš„æ¨¡æ¿é…ç½®æ–‡ä»¶ï¼Œåœ¨ä½¿ç”¨ autotools ç¼–è¯‘æ—¶å€™ï¼Œå®ƒä¼šè‡ªåŠ¨é€šè¿‡è¿™ä¸ªæ–‡ä»¶ç”Ÿæˆå¯¹åº”çš„ jconfig.hï¼Œè€Œåœ¨æˆ‘ä»¬ç§»æ¤åçš„ xmake.lua ä¸­ä¹Ÿéœ€è¦è‡ªåŠ¨å»ç”Ÿæˆå®ƒã€‚\nè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ add_configfiles æ¥å£ï¼Œé…ç½®ä¸Šå®ƒå°±å¯ä»¥å°†å…¶è‡ªåŠ¨ç”Ÿæˆåˆ° build/jconfig.hã€‚\nç„¶åï¼Œæˆ‘ä»¬åˆé€šè¿‡ä¸‹é¢çš„é…ç½®ï¼Œå°†è‡ªåŠ¨ç”Ÿæˆçš„ jconfig.h ä»¥åŠå…¶å®ƒå¤´æ–‡ä»¶ä¸€èµ·ä½œä¸ºå®‰è£…æ–‡ä»¶ï¼Œåœ¨å®‰è£…é›†æˆçš„æ—¶å€™å¯¼å‡ºåˆ°äº† include å®‰è£…ç›®å½•ä¸‹ã€‚\nadd_headerfiles(\u0026quot;jerror.h\u0026quot;, \u0026quot;jmorecfg.h\u0026quot;, \u0026quot;jpeglib.h\u0026quot;, \u0026quot;$(buildir)/jconfig.h\u0026quot;)\r è¿™æ ·ï¼Œæˆ‘ä»¬åœ¨è‡ªå·±çš„å·¥ç¨‹é‡Œé¢å°±å¯ä»¥æ­£å¸¸é€šè¿‡ #include \u0026quot;jpeglib.h\u0026quot; ä½¿ç”¨ libjpeg çš„å¤´æ–‡ä»¶äº†ã€‚\nç›´æ¥é›†æˆä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ é€šè¿‡è¿œç¨‹ä¾èµ–é›†æˆçš„å¥½å¤„æ˜¯ç¬¬ä¸‰æ–¹åº“çš„æºç ä¸éœ€è¦å†…ç½®åˆ°é¡¹ç›®ä¸­å»ï¼Œå½“ç„¶å¦‚æœåƒ libjpeg è¿™ç§å°åº“ï¼Œä»£ç é‡ä¸å¤§ï¼Œé‚£ä¹ˆç›´æ¥é›†æˆè¿›å»ä½¿ç”¨ï¼Œä¹Ÿè®¸ä¼šæ›´åŠ æ–¹ä¾¿ã€‚\nè¦ç›´æ¥è¿›è¡Œä»£ç å†…ç½®é›†æˆï¼Œæˆ‘ä»¬éœ€è¦å…ˆå°†åˆšåˆšçš„ jpeg-9d æºç ç›®å½•æ”¾ç½®è¿›æ¥ã€‚\ncd jpegtest\rmv ../jpeg-9d .\r ç„¶åä¿®æ”¹ xmake.lua æ–‡ä»¶ï¼Œé€šè¿‡ includes çš„æ–¹å¼å¼•å…¥åˆšåˆšåœ¨ jpeg-9d ä¸‹ç§»æ¤å®Œæˆçš„ xmake.luaï¼Œä¾‹å¦‚ã€‚\nadd_rules(\u0026quot;mode.debug\u0026quot;, \u0026quot;mode.release\u0026quot;)\rtarget(\u0026quot;jpegtest\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\radd_deps(\u0026quot;jpeg\u0026quot;)\rincludes(\u0026quot;jpeg-9d\u0026quot;)\r åœ¨ä¸Šé¢çš„é…ç½®ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°åªéœ€è¦é€šè¿‡ includes(\u0026quot;jpeg-9d\u0026quot;) å¼•å…¥åˆšåˆšç§»æ¤å¥½çš„ jpeg-9d/xmake.lua åï¼Œå°†å…¶ä½œä¸ºå­å·¥ç¨‹ï¼Œç„¶åé€šè¿‡ add_deps(\u0026quot;jpeg\u0026quot;) å°† jpeg åº“å…³è”åˆ°æŒ‡å®šç›®æ ‡ç¨‹åºå³å¯ã€‚\næ‰§è¡Œ xmake -r è¿›è¡Œç¼–è¯‘ï¼Œå¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œé‚£ä¹ˆæ•´ä¸ªé¡¹ç›®éƒ½ä¼šå®Œæˆç¼–è¯‘ï¼Œç»“æœå¦‚ä¸‹å›¾ã€‚\nå®éªŒæ€»ç»“ åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå®Œæ•´çš„ä¾‹å­å­¦ä¹ äº†å¦‚ä½•ä½¿ç”¨ xmake æ¥ç§»æ¤ç¼–è¯‘ libjpegï¼Œå¹¶ä¸”ä¹Ÿå­¦ä¹ äº†å¦‚ä½•å°†ç§»æ¤åçš„ libjpeg é›†æˆåˆ°é¡¹ç›®å·¥ç¨‹ä¸­å»ã€‚æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬è¿˜å­¦ä¹ åˆ°äº† xmake çš„è‡ªåŠ¨æ‰«æå’Œç”Ÿæˆæ¨¡å¼ä»¥åŠ autotools çš„åŸºæœ¬æ¦‚å¿µå’Œä½¿ç”¨ã€‚\næœ¬å®éªŒçš„å‚è€ƒä»£ç å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ä¸‹è½½ï¼š\nwget https://labfile.oss.aliyuncs.com/courses/2764/code19.zip\r ","id":48,"section":"categories","summary":"libjpeg å¼€æºåº“ç§»æ¤ åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬ä¼šå­¦ä¹ åˆ°å¦‚ä½•ä½¿ç”¨ xmake å»ç§»æ¤ç¼–è¯‘ç¬¬ä¸‰æ–¹åº“ libjpeg æºç ï¼Œä»¥åŠå¦‚ä½•å°†ç§»æ¤å¥½çš„åº“å¿«é€Ÿé›†æˆè¿›è‡ªå·±çš„ C/C++ å·¥ç¨‹ä¸­å»ä½¿ç”¨ã€‚ çŸ¥è¯†ç‚¹ autotools ä»‹ç»å’Œ","tags":["xmake"],"title":"å®éªŒ19libjpeg å¼€æºåº“ç§»æ¤","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/app/xmake/%E8%93%9D%E6%A1%A5%E7%BD%91%E8%AF%BE/4xmake%E5%AE%9E%E6%88%98/%E5%AE%9E%E9%AA%8C19libjpeg%E5%BC%80%E6%BA%90%E5%BA%93%E7%A7%BB%E6%A4%8D/","year":"2021"},{"content":"æ’ä»¶å¼€å‘è¯¦è§£ åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬ä¼šå­¦ä¹ åˆ°å¦‚ä½•å»ç¼–å†™å’Œè¿è¡Œä¸€ä¸ªåŸºäº xmake çš„æ‰©å±•æ’ä»¶ï¼Œå¦å¤–æˆ‘ä»¬è¿˜ä¼šå­¦ä¹ åˆ°å¦‚ä½•åœ¨ xmake.lua ä¸­å»é…ç½®å®šä¹‰å†…éƒ¨ä»»åŠ¡ï¼Œä»¥åŠå¦‚ä½•å»ç›´æ¥è°ƒç”¨è¿è¡Œå®ƒã€‚\nçŸ¥è¯†ç‚¹  xmake æ’ä»¶å’Œä»»åŠ¡çš„åŸºæœ¬æ¦‚å¿µ å¦‚ä½•ç¼–å†™å’Œè¿è¡Œ xmake æ‰©å±•æ’ä»¶ å†…éƒ¨ task ä»»åŠ¡çš„å®šä¹‰å’Œè¿è¡Œ  xmake æ’ä»¶ä»»åŠ¡ä»‹ç» é™¤äº† option() å’Œ target() ä¸¤ä¸ªå¯¹è±¡é…ç½®åŸŸï¼Œxmake è¿˜æä¾›äº†å¦å¤–ä¸€ç§é…ç½®åŸŸ task()ï¼Œé€šè¿‡å®ƒæˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰ä¸€äº›æ‰©å±•çš„è¿è¡Œä»»åŠ¡ï¼Œç”šè‡³å¯ä»¥ç”¨æ¥å®ç°ä¸€äº›æ‰©å±•æ’ä»¶ã€‚\nè€Œåœ¨ä¸ŠèŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ xmake å†…ç½®çš„å·¥ç¨‹ç”Ÿæˆæ’ä»¶ï¼Œå…¶å®ä¹Ÿå·²ç»å¤§æ¦‚äº†è§£äº† xmake æ’ä»¶æ˜¯ä»€ä¹ˆä»¥åŠå¦‚ä½•ä½¿ç”¨äº†ã€‚\næ‰€è°“çš„æ’ä»¶ï¼Œå°±æ˜¯é™¤äº† xmake æä¾›çš„ä¸€äº›å†…ç½®åŸºæœ¬å­å‘½ä»¤ï¼Œä¾‹å¦‚ xmake buildã€xmake install ä¹‹å¤–çš„å…¶å®ƒå­å‘½ä»¤ï¼Œå¤§å®¶å¯ä»¥åœ¨ xmake.lua ä¸­é€šè¿‡ task(\u0026quot;myplugin\u0026quot;) è‡ªå®šä¹‰ä¸€ä¸ªæ’ä»¶å‘½ä»¤ï¼Œç„¶åé€šè¿‡ xmake myplugin çš„æ–¹å¼è¿è¡Œæˆ‘ä»¬å®šä¹‰çš„æ’ä»¶å­å‘½ä»¤ã€‚\nç¼–å†™ä¸€ä¸ªç®€å•çš„æ’ä»¶ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬é€šè¿‡å®ç°ä¸€ä¸ªç®€å•çš„ echo æ’ä»¶ï¼Œæ¥äº†è§£ä¸‹æ•´ä¸ªæ’ä»¶ç¼–å†™è¿‡ç¨‹ã€‚ç”±äºæˆ‘ä»¬æ˜¯åœ¨è‡ªå·±é¡¹ç›®å·¥ç¨‹çš„ xmake.lua é‡Œé¢å»ç¼–å†™æ’ä»¶ä»»åŠ¡ï¼Œå› æ­¤å…ˆæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œåˆ›å»ºä¸€ä¸ªç©ºå·¥ç¨‹ã€‚\ncd ~/Code\rxmake create plugin_test\r åˆ›å»ºå®Œæˆåï¼Œè¿›å…¥ plugin_test ç›®å½•ï¼Œç¼–è¾‘é‡Œé¢çš„ xmake.lua æ–‡ä»¶ï¼Œä¿®æ”¹æˆå¦‚ä¸‹é…ç½®ï¼Œåœ¨é‡Œé¢å®šä¹‰ä¸€ä¸ª task(\u0026quot;echo\u0026quot;) æ’ä»¶ä»»åŠ¡é…ç½®åŸŸç”¨æ¥æè¿° echo æ’ä»¶ã€‚\ntask(\u0026quot;echo\u0026quot;)\rset_menu {usage = \u0026quot;xmake echo [options]\u0026quot;, description = \u0026quot;Echo the given info!\u0026quot;, options = {}}\ron_run(function ()\rprint(\u0026quot;hello xmake!\u0026quot;)\rend)\rtarget(\u0026quot;test\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\r é€šè¿‡ä¸Šé¢çš„é…ç½®å¯ä»¥çœ‹åˆ°ï¼Œæ•´ä¸ªæ’ä»¶çš„å®šä¹‰å¾ˆç®€å•ï¼Œä¸»è¦ç”±ä»¥ä¸‹ä¸‰éƒ¨åˆ†ç»„æˆã€‚\n task()ï¼šå®šä¹‰æ•´ä¸ªæ’ä»¶ä»»åŠ¡é…ç½®åŸŸã€‚ set_menu()ï¼šç”¨äºé…ç½®æ’ä»¶åœ¨ help å‘½ä»¤èœå•ä¸­çš„æ˜¾ç¤ºå’Œå‚æ•°æè¿°ã€‚ on_run()ï¼šå®šä¹‰æ•´ä¸ªæ’ä»¶çš„è„šæœ¬è¿è¡Œå…¥å£ã€‚  é…ç½®å®Œæˆåé€šè¿‡è¿è¡Œ xmake --help å‘½ä»¤ï¼ŒæŸ¥çœ‹ xmake å¸®åŠ©èœå•ï¼Œæ‰¾å¯»æˆ‘ä»¬å®šä¹‰çš„ echo æ’ä»¶ï¼Œçœ‹çœ‹æ˜¯å¦å‡ºç°åœ¨å¸®åŠ©åˆ—è¡¨é‡Œé¢ã€‚\nåœ¨ä¸Šå›¾çš„çº¢æ¡†ä½ç½®ï¼Œå°±æ˜¯æˆ‘ä»¬æ–°å®šä¹‰çš„æ’ä»¶ï¼Œä¸è¿‡å½“å‰æ²¡æœ‰è¢«åˆ’åˆ†åˆ° Plugins é‡Œé¢ï¼Œè€Œæ˜¯åœ¨ Tasks ä¸‹é¢ï¼Œè¿™ä¸ªåªæ˜¯ task() çš„åˆ†ç±»é—®é¢˜ï¼Œé»˜è®¤å®šä¹‰çš„ task() æ—¢ä¸å±äº Actions ä¹Ÿä¸å±äº Plugins åˆ†ç±»ï¼Œè€Œæ˜¯ä½œä¸ºé€šç”¨çš„ Tasks åˆ†ç±»ã€‚\nå½“ç„¶ï¼Œè¿™ä»…ä»…åªæ˜¯ help èœå•æ˜¾ç¤ºåˆ†ç±»çš„å·®å¼‚ï¼Œå¹¶ä¸å½±å“æˆ‘ä»¬æŠŠå®ƒä½œä¸ºæ’ä»¶æ¥ä½¿ç”¨ï¼Œä¸è¿‡æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ set_category(\u0026quot;plugin\u0026quot;) å°†å…¶æ ‡è®°ä¸º Plugins åˆ†ç±»ã€‚\nç»§ç»­ç¼–è¾‘ xmake.lua æ–‡ä»¶ã€‚\ntask(\u0026quot;echo\u0026quot;)\rset_menu {usage = \u0026quot;xmake echo [options]\u0026quot;, description = \u0026quot;Echo the given info!\u0026quot;, options = {}}\rset_category(\u0026quot;plugin\u0026quot;)\ron_run(function ()\rprint(\u0026quot;hello xmake!\u0026quot;)\rend)\r æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°è¯•è¿è¡Œæ’ä»¶äº†ï¼Œåªéœ€è¦æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ã€‚\nxmake echo\r å¦‚æœè¿è¡Œæ­£å¸¸ï¼Œå°±èƒ½æ‰§è¡Œåˆ°æˆ‘ä»¬å®šä¹‰åœ¨ on_run() ä¸­çš„è„šæœ¬ï¼Œç„¶åå›æ˜¾ hello xmake! å­—ç¬¦ä¸²ä¿¡æ¯ï¼Œå¦‚ä¸‹å›¾ã€‚\nä¼ é€’å¤–éƒ¨å‚æ•°ç»™æ’ä»¶ åˆšåˆšçš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åœ¨æ’ä»¶é‡Œé¢ç¡¬ç¼–ç å­—ç¬¦ä¸²æ¥æ˜¾ç¤ºï¼Œè€Œåœ¨å®é™…çš„æ’ä»¶ä¸­ï¼Œé€šå¸¸æˆ‘ä»¬éœ€è¦èƒ½å¤Ÿé€šè¿‡ä¼ é€’å‚æ•°çš„å½¢å¼ï¼Œæ¥åŠ¨æ€åœ°å°†ä¸€äº›ä¿¡æ¯ä¼ å…¥æ’ä»¶ä¸­å»ã€‚\næ¯”å¦‚ï¼Œæ”¹é€ ä¸‹åˆšåˆšçš„ echo æ’ä»¶ï¼Œå°†æ˜¾ç¤ºçš„å­—ç¬¦ä¸²å†…å®¹ï¼Œé€šè¿‡ xmake echo \u0026quot;hello xmake!\u0026quot; çš„å‚æ•°ä¼ é€’æ–¹å¼ï¼ŒåŠ¨æ€åœ°æ˜¾ç¤ºå‡ºæ¥ã€‚\nä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹ä¹‹å‰çš„ xmake.lua é…ç½®ï¼Œæ”¹æˆå¦‚ä¸‹å†…å®¹ã€‚\ntask(\u0026quot;echo\u0026quot;)\rset_menu {usage = \u0026quot;xmake echo [options]\u0026quot;, description = \u0026quot;Echo the given info!\u0026quot;, options = {\r-- å®šä¹‰å‚æ•°åˆ—è¡¨\r{nil, \u0026quot;contents\u0026quot;, \u0026quot;vs\u0026quot;, nil, \u0026quot;The info contents.\u0026quot; }\r}}\ron_run(function ()\rimport(\u0026quot;core.base.option\u0026quot;)\rprint(\u0026quot;%s\u0026quot;, table.concat(option.get(\u0026quot;contents\u0026quot;) or {}, \u0026quot; \u0026quot;))\rend)\rtarget(\u0026quot;test\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\r è¿™å›ï¼Œæˆ‘ä»¬åœ¨ task(\u0026quot;echo\u0026quot;) æ’ä»¶ä»»åŠ¡çš„ options å‚æ•°é€‰é¡¹åˆ—è¡¨é…ç½®ä¸­ï¼ŒåŠ å…¥äº†ä¸€é¡¹å‚æ•°å®šä¹‰é…ç½®ï¼Œç”¨äºè·å– xmake echo å‘½ä»¤ä¹‹åçš„æ‰€æœ‰å‚æ•°å€¼ã€‚\nè€Œåœ¨ on_run é‡Œé¢ï¼Œé€šè¿‡ import å¯¼å…¥äº† xmake æä¾›çš„å†…ç½®æ‰©å±•æ¨¡å— core.base.option æ¥è·å–ç”¨æˆ·è¾“å…¥çš„å‚æ•°é€‰é¡¹ï¼Œä¹Ÿå°±æ˜¯ option.get(\u0026quot;contents\u0026quot;)ã€‚\nç”±äºæˆ‘ä»¬å®šä¹‰çš„ contents å‚æ•°å±äº vs ç±»å‹å‚æ•°ï¼Œä¹Ÿå°±æ˜¯å€¼åˆ—è¡¨å‚æ•°ï¼Œå› æ­¤ä¼šè·å–åˆ° xmake echo arg1 arg2 ... åé¢çš„æ‰€æœ‰å‚æ•°åˆ—è¡¨ã€‚ç„¶åé€šè¿‡ table.concat æ¥å£ï¼Œå°†å…¶æ‹¼æ¥æˆå­—ç¬¦ä¸²åæ˜¾ç¤ºå‡ºæ¥ã€‚\né…ç½®ä¿®æ”¹å®Œæˆåï¼Œé€šè¿‡ xmake echo --help æŸ¥çœ‹ä¸‹ echo æ’ä»¶çš„å¸®åŠ©èœå•ï¼Œçœ‹ä¸‹èƒ½å¦çœ‹åˆ°æ–°å¢çš„å‚æ•°é€‰é¡¹ï¼Œå¦‚ä¸‹å›¾ã€‚\nåœ¨å›¾ä¸­æœ€ä¸‹é¢ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†æ–°å¢çš„ contents å‚æ•°é€‰é¡¹ï¼Œåé¢æ˜¾ç¤ºçš„ ... è¯´æ˜æ­¤é€‰é¡¹æ˜¯ vs å¤šå€¼åˆ—è¡¨ç±»å‹ã€‚\nç„¶åï¼Œæˆ‘ä»¬é‡æ–°æ‰§è¡Œä¸‹è¿™ä¸ªæ’ä»¶ï¼Œä¼ é€’å‚æ•°è¿›å»çœ‹ä¸‹æ•ˆæœã€‚\nxmake echo 'hello xmake!' # æ³¨ï¼šæ­¤å¤„å•å¼•å·\rxmake echo hello xmake!\r æ‰§è¡Œä¸Šé¢ä¸¤ä¸ªå‘½ä»¤åï¼Œéƒ½èƒ½æ­£å¸¸è¾“å‡º hello xmake! å­—ç¬¦ä¸²ä¿¡æ¯ï¼Œç¬¬ä¸€ä¸ªå‘½ä»¤ä»…ä»…åªä¼ é€’ä¸€ä¸ªå­—ç¬¦ä¸²å‚æ•°ï¼Œè€Œç¬¬äºŒä¸ªå‘½ä»¤æ˜¯ä¼ é€’äº†ä¸€ä¸ªå­—ç¬¦ä¸²å‚æ•°åˆ—è¡¨ï¼Œä¹Ÿå°±æ˜¯ {\u0026quot;hello\u0026quot;, \u0026quot;xmake!\u0026quot;}ï¼Œç„¶ååœ¨ on_run é‡Œé¢é€šè¿‡ table.concat æ‹¼æ¥æˆäº†æœ€ç»ˆçš„å­—ç¬¦ä¸²ï¼šhello xmake!ã€‚\nä½†ä¸ç®¡å“ªç§å‚æ•°ä¼ é€’ï¼Œå…¶æœ€ç»ˆçš„è¾“å‡ºç»“æœéƒ½æ˜¯ç›¸åŒçš„ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚\næ’ä»¶å‚æ•°é€‰é¡¹è¯¦è§£ åˆšåˆšæˆ‘ä»¬é€šè¿‡æ·»åŠ ä¸‹é¢çš„é…ç½®è¡Œç»™ options = {} æ¥æ–°å¢äº†ä¸€ä¸ªæ’ä»¶å‚æ•°é€‰é¡¹ï¼Œæ¥ä¸‹æ¥å°†è¯¦ç»†è®²è§£è¿™ä¸ªå‚æ•°å®šä¹‰åˆ—è¡¨çš„æ¯ä¸ªé…ç½®å€¼çš„å«ä¹‰ã€‚\n{nil, \u0026quot;contents\u0026quot;, \u0026quot;vs\u0026quot;, nil, \u0026quot;The info contents.\u0026quot; }\r åœ¨ä»‹ç»ä¹‹å‰ï¼Œå…ˆå¯¹å‚æ•°ç±»å‹åšä¸€ä¸‹åˆ†ç±»ï¼Œä¹Ÿå°±æ˜¯ä¸Šè¿°é…ç½®ä¸­ç¬¬ä¸‰ä¸ªå€¼ vs æ‰€å®šä¹‰çš„ç±»å‹ï¼Œä¸»è¦æœ‰ä»¥ä¸‹å‡ ç±»ã€‚\n kï¼šå•çº¯çš„ key ç±»å‹å‚æ•°ï¼Œä¾‹å¦‚ï¼š-k/--key è¿™ç§ä¼ å‚æ–¹å¼ï¼Œé€šå¸¸ç”¨äºè¡¨ç¤º bool å€¼çŠ¶æ€ã€‚ kvï¼šé”®å€¼ç±»å‹ä¼ å‚ï¼Œä¾‹å¦‚ï¼š-k value æˆ–è€… --key=value çš„ä¼ å‚æ–¹å¼ï¼Œé€šå¸¸ç”¨äºè·å–æŒ‡å®šå‚æ•°å€¼ã€‚ vï¼šå•ä¸ªå€¼ä¼ å‚ï¼Œä¾‹å¦‚ï¼švalueï¼Œé€šå¸¸å®šä¹‰åœ¨æ‰€æœ‰å‚æ•°çš„æœ€å°¾éƒ¨ã€‚ vsï¼šå¤šå€¼åˆ—è¡¨ä¼ å‚ï¼Œä¹Ÿå°±æ˜¯åˆšåˆšæˆ‘ä»¬é…ç½®çš„å‚æ•°ç±»å‹ï¼Œä¾‹å¦‚ï¼švalue1 value2 ... çš„ä¼ å‚æ–¹å¼ï¼Œå¯ä»¥è·å–å¤šä¸ªå‚æ•°å€¼ä½œä¸ºåˆ—è¡¨è¾“å…¥ã€‚  è€Œç¬¬ä¸€ä¸ªå‚æ•°å€¼ï¼Œä¸»è¦ç”¨äºè®¾ç½®å‚æ•°åçš„ç®€å†™å½¢å¼ï¼Œä¾‹å¦‚ï¼š--key å¯¹åº”çš„ -k ç®€å†™ï¼Œè¿™é‡Œæ²¡æœ‰ç”¨åˆ°ï¼Œæ‰€ä»¥è®¾ç½®äº† nilï¼Œç¬¬äºŒä¸ª contents å°±æ˜¯å‚æ•°å…¨åï¼Œç¬¬å››ä¸ªé…ç½®å€¼æ˜¯å‚æ•°çš„é»˜è®¤å€¼ï¼Œæœ€åä¸€ä¸ªå€¼å°±æ˜¯å‚æ•°çš„æè¿°å­—ç¬¦ä¸²ã€‚\nä¸ºäº†æ›´åŠ æ·±å…¥äº†è§£æ’ä»¶å‚æ•°çš„é…ç½®ï¼Œæˆ‘ä»¬å†å¯¹ echo æ’ä»¶æ–°å¢ä¸¤ä¸ªå‚æ•°ï¼Œ-c v/--color=value å‚æ•°ç”¨äºæŒ‡å®šè¾“å‡ºæ–‡æœ¬çš„é¢œè‰²ï¼Œè€Œ -b/--bright ç”¨äºå¯ç”¨æ–‡æœ¬çš„é«˜äº®è¾“å‡ºã€‚\nç›¸å…³çš„å‚æ•°é…ç½®ä¿®æ”¹å¦‚ä¸‹ã€‚\ntask(\u0026quot;echo\u0026quot;)\rset_menu {usage = \u0026quot;xmake echo [options]\u0026quot;, description = \u0026quot;Echo the given info!\u0026quot;, options = {\r{'b', \u0026quot;bright\u0026quot;, \u0026quot;k\u0026quot;, nil, \u0026quot;Enable bright.\u0026quot;},\r{'c', \u0026quot;color\u0026quot;, \u0026quot;kv\u0026quot;, \u0026quot;black\u0026quot;, \u0026quot;Set the output color.\u0026quot;,\r\u0026quot; - red\u0026quot;,\r\u0026quot; - blue\u0026quot;,\r\u0026quot; - yellow\u0026quot;,\r\u0026quot; - green\u0026quot;,\r\u0026quot; - magenta\u0026quot;,\r\u0026quot; - cyan\u0026quot;,\r\u0026quot; - white\u0026quot;},\r{},\r{nil, \u0026quot;contents\u0026quot;, \u0026quot;vs\u0026quot;, nil, \u0026quot;The info contents.\u0026quot; }\r}}\ron_run(function ()\rimport(\u0026quot;core.base.option\u0026quot;)\rlocal color = option.get(\u0026quot;color\u0026quot;)\rlocal bright = option.get(\u0026quot;bright\u0026quot;)\rlocal content = table.concat(option.get(\u0026quot;contents\u0026quot;) or {}, \u0026quot; \u0026quot;)\rif color ~= \u0026quot;black\u0026quot; or bright then\rcprint(\u0026quot;${%s %s}%s\u0026quot;, color, bright and \u0026quot;bright\u0026quot; or \u0026quot;\u0026quot;, content)\relse\rprint(\u0026quot;%s\u0026quot;, content)\rend\rend)\rtarget(\u0026quot;test\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\r é€šè¿‡ä¸Šé¢çš„é…ç½®å¯ä»¥çœ‹åˆ°ï¼Œæ–°å¢çš„ -b/--bright å‚æ•°ä¸»è¦ç”¨äºæ ‡è¯† bool çŠ¶æ€ï¼Œæ‰€ä»¥ä»…ä»…è®¾ç½®äº† k å‚æ•°ç±»å‹ï¼Œè€Œ -c v/--color=value æ˜¯å±äºé”®å€¼å¯¹å‚æ•°ç±»å‹ kvï¼Œå¦å¤–æˆ‘ä»¬è¿˜ç»™å®ƒé…ç½®äº†é»˜è®¤å€¼ï¼Œä¹Ÿå°±æ˜¯ -c black æˆ–è€… --color=blackã€‚\næ‰§è¡Œ xmake echo --help å‘½ä»¤å†æŸ¥çœ‹ help å¸®åŠ©èœå•é‡Œé¢çš„å‚æ•°åˆ—è¡¨ï¼Œå°±ä¼šæ˜¯ä¸‹é¢å›¾ç‰‡ä¸­çš„è¿™ä¸ªæ ·å­ã€‚\næ¥ç€å†æ¥è®²è§£ä¸Šé¢ on_run é…ç½®å—ä¸­çš„è„šæœ¬ï¼Œæˆ‘ä»¬é€šè¿‡ option.get(\u0026quot;color\u0026quot;) å’Œ option.get(\u0026quot;bright\u0026quot;) åˆ¤æ–­é¢œè‰²ã€é«˜äº®æ˜¯å¦è¢«è®¾ç½®ï¼Œæ¥å†³å®šæ˜¯å¦å¼€å¯ cprint(\u0026quot;${red bright}hello xmake!\u0026quot;) ç­‰é«˜äº®è‰²å½©è¾“å‡ºã€‚\nå¦‚æœæˆ‘ä»¬æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œå°±ä¼šæ˜¾ç¤ºçº¢è‰²çš„å­—ç¬¦ä¸²æ–‡æœ¬ï¼Œä¾‹å¦‚ã€‚\nxmake echo -c red 'hello xmake!'\r è¿™é‡Œæˆ‘ä»¬ä»…ä»…é€šè¿‡ç®€å†™çš„æ–¹å¼ä¼ é€’äº† -c red å‚æ•°ï¼Œå…¶å®ä¹Ÿå¯ä»¥å†™å…¨å‚æ•°åä¼ é€’ï¼Œæ•ˆæœæ˜¯ç›¸åŒçš„ï¼Œä¾‹å¦‚ --color=redã€‚\nç„¶åæˆ‘ä»¬ç»§ç»­ä¼ é€’ -b/--bright å‚æ•°å¼€å¯é«˜äº®è¾“å‡ºï¼Œä¹Ÿå°±æ˜¯æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œå°±ä¼šæ˜¾ç¤ºé«˜äº®åçš„çº¢è‰²å­—ç¬¦ä¸²æ–‡æœ¬ï¼Œä¾‹å¦‚ã€‚\nxmake echo -b -c red 'hello xmake!'\r æˆ–è€…\nxmake echo --bright --color=red 'hello xmake!'\r å†…éƒ¨ä»»åŠ¡çš„å®šä¹‰å’Œä½¿ç”¨ é€šè¿‡ task() å®šä¹‰çš„ä»»åŠ¡ï¼Œå¹¶ä¸ä¸€å®šæ˜¯æ’ä»¶ä»»åŠ¡ï¼Œåªèƒ½è¯´æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ task() æ¥æš´éœ²å­å‘½ä»¤å®ç°æ’ä»¶æ‰©å±•ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ä¸å¯¹å¤–å¼€æ”¾ task() çš„ä»»åŠ¡è°ƒç”¨ï¼Œä»…ä»…æä¾›ç»™ xmake.lua å†…éƒ¨çš„é…ç½®è„šæœ¬ä½¿ç”¨ã€‚\nåªè¦æˆ‘ä»¬å®šä¹‰çš„ä»»åŠ¡æ²¡æœ‰è°ƒç”¨ set_menu é…ç½®ä¸Šå¯¹åº”å¸®åŠ©èœå•å’Œå‚æ•°é€‰é¡¹ï¼Œé‚£ä¹ˆè¿™ä¸ªä»»åŠ¡å°±ä¸æ˜¯å¯¹å¤–å¼€æ”¾çš„ï¼Œæ— æ³•é€šè¿‡å­å‘½ä»¤çš„æ–¹å¼ç›´æ¥æ‰§è¡Œã€‚\nä¾‹å¦‚ï¼Œæˆ‘ä»¬æŠŠåˆšåˆšçš„æ’ä»¶æ”¹é€ æˆå†…éƒ¨ä»»åŠ¡ï¼Œä¸ä½œä¸ºæ’ä»¶æä¾›ã€‚\ntask(\u0026quot;echo\u0026quot;)\ron_run(function (content, opt)\rif opt.color or opt.bright then\rcprint(\u0026quot;${%s %s}%s\u0026quot;, opt.color or \u0026quot;\u0026quot;, opt.bright and \u0026quot;bright\u0026quot; or \u0026quot;\u0026quot;, content)\relse\rprint(\u0026quot;%s\u0026quot;, content)\rend\rend)\rtarget(\u0026quot;test\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\rafter_build(function (target)\rimport(\u0026quot;core.base.task\u0026quot;)\rtask.run(\u0026quot;echo\u0026quot;, {}, \u0026quot;hello xmake!\u0026quot;, {color = \u0026quot;red\u0026quot;, bright = true})\rend)\r åªè¦æˆ‘ä»¬ä¸è®¾ç½® set_menu ç»™ task()ï¼Œé‚£ä¹ˆè¿™ä¸ªä»»åŠ¡å°±å±äºå†…éƒ¨ä»»åŠ¡ï¼Œè™½ç„¶æ— æ³•é€šè¿‡å¤–éƒ¨å‘½ä»¤çš„æ–¹å¼è°ƒç”¨ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥åœ¨è‡ªå®šä¹‰è„šæœ¬ä¸­é€šè¿‡ core.base.task æ¨¡å—çš„ task.run æ¥å£ç›´æ¥å»è°ƒç”¨å®ƒã€‚\ntask.run(\u0026quot;echo\u0026quot;, {}, \u0026quot;hello xmake!\u0026quot;, {color = \u0026quot;red\u0026quot;, bright = true})\r å…¶ä¸­ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä»»åŠ¡åç§°ï¼Œç¬¬äºŒä¸ªå‚æ•°å°±æ˜¯ set_menu ä¸­å®šä¹‰çš„å‘½ä»¤å‚æ•°é€‰é¡¹çš„å®é™…å€¼åˆ—è¡¨ï¼ˆè¿™é‡Œæ²¡æœ‰ï¼Œæˆ‘ä»¬è°ƒç”¨ xmake echo ç­‰æ’ä»¶å‘½ä»¤æ—¶å€™å¯ä»¥ä¼ é€’ï¼‰ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°ä¹‹åçš„å€¼éƒ½æ˜¯ç›´æ¥ä¼ å…¥ç»™ on_run() ä¸­çš„å‡½æ•°å‚æ•°ã€‚\nå› æ­¤ï¼Œæˆ‘ä»¬å³ä½¿ä¸èµ°å‘½ä»¤è¡Œå‚æ•°ï¼Œä¹Ÿå¯ä»¥å¿«é€Ÿçš„æŠŠå‚æ•°ä¼ é€’è¿›ä»»åŠ¡è„šæœ¬ä¸­ï¼Œè¿™é‡Œçš„é…ç½®ä¾‹å­ï¼Œä¼šåœ¨ç¼–è¯‘å®Œæˆåï¼Œè¿è¡Œ echo ä»»åŠ¡å»æ‰“å°çº¢è‰²çš„å­—ç¬¦ä¸²ä¿¡æ¯ï¼Œå¦‚ä¸‹å›¾ã€‚\nå®éªŒæ€»ç»“ åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬äº†è§£äº† xmake æ’ä»¶çš„åŸºæœ¬æ¦‚å¿µï¼Œå¹¶ä¸”é€šè¿‡ä¸€ä¸ªå®Œæ•´çš„ echo æ’ä»¶ä¾‹å­æ¥å­¦ä¹ æ•´ä¸ªæ’ä»¶çš„ç¼–å†™è¿‡ç¨‹ï¼ŒåŒæ—¶è¿˜å­¦ä¹ äº†å¦‚ä½•å»ç¼–å†™å’Œè°ƒç”¨å†…éƒ¨çš„ä»»åŠ¡è„šæœ¬ã€‚\næœ¬å®éªŒçš„å‚è€ƒä»£ç å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ä¸‹è½½ï¼š\nwget https://labfile.oss.aliyuncs.com/courses/2764/code18.zip\r ","id":49,"section":"categories","summary":"æ’ä»¶å¼€å‘è¯¦è§£ åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬ä¼šå­¦ä¹ åˆ°å¦‚ä½•å»ç¼–å†™å’Œè¿è¡Œä¸€ä¸ªåŸºäº xmake çš„æ‰©å±•æ’ä»¶ï¼Œå¦å¤–æˆ‘ä»¬è¿˜ä¼šå­¦ä¹ åˆ°å¦‚ä½•åœ¨ xmake.lua ä¸­å»é…ç½®å®šä¹‰å†…éƒ¨ä»»åŠ¡ï¼Œä»¥åŠå¦‚ä½•å»ç›´æ¥è°ƒ","tags":["xmake"],"title":"å®éªŒ18æ’ä»¶å¼€å‘è¯¦è§£","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/app/xmake/%E8%93%9D%E6%A1%A5%E7%BD%91%E8%AF%BE/3xmake%E8%BF%9B%E9%98%B6/%E5%AE%9E%E9%AA%8C18%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E8%AF%A6%E8%A7%A3/","year":"2021"},{"content":"å·¥ç¨‹ç”Ÿæˆæ’ä»¶ä½¿ç”¨ åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬ä¸»è¦å­¦ä¹ å¦‚ä½•ä½¿ç”¨ xmake project å·¥ç¨‹ç”Ÿæˆæ’ä»¶å»ç”Ÿæˆå„ç§ç¬¬ä¸‰æ–¹çš„å·¥ç¨‹æ–‡ä»¶ï¼Œä¾‹å¦‚ï¼šMakefileã€CMakeLists.txt å’Œ build.ninja æ–‡ä»¶ç­‰ï¼Œä»¥åŠæ“ä½œå’Œä½“éªŒå®é™… xmake é¡¹ç›®å·¥ç¨‹çš„ç¼–è¯‘ã€‚\nçŸ¥è¯†ç‚¹  å·¥ç¨‹ç”Ÿæˆæ’ä»¶ä»‹ç» Makefile æ–‡ä»¶çš„ç”Ÿæˆ CMakeLists.txt æ–‡ä»¶çš„ç”Ÿæˆ build.ninja æ–‡ä»¶çš„ç”Ÿæˆ  å·¥ç¨‹ç”Ÿæˆæ’ä»¶ä»‹ç» xmake é™¤äº†å¯ä»¥ç›´æ¥æ„å»ºå·¥ç¨‹å¤–ï¼Œè¿˜æä¾›äº† xmake project æ’ä»¶å‘½ä»¤ï¼Œä½¿å¾—å¯ä»¥åƒ cmake é‚£æ ·ç”Ÿæˆç¬¬ä¸‰æ–¹å·¥ç¨‹æ–‡ä»¶ï¼Œä¾‹å¦‚ç”Ÿæˆ vs å·¥ç¨‹ã€makefile æ–‡ä»¶ä»¥åŠ CMakeLists.txt ç­‰ç­‰ã€‚\nè¿™å¯¹äºä¸€äº›éœ€è¦å€ŸåŠ©åƒ vs æ­¤ç±»çš„ç¬¬ä¸‰æ–¹ IDE ç¨‹åºæ¥ç¼–è¯‘è°ƒè¯•ç¨‹åºçš„æ—¶å€™ï¼Œä¼šæ¯”è¾ƒæœ‰ç”¨ï¼Œä¹Ÿå¯ä»¥ç”¨äºæä¾›é¡¹ç›®ç»™ä¸€äº›æ²¡æœ‰å®‰è£… xmake åˆæƒ³è¦ç¼–è¯‘çš„ç”¨æˆ·ã€‚\nä¸‹é¢æˆ‘ä»¬æ¥é€ä¸€è®²è§£å„ç§å·¥ç¨‹æ–‡ä»¶çš„ç”Ÿæˆå’Œä½¿ç”¨ã€‚\nç”Ÿæˆ Makefile æ–‡ä»¶ æˆ‘ä»¬å¯ä»¥é€šè¿‡ xmake ç”Ÿæˆ Makefile æ–‡ä»¶æ¥ä½¿ç”¨ make å‘½ä»¤ç¼–è¯‘é¡¹ç›®ï¼Œç”Ÿæˆ Makefile æ–‡ä»¶åï¼Œæˆ‘ä»¬å°±å¯ä»¥å®Œå…¨ä¸ä¾èµ– xmakeï¼Œåªè¦ç”¨æˆ·çš„ç³»ç»Ÿä¸Šæœ‰ make å‘½ä»¤ï¼Œå°±å¯ä»¥å®Œæˆç¼–è¯‘ã€‚\nä¸ºäº†å®éªŒå¦‚ä½•ç”Ÿæˆ Makefile æ–‡ä»¶ï¼Œé¦–å…ˆæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤åˆ›å»ºä¸€ä¸ªç©ºå·¥ç¨‹ã€‚\ncd ~/Code\rxmake create protest\r ç„¶åæˆ‘ä»¬è¿›å…¥ protest æ–‡ä»¶å¤¹ï¼Œç¼–è¾‘ xmake.lua æ–‡ä»¶æ”¹æˆå¦‚ä¸‹é…ç½®ï¼Œå¹¶åœ¨å…¶ä¸­è®¾ç½®ä¸Šä¸€äº›ç®€å•ç¼–è¯‘é…ç½®ï¼Œæ¯”å¦‚æ·»åŠ  -DTEST å®å®šä¹‰ï¼Œä»¥åŠæ·»åŠ ä¸€äº›é“¾æ¥åº“ã€‚\ntarget(\u0026quot;protest\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\radd_defines(\u0026quot;TEST\u0026quot;)\radd_syslinks(\u0026quot;pthread\u0026quot;, \u0026quot;m\u0026quot;, \u0026quot;dl\u0026quot;)\r æ¥ç€ï¼Œæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤å¼€å§‹ç”Ÿæˆå¯¹åº”çš„ Makefile æ–‡ä»¶ã€‚\nxmake project -k makefile\r xmake project å°±æ˜¯ xmake æä¾›çš„å·¥ç¨‹æ’ä»¶ç”Ÿæˆå‘½ä»¤ï¼Œè€Œæˆ‘ä»¬åªéœ€è¦é€šè¿‡ -k å‚æ•°è®¾ç½®å·¥ç¨‹ç±»å‹ä¸º makefile å°±å¯ä»¥ç”Ÿæˆ Makefile æ–‡ä»¶äº†ã€‚\nè¿è¡Œä¸Šè¿°å‘½ä»¤åï¼Œå¯ä»¥çœ‹åˆ°å½“å‰é¡¹ç›®æ ¹ç›®å½•ä¸‹æ–°å¢äº†ä¸€ä¸ª Makefile æ–‡ä»¶ï¼Œå¦‚ä¸‹å›¾ã€‚\næˆ‘ä»¬å¯ä»¥æ‰§è¡Œ gvim ./makefile çœ‹ä¸‹å®é™…ç”Ÿæˆçš„ makefile æ–‡ä»¶å†…å®¹ã€‚\nå…¶ä¸­ï¼Œæœ€å¼€å¤´éƒ¨åˆ†æ˜¯å¯¹ç¼–è¯‘å·¥å…·é“¾çš„é…ç½®å®šä¹‰ï¼Œç„¶åæ˜¯é…ç½®ç¼–è¯‘é“¾æ¥é€‰é¡¹çš„å®šä¹‰ï¼Œä¹Ÿå°±æ˜¯å›¾ä¸­çº¢çº¿éƒ¨åˆ†ï¼Œæˆ‘ä»¬çœ‹åˆ°ä¹‹å‰åœ¨ xmake.lua é…ç½®çš„ -DTEST å®å®šä¹‰ä»¥åŠ pthread ç­‰é“¾æ¥åº“ä¿¡æ¯éƒ½æˆåŠŸé…ç½®è¿›å»äº†ã€‚\nåœ¨æœ€ä¸‹é¢ï¼Œå°±æ˜¯ make å¯¹ c++ æºæ–‡ä»¶çš„ç¼–è¯‘å’Œç›®æ ‡ç¨‹åºçš„é“¾æ¥é…ç½®äº†ï¼Œæ•´ä½“ç»“æ„è¿˜æ˜¯æ¯”è¾ƒæ¸…æ™°æ˜äº†çš„ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ç›´æ¥ä½¿ç”¨ make å‘½ä»¤è€Œä¸æ˜¯ xmake å‘½ä»¤æ¥ç¼–è¯‘ä¸‹å½“å‰å·¥ç¨‹ã€‚\nmake\r å¦‚æœç¼–è¯‘æ­£å¸¸ï¼Œä¼šçœ‹åˆ°ä¸‹å›¾çš„è¾“å‡ºç»“æœã€‚\nç¼–è¯‘å®Œæˆåï¼Œæˆ‘ä»¬å†æ¥æ‰§è¡Œ tree å‘½ä»¤ï¼ŒæŸ¥çœ‹å®é™…é€šè¿‡ make å‘½ä»¤ç¼–è¯‘ç”Ÿæˆçš„å¯æ‰§è¡Œè·¯å¾„åœ¨å“ªé‡Œï¼Œä»ä¸‹å›¾ä¸­ï¼Œå¯ä»¥ç¡®è®¤å®é™…çš„è¾“å‡ºè·¯å¾„è·Ÿé€šè¿‡ xmake å‘½ä»¤ç¼–è¯‘çš„ç»“æœå®Œå…¨ä¸€è‡´ã€‚\næ—¢ç„¶çŸ¥é“äº†ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç›´æ¥æ‰§è¡Œä¸‹å®ƒçœ‹çœ‹ï¼Œæ˜¯å¦èƒ½å¤Ÿæ­£å¸¸è¿è¡Œã€‚\n./build/linux/x86_64/release/protest\rhello world!\r å¦‚æœä¸€åˆ‡è¿è¡Œæ­£å¸¸ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°ä¸‹é¢çš„è¿è¡Œè¾“å‡ºç»“æœã€‚\nç”Ÿæˆ CMakeLists.txt xmake é™¤äº†èƒ½å¤Ÿç”Ÿæˆ Makefile æ–‡ä»¶ï¼Œè¿˜å¯ä»¥ç”Ÿæˆ CMakeLists.txt æ–‡ä»¶ï¼ˆè¿™æ˜¯ cmake ä¸“å±çš„å·¥ç¨‹æè¿°æ–‡ä»¶ï¼‰ï¼Œä½¿ç”¨æˆ·èƒ½å¤Ÿé€šè¿‡ cmake æ¥ç¼–è¯‘é¡¹ç›®ã€‚è™½ç„¶ cmake ä¹Ÿåªä¸è¿‡æ˜¯å·¥ç¨‹æ–‡ä»¶ç”Ÿæˆå™¨ï¼Œè¿˜æ˜¯éœ€è¦ç”Ÿæˆ Makefile ç­‰æ–‡ä»¶æ‰èƒ½ç»§ç»­ç¼–è¯‘ã€‚\nè¿™æ ·æ„Ÿè§‰ä¼¼ä¹æœ‰ç‚¹å¤šæ­¤ä¸€ä¸¾ï¼Œä¸­é—´è¿˜å¤šé¥¶äº†ä¸€ä¸‹ï¼Œå…¶å®å¤§éƒ¨åˆ†æƒ…å†µä¸‹æ˜¯è¿™æ ·çš„ï¼Œä½†æ˜¯æ¯•ç«Ÿå¾ˆå¤š IDE ç¨‹åºå¯¹ cmake çš„æ”¯æŒåŠ›åº¦ä¼šæ›´å¥½äº›ï¼Œæ¯”å¦‚ Android Studio ä¸‹å¯¹ cmake ç¨‹åºçš„è°ƒè¯•æ”¯æŒä¼šæ›´åŠ çš„å®Œå–„ã€‚å› æ­¤åœ¨æŸäº›ç‰¹å®šåœºæ™¯ï¼Œé€šè¿‡ç”Ÿæˆ CMakeLists.txt è¿˜æ˜¯å¯ä»¥å˜ç›¸è§£å†³ä¸å°‘é—®é¢˜çš„ï¼Œä¹Ÿæ–¹ä¾¿ä¸€äº›ä¹ æƒ¯ä½¿ç”¨ cmake çš„ç”¨æˆ·æ¥ç¼–è¯‘é¡¹ç›®ã€‚\nä¸ºäº†èƒ½å¤Ÿç”Ÿæˆ CMakeLists.txtï¼Œå…¶å®æˆ‘ä»¬ä¸éœ€è¦åšä»€ä¹ˆæ”¹åŠ¨ï¼Œåªéœ€è¦æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤å³å¯ç”Ÿæˆã€‚\nxmake project -k cmake\r å¦‚æœç”ŸæˆæˆåŠŸï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ CMakeLists.txt æ–‡ä»¶ï¼Œç„¶åæˆ‘ä»¬æ‰§è¡Œ gvim CMakeLists.txt çœ‹ä¸‹é‡Œé¢çš„å†…å®¹ã€‚\nä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼Œçº¢æ¡†éƒ¨åˆ†å°±æ˜¯åœ¨ xmake.lua é…ç½®ä¸­åŠ å…¥çš„å®å®šä¹‰å’Œé“¾æ¥é€‰é¡¹é…ç½®ï¼Œè¿™äº›ä¹Ÿå·²ç»è¢«æ­£å¸¸åŠ å…¥åˆ°äº† CMakeLists.txt æ–‡ä»¶ä¸­ã€‚\nåœ¨å°è¯•ä½¿ç”¨ cmake æ¥å¤„ç†ç”Ÿæˆçš„ CMakeLists.txt ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆæ‰§è¡Œ cmake --versionï¼Œç¡®è®¤ cmake å·²ç»è¢«å®‰è£…åˆ°å®éªŒç¯å¢ƒï¼Œå¦‚æœè¿˜æ²¡æœ‰å®‰è£…ï¼Œå¯ä»¥æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤å®‰è£…ä¸‹ã€‚\nsudo apt update\rsudo apt install cmake\r å¦‚æœå·²ç»å®‰è£…å®Œæˆï¼Œå°±å¯ä»¥ä½¿ç”¨ cmake æ¥ç¼–è¯‘é¡¹ç›®äº†ï¼Œå› ä¸ºæˆ‘ä»¬å·²ç»é€šè¿‡ xmake ç”Ÿæˆäº† CMakeLists.txt æ–‡ä»¶ï¼Œå› æ­¤åªéœ€è¦æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤è¿›å…¥ build ç›®å½•åç”Ÿæˆ makefile æ–‡ä»¶ï¼Œç„¶åæ‰§è¡Œ make æ¥ç¼–è¯‘å³å¯ã€‚\ncd build\rcmake .. # è°ƒç”¨ cmake å»ç”Ÿæˆ Makefile æ–‡ä»¶\rmake\r è¿è¡Œç»“æœå¦‚ä¸‹å›¾ï¼Œä¹Ÿæ­£å¸¸å®Œæˆäº†ç¼–è¯‘ã€‚\nç”Ÿæˆ build.ninja xmake é™¤äº†å¯ä»¥ç”Ÿæˆ Makefile å’Œ CMakeLists.txt ä»¥å¤–ï¼Œè¿˜å¯ä»¥ç›´æ¥ç”Ÿæˆ build.ninja æ–‡ä»¶ï¼Œæ”¯æŒ Ninja æ¥ç¼–è¯‘é¡¹ç›®ã€‚Ninja æ˜¯ä¸€ä¸ªæ¯”è¾ƒè½»é‡å¹¶ä¸”ä¸»æ‰“ç¼–è¯‘æ•ˆç‡çš„æ„å»ºå·¥å…·ï¼Œç‰¹ç‚¹æ˜¯ç¼–è¯‘éå¸¸çš„å¿«ï¼ˆå½“ç„¶ï¼Œxmake ç›´æ¥ç¼–è¯‘ä¹Ÿæ˜¯æå¿«çš„ï¼Œä¸¤è€…é€Ÿåº¦ä¸Šå·®å¼‚ä¸å¤§ï¼‰ã€‚\nä¸ºäº†ä½¿ç”¨ Ninjaï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å»å®‰è£…å®ƒã€‚\nwget https://github.com/ninja-build/ninja/releases/download/v1.10.1/ninja-linux.zip\runzip ./ninja-linux.zip\rsudo cp ./ninja /usr/local/bin/ninja\r å®‰è£…å®Œæˆåï¼Œé€šè¿‡ xmake project æ’ä»¶ç”Ÿæˆå¯¹åº”çš„ build.ninja æ–‡ä»¶ï¼Œåªéœ€è¦æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ã€‚\ncd ~/Code/protest\rxmake project -k ninja\r ç”±äºç”Ÿæˆçš„ build.ninja å†…å®¹æ¯”è¾ƒå¤šï¼Œè¿™é‡Œå°±ä¸å±•ç¤ºäº†ï¼Œåªè¦æˆ‘ä»¬ç¡®è®¤å½“å‰å·¥ç¨‹æ ¹ç›®å½•ä¸‹ç¡®å®ç”Ÿæˆäº† build.ninja æ–‡ä»¶ï¼Œå°±å¯ä»¥æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤å»è°ƒç”¨ ninja ç¼–è¯‘äº†ã€‚\nninja\r ç¼–è¯‘å’Œè¿è¡Œæ•ˆæœå¦‚ä¸‹å›¾ã€‚\nå®æˆ˜ä¹‹ tbox å·¥ç¨‹ç¼–è¯‘ ç”±äºä¹‹å‰çš„æµ‹è¯•å·¥ç¨‹ä»…ä»…åªæœ‰ä¸€ä¸ªç®€å• C++ æ–‡ä»¶ï¼Œä¸ç®¡æ˜¯ç”¨ xmake ç›´æ¥ç¼–è¯‘ï¼Œè¿˜æ˜¯ç”Ÿæˆ cmake å’Œ ninja å·¥ç¨‹æ–‡ä»¶æ¥ç¼–è¯‘ï¼Œéƒ½ä¸å¤ªèƒ½ç›´è§‚çš„æ„Ÿå—å‡ºåŒºåˆ«æ¥ã€‚\nå› æ­¤è¿™é‡Œï¼Œæˆ‘ä»¬æ‹¿ä¸€ä¸ªçœŸå®çš„åŸºäº xmake.lua ç»´æŠ¤çš„ tbox é¡¹ç›® æ¥å°è¯•å„ç§ç¼–è¯‘ã€‚\né¦–å…ˆï¼Œæˆ‘ä»¬å…ˆä» gitee ä¸Šæ‹‰å–ä¸‹ä»£ç ï¼ˆgithub ä¸Šä¸‹è½½æœ‰ç‚¹æ…¢ï¼‰ã€‚\ncd ~/Code\rgit clone https://gitee.com/tboox/tbox --depth 1\r æ‹‰å–ä»£ç ä¸‹æ¥åï¼Œå…ˆè¿›å…¥ tbox çš„é¡¹ç›®æ ¹ç›®å½•å°è¯•ç›´æ¥ç”¨ xmake ç¼–è¯‘æ„Ÿå—ä¸‹ã€‚\ncd tbox\rxmake\r å¦‚æœç¼–è¯‘æˆåŠŸï¼Œä¼šæ˜¾ç¤ºä¸‹é¢çš„ä¿¡æ¯ã€‚\næ³¨ï¼šä¸Šå›¾æœ€åº•ä¸‹é»„è‰²éƒ¨åˆ†çš„è­¦å‘Šä¿¡æ¯ä¸ç”¨ç®¡å®ƒï¼Œè¿™æ˜¯ç”±äºæˆ‘ä»¬çš„å®éªŒç¯å¢ƒä¸­ï¼Œgcc ç¼–è¯‘å™¨ç‰ˆæœ¬å¤ªä½ï¼Œtbox é¡¹ç›®é‡Œé¢é…ç½®çš„ä¸€äº›ç¼–è¯‘é€‰é¡¹ gcc ä¸çŸ¥é“å¯¼è‡´è‡ªåŠ¨è¢« xmake å¿½ç•¥äº†ï¼Œä½†ä¸ä¼šå½±å“æ­£å¸¸ç¼–è¯‘ã€‚\nç„¶åï¼Œæˆ‘ä»¬å°è¯•ç”Ÿæˆ build.ninja æ–‡ä»¶ï¼Œè°ƒç”¨ ninja ç¼–è¯‘ã€‚\nxmake project -k ninja\rninja\r æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œninja çš„æ•´ä¸ªç¼–è¯‘è¾“å‡ºé£æ ¼ä¸Šï¼Œè¿˜æ˜¯è·Ÿ xmake æœ‰äº›å·®å¼‚çš„ï¼Œxmake é»˜è®¤æ˜¯å›æ»šæ˜¾ç¤ºç¼–è¯‘è¿›åº¦ï¼Œè€Œ ninja å§‹ç»ˆåœ¨ä¸€è¡Œä¸Šå›æ˜¾è¿›åº¦ä¿¡æ¯ï¼Œå¦‚ä¸‹å›¾ã€‚\nè¿™ä¸ªè¿›åº¦æ˜¾ç¤ºé£æ ¼ï¼Œä»…ä»…åªæ˜¯ä¸ªäººå–œå¥½é—®é¢˜ï¼Œå¹¶æ²¡æœ‰ä»€ä¹ˆå…¶å®ƒå½±å“ï¼Œä¸è¿‡ xmake ä¹Ÿå¯ä»¥é€šè¿‡åˆ‡æ¢ä¸»é¢˜é£æ ¼ï¼Œå®ç°è·Ÿ ninja ä¸€æ ·çš„è¿›åº¦è¾“å‡ºä¿¡æ¯ã€‚\nåªéœ€è¦æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œå…¨å±€é…ç½®åˆ‡åˆ° ninja ä¸»é¢˜å³å¯ã€‚\nxmake g --theme=ninja\r åˆ‡è¿‡å»åï¼Œæˆ‘ä»¬å†å°è¯•æ‰§è¡Œä¸‹ xmake -r ç¼–è¯‘çœ‹çœ‹è¾“å‡ºæ•ˆæœï¼Œåº”è¯¥åŸºæœ¬è·Ÿ ninja ä¿æŒä¸€è‡´äº†ï¼Œå¦‚ä¸‹å›¾ã€‚\nä¸è¿‡ï¼Œè¿™é‡Œåªæ˜¯ä¸´æ—¶æ€§æµ‹è¯•ä¸‹ï¼Œå®éªŒå®Œæˆåï¼Œè®°å¾—æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œé‡ç½®åˆ°é»˜è®¤ä¸»é¢˜é£æ ¼ã€‚\nxmake g -c\r å®éªŒæ€»ç»“ åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬ä¸»è¦å­¦ä¹ äº†å¦‚ä½•ä½¿ç”¨ xmake ç”Ÿæˆå…¶å®ƒç¬¬ä¸‰æ–¹çš„å·¥ç¨‹æ–‡ä»¶ï¼Œä¾‹å¦‚ï¼šMakefileã€CMakeLists.txt å’Œ build.ninja ç­‰ç­‰ï¼Œå…¶å® xmake è¿˜å¯ä»¥ç”Ÿæˆ vcproj ç­‰ vs å·¥ç¨‹æ–‡ä»¶ï¼Œä¸è¿‡ç”±äºå®éªŒç¯å¢ƒå…³ç³»ï¼Œè¿™é‡Œæ²¡æœ‰è¯¦ç»†è®²è§£ï¼Œæœ‰å…´è¶£çš„åŒå­¦ï¼Œå¯ä»¥ç›´æ¥åˆ° xmake çš„å®˜æ–¹æ–‡æ¡£ æŸ¥é˜…ã€‚\næœ¬å®éªŒçš„å‚è€ƒä»£ç å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ä¸‹è½½ï¼š\nwget https://labfile.oss.aliyuncs.com/courses/2764/code17.zip\r ","id":50,"section":"categories","summary":"å·¥ç¨‹ç”Ÿæˆæ’ä»¶ä½¿ç”¨ åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬ä¸»è¦å­¦ä¹ å¦‚ä½•ä½¿ç”¨ xmake project å·¥ç¨‹ç”Ÿæˆæ’ä»¶å»ç”Ÿæˆå„ç§ç¬¬ä¸‰æ–¹çš„å·¥ç¨‹æ–‡ä»¶ï¼Œä¾‹å¦‚ï¼šMakefileã€CMakeLists.","tags":["xmake"],"title":"å®éªŒ17å·¥ç¨‹ç”Ÿæˆæ’ä»¶ä½¿ç”¨","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/app/xmake/%E8%93%9D%E6%A1%A5%E7%BD%91%E8%AF%BE/3xmake%E8%BF%9B%E9%98%B6/%E5%AE%9E%E9%AA%8C17%E5%B7%A5%E7%A8%8B%E7%94%9F%E6%88%90%E6%8F%92%E4%BB%B6%E4%BD%BF%E7%94%A8/","year":"2021"},{"content":"è„šæœ¬è¿è¡Œæ’ä»¶ä½¿ç”¨ åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬ä¼šå­¦ä¹ å¦‚ä½•ä½¿ç”¨ xmake lua æ’ä»¶æ¥æ›´å¿«é€Ÿåœ°è¿è¡Œ lua è„šæœ¬å’Œæ¨¡å—æ¥å£ï¼Œä½¿æˆ‘ä»¬èƒ½å¤Ÿæ›´é«˜æ•ˆçš„è°ƒè¯•è‡ªå®šä¹‰é…ç½®è„šæœ¬ã€‚\nçŸ¥è¯†ç‚¹  äº¤äº’å¼è¿è¡Œï¼ˆREPLï¼‰çš„åŸºæœ¬æ¦‚å¿µå’Œä½¿ç”¨ æŒ‡å®š lua è„šæœ¬çš„è¿è¡Œ æ¨¡å—æ¥å£çš„å¿«é€Ÿè¿è¡Œ å­—ç¬¦ä¸²è„šæœ¬ç‰‡æ®µçš„è¿è¡Œ  è„šæœ¬è¿è¡Œæ’ä»¶ä»‹ç» åœ¨ä¸Šä¸¤èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬å·²ç»ç®€å•ç†Ÿæ‚‰äº†å¦‚ä½•åœ¨è‡ªå®šä¹‰è„šæœ¬ä¸­å»ç¼–å†™æ›´åŠ çµæ´»çš„é…ç½®è„šæœ¬ï¼Œä¸è¿‡æ¯æ¬¡éƒ½éœ€è¦ä¿®æ”¹ xmake.lua ç„¶åè¿è¡Œ xmake å»ç¼–è¯‘æ‰èƒ½è¿è¡Œåˆ°é‡Œé¢æˆ‘ä»¬ç¼–å†™çš„è„šæœ¬ä»£ç ï¼Œå¦‚æœæ˜¯åœ¨ after_build ç­‰é˜¶æ®µï¼Œé‚£æ¯æ¬¡æµ‹è¯•è¿˜å¾—ç­‰åˆ°å®Œæ•´ç¼–è¯‘é€šè¿‡ã€‚\næ•´ä¸ªè°ƒè¯•è¿‡ç¨‹ä¼šéå¸¸çš„ä½æ•ˆï¼Œå› æ­¤ä¸ºäº†æ–¹ä¾¿ç”¨æˆ·å’Œå¼€å‘è€…è°ƒè¯•å’Œå¿«é€ŸéªŒè¯ xmake å†…éƒ¨çš„å„ç§æ¨¡å—ï¼Œä»¥åŠç”¨æˆ·è‡ªå®šä¹‰çš„æ‰©å±•æ¨¡å—ã€‚\nxmake æä¾›äº†ä¸€ä¸ª xmake l/lua æ’ä»¶ï¼Œå¯ä»¥å¿«é€Ÿçš„è¿è¡Œæˆ‘ä»¬æä¾›çš„ç‹¬ç«‹ lua è„šæœ¬ã€è„šæœ¬ç‰‡æ®µä»£ç ï¼Œç”šè‡³è¿˜å¯ä»¥ç›´æ¥è°ƒç”¨æŒ‡å®šçš„æ¨¡å—æ¥å£æˆ–è€…å¼€å¯äº¤äº’è¿è¡Œæ¨¡å¼æ¥å¿«é€Ÿæµ‹è¯•å’ŒéªŒè¯ã€‚\nè¿è¡Œäº¤äº’å‘½ä»¤ï¼ˆREPLï¼‰ é¦–å…ˆæˆ‘ä»¬æ¥è®²è§£å’Œä½¿ç”¨ xmake lua æ’ä»¶æä¾›çš„äº¤äº’è¿è¡Œæ¨¡å¼ï¼Œä¹Ÿå°±æ˜¯ REPLã€‚ç®€å•çš„è¯´ï¼Œå®ƒå°±æ˜¯ä¸€ç§äº¤äº’å¼è§£é‡Šæ‰§è¡Œç¯å¢ƒ Rï¼ˆreadï¼‰ã€Eï¼ˆevaluateï¼‰ã€Pï¼ˆprintï¼‰ã€Lï¼ˆloopï¼‰ã€‚ç”¨æˆ·è¾“å…¥å€¼ï¼Œäº¤äº’å¼è§£é‡Šå™¨ä¼šè¯»å–è¾“å…¥å†…å®¹å¹¶å¯¹å®ƒæ±‚å€¼ï¼Œå†è¿”å›ç»“æœï¼Œå¹¶é‡å¤æ­¤è¿‡ç¨‹ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å®æ—¶æ‰§è¡Œè‡ªå·±çš„ lua è„šæœ¬ç„¶åå¿«é€Ÿè·å–è¿è¡Œç»“æœã€‚\nåœ¨äº¤äº’æ¨¡å¼ä¸‹ï¼Œè¿è¡Œå‘½ä»¤å¯ä»¥æ›´åŠ æ–¹ä¾¿åœ°æµ‹è¯•å’ŒéªŒè¯ä¸€äº›æ¨¡å—æ¥å£ï¼Œä¹Ÿæ›´åŠ åœ°çµæ´»ï¼Œä¸éœ€è¦å»é¢å¤–å†™ä¸€ä¸ªè„šæœ¬æ–‡ä»¶æ¥åŠ è½½ã€‚\næˆ‘ä»¬åªéœ€è¦æ‰§è¡Œ xmake lua å‘½ä»¤å°±å¯ä»¥è¿›å…¥äº¤äº’æ¨¡å¼ï¼Œä¾‹å¦‚ã€‚\n$ xmake lua\rxmake\u0026gt;\r æ‰§è¡Œåçš„æ•ˆæœå›¾å¦‚ä¸‹ï¼Œå¦‚æœæˆ‘ä»¬æ­£å¸¸çœ‹åˆ° xmake\u0026gt; æç¤ºç”¨æˆ·è¾“å…¥çš„å‰ç¼€å­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆè¯´æ˜ç°åœ¨å·²ç»æˆåŠŸè¿›å…¥äº¤äº’æ¨¡å¼äº†ã€‚\næ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•åšä¸€äº›åŸºç¡€æ“ä½œç›´è§‚æ„Ÿå—ä¸‹ï¼Œæ¯”å¦‚è¿›è¡Œè¡¨è¾¾å¼è®¡ç®—ã€‚\nxmake\u0026gt; 1 + 2\r\u0026lt; 3\r è¿è¡Œå®Œï¼Œä¼šè¾“å‡ºè®¡ç®—ç»“æœ 3ï¼Œç„¶åæˆ‘ä»¬å†æ¥å°è¯•ä¸‹å˜é‡çš„èµ‹å€¼å’Œæ‰“å°ã€‚\nxmake\u0026gt; a = {1, 2, b = 3}\rxmake\u0026gt; a\r\u0026lt; {\r1,\r2,\rb = 3\r}\r æˆ‘ä»¬å¯¹å˜é‡ a èµ‹å€¼äº†ä¸€ä¸ª table å¯¹è±¡ï¼Œç„¶åæ•² a å°±å¯ä»¥å°†å…¶å†…å®¹åºåˆ—åŒ–æ‰“å°å‡ºæ¥ã€‚\nè¿˜å¯ä»¥æ‰§è¡Œå¤šè¡Œè¾“å…¥å®ç° for å¾ªç¯è¿­ä»£ï¼Œåªéœ€è¦æ­£å¸¸è¾“å…¥ for å¾ªç¯ä½“çš„æ¯è¡Œä»£ç ï¼Œç„¶åæŒ‰å›è½¦ï¼Œå°±ä¼šè‡ªåŠ¨æç¤ºå…¶å®ƒè¡Œçš„è¾“å…¥ï¼Œç›´åˆ°æ•´ä¸ª for-do-end å®Œæˆè¾“å…¥ã€‚\nxmake\u0026gt; for _, v in pairs({1, 2, 3}) do\rxmake\u0026gt;\u0026gt; print(v)\rxmake\u0026gt;\u0026gt; end\r1\r2\r3\r å¦‚æœæˆ‘ä»¬çœ‹åˆ°å‰ç½®æç¤ºç¬¦å˜æˆäº† xmake\u0026gt;\u0026gt;ï¼Œè¯´æ˜ç°åœ¨è¿›å…¥äº†å¤šè¡Œè¾“å…¥æ¨¡å¼ã€‚\nå¯¹äºåˆšåˆšçš„ä¸€äº›è¾“å…¥æµ‹è¯•ï¼Œæ•´ä¸ªè¿è¡Œæ•ˆæœå¦‚ä¸‹å›¾ã€‚\næ³¨ï¼šå¦‚æœåœ¨å¤šè¡Œè¾“å…¥ä¸­ï¼Œæˆ‘ä»¬æƒ³å–æ¶ˆç»§ç»­æ‰§è¡Œï¼Œé€€å‡ºå¤šè¡Œæ¨¡å¼ï¼Œåªéœ€è¦æŒ‰ q åå›è½¦å³å¯ï¼Œä¾‹å¦‚ã€‚\nxmake\u0026gt; for _, v in ipairs({1, 2}) do\rxmake\u0026gt;\u0026gt; print(v)\rxmake\u0026gt;\u0026gt; q # å–æ¶ˆå¤šè¡Œè¾“å…¥ï¼Œæ¸…ç©ºå…ˆå‰çš„è¾“å…¥æ•°æ®\rxmake\u0026gt; 1 + 2\r\u0026lt; 3\r æˆ‘ä»¬ä¹Ÿèƒ½å¤Ÿé€šè¿‡ import æ¥å¯¼å…¥å„ç§æ‰©å±•æ¨¡å—ï¼Œç›´æ¥è°ƒç”¨é‡Œé¢æ¥å£åšç›¸å…³æµ‹è¯•ï¼Œä¾‹å¦‚ä¸Šä¸ªå®éªŒä¸­çš„ mymod.lua é‡Œé¢å¯¹ lib.detect.find_tool æ¨¡å—çš„ä½¿ç”¨ï¼Œè¿™é‡Œå¯ä»¥ç›´æ¥åœ¨äº¤äº’æ¨¡å¼ä¸‹å¯¼å…¥åè°ƒç”¨è¿è¡Œã€‚\nxmake\u0026gt; find_tool = import(\u0026quot;lib.detect.find_tool\u0026quot;)\rxmake\u0026gt; find_tool(\u0026quot;gcc\u0026quot;)\r\u0026lt; {\rprogram = \u0026quot;/usr/bin/gcc\u0026quot;,\rname = \u0026quot;gcc\u0026quot;\r}\r è¿è¡Œæ•ˆæœå¦‚ä¸‹å›¾ã€‚\næ‰§è¡ŒæŒ‡å®š lua è„šæœ¬ è™½ç„¶äº¤äº’æ¨¡å¼è¿è¡Œå¾ˆæ–¹ä¾¿ï¼Œä½†æ˜¯å¯¹äºæˆ‘ä»¬è‡ªå·±å†™çš„æ‰©å±•æ¨¡å—è„šæœ¬ï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯ç‹¬ç«‹çš„ lua æ–‡ä»¶ï¼Œå¦‚æœæˆ‘ä»¬èƒ½å¤Ÿç›´æ¥å»è¿è¡Œå®ƒä»¬ï¼Œé‚£ä¼šæ›´åŠ çš„æ–¹ä¾¿ï¼Œå¹¶ä¸”ç»•è¿‡äº† xmake.lua å’Œç¼–è¯‘è¿‡ç¨‹ã€‚\nå¦‚æœæŒ‡å®šçš„ lua æ¨¡å—è„šæœ¬é‡Œé¢æä¾›äº† main() å…¥å£å‡½æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿è¡Œä¸‹é¢çš„å‘½ä»¤ç›´æ¥åŠ è½½è¿è¡Œå®ƒï¼Œè¿˜æ˜¯ä»¥ä¸ŠèŠ‚å®éªŒä¸­æˆ‘ä»¬åˆ›å»ºçš„ import_test å·¥ç¨‹ä¸­çš„ mymod.lua ä¸ºä¾‹ï¼Œè¿™é‡Œå°è¯•ç›´æ¥æ‰§è¡Œå®ƒã€‚\n# å¦‚æœæ²¡æœ‰ä¿å­˜ä¸Šä¸€ä¸ªå®éªŒçš„ä»£ç ï¼Œå¯ä»¥é€šè¿‡å¦‚ä¸‹å‘½ä»¤ä¸‹è½½ä½¿ç”¨\rwget https://labfile.oss.aliyuncs.com/courses/2764/code15.zip\rcd ~/Code/import_test\rxmake lua xmake_modules/mymod.lua\r æ‰§è¡Œæ•ˆæœå¦‚ä¸‹å›¾ï¼Œå¯ä»¥çœ‹åˆ° find_tool(\u0026quot;gcc\u0026quot;) çš„æ‰§è¡Œç»“æœå·²ç»æ­£å¸¸äº†ï¼Œä½†æ˜¯ print(\u0026quot;mymod: %s\u0026quot;, str) çš„æ‰§è¡Œç”±äºç¼ºå°‘å‚æ•°ï¼Œè¿™é‡Œä»…ä»…æ˜¾ç¤º %sã€‚\nä¸ºäº†ä¼ é€’å‚æ•°åˆ° mymod.lua æ¨¡å—æ–‡ä»¶ä¸­çš„ main(str) å…¥å£å‚æ•°ï¼Œæˆ‘ä»¬åªéœ€è¦è¿½åŠ å‚æ•°åˆ° xmake lua å‘½ä»¤çš„æœ€åé¢ï¼Œä¾‹å¦‚ã€‚\nxmake lua xmake_modules/mymod.lua hello\r ä¼ å…¥å‚æ•°åï¼Œæˆ‘ä»¬å°±å¯ä»¥çœ‹åˆ°ä¸‹å›¾çº¢çº¿éƒ¨åˆ†çš„å‚æ•°å†…å®¹äº†ã€‚\næ‰§è¡ŒæŒ‡å®š lua å­—ç¬¦ä¸²è„šæœ¬ xmake lua é™¤äº†èƒ½å¤Ÿç›´æ¥åŠ è½½è¿è¡Œ lua è„šæœ¬æ–‡ä»¶å¤–ï¼Œè¿˜å¯ä»¥é€šè¿‡ä¼ é€’ -c å‚æ•°æ¥ç›´æ¥æ‰§è¡Œä¸€æ®µç®€çŸ­çš„å­—ç¬¦ä¸²è„šæœ¬ï¼Œä¾‹å¦‚ä¸‹é¢çš„å‘½ä»¤ã€‚\nxmake lua -c 'for i = 1, 10 do print(i) end'\r å¦‚æœè¿è¡ŒæˆåŠŸï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°å®é™…çš„è¾“å‡ºç»“æœï¼Œå¦‚ä¸‹å›¾ã€‚\nå¿«é€Ÿè°ƒç”¨å’Œæµ‹è¯•æ¨¡å—æ¥å£ æœ€åï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ xmake lua æ¥ç›´æ¥è°ƒç”¨ xmake æä¾›çš„ä»»ä½•å†…ç½®æ¨¡å—çš„æ¥å£ï¼Œæ¥å¿«é€Ÿè·å–è¾“å‡ºç»“æœï¼Œä¾‹å¦‚è¿è¡Œä¸‹é¢çš„å‘½ä»¤å»æŸ¥æ‰¾ gcc ç¼–è¯‘å™¨è·¯å¾„ä¿¡æ¯ã€‚\nxmake lua lib.detect.find_tool gcc\r ç»“æœå¦‚ä¸‹ã€‚\nä¹Ÿå¯ä»¥æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œå»å¿«é€Ÿæ¢æµ‹å®‰è£…çš„ C/C++ ä¾èµ–åŒ…ï¼Œä¾‹å¦‚ã€‚\nxmake lua find_packages zlib\r ä¸Šé¢çš„å‘½ä»¤ï¼Œæˆ‘ä»¬é€šè¿‡ç›´æ¥æ‰§è¡Œ find_packages æ¥å£å»æŸ¥æ‰¾ zlib åŒ…ï¼Œå¦‚æœæ£€æµ‹æˆåŠŸï¼Œå°±ä¼šçœ‹åˆ°å®é™…çš„ zlib åº“ä¿¡æ¯ã€‚\nåˆæˆ–è€…ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è°ƒç”¨ os æ¨¡å—é‡Œé¢çš„æ¥å£ï¼Œæ¯”å¦‚å¿«é€Ÿéå†è·å– src ç›®å½•ä¸‹ C++ æ–‡ä»¶åˆ—è¡¨ã€‚\ncd ~/Code/import_test\rxmake lua os.files 'src/*.cpp'\r æˆ‘ä»¬è¿›å…¥ä¹‹å‰çš„ import_test å·¥ç¨‹ç›®å½•ï¼Œç„¶åè·å–åˆ° src çš„æ‰€æœ‰æºæ–‡ä»¶ï¼Œç»“æœå¦‚ä¸‹å›¾ã€‚\nå®éªŒæ€»ç»“ åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•ä½¿ç”¨ xmake lua æ’ä»¶æ¥å¿«é€Ÿè¿è¡ŒæŒ‡å®šçš„ lua è„šæœ¬æ¨¡å—ï¼Œä»£ç ç‰‡æ®µä»¥åŠæ¨¡å—æ¥å£ï¼Œæ–¹ä¾¿å¤§å®¶å¿«é€Ÿè¿›è¡Œæ¨¡å—è„šæœ¬è°ƒè¯•ï¼Œå¦å¤–æˆ‘ä»¬è¿˜å­¦ä¹ åˆ°äº†å¦‚ä½•è¿›å…¥äº¤äº’æ¨¡å¼æ¥æ‰§è¡Œä¸€äº›è„šæœ¬é€»è¾‘ã€‚\næœ¬å®éªŒçš„å‚è€ƒä»£ç å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ä¸‹è½½ï¼š\nwget https://labfile.oss.aliyuncs.com/courses/2764/code16.zip\r ","id":51,"section":"categories","summary":"è„šæœ¬è¿è¡Œæ’ä»¶ä½¿ç”¨ åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬ä¼šå­¦ä¹ å¦‚ä½•ä½¿ç”¨ xmake lua æ’ä»¶æ¥æ›´å¿«é€Ÿåœ°è¿è¡Œ lua è„šæœ¬å’Œæ¨¡å—æ¥å£ï¼Œä½¿æˆ‘ä»¬èƒ½å¤Ÿæ›´é«˜æ•ˆçš„è°ƒè¯•è‡ªå®šä¹‰é…ç½®è„šæœ¬ã€‚ çŸ¥è¯†ç‚¹ äº¤äº’å¼è¿","tags":["xmake"],"title":"å®éªŒ16è„šæœ¬è¿è¡Œæ’ä»¶ä½¿ç”¨","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/app/xmake/%E8%93%9D%E6%A1%A5%E7%BD%91%E8%AF%BE/3xmake%E8%BF%9B%E9%98%B6/%E5%AE%9E%E9%AA%8C16%E8%84%9A%E6%9C%AC%E8%BF%90%E8%A1%8C%E6%8F%92%E4%BB%B6%E4%BD%BF%E7%94%A8/","year":"2021"},{"content":"æ‰©å±•æ¨¡å—å¯¼å…¥å’Œä½¿ç”¨ åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬å°†ä¼šå­¦ä¹ åˆ° xmake ä¸­æ¨¡å—çš„åŸºæœ¬æ¦‚å¿µå’Œç§ç±»ï¼Œå¹¶ä¸”è¿˜ä¼šå­¦åˆ°å¦‚ä½•åœ¨é¡¹ç›®é…ç½®ä¸­é€šè¿‡ import å»å¯¼å…¥å’Œä½¿ç”¨å†…éƒ¨æ‰©å±•æ¨¡å—ï¼Œä»¥åŠç”¨æˆ·å’Œç¬¬ä¸‰æ–¹æ¨¡å—ã€‚\nçŸ¥è¯†ç‚¹  xmake çš„æ¨¡å—ç±»å‹ import æ¨¡å—å¯¼å…¥æ¥å£çš„åŸºæœ¬ä½¿ç”¨ å†…éƒ¨æ‰©å±•æ¨¡å—çš„å¯¼å…¥ ç”¨æˆ·å’Œç¬¬ä¸‰æ–¹æ¨¡å—çš„å¯¼å…¥  import æ¨¡å—å¯¼å…¥æ¥å£ä»‹ç» è™½ç„¶æˆ‘ä»¬å¯ä»¥åœ¨è‡ªå®šä¹‰è„šæœ¬ä¸­ä½¿ç”¨ xmake æä¾›çš„ä¸€äº›å†…ç½®æ¨¡å—ï¼Œä¾‹å¦‚ä¸Šä¸¤èŠ‚å®éªŒä¸­ä»‹ç»çš„ os ç³»ç»Ÿæ¨¡å—ï¼Œä»¥åŠ io æ–‡ä»¶æ“ä½œæ¨¡å—ç­‰ç­‰ã€‚\nä½†æ˜¯å†…ç½®çš„æ¨¡å—æ¯•ç«Ÿæœ‰é™ï¼Œå•çº¯åœ°ä½¿ç”¨å†…ç½®æ¨¡å—æ˜¯æ— æ³•æ»¡è¶³æ‰€æœ‰ç”¨æˆ·åœ¨è‡ªå®šä¹‰è„šæœ¬ä¸­çš„å„ç§å¤æ‚çš„é…ç½®éœ€æ±‚ï¼Œè€Œå¦‚æœæˆ‘ä»¬æŠŠæ›´å¤šçš„æ¨¡å—é›†æˆè¿› xmake çš„å†…ç½®æ¨¡å—ä¸­ï¼Œè¿™æ ·ä¸ä»…ä¼šè®© xmake éå¸¸çš„è‡ƒè‚¿ï¼Œè€Œä¸”æ›´å®¹æ˜“å¯¼è‡´å‘½åå†²çªç­‰å…¶å®ƒé—®é¢˜ã€‚\nå› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ xmake æä¾›çš„ import æ¥å£æ¥å¯¼å…¥æ‰©å±•æ¨¡å—è¿›è¡Œä½¿ç”¨ï¼Œè¿™æ ·æ—¢ä¿è¯äº† xmake ç²¾ç®€çš„åŒæ—¶ï¼Œåˆèƒ½è®©å…¶å…·å¤‡çµæ´»å¼ºå¤§çš„æ‰©å±•æ€§ã€‚\nåœ¨å…·ä½“ä»‹ç»å¦‚ä½•ä½¿ç”¨ import å¯¼å…¥æ¨¡å—ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆç®€å•ä»‹ç»ä¸‹ xmake æä¾›çš„å„ç§æ¨¡å—ç§ç±»ã€‚\n å†…ç½®æ¨¡å—ï¼šä¸å¯¼å…¥å°±å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œä¸éœ€è¦ import é¢å¤–å¯¼å…¥ã€‚ å†…ç½®çš„æ‰©å±•æ¨¡å—ï¼šæ¨¡å—æœ¬èº«è¿˜æ˜¯åœ¨ xmake å®‰è£…åŒ…å†…çš„ï¼Œä½†æ˜¯é»˜è®¤æ²¡æœ‰å¯¼å…¥è¿›æ¥ï¼Œåªæœ‰é€šè¿‡ import å¯¼å…¥åæ‰èƒ½ä½¿ç”¨ã€‚ å¤–éƒ¨çš„æ‰©å±•æ¨¡å—ï¼šç”¨æˆ·è‡ªå·±å®ç°çš„æ¨¡å—ã€æˆ–è€…ç¬¬ä¸‰æ–¹çš„ lua æ¨¡å—æ–‡ä»¶ï¼Œé€šè¿‡ import æŒ‡å®šè·¯å¾„åå¯¼å…¥è¿›æ¥ä½¿ç”¨ã€‚  å¯¼å…¥å†…ç½®çš„æ‰©å±•æ¨¡å— xmake æœ¬èº«æä¾›äº†å¤§é‡çš„å†…ç½®æ‰©å±•æ¨¡å—ï¼Œè™½ç„¶é»˜è®¤æ²¡æœ‰å¯¼å…¥åˆ°è‡ªå®šä¹‰è„šæœ¬ä¸­æ¥ï¼Œä½†æ˜¯ç”¨æˆ·å¯ä»¥æ ¹æ®è‡ªå·±é¡¹ç›®çš„å®é™…é…ç½®éœ€æ±‚ï¼Œé€‰æ‹©æ€§å¯¼å…¥ä¸€äº›éœ€è¦çš„æ‰©å±•æ¨¡å—æ¥ä½¿ç”¨ã€‚\nåŸºæœ¬ä¸Šï¼Œxmake çš„æ‰©å±•æ¨¡å—å·²ç»å¯ä»¥æ»¡è¶³å¤§éƒ¨åˆ†ç”¨æˆ· 80% çš„è„šæœ¬é…ç½®éœ€æ±‚ï¼Œè¿™é‡Œæˆ‘ä»¬ä¸»è¦åˆ—ä¸¾å’Œä»‹ç»ä¸€äº›æ¯”è¾ƒå¸¸ç”¨çš„æ¨¡å—åŒ…ã€‚\n   æ¨¡å—åŒ… æè¿°     core.base xmake çš„æ ¸å¿ƒåŸºç¡€æ¨¡å—   core.project xmake çš„æ ¸å¿ƒå·¥ç¨‹é…ç½®ç›¸å…³æ¨¡å—   lib.detect å„ç§æ£€æµ‹æ¨¡å—   net ç½‘ç»œè®¿é—®ç›¸å…³æ¨¡å—   utils å®ç”¨å·¥å…·æ¨¡å—   ui ç»ˆç«¯å­—ç¬¦ ui åº“æ¨¡å—    å…¶ä¸­ï¼Œæˆ‘ä»¬å¤§éƒ¨åˆ†çš„åŠŸèƒ½æ¨¡å—éƒ½åœ¨ core è¿™ä¸ªæ ¸å¿ƒæ¨¡å—åŒ…ä¸­ï¼Œé‡Œé¢æœ‰å„ç§åŸºç¡€åº“ï¼Œä»¥åŠå¯¹ xmake å·¥ç¨‹ç»“æ„å’Œä¿¡æ¯çš„å„ç§è®¿é—®æ“ä½œæ¥å£ã€‚\nè€Œ import çš„ä½¿ç”¨æ–¹å¼å…¶å®è·Ÿ javaã€kotlin è¿™ç±»è¯­è¨€å¾ˆåƒï¼Œä¼ å…¥ import çš„æ¨¡å—åå‚æ•°ä¹Ÿæ˜¯åŸºäº . æ¥æŒ‰åŒ…åå±‚çº§åˆ’åˆ†çš„ï¼Œä¾‹å¦‚ import(\u0026quot;core.project.config\u0026quot;)ã€‚\næ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªç©ºå·¥ç¨‹æ¥å°è¯•å¦‚ä½•ä½¿ç”¨ import å¯¼å…¥ xmake çš„å†…éƒ¨æ‰©å±•æ¨¡å—ã€‚\ncd ~/Code\rxmake create import_test\r åˆ›å»ºå®Œæˆåï¼Œè¿›å…¥ import_test ç›®å½•ï¼Œç„¶åç¼–è¾‘é‡Œé¢çš„ xmake.lua æ–‡ä»¶ï¼Œåœ¨ on_load é˜¶æ®µé€šè¿‡ import å¯¼å…¥å·¥ç¨‹çš„ config æ¨¡å—æ¥è·å– xmake f/config -p xxx -m debug é‡Œé¢çš„ç¼–è¯‘å¹³å°ã€æ¶æ„ä»¥åŠç¼–è¯‘æ¨¡å¼ç­‰é…ç½®ä¿¡æ¯ã€‚\ntarget(\u0026quot;import_test\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\ron_load(function (target)\rimport(\u0026quot;core.project.config\u0026quot;)\rprint(\u0026quot;plat: %s\u0026quot;, config.get(\u0026quot;plat\u0026quot;))\rprint(\u0026quot;arch: %s\u0026quot;, config.get(\u0026quot;arch\u0026quot;))\rprint(\u0026quot;mode: %s\u0026quot;, config.get(\u0026quot;mode\u0026quot;))\rend)\r é€šè¿‡ä¸Šé¢çš„é…ç½®ï¼Œæˆ‘ä»¬å¤§æ¦‚äº†è§£åˆ°ï¼Œåªè¦é€šè¿‡ import å¯¼å…¥äº† core.project.config æ¨¡å—åï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨å¯¼å…¥çš„å½“å‰ä½œç”¨åŸŸå†…ç›´æ¥ä½¿ç”¨ config æ¨¡å—äº†ã€‚\næ‰§è¡Œ xmake æŸ¥çœ‹èƒ½å¦è¾“å‡ºæ‰“å°çš„é…ç½®ä¿¡æ¯ï¼Œå¦‚æœè¿è¡Œæ­£å¸¸ï¼Œé‚£ä¹ˆä¼šæ˜¾ç¤ºä¸‹å›¾çš„ç»“æœã€‚\nä¸‹é¢ï¼Œæˆ‘ä»¬å†æ¥å°è¯•ä¸€ä¸ªä¾‹å­ï¼Œè¿™å›å¯¼å…¥ core.project.project æ¨¡å—æ¥ä½¿ç”¨ï¼Œé€šè¿‡è¿™ä¸ªæ¨¡å—ï¼Œæˆ‘ä»¬å¯ä»¥è·å–åˆ°æ‰€æœ‰åœ¨ xmake.lua ä¸­å®šä¹‰çš„ target ç›®æ ‡åˆ—è¡¨ï¼Œç„¶åé€šè¿‡è¿™äº› target å¯¹è±¡ï¼Œè·å–åˆ°æ¯ä¸ªç›®æ ‡ç¨‹åºåå’Œå®é™…è¾“å‡ºè·¯å¾„ã€‚\ntarget(\u0026quot;test2\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\rtarget(\u0026quot;import_test\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\rafter_build(function (target)\rimport(\u0026quot;core.project.project\u0026quot;)\rfor _, t in pairs(project.targets()) do\rprint(\u0026quot;%s: %s\u0026quot;, t:name(), t:targetfile())\rend\rend)\r ä¸ºäº†ä½¿å¾—éå† target ç›®æ ‡çš„æ•ˆæœæ›´åŠ æ˜æ˜¾ï¼Œæˆ‘ä»¬è¿™é‡Œåœ¨é…ç½®ä¸­é¢å¤–æ·»åŠ äº†ä¸€ä¸ª test2 çš„ç›®æ ‡ç¨‹åºï¼Œå¹¶ä¸”è¿™å›æˆ‘ä»¬æ˜¯åœ¨ after_build é˜¶æ®µéå†çš„ targetsï¼Œè¿™æ˜¯å› ä¸ºåœ¨ on_load é˜¶æ®µï¼Œxmake è¿˜æ²¡å®Œæˆå¯¹æ‰€æœ‰ targets çš„åŠ è½½ï¼Œå› æ­¤æ˜¯æ— æ³•è·å–æ‰€æœ‰ç›®æ ‡çš„ã€‚\næ‰§è¡Œ xmake -r é‡æ–°ç¼–è¯‘ç¨‹åºï¼Œåœ¨æ„å»ºå®Œæˆåçš„é˜¶æ®µéå†æ‰€æœ‰ targets ç›®æ ‡ç¨‹åºï¼Œå¦‚ä¸‹å›¾ã€‚\nå…³äº xmake çš„æ›´å¤šæ¨¡å—ä»‹ç»å’Œä½¿ç”¨ï¼Œå¯ä»¥æŸ¥çœ‹ xmake çš„ æ‰©å±•æ¨¡å—å®˜æ–¹æ–‡æ¡£ï¼Œä¹Ÿå¯ä»¥ç›´æ¥åˆ° xmake æ‰©å±•æ¨¡å—æºç ç›®å½• ä¸­å»ç¿»é˜…æŸ¥æ‰¾ã€‚\nå¯¼å…¥å¤–éƒ¨ç¬¬ä¸‰æ–¹æ¨¡å— é™¤äº† xmake è‡ªèº«æä¾›çš„æ‰©å±•æ¨¡å—ï¼Œimport è¿˜æ”¯æŒå¯¼å…¥å¤§å®¶è‡ªå·±ç¼–å†™çš„æ¨¡å—ã€ä»¥åŠå…¶å®ƒçš„ç¬¬ä¸‰æ–¹ lua æ¨¡å—ã€‚å¤§å®¶åªéœ€è¦å°†è‡ªå·±çš„ lua æ¨¡å—æ”¾ç½®åœ¨è·Ÿ import è°ƒç”¨è„šæœ¬åŒçº§çš„ç›®å½•ä¸‹ï¼Œæ¯”å¦‚ mymod.luaï¼Œé‚£ä¹ˆ import(\u0026quot;mymod\u0026quot;) å°±å¯ä»¥é€šè¿‡ç›¸å¯¹è·¯å¾„çš„æ–¹å¼ç›´æ¥å¯¼å…¥è¿›æ¥ã€‚\næˆ‘ä»¬æŒ‰è¿™ä¸ªæ€è·¯ï¼Œå…ˆåœ¨å½“å‰é¡¹ç›®æ ¹ç›®å½•åˆ›å»º mymod.lua æ–‡ä»¶ã€‚\ntouch mymod.lua\r å…¶æ•´ä¸ªç›®å½•ç»“æ„å¤§æ¦‚å¦‚ä¸‹ã€‚\ntree\r.\râ”œâ”€â”€ mymod.lua\râ”œâ”€â”€ src\râ”‚ â””â”€â”€ main.cpp\râ””â”€â”€ xmake.lua\r ç„¶åæ‰§è¡Œ vim mymod.lua ç¼–è¾‘æ·»åŠ è¿™ä¸ªè‡ªå®šä¹‰æ¨¡å—çš„ä»£ç ï¼Œåœ¨é‡Œé¢å®šä¹‰å¯¼å‡ºä¸€ä¸ª hello() çš„æ¨¡å—æ¥å£ã€‚\nfunction hello(str)\rprint(\u0026quot;mymod: %s\u0026quot;, str)\rend\r å®Œæˆ mymod.lua çš„æ¨¡å—å®ç°åï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨ xmake.lua ä¸­å°†å…¶å¯¼å…¥è¿›æ¥ä½¿ç”¨äº†ã€‚\ntarget(\u0026quot;import_test\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\rafter_build(function (target)\rimport(\u0026quot;mymod\u0026quot;)\rmymod.hello(\u0026quot;xmake\u0026quot;)\rend)\r é€šè¿‡ import(\u0026quot;mymod\u0026quot;) å¯¼å…¥åï¼Œå°±å¯ä»¥è°ƒç”¨ mymod.hello çš„æ¨¡å—æ¥å£äº†ï¼Œè¿™é‡Œæˆ‘ä»¬ä¼ å…¥ä¸€äº›å‚æ•°è¿›å»å¹¶ä¸”åœ¨ mymod æ¨¡å—é‡Œé¢å°†å…¶æ‰“å°å‡ºæ¥ã€‚\næ‰§è¡Œ xmake -r è¿è¡Œåçš„æ•ˆæœå¦‚ä¸‹å›¾çº¢çº¿éƒ¨åˆ†çš„è¾“å‡ºã€‚\nimport çš„æ¨¡å—æŸ¥æ‰¾é¡ºåº æˆ‘ä»¬ç°åœ¨å¤§æ¦‚çŸ¥é“äº†ï¼Œå¯ä»¥ç›´æ¥ä»å½“å‰è·¯å¾„ä¸‹å¯¼å…¥è‡ªå·±çš„æ¨¡å—æ–‡ä»¶ï¼Œå…¶å® import è¿˜ä¼šä»å¾ˆå¤šå…¶å®ƒè·¯å¾„æŸ¥æ‰¾æ¨¡å—ã€‚å› æ­¤åœ¨è¿›ä¸€æ­¥äº†è§£æ¨¡å—çš„å¯¼å…¥è§„åˆ™ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥äº†è§£ä¸‹ import æ¥å£å¯¼å…¥æ¨¡å—çš„æ•´ä¸ªæŸ¥æ‰¾æµç¨‹ã€‚\n ä¼˜å…ˆä»ç”¨æˆ·åœ¨ xmake.lua ä¸­é€šè¿‡ add_moduledirs æ¥å£æŒ‡å®šçš„æ¨¡å—æ ¹ç›®å½•ä¸‹æŸ¥æ‰¾æŒ‡å®šæ¨¡å—ã€‚ ä» $XMAKE_MODULES_DIR ç¯å¢ƒå˜é‡æŒ‡å®šçš„æ¨¡å—ç›®å½•ä¸­æŸ¥æ‰¾æ¨¡å—ã€‚ ä» ~/.xmake/modules å…¨å±€æ¨¡å—ç›®å½•ä¸­æŸ¥æ‰¾æ¨¡å—ã€‚ ä» xmake çš„å®‰è£…ç›®å½•é‡Œé¢çš„æ¨¡å—ç›®å½•ä¸­æŸ¥æ‰¾æ¨¡å—ã€‚ ä»å½“å‰ import è¢«è°ƒç”¨çš„è„šæœ¬æ–‡ä»¶æ‰€åœ¨ç›®å½•ä¸‹æŸ¥æ‰¾æ¨¡å—ã€‚  ä»ä¸Šé¢çš„æµç¨‹ä¸­å¯ä»¥çŸ¥é“ï¼Œåˆšåˆšæˆ‘ä»¬ä»å½“å‰ç›®å½•ä¸‹åŠ è½½æ¨¡å—ï¼Œå°±æ˜¯ä¸Šé¢æœ€ä½çš„æŸ¥æ‰¾ä¼˜å…ˆçº§ï¼Œä¹Ÿå°±æ˜¯ç¬¬ 5 ç§æ–¹å¼ã€‚è€Œå¯¹äºé¡¹ç›®ç»´æŠ¤ï¼Œå…¶å®æˆ‘ä»¬æ›´æ¨èä½¿ç”¨ç¬¬ä¸€ç§æ–¹å¼æ¥åŠ è½½è‡ªå·±çš„æ‰©å±•æ¨¡å—ã€‚\né€šè¿‡ç¬¬ 1 ç§æŸ¥æ‰¾æ–¹å¼ï¼Œæˆ‘ä»¬ä½¿ç”¨ add_moduledirs æ¥å£å›ºå®šæ¯ä¸ªé¡¹ç›®çš„æ‰©å±•æ¨¡å—å­˜å‚¨æ ¹ç›®å½•ï¼Œç»Ÿä¸€ç®¡ç†å­˜æ”¾ï¼Œä¹Ÿæ–¹ä¾¿äº†ç”¨æˆ·çš„ç®¡ç†ï¼Œä»¥åŠè·Ÿ C/C++ ä»£ç æ–‡ä»¶çš„ç‹¬ç«‹å­˜å‚¨ã€‚\nä¸ºäº†æ›´åŠ æ·±åˆ»çš„äº†è§£ç¬¬ 1 ç§æ–¹å¼çš„æ¨¡å—å¯¼å…¥å’Œç»´æŠ¤ï¼Œæˆ‘ä»¬ç»§ç»­æ”¹è¿›ä¸‹é¡¹ç›®å·¥ç¨‹ï¼Œæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤å°† mymod.lua æŒªä¸€ä¸‹ä½ç½®ï¼Œå°†å…¶æ”¾ç½®åˆ° xmake_modules æ¨¡å—ç›®å½•ä¸‹ã€‚\nmkdir xmake_modules\rmv mymod.lua xmake_modules\r æ•´ä¸ªé¡¹ç›®ç»“æ„å¤§æ¦‚å¦‚ä¸‹ã€‚\n.\râ”œâ”€â”€ src\râ”‚ â””â”€â”€ main.cpp\râ”œâ”€â”€ xmake.lua\râ””â”€â”€ xmake_modules\râ””â”€â”€ mymod.lua\r ç„¶åç¼–è¾‘ xmake.lua æ–‡ä»¶ï¼Œé€šè¿‡ add_moduledirs æ¥å£ï¼Œè®¾ç½® xmake_modules ä½œä¸ºæˆ‘ä»¬è‡ªå·±çš„æ‰©å±•æ¨¡å—æ ¹ç›®å½•ã€‚\nadd_moduledirs(\u0026quot;xmake_modules\u0026quot;)\rtarget(\u0026quot;import_test\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\rafter_build(function (target)\rimport(\u0026quot;mymod\u0026quot;)\rmymod.hello(\u0026quot;xmake\u0026quot;)\rend)\r é™¤äº†æ–°åŠ å…¥çš„ add_moduledirs(\u0026quot;xmake_modules\u0026quot;) æŒ‡å®šæ¨¡å—ç›®å½•ï¼Œå…¶å®ƒé…ç½®å®Œå…¨è·Ÿä¹‹å‰ä¿æŒä¸€è‡´ï¼Œè™½ç„¶ç°åœ¨ mymod.lua å·²ç»ä¸åœ¨å½“å‰ xmake.lua æ–‡ä»¶åŒçº§ç›®å½•ä¸‹äº†ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜æ˜¯å¯ä»¥é€šè¿‡ import(\u0026quot;mymod\u0026quot;) ç›´æ¥æ‰¾åˆ°å¹¶å¯¼å…¥è¿›æ¥ã€‚è¿™æ˜¯å› ä¸º xmake ç°åœ¨ä¼šè‡ªåŠ¨å…ˆä»æŒ‡å®šçš„ xmake_modules ç›®å½•ä¸‹æŸ¥æ‰¾æ˜¯å¦å­˜åœ¨ mymod.lua æ¨¡å—æ–‡ä»¶ï¼Œå¦‚æœæœ‰å°±ä¼šåŠ è½½è¿›æ¥ã€‚\næ‰§è¡Œ xmake -r å‘½ä»¤ï¼Œå¯ä»¥çœ‹åˆ°æ¨¡å—çš„æ‰§è¡Œæ•ˆæœä¹Ÿè·Ÿä¹‹å‰å®Œå…¨ä¸€æ ·ï¼Œä¹Ÿæ­£å¸¸è¾“å‡ºäº†å¯¹åº”çš„ä¿¡æ¯ã€‚\nåœ¨ç‹¬ç«‹æ¨¡å—æ–‡ä»¶ä¸­å¯¼å…¥ æˆ‘ä»¬ä¸ä»…å¯ä»¥åœ¨ after_build ç­‰è‡ªå®šä¹‰è„šæœ¬ä¸­è¿›è¡Œæ¨¡å—å¯¼å…¥ï¼Œè¿˜å¯ä»¥åœ¨ä»»æ„çš„æ¨¡å—è„šæœ¬æ–‡ä»¶ä¸­ä½¿ç”¨ import æ¥ç»§ç»­å¯¼å…¥å…¶å®ƒæ¨¡å—ã€‚è¿˜æ˜¯æ‹¿ä¹‹å‰çš„ mymod.lua æ¨¡å—æ–‡ä»¶ä¸ºä¾‹ï¼Œæˆ‘ä»¬ç»§ç»­ä¿®æ”¹å®Œå–„å®ƒã€‚\nimport(\u0026quot;lib.detect.find_tool\u0026quot;)\rfunction hello(str)\rprint(\u0026quot;mymod: %s\u0026quot;, str)\rprint(find_tool(\u0026quot;gcc\u0026quot;))\rend\r ç”±äºæ˜¯åœ¨ç‹¬ç«‹çš„è„šæœ¬æ–‡ä»¶ä¸­ï¼Œå› æ­¤ import å¯¼å…¥è°ƒç”¨æ²¡å¿…è¦æ”¾ç½®åœ¨ function å†…éƒ¨ï¼Œä»…éœ€è¦æ”¾ç½®åˆ°æ–‡ä»¶æœ€å¼€å¤´å³å¯ã€‚è¿™æ ·ï¼Œå½“å‰æ–‡ä»¶å†…æ‰€æœ‰çš„å‡½æ•°å®ç°éƒ½å¯ä»¥è®¿é—®åˆ°è¢«å¯¼å…¥çš„æ¨¡å—ã€‚\nè¿™é‡Œï¼Œæˆ‘ä»¬å¯¼å…¥äº† lib.detect.find_tool æ¨¡å—ï¼Œç”¨æ¥æ¢æµ‹å½“å‰ç¯å¢ƒä¸‹çš„ gcc å‘½ä»¤æ˜¯å¦å­˜åœ¨ï¼Œä»¥åŠå¯¹åº”çš„è·¯å¾„ä¿¡æ¯ã€‚\nç”±äºå®éªŒç¯å¢ƒå·²ç»å®‰è£…äº† gccï¼Œå› æ­¤å¦‚æœæˆ‘ä»¬ç»§ç»­æ‰§è¡Œ xmake -r å‘½ä»¤ï¼Œåº”è¯¥ä¼šçœ‹åˆ°ä¸‹å›¾çš„è¾“å‡ºä¿¡æ¯ã€‚\nå¯¼å…¥ä½œä¸ºå‡½æ•°æ¥å£ä½¿ç”¨ é™¤äº†å¯ä»¥è°ƒç”¨å¯¼å…¥æ¨¡å—çš„æ¥å£ä¹‹å¤–ï¼Œå…¶å®è¿˜å¯ä»¥å°†è¢«å¯¼å…¥çš„æ¨¡å—ä½œä¸ºå‡½æ•°æ¥è°ƒç”¨ï¼Œä¾‹å¦‚ mymod(\u0026quot;xx\u0026quot;) ç›¸å½“äºé€šè¿‡ import å¯¼å…¥äº†ä¸€ä¸ªæ¥å£å‡½æ•°ã€‚\nè¿™é€šå¸¸ä¹Ÿæ˜¯éå¸¸æœ‰ç”¨çš„ï¼Œä¸è¿‡ä¸ºäº†æ”¯æŒè¿™ç§æ–¹å¼è°ƒç”¨ï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹ mymod.lua æ–‡ä»¶ï¼Œåœ¨é‡Œé¢æä¾›ä¸€ä¸ª main() çš„å…¥å£å‡½æ•°æ‰è¡Œï¼Œimport æ¥å£ä¼šåˆ¤æ–­åŠ è½½çš„æ¨¡å—æ˜¯å¦å­˜åœ¨ main å…¥å£ï¼Œå¦‚æœå­˜åœ¨å°±å¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼è°ƒç”¨æˆ‘ä»¬å¯¼å…¥çš„æ¨¡å—ã€‚\nä¿®æ”¹ mymod.lua ä¸­çš„ä»£ç ï¼ŒåŠ ä¸Š main å…¥å£ã€‚\nimport(\u0026quot;lib.detect.find_tool\u0026quot;)\rfunction _hello(str)\rprint(\u0026quot;mymod: %s\u0026quot;, str)\rprint(find_tool(\u0026quot;gcc\u0026quot;))\rend\rfunction main(str)\r_hello(str)\rend\r è¿™é‡Œï¼Œæˆ‘ä»¬è¿˜æŠŠ hello() é‡å‘½åæˆäº† _hello()ï¼Œè¿™æ˜¯å¯é€‰çš„æ“ä½œï¼Œåªä¸è¿‡å¸¦ä¸‹åˆ’çº¿å‰ç¼€åï¼Œ_hello å°±ä¼šè¢«å½“åšç§æœ‰æ¥å£ï¼Œä¸å‚ä¸å¯¼å‡ºï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬æ— æ³•å†ç›´æ¥è°ƒç”¨ mymod._hello() äº†ã€‚\næ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å†æ¥ç¨å¾®æ”¹åŠ¨ä¸‹ xmake.luaï¼Œæ”¹æˆå‡½æ•°å¼è°ƒç”¨ã€‚\nadd_moduledirs(\u0026quot;xmake_modules\u0026quot;)\rtarget(\u0026quot;import_test\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\rafter_build(function (target)\rimport(\u0026quot;mymod\u0026quot;)\rmymod(\u0026quot;xmake\u0026quot;) -- æ­¤å¤„å˜æˆç›´æ¥å‡½æ•°è°ƒç”¨\rend)\r å¯ä»¥çœ‹åˆ°ä¸Šé¢çš„é…ç½®ä¸­ï¼Œæˆ‘ä»¬ä¸å†æ˜¯è°ƒç”¨ mymod.hello() äº†ï¼Œè€Œæ˜¯æ”¹æˆäº† mymod() ä½œä¸ºå‡½æ•°æ¥å£æ¥ç›´æ¥è°ƒç”¨ï¼Œå…¶å®ƒåœ°æ–¹æ²¡æœ‰ä»»ä½•å˜åŒ–ã€‚\næ‰§è¡Œ xmake -r æŸ¥çœ‹ç»“æœï¼Œå¦‚æœè¿è¡Œæ­£å¸¸ï¼Œåº”è¯¥è·Ÿä¹‹å‰ä¸€æ ·çš„è¾“å‡ºç»“æœã€‚\nå¯¼å…¥æ¨¡å—åŒ…å’Œåˆ«å ä¹‹å‰æˆ‘ä»¬éƒ½æ˜¯å†™å…¨äº†å®Œæ•´æ¨¡å—è·¯å¾„æ¥å¯¼å…¥æŒ‡å®šæ¨¡å—ï¼Œå…¶å®æ¯ä¸ª . ä¹‹å‰çš„åç§°å°±æ˜¯æ¨¡å—æ‰€å±çš„çˆ¶ç›®å½•ï¼Œæ¯ä¸€çº§å¯¹åº”ä¸€å±‚å­ç›®å½•ã€‚æ¯”å¦‚ï¼šcore.project.config å…¶å®å°±æ˜¯å¯¹åº”çš„ moduledir/core/project/config.luaã€‚\nè€Œæ¯çº§çš„å­ç›®å½•åœ¨ import ä¸­ç§°ä¹‹ä¸ºåŒ…åï¼Œé‡Œé¢å¯ä»¥åŒ…å«å¾ˆå¤šçš„æ¨¡å—ï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥é€šè¿‡ import å¯¼å…¥æ•´ä¸ªåŒ…ï¼Œè€Œä¸æ˜¯å•ä¸ªæ¨¡å—ï¼Œä¾‹å¦‚ä¿®æ”¹ mymod.luaã€‚\nimport(\u0026quot;lib.detect\u0026quot;, {alias = \u0026quot;lib_detect\u0026quot;})\rfunction _hello(str)\rprint(\u0026quot;mymod: %s\u0026quot;, str)\rprint(lib_detect.find_tool(\u0026quot;gcc\u0026quot;))\rend\rfunction main(str)\r_hello(str)\rend\r è¿™é‡Œï¼Œæˆ‘ä»¬ä»…ä»…é€šè¿‡ import å¯¼å…¥äº†æ•´ä¸ª lib.detect åŒ…ï¼Œç„¶åé€šè¿‡æ‰©å±•å‚æ•° {alias = \u0026quot;lib_detect\u0026quot;} å¯¹å¯¼å…¥çš„åŒ…å–äº†ä¸€ä¸ªåˆ«å lib_detectï¼Œè¿™ä¸ªå‚æ•°æ˜¯å¯é€‰çš„ï¼Œä»…ä»…æ˜¯ä¸ºäº†é¿å…ä½œç”¨åŸŸå†…ä¸å˜é‡é‡åï¼Œå¯¼è‡´å†²çªã€‚\nç„¶åï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ lib_detect.find_tool æ–¹å¼ï¼Œå°†è¿™ä¸ªåŒ…ä½œä¸ºä¸€ä¸ªæ¨¡å—ï¼Œè°ƒç”¨é‡Œé¢çš„ find_tool.lua æ¨¡å—æ¥å£ã€‚å½“ç„¶ä¹Ÿå¯ä»¥åªå¯¼å…¥ lib åŒ…ï¼Œç„¶åè°ƒç”¨ lib.detect.find_tool()ã€‚\næœ€åæ‰§è¡Œ xmake -rï¼Œè¾“å‡ºç»“æœåº”è¯¥è·Ÿä¹‹å‰å®Œå…¨ä¸€æ ·ã€‚\nå®éªŒæ€»ç»“ åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬ä¸»è¦äº†è§£äº† xmake é‡Œé¢æ¨¡å—çš„æ¦‚å¿µï¼Œå¹¶å­¦ä¹ äº†å¦‚ä½•å»ä½¿ç”¨ import æ¥å£å¯¼å…¥ xmake æä¾›çš„å„ç§å†…ç½®æ‰©å±•æ¨¡å—ï¼Œä»¥åŠå¦‚ä½•å»å¯¼å…¥ç”¨æˆ·è‡ªå·±çš„æ‰©å±•æ¨¡å—ã€‚\næœ¬å®éªŒçš„å‚è€ƒä»£ç å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ä¸‹è½½ï¼š\nwget https://labfile.oss.aliyuncs.com/courses/2764/code15.zip\r ","id":52,"section":"categories","summary":"æ‰©å±•æ¨¡å—å¯¼å…¥å’Œä½¿ç”¨ åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬å°†ä¼šå­¦ä¹ åˆ° xmake ä¸­æ¨¡å—çš„åŸºæœ¬æ¦‚å¿µå’Œç§ç±»ï¼Œå¹¶ä¸”è¿˜ä¼šå­¦åˆ°å¦‚ä½•åœ¨é¡¹ç›®é…ç½®ä¸­é€šè¿‡ import å»å¯¼å…¥å’Œä½¿ç”¨å†…éƒ¨æ‰©å±•æ¨¡å—ï¼Œä»¥åŠç”¨æˆ·","tags":["xmake"],"title":"å®éªŒ15æ‰©å±•æ¨¡å—å¯¼å…¥å’Œä½¿ç”¨","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/app/xmake/%E8%93%9D%E6%A1%A5%E7%BD%91%E8%AF%BE/3xmake%E8%BF%9B%E9%98%B6/%E5%AE%9E%E9%AA%8C15%E6%89%A9%E5%B1%95%E6%A8%A1%E5%9D%97%E5%AF%BC%E5%85%A5%E5%92%8C%E4%BD%BF%E7%94%A8/","year":"2021"},{"content":"ioè¯»å†™ åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å­¦ä¹ åˆ° xmake å†…ç½®çš„ io æ¨¡å—çš„åŸºæœ¬æ“ä½œï¼Œä¾‹å¦‚æ–‡ä»¶æ•°æ®çš„å¿«é€Ÿè¯»å†™å’Œåºåˆ—åŒ–ï¼Œè¿˜èƒ½æ›´æ·±å…¥åœ°å­¦ä¹ å¦‚ä½•ä½¿ç”¨ print æ¥å£æ¥å®ç°æ‰“å°è¾“å‡ºï¼Œä»¥åŠåœ¨ç»ˆç«¯ä¸Šè·å–ç”¨æˆ·çš„è¾“å…¥å†…å®¹ã€‚\nçŸ¥è¯†ç‚¹  io æ¨¡å—çš„ä»‹ç»å’ŒåŸºæœ¬ä½¿ç”¨ æ–‡ä»¶æ•°æ®çš„è¯»å†™å’Œåºåˆ—åŒ– æ ‡å‡†è¾“å…¥è¾“å‡ºçš„è¯»å†™ï¼Œç”¨æˆ·è¾“å…¥çš„è·å–  io æ¨¡å—ä»‹ç» åœ¨è‡ªå®šä¹‰è„šæœ¬ä¸­ï¼Œé™¤äº† os æ¨¡å—å¯¹åº”çš„ç³»ç»Ÿæ“ä½œä¹‹å¤–ï¼Œè¿˜æœ‰æ–‡ä»¶ io æ“ä½œä¹Ÿæ˜¯æˆ‘ä»¬ç»å¸¸éœ€è¦ä½¿ç”¨çš„ï¼Œæ¯”å¦‚è¯»å†™æ–‡ä»¶æ•°æ®ç­‰ç­‰ã€‚è€Œ xmake å†…éƒ¨æä¾›çš„ io æ¨¡å—æ˜¯åœ¨ lua åŸç”Ÿæ¨¡å—çš„åŸºç¡€ä¸Šåšäº†ä¸€äº›æ”¹è¿›ï¼Œæ¯”å¦‚æ–°å¢äº†åºåˆ—åŒ–è¯»å†™æ¥å£ï¼Œæ–‡ä»¶é”æ¥å£ç­‰ç­‰ï¼Œå¦å¤–è¿˜å¯¹ unicode ç¼–ç ä¹Ÿè¿›è¡Œäº†å¾ˆå¥½çš„æ”¯æŒã€‚\næ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä¼šé€ä¸€ä»‹ç»ä¸‹ io æ¨¡å—ä¸­ä¸€äº›æ¯”è¾ƒå¸¸ç”¨çš„æ¥å£æ˜¯å¦‚ä½•ä½¿ç”¨çš„ã€‚\nè¯»å†™æ•°æ®åˆ°æ–‡ä»¶ æˆ‘ä»¬å…ˆæ¥ç®€å•ä»‹ç»ä¸‹ io æ¨¡å—ä¸­æœ€ç®€å•æ–¹ä¾¿åœ°è¯»å†™æ–‡ä»¶æ•°æ®çš„æ¥å£æ“ä½œï¼Œä¸è¿‡åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬è¿˜æ˜¯å…ˆæ¥åˆ›å»ºä¸€ä¸ªç”¨äºå½“å‰å®éªŒæ“ä½œçš„ç©ºå·¥ç¨‹ã€‚\ncd Code\rxmake create iotest\r å·¥ç¨‹åˆ›å»ºå®Œæˆåï¼Œè¿›å…¥ iotest æ–‡ä»¶å¤¹ï¼Œç„¶åç¼–è¾‘ xmake.lua æ–‡ä»¶ï¼Œåœ¨ç¼–è¯‘å‰é€šè¿‡ io æ¨¡å—è¯»å†™ src/main.cpp æºæ–‡ä»¶ï¼Œå¹¶åšä¸€äº›æ–‡æœ¬æ›¿æ¢å¤„ç†ï¼Œç„¶åé‡æ–°å†™å›åå†è¿›è¡Œç¼–è¯‘ã€‚\ntarget(\u0026quot;iotest\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\rbefore_build_file(function (target, sourcefile)\rlocal data = io.readfile(sourcefile)\rif data then\rprint(\u0026quot;readfile\u0026quot;, data)\rdata = data:gsub(\u0026quot;world\u0026quot;, \u0026quot;xmake\u0026quot;)\rio.writefile(sourcefile, data)\rprint(\u0026quot;writefile\u0026quot;, data)\rend\rend)\r è¿™é‡Œæˆ‘ä»¬ç”¨åˆ°äº† io.readfile å’Œ io.writefile ä¸¤ä¸ªæ¥å£æ¥å¿«é€Ÿçš„è¯»å†™æŒ‡å®šçš„æ–‡ä»¶ï¼Œè¿™ä¸¤ä¸ªæ¥å£å¹¶ä¸æ˜¯ lua åŸç”Ÿæä¾›çš„æ¥å£ï¼Œè€Œæ˜¯ xmake ä¸ºäº†æ–¹ä¾¿ io æ“ä½œï¼Œé¢å¤–å°è£…çš„æ¥å£ï¼Œå¯ä»¥è®©å¤§å®¶ä¸å¿…è‡ªå·±å» open å’Œ close æ–‡ä»¶ï¼Œå°±èƒ½å¿«é€Ÿè¯»å†™æ–‡ä»¶æ•°æ®ï¼Œéå¸¸çš„å®ç”¨ã€‚\né€šè¿‡æ‰§è¡Œ xmake ç¼–è¯‘ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°ä¸‹å›¾çš„æ•°æ®å†…å®¹ï¼Œå¦å¤– main.cpp ä¸­çš„ world å­—ç¬¦ä¸²ä¹Ÿç¡®å®è¢«æ›¿æ¢æˆäº† xmake å­—ç¬¦ä¸²ã€‚\nè¿è¡Œ xmake run ç»§ç»­ç¡®è®¤ä¸‹è¾“å‡ºç»“æœæ˜¯å¦çœŸçš„è¢«æ”¹å†™ä¸º hello xmake!ï¼Œå¦‚ä¸‹å›¾ã€‚\nå½“ç„¶é™¤äº†å¿«é€Ÿè¯»å†™ï¼Œè¿˜å¯ä»¥ä½¿ç”¨åŸç”Ÿçš„ io.open æ¥å£æ¥è¯»å†™æ–‡ä»¶ï¼Œè™½ç„¶è¿™æ ·ä½¿ç”¨èµ·æ¥ç¨å¾®ç¹çäº›ï¼Œä½†ä¹Ÿæ˜¯æœ‰ä¸€äº›ä¸å¯æ›¿ä»£çš„ä¼˜åŠ¿ï¼Œæ¯”å¦‚å¯¹å¤§æ–‡ä»¶çš„è¯»å†™æ€§èƒ½ä¼šéå¸¸çš„å¥½ï¼Œæ¯•ç«Ÿ io.readfile éœ€è¦ä¸€æ¬¡æ€§åŠ è½½åˆ°å†…å­˜ï¼Œè€Œé€šè¿‡ open åè¿”å›çš„æ–‡ä»¶å¯¹è±¡å»è¯»å†™å¯ä»¥æŒ‰è¡Œè¯»ä»¥åŠåˆ†æ‰¹å†™å…¥ï¼Œæå¤§åœ°å‡å°‘å†…å­˜ä½¿ç”¨ã€‚\nå¦å¤–ï¼Œè¿™æ ·çš„è¯»å†™æ–¹å¼ä¹Ÿæ›´åŠ çš„çµæ´»ï¼Œæˆ‘ä»¬ä¿®æ”¹ xmake.lua æ–‡ä»¶ï¼Œå°†é‡Œé¢çš„è¯»å†™æ–¹å¼æ”¹æˆä½¿ç”¨ io.open çš„åŸç”Ÿæ¥å£ã€‚\ntarget(\u0026quot;iotest\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\rbefore_build_file(function (target, sourcefile)\rlocal tmpfile = os.tmpfile()\rlocal ifile = io.open(sourcefile, 'r')\rlocal ofile = io.open(tmpfile, 'w')\rfor line in ifile:lines() do\rline = line:gsub(\u0026quot;xmake\u0026quot;, \u0026quot;world\u0026quot;)\rofile:print(\u0026quot;%s\u0026quot;, line)\rend\rifile:close()\rofile:close()\ros.cp(tmpfile, sourcefile)\ros.rm(tmpfile)\rend)\r è¿™å›ï¼Œæˆ‘ä»¬çš„è„šæœ¬ç›¸æ¯”ä¹‹å‰å°±ç¨æ˜¾å¤æ‚äº†ï¼Œæˆ‘ä»¬å…ˆæ˜¯é€šè¿‡ io.open åˆ†åˆ«æŒ‰åªè¯»æ¨¡å¼ rã€åªå†™æ¨¡å¼ w æ‰“å¼€ä¸¤ä¸ªæ–‡ä»¶ï¼Œç„¶åé€šè¿‡ ifile:lines() æ¥å£æŒ‰è¡Œè¯»å–æºæ–‡ä»¶ï¼Œç„¶ååšå­—ç¬¦ä¸²æ›¿æ¢ï¼Œé€šè¿‡ ofile:print() æ¥å£æ ¼å¼åŒ–å†™å…¥ os.tmpfile() åˆ›å»ºçš„ä¸´æ—¶æ–‡ä»¶ä¸­å»ã€‚\nåœ¨è„šæœ¬çš„æœ€åï¼Œæˆ‘ä»¬é€šè¿‡ä¹‹å‰ä»‹ç»è¿‡çš„ os.cp å’Œ os.rm æ¥å£å°†æ–‡ä»¶è¦†ç›–å› sourcefileã€‚\nç”±äºåˆšåˆšæˆ‘ä»¬æŠŠ main.cpp ä¸­çš„ world å­—ç¬¦ä¸²æ›¿æ¢æˆäº† xmakeï¼Œè¿™é‡Œåˆé‡æ–°æ›¿æ¢å›äº† worldã€‚é¦–å…ˆæ‰§è¡Œ xmake ç¼–è¯‘é€šè¿‡ï¼Œç„¶åè¿è¡Œ xmake run ç¡®è®¤ä¸‹æœ€ç»ˆçš„æ›¿æ¢ç»“æœã€‚\nåºåˆ—åŒ–å’Œååºåˆ—åŒ– ä¸Šé¢ä»‹ç»çš„æ–‡ä»¶è¯»å†™æ¥å£ï¼Œéƒ½æ˜¯é’ˆå¯¹å­—ç¬¦ä¸²æ•°æ®çš„è¯»å†™æ“ä½œï¼Œç„¶è€Œæœ‰æ—¶å€™æˆ‘ä»¬åœ¨è¯»å†™æ•°æ®æ—¶ï¼Œè¿˜æƒ³é¢å¤–çš„è§£æå…¶ä¸­çš„æ•°æ®ç»“æ„ã€‚å¦‚æœç›´æ¥ä»å­—ç¬¦ä¸²è§£æä¼šéå¸¸ç¹çï¼Œå¯¼è‡´æ•´ä¸ªé…ç½®è„šæœ¬å¯è¯»æ€§å¾ˆå·®ä¹Ÿä¸æ–¹ä¾¿ç»´æŠ¤ã€‚\nå› æ­¤ï¼Œxmake æ‰©å±•äº† io æ¨¡å—ï¼Œæ–°å¢äº† io.load å’Œ io.save ä¸¤ä¸ªè¯»å†™æ¥å£ï¼Œä¸“é—¨ç”¨æ¥å¿«é€Ÿçš„åºåˆ—åŒ–å­˜å‚¨ lua å¯¹è±¡åˆ°æ–‡ä»¶ï¼Œä»¥åŠç›´æ¥åŠ è½½è¢«åºåˆ—åŒ–åçš„æ–‡ä»¶åˆ° lua å¯¹è±¡ã€‚\nè¿™é‡Œæ‰€è°“çš„ lua å¯¹è±¡ï¼Œå…¶å®å°±æ˜¯è„šæœ¬ä¸­æ‰€æœ‰åŸºç¡€ lua å˜é‡ç±»å‹ï¼Œæ¯”å¦‚ï¼šstringã€tableã€boolean å’Œ number ç­‰ï¼Œè€Œæˆ‘ä»¬é€šå¸¸éƒ½ä¼šå»ç›´æ¥åºåˆ—åŒ– table å¯¹è±¡ï¼Œè¿™æ˜¯ lua åŸç”Ÿçš„æ•°æ®ç±»å‹ï¼Œå®ƒå¯ä»¥æ˜¯å­—å…¸ç±»å‹ä¹Ÿå¯ä»¥æ˜¯æ•°ç»„ç±»å‹ï¼Œä¾‹å¦‚ï¼š{1, 2, 3, a = 1}ã€‚\né€šå¸¸ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¯¹è±¡çš„åºåˆ—åŒ–å­˜å‚¨æ¥å®ç°ä¸€äº›åœ¨æ„å»ºè¿‡ç¨‹ä¸­å¯¹ä¸€äº›é…ç½®ã€çŠ¶æ€ä¿¡æ¯çš„ç¼“å­˜å’ŒåŠ è½½åŠŸèƒ½ã€‚æ¯”å¦‚ï¼Œåœ¨ target çš„ before_build è„šæœ¬å†…ç¼“å­˜å½“å‰ç›®æ ‡ç¨‹åºçš„æºæ–‡ä»¶åˆ—è¡¨ï¼Œç„¶ååœ¨ after_build è„šæœ¬ä¸­å»åŠ è½½æ˜¾ç¤ºå‡ºæ¥ã€‚\nä¿®æ”¹ xmake.lua æ–‡ä»¶ä¸ºå¦‚ä¸‹å†…å®¹ã€‚\ntarget(\u0026quot;iotest\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\rbefore_build(function (target)\rio.save(\u0026quot;$(buildir)/sourcefiles\u0026quot;, {sourcefiles = target:sourcefiles()})\rend)\rafter_build(function (target)\rlocal sourcefiles = io.load(\u0026quot;$(buildir)/sourcefiles\u0026quot;)\rprint(sourcefiles)\rend)\r æˆ‘ä»¬æŠŠåºåˆ—åŒ–çš„æ•°æ®ä¿å­˜åœ¨ build/sourcefiles æ–‡ä»¶ä¸­ï¼Œæ‰§è¡Œå®Œ xmake ç¼–è¯‘åï¼Œæˆ‘ä»¬å°±é€šè¿‡ print å°† io.load åŠ è½½çš„æ•°æ®å¯¹è±¡æ•´ä¸ª dump äº†å‡ºæ¥ï¼Œå¹¶ä¿ç•™äº†åŸå§‹çš„æ•°æ®ç»“æ„ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚\nè·å–ç”¨æˆ·è¾“å…¥ å…³äº io æ“ä½œï¼Œé™¤äº†å¯¹äºæ–‡ä»¶çš„è¯»å†™ï¼Œæˆ‘ä»¬æœ‰æ—¶å€™è¿˜éœ€è¦è¯»å†™æ ‡å‡†è¾“å…¥è¾“å‡ºï¼Œä¹Ÿå°±æ˜¯ stdoutã€stdin è¿™äº›ï¼Œå…¶ä¸­ stdout å°±æ˜¯æˆ‘ä»¬é€šå¸¸ä½¿ç”¨ print æ¥å£åœ¨ç»ˆç«¯ä¸‹çš„è¾“å‡ºï¼Œå…¶å®ä¹Ÿå°±æ˜¯å†…éƒ¨å¯¹ io.print çš„å°è£…è°ƒç”¨ï¼Œè€Œå¦‚æœæˆ‘ä»¬è¦æ¥å—ç”¨æˆ·åœ¨ç»ˆç«¯ä¸‹è¾“å…¥ï¼Œå°±éœ€è¦é€šè¿‡ io.read å»è¯»å– stdin äº†ã€‚\nä¸ºäº†è·å–ç”¨æˆ·è¾“å…¥ï¼Œæˆ‘ä»¬ç»§ç»­æ”¹é€ ä¸‹ xmake.luaï¼Œé€šè¿‡åœ¨ç¼–è¯‘å‰æç¤ºç”¨æˆ·è¾“å…¥ y æ¥ç¡®è®¤æ˜¯å¦éœ€è¦ç»§ç»­ç¼–è¯‘ï¼Œå¦‚æœç”¨æˆ·è¾“å…¥äº†å…¶å®ƒå­—ç¬¦ï¼Œé‚£ä¹ˆå°±ç»ˆæ­¢ç¼–è¯‘ã€‚\ntarget(\u0026quot;iotest\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\rbefore_build(function (target)\rcprint(\u0026quot;please input: ${bright}y${clear} to continue building project (y/n)\u0026quot;)\rio.flush()\rlocal confirm = io.read()\rif confirm:trim() ~= 'y' then\rprint(\u0026quot;build abort!\u0026quot;)\ros.exit()\rend\rend)\r ä¸Šé¢çš„é…ç½®ä¸­ï¼Œåœ¨è¾“å…¥å‰ï¼Œæˆ‘ä»¬ä¼šå…ˆæ‰“å°ä¸€äº›æç¤ºä¿¡æ¯æ¥æç¤ºç”¨æˆ·è¾“å…¥ï¼Œç„¶åè°ƒç”¨ io.flush åˆ·æ–°ä¸‹ä¹‹å‰å·²æœ‰çš„è¾“å…¥ç¼“å­˜åï¼Œå°±å¯ä»¥é€šè¿‡ io.read() æ¥å—ç»ˆç«¯çš„è¾“å…¥æ•°æ®äº†ã€‚\nç›´åˆ°ç”¨æˆ·è¾“å…¥å®Œæ¯•æŒ‰ä¸‹å›è½¦ï¼Œconfirm å˜é‡ä¸­å°±ä¼šå­˜å‚¨å®é™…çš„è¾“å…¥ç»“æœï¼Œæ ¹æ®è¿™é‡Œé¢çš„å†…å®¹åˆ¤æ–­ç”¨æˆ·æ˜¯å¦è¾“å…¥äº† y å­—ç¬¦ã€‚å¦‚æœç¡®å®æ˜¯ y é‚£ä¹ˆ xmake å°±ä¼šç»§ç»­å®Œæˆç¼–è¯‘ï¼Œè€Œå¦‚æœä¸æ˜¯ï¼Œé‚£ä¹ˆå°±ä¼šè°ƒç”¨åˆ°é…ç½®é‡Œé¢çš„ os.exit æ¥å£ï¼Œå¼ºåˆ¶ä¸­æ–­æ•´ä¸ª xmake å‘½ä»¤çš„æ‰§è¡Œã€‚\nå¤§æ¦‚çš„è¾“å…¥æç¤ºå†…å®¹å¦‚ä¸‹ã€‚\n$ please input: y to continue building project (y/n)\r# ç­‰å¾…ç”¨æˆ·è¾“å…¥\r å¦‚æœæ‰§è¡Œ xmake -r å‘½ä»¤ï¼Œç­‰åˆ°æ¥å—è¾“å…¥åï¼Œè¾“å…¥ yï¼Œå¯ä»¥çœ‹åˆ°æ•´ä¸ªç¼–è¯‘ç»§ç»­æ­£å¸¸å®Œæˆäº†ã€‚\nè€Œå¦‚æœè¾“å…¥ nï¼Œç¼–è¯‘è¿‡ç¨‹å°±è¢«ä¸­æ–­äº†ã€‚\næ‰“å°æ ‡å‡†è¾“å‡º æ—¢ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ io.read() æ¥è¯»å–ç”¨æˆ·è¾“å…¥ï¼Œé‚£ä¹ˆä¹Ÿå¯ä»¥é€šè¿‡ io.write() æ¥æ˜¾ç¤ºè¾“å‡ºåˆ°ç»ˆç«¯ï¼Œä¸è¿‡é€šå¸¸ä¸éœ€è¦ç›´æ¥ä½¿ç”¨è¿™ä¸ªæ¥å£ï¼Œå¯ä»¥ä½¿ç”¨ xmake æä¾›çš„ print() æ¥å£æ‰“å°è¾“å‡ºã€‚\nå®ƒä»¬çš„åŒºåˆ«åœ¨äºï¼Œæˆ‘ä»¬æ‰©å±•äº† lua åŸç”Ÿçš„ print æ¥å£ï¼Œä½¿å…¶æ‹¥æœ‰æ›´åŠ å¼ºå¤§çš„è¾“å‡ºåŠŸèƒ½ï¼Œå¯ä»¥åŒæ—¶æ”¯æŒæ ¼å¼åŒ–è¾“å‡ºã€å¯¹è±¡åºåˆ—åŒ–è¾“å‡ºï¼Œè‡ªåŠ¨æ¢è¡Œç­‰ç‰¹æ€§ã€‚è€Œ io.write ä»…ä»…åªèƒ½æ˜¾ç¤ºåŸå§‹çš„å­—ç¬¦ä¸²æ•°æ®åˆ°ç»ˆç«¯ã€‚\nå› æ­¤è¿™é‡Œæˆ‘ä»¬é‡ç‚¹è®²è§£ print æ¥å£çš„ä½¿ç”¨ï¼Œè¿™åœ¨è‡ªå®šä¹‰è„šæœ¬ä¸­é€šè¿‡æ‰“å°æ¥è°ƒè¯•é…ç½®è„šæœ¬æ—¶æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚\né¦–å…ˆï¼Œæˆ‘ä»¬å…ˆæ¥å°è¯•ä¸‹æ ¼å¼åŒ–è¾“å‡ºæ˜¾ç¤ºå­—ç¬¦ä¸²ä¿¡æ¯ï¼Œå…¶ä¼ å‚æ ¼å¼å’Œç”¨æ³•åŸºæœ¬ä¸Šè·Ÿ C/C++ é‡Œé¢çš„ printf å‡½æ•°å®Œå…¨ä¸€è‡´ï¼ŒåŒæ ·æ”¯æŒ %sã€%d ç­‰æ ¼å¼åŒ–å‚æ•°ã€‚\nä¿®æ”¹ xmake.lua æ–‡ä»¶ï¼Œåœ¨é‡Œé¢çš„ on_load() é˜¶æ®µçš„è„šæœ¬ä¸­æ‰“å°ä¸€äº›æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¿¡æ¯ã€‚\ntarget(\u0026quot;iotest\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\radd_defines(\u0026quot;TEST\u0026quot;)\radd_syslinks(\u0026quot;pthread\u0026quot;, \u0026quot;dl\u0026quot;, \u0026quot;m\u0026quot;)\ron_load(function (target)\rprint(\u0026quot;defines: %s\u0026quot;, target:get(\u0026quot;defines\u0026quot;))\rprint(\u0026quot;syslinks: %s\u0026quot;, target:get(\u0026quot;syslinks\u0026quot;))\rend)\r è¿™é‡Œï¼Œæˆ‘ä»¬é€šè¿‡ target:get() æ¥å£è·å–äº†å½“å‰ target ç¨‹åºçš„ä¸€äº›æè¿°åŸŸé…ç½®ä¿¡æ¯ï¼Œç„¶åé€šè¿‡ print çš„ %s æ ¼å¼åŒ–å‚æ•°ä½œä¸ºå­—ç¬¦ä¸²æ‰“å°å‡ºæ¥ã€‚\nç„¶åæ‰§è¡Œ xmake æŸ¥çœ‹ target åŠ è½½å®Œæˆåï¼Œå®é™…æ‰“å°è¾“å‡ºäº†å“ªäº›ä¿¡æ¯ã€‚\nä»ä¸Šå›¾ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ° defines ä¿¡æ¯è¢«æ­£å¸¸è¾“å‡ºæ˜¾ç¤ºäº†ï¼Œä½†æ˜¯ syslinks çš„é…ç½®ä¿¡æ¯ä»…ä»…æ˜¾ç¤ºäº† table: 0x405578f0 å­—æ ·ï¼Œçœ‹ä¸å‡ºå…·ä½“æœ‰å“ªäº›é…ç½®ã€‚\nè¿™æ˜¯å› ä¸ºæˆ‘ä»¬ç»™ syslinks è®¾ç½®äº†å¤šä¸ªé“¾æ¥åº“ï¼Œæ‰€ä»¥å®ƒå½“å‰çš„æ•°æ®ç±»å‹å…¶å®æ˜¯ array å¯¹è±¡ï¼ˆåœ¨ lua ä¹Ÿå°±æ˜¯ table ç±»å‹ï¼‰ã€‚\nå¦‚æœè¦å°†å…¶æ­£å¸¸è¾“å‡ºï¼Œè¿˜æ˜¯å¯ä»¥ç”¨ printï¼Œä¸è¿‡å°±ä¸èƒ½é€šè¿‡æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„æ–¹å¼è¾“å‡ºäº†ï¼Œè€Œæ˜¯ç›´æ¥å»æ‰“å°å®ƒã€‚ç»§ç»­ä¿®æ”¹åˆšæ‰çš„é…ç½®ã€‚\ntarget(\u0026quot;iotest\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\radd_defines(\u0026quot;TEST\u0026quot;)\radd_syslinks(\u0026quot;pthread\u0026quot;, \u0026quot;dl\u0026quot;, \u0026quot;m\u0026quot;)\ron_load(function (target)\rprint(\u0026quot;defines: %s\u0026quot;, target:get(\u0026quot;defines\u0026quot;))\rprint(\u0026quot;syslinks:\u0026quot;, target:get(\u0026quot;syslinks\u0026quot;))\rend)\r è¿™å›ï¼Œæˆ‘ä»¬æŠŠ syslinks: %s æ”¹æˆäº† syslinks:ï¼Œä¹Ÿå°±æ˜¯å»æ‰äº† %s çš„æ ¼å¼åŒ–å‚æ•°ï¼Œè¿™æ · print å°±ä¸ä¼šèµ°æ ¼å¼åŒ–æ¨¡å¼ï¼Œè€Œæ˜¯ç›´æ¥èµ° dump å¯¹è±¡æ¨¡å¼ã€‚å®ƒä¼šå®Œæ•´æ‰“å°æ•´ä¸ªå¯¹è±¡ç»“æ„ã€‚\næ‰§è¡Œ xmake æŸ¥çœ‹ç»“æœã€‚\næ³¨ï¼šè™½ç„¶åœ¨æè¿°åŸŸä¹Ÿå¯ä»¥è°ƒç”¨ printï¼Œä½†æ˜¯é€šå¸¸ä¸å»ºè®®è¿™ä¹ˆåšï¼Œå¦‚æœè¦è°ƒè¯•æ‰“å° target çš„é…ç½®ä¿¡æ¯ï¼Œè¯·å°½é‡åœ¨ on_load é‡Œé¢å®Œæˆã€‚\nåœ¨ç»ˆç«¯æ˜¾ç¤ºè‰²å½©æ–‡æœ¬ é™¤äº†ä½¿ç”¨ print è¿›è¡Œæ­£å¸¸çš„æ ¼å¼åŒ–æ‰“å°è¾“å‡ºï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ cprint æ¥æ˜¾ç¤ºè‰²å½©æ–‡æœ¬è¾“å‡ºï¼Œè€Œä¸”å½“å‰çš„ä¸»æµç»ˆç«¯éƒ½åŸºæœ¬ä¸Šå·²ç»å¯ä»¥æ”¯æŒ 16 è‰²çš„ color codes è¾“å‡ºäº†ã€‚\nå…³äºè¿™å—ï¼Œå¹¶ä¸æ˜¯æˆ‘ä»¬æ„å»ºé¡¹ç›®çš„é‡ç‚¹ï¼Œå› æ­¤åªéœ€è¦ç®€å•äº†è§£ä¸‹ç”¨æ³•å°±å¯ä»¥äº†ï¼Œè¿™ä¸ªæ¥å£æ”¯æŒå°†é¢œè‰²åç§°é€šè¿‡ ${red} çš„æ ¼å¼ä¼ å…¥ cprint æ¥å£ï¼Œå°±èƒ½å°†åé¢çš„å­—ç¬¦ä¸²æ–‡æœ¬ï¼ŒæŒ‰å‰é¢æŒ‡å®šçš„é¢œè‰²è¾“å‡ºã€‚\nè¿™é‡Œï¼Œæˆ‘ä»¬ç›´æ¥é€šè¿‡æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤æ¥å¿«é€Ÿè°ƒç”¨ cprint(\u0026quot;${red}hello ${green}xmake!\u0026quot;) è¾“å‡ºå¸¦æœ‰è‰²å½©çš„æ–‡æœ¬å­—ç¬¦ä¸²ã€‚\nxmake l cprint '${red}hello ${green}xmake!'\r æ‰§è¡Œåçš„æ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚\nxmake ä¸ä»…æ”¯æŒå¸¸ç”¨çš„ 16 è‰²è¾“å‡ºï¼Œè¿˜æ”¯æŒ 24 ä½è‰²é«˜å½©è¾“å‡ºä»¥åŠ emoji ç¬¦å·è¾“å‡ºï¼Œå…³äºè¿™å—è¯¦æƒ…ï¼Œå¯ä»¥çœ‹ä¸‹ç›¸å…³çš„æ–‡ç«  è‰²å½©é«˜äº®æ˜¾ç¤ºã€‚\nå®éªŒæ€»ç»“ åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•é€šè¿‡ io æ¨¡å—æ¥å£å»è¯»å†™æ–‡ä»¶æ•°æ®ï¼Œä»¥åŠå¦‚ä½•é€šè¿‡åºåˆ—åŒ–çš„æ–¹å¼è¯»å†™æ•°æ®ï¼Œå¦å¤–æˆ‘ä»¬è¿˜å­¦ä¹ åˆ°äº†å¦‚ä½•åœ¨ç»ˆç«¯ä¸Šè¾“å‡ºä¿¡æ¯ä»¥åŠè·å–ç”¨æˆ·çš„è¾“å…¥å†…å®¹ã€‚\næœ¬å®éªŒçš„å‚è€ƒä»£ç å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ä¸‹è½½ï¼š\nwget https://labfile.oss.aliyuncs.com/courses/2764/code14.zip\r ","id":53,"section":"categories","summary":"ioè¯»å†™ åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å­¦ä¹ åˆ° xmake å†…ç½®çš„ io æ¨¡å—çš„åŸºæœ¬æ“ä½œï¼Œä¾‹å¦‚æ–‡ä»¶æ•°æ®çš„å¿«é€Ÿè¯»å†™å’Œåºåˆ—åŒ–ï¼Œè¿˜èƒ½æ›´æ·±å…¥åœ°å­¦ä¹ å¦‚ä½•ä½¿ç”¨ print æ¥å£æ¥å®ç°æ‰“å°è¾“å‡ºï¼Œ","tags":["xmake"],"title":"å®éªŒ14ioè¯»å†™","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/app/xmake/%E8%93%9D%E6%A1%A5%E7%BD%91%E8%AF%BE/3xmake%E8%BF%9B%E9%98%B6/%E5%AE%9E%E9%AA%8C14io%E8%AF%BB%E5%86%99/","year":"2021"},{"content":"å®éªŒ13ç³»ç»Ÿæ“ä½œè¯¦è§£ åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å­¦ä¹ åˆ°å¦‚ä½•åœ¨è‡ªå®šä¹‰è„šæœ¬ä¸­å¯¹æ–‡ä»¶ç³»ç»Ÿæ“ä½œï¼Œä»¥åŠå¦‚ä½•å»æ‰§è¡Œå¤–éƒ¨ shell å‘½ä»¤ç¨‹åºå¹¶è·å–è¿è¡Œåçš„è¾“å‡ºå†…å®¹ã€‚\nçŸ¥è¯†ç‚¹  ç³»ç»Ÿ os æ¨¡å—æ¥å£çš„ä»‹ç»ä½¿ç”¨ æ–‡ä»¶å’Œç›®å½•æ“ä½œ å¤–éƒ¨å‘½ä»¤çš„æ‰§è¡Œ  osç³»ç»Ÿæ¨¡å—ä»‹ç» xmake æä¾›äº†å¾ˆå¤šçš„å†…ç½®æ¨¡å—å’Œæ¥å£ï¼Œå¯ä»¥è®©ç”¨æˆ·åœ¨è‡ªå®šä¹‰è„šæœ¬åŸŸä¸­éšæ„ä½¿ç”¨ï¼Œæ–¹ä¾¿ç”¨æˆ·å¤„ç†ç¼–è¯‘è¿‡ç¨‹ä¸­çš„å„ç§å®šåˆ¶åŒ–é€»è¾‘ã€‚å…¶ä¸­ï¼Œæˆ‘ä»¬å¤šå°‘ä¼šéœ€è¦æ¶‰åŠåˆ°ä¸€äº›ç³»ç»Ÿè°ƒç”¨ã€io æ“ä½œç­‰ã€‚\nå› ä¸ºè¿™äº›æ˜¯æœ€åŸºæœ¬ä¹Ÿæ˜¯æœ€å¸¸ç”¨çš„æ“ä½œæ¥å£ï¼Œè€Œ lua è¯­è¨€è‡ªèº«å°±æœ‰æä¾› os å’Œ io å†…ç½®æ¨¡å—å»å¤„ç†è¿™äº›ï¼Œä½†æ˜¯ lua è‡ªå¸¦çš„è¿™ä¸¤ä¸ªæ¨¡å—åŠŸèƒ½æœ‰é™ï¼Œä½¿ç”¨ä¹Ÿä¸æ˜¯å¾ˆæ–¹ä¾¿ï¼Œå¹¶ä¸”ä¹Ÿæ— æ³•æ»¡è¶³ç”¨æˆ·å¯¹ç¼–è¯‘çš„ä¸€äº›ç‰¹æ®Šéœ€æ±‚ã€‚å› æ­¤ xmake åœ¨æ­¤åŸºç¡€ä¸Šï¼Œåšäº†äº›æ‰©å±•å’Œæ”¹è¿›ï¼Œå°è£…äº†æ›´å¤šå¥½ç”¨çš„æ¥å£æä¾›ç»™å¤§å®¶ä½¿ç”¨ã€‚\nåœ¨æœ¬å®éªŒä¸­ï¼Œæˆ‘ä»¬é‡ç‚¹ä»‹ç»å¦‚ä½•ä½¿ç”¨ os ç³»ç»Ÿæ¨¡å—é‡Œé¢çš„å„ç§å¸¸ç”¨æ¥å£ã€‚\nå¤åˆ¶åˆ é™¤æ–‡ä»¶å’Œç›®å½• é¦–å…ˆæˆ‘ä»¬æ¥è®²è§£å¦‚ä½•ä½¿ç”¨ os æ¨¡å—å»å¤åˆ¶å’Œåˆ é™¤æŒ‡å®šçš„æ–‡ä»¶ä»¥åŠç›®å½•ã€‚\nå¯¹äºå¤åˆ¶æ–‡ä»¶ï¼Œxmake æä¾›äº†å†…ç½®çš„ os.cp(src, dst) æ¥å£ï¼Œå¯ä»¥ä»æºè·¯å¾„å¤åˆ¶åˆ°ç›®çš„è·¯å¾„ï¼ŒåŒæ—¶æ”¯æŒæ–‡ä»¶å’Œç›®å½•çš„å¤åˆ¶ï¼Œå¹¶ä¸”æ”¯æŒ * æ¥æ¨¡å¼åŒ¹é…ã€‚\nè€Œå¯¹äºåˆ é™¤æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ os.rm() æ¥å£ï¼Œå®ƒä¹ŸåŒæ—¶æ”¯æŒæ–‡ä»¶å’Œç›®å½•çš„åˆ é™¤ã€‚åœ¨å®éªŒå‰ï¼Œæˆ‘ä»¬è¿˜æ˜¯ä¸€æ ·ï¼Œå…ˆæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„ç©ºå·¥ç¨‹ã€‚\ncd ~/Code\rxmake create ostest\r æ¥ä¸‹æ¥è¿›å…¥ ostest ç›®å½•ï¼Œä¿®æ”¹ xmake.lua æ–‡ä»¶ï¼ŒåŠ å…¥å¯¹ os æ¨¡å—æ¥å£çš„è°ƒç”¨ï¼Œå…·ä½“ä¿®æ”¹å¦‚ä¸‹ã€‚\ntarget(\u0026quot;ostest\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\rafter_build(function (target)\ros.cp(target:targetfile(), \u0026quot;$(buildir)/test\u0026quot;)\ros.rm(target:targetfile())\rend)\r ä¸Šé¢çš„é…ç½®ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡åœ¨ after_build çš„è‡ªå®šä¹‰è„šæœ¬ä¸­ï¼Œé¢å¤–è°ƒç”¨ os.cp æ¥å£å°†ç¼–è¯‘å®Œæˆåç”Ÿæˆçš„ç›®æ ‡ç¨‹åºå¤åˆ¶åˆ° build/testï¼Œç„¶åè°ƒç”¨ os.rm åˆ é™¤äº†æºæ–‡ä»¶ï¼Œå®ç°äº†ç§»åŠ¨ç›®æ ‡ç¨‹åºè·¯å¾„çš„ç›®çš„ã€‚\nå½“ç„¶ï¼Œè¿™é‡Œåªæ˜¯å‡ºäºæ¼”ç¤ºç›®çš„ï¼Œå…¶å®è¦åšåˆ°è¿™ä¸ªéœ€æ±‚ï¼Œå¹¶ä¸éœ€è¦è¿™ä¹ˆå¤æ‚ï¼Œåªéœ€è¦è°ƒç”¨ os.mv æˆ–è€…ç›´æ¥ä½¿ç”¨ set_targetdir å»ä¿®æ”¹ç›®æ ‡è·¯å¾„æ›´åŠ çš„æ–¹ä¾¿çœäº‹ã€‚\nè€Œå¯¹äº os.cp ç­‰å¸¦æœ‰è·¯å¾„å‚æ•°çš„æ¥å£ï¼Œå®ƒä»¬ä¹Ÿå¯ä»¥åƒæè¿°åŸŸé…ç½®é‚£æ ·æ”¯æŒå°†å†…ç½®å˜é‡ $(buildir) ç›´æ¥åµŒå…¥å­—ç¬¦ä¸²ã€‚\næ‰§è¡Œ xmake å‘½ä»¤ï¼Œå¹¶é€šè¿‡ tree å‘½ä»¤çœ‹ä¸‹å®é™…ç”Ÿæˆçš„ç›®æ ‡è·¯å¾„ã€‚\nä»å›¾ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ° release ç›®å½•å·²ç»å˜æˆäº†ç©ºç›®å½•ï¼Œå› ä¸º test ç¨‹åºå·²ç»è¢«ç§»åŠ¨åˆ°äº† build ç›®å½•ä¸‹ã€‚\néå†è·å–æ–‡ä»¶å’Œç›®å½•åˆ—è¡¨ æ—¢ç„¶æœ‰äº†æ–‡ä»¶çš„å¤åˆ¶åˆ é™¤æ“ä½œï¼Œé‚£è‚¯å®šå°‘ä¸äº†æ–‡ä»¶çš„éå†æ“ä½œï¼Œè¿™ä¸ªä¹Ÿæ˜¯æˆ‘ä»¬ç»å¸¸éœ€è¦ç”¨åˆ°çš„æ¥å£ã€‚è€Œå…³äºæ–‡ä»¶éå†ï¼Œxmake å…¶å®æä¾›äº†ä¸‰ä¸ªæ¥å£æ¥åˆ†åˆ«å®ç°å„ç§ç²’åº¦çš„éå†ï¼Œä¸»è¦æœ‰å¦‚ä¸‹å‡ ä¸ªã€‚\n   éå†æ¥å£ æ¥å£è¯´æ˜     os.dirs éå†æ‰€æœ‰ç›®å½•   os.files éå†æ‰€æœ‰æ–‡ä»¶   os.filedirs éå†æ‰€æœ‰æ–‡ä»¶å’Œç›®å½•    è¿™ä¸‰ä¸ªæ¥å£é™¤äº†éå†è·å–çš„æ–‡ä»¶ç±»å‹æœ‰ä¸åŒå¤–ï¼Œå…¶ä¼ å‚æ¨¡å¼å’Œè¿”å›å€¼çš„å¤„ç†å®Œå…¨ç›¸åŒã€‚åŒæ ·éƒ½æ”¯æŒé€šé…ç¬¦çš„åŒ¹é…å’Œé€’å½’éå†ï¼Œç”šè‡³æ”¯æŒåœ¨éå†æ—¶æŒ‡å®šå¿½ç•¥ä¸€æ‰¹æ–‡ä»¶ã€‚\nå‚æ•°æ ¼å¼ä¹Ÿå®Œå…¨è·Ÿ add_files() ç›¸åŒï¼Œå› ä¸º add_files å†…éƒ¨å°±æ˜¯åŸºäºè¿™å‡ ä¸ªæ¥å£å®ç°çš„ã€‚\næˆ‘ä»¬å†æ¥æ”¹ä¸‹ xmake.lua æ–‡ä»¶ï¼Œåœ¨ç¼–è¯‘ä¹‹å‰å»éå† src ç›®å½•ï¼Œåœ¨å®Œæˆç¼–è¯‘ä¹‹åå»éå† build ç›®å½•ï¼Œä¾‹å¦‚ã€‚\ntarget(\u0026quot;ostest\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\rbefore_build(function (target)\rprint(os.filedirs(\u0026quot;src/*\u0026quot;))\rend)\rafter_build(function (target)\rfor _, filepath in ipairs(os.files(\u0026quot;$(buildir)/**\u0026quot;)) do\rprint(filepath)\rend\rend)\r ä¸Šé¢çš„é…ç½®ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ os.filedirs(\u0026quot;src/*\u0026quot;) å»éå† src ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼Œä½¿ç”¨ * é€šé…ç¬¦å¯ä»¥å®ç°ç›®å½•ä¸‹æ–‡ä»¶åçš„ä»»æ„åŒ¹é…ï¼Œè€Œ os.files(\u0026quot;$(buildir)/**\u0026quot;) åˆ™ä¼šé€šè¿‡ ** é€šé…ç¬¦æ¥å®ç°é€’å½’çš„æ¨¡å¼åŒ¹é…ã€‚\nå¦å¤–ï¼Œä½¿ç”¨ print å¯ä»¥ç›´æ¥æ‰“å°å‡ºè¿”å›çš„æ•´ä¸ªåˆ—è¡¨å†…å®¹ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ lua åŸç”Ÿæä¾›çš„ for/ipairs å»éå† os.files è¿”å›çš„ table åˆ—è¡¨å†…å®¹ã€‚\næ‰§è¡Œ xmake ç¼–è¯‘æŸ¥çœ‹è¾“å‡ºå†…å®¹ï¼Œå¦‚ä¸‹å›¾ã€‚\nå›¾ä¸­æ‰€éå†å‡ºæ¥çš„ build/.deps è·¯å¾„æ˜¯ç”¨æ¥å­˜å‚¨è‡ªåŠ¨ç”Ÿæˆçš„å¤´æ–‡ä»¶ä¾èµ–æ–‡ä»¶ä¿¡æ¯ï¼Œè€Œ build/.objs ä¸»è¦ç”¨äºå­˜å‚¨è‡ªåŠ¨ç”Ÿæˆçš„ .o å¯¹è±¡æ–‡ä»¶ã€‚\nåˆ¤æ–­æ–‡ä»¶ç±»å‹ å¦‚æœæœ‰äº›è·¯å¾„ï¼Œæˆ‘ä»¬æƒ³çŸ¥é“å®ƒåˆ°åº•æ˜¯æ–‡ä»¶ç±»å‹è¿˜æ˜¯ç›®å½•ç±»å‹ï¼Œåˆæˆ–è€…æ˜¯å¦çœŸçš„å­˜åœ¨ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ä¸‹é¢å‡ ä¸ªæ¥å£ã€‚\n   éå†æ¥å£ æ¥å£è¯´æ˜     os.isdir æ˜¯å¦ä¸ºç›®å½•   os.isfile æ˜¯å¦ä¸ºæ–‡ä»¶   os.exists ç›®å½•æˆ–è€…æ–‡ä»¶æ˜¯å¦å­˜åœ¨    å…¶ä¸­ï¼Œos.isdir å’Œ os.isfile é™¤äº†åˆ¤æ–­è·¯å¾„ç±»å‹å¤–ï¼Œè¿˜è‡ªå¸¦å­˜åœ¨æ€§åˆ¤æ–­ï¼Œå¦‚æœä¸å­˜åœ¨çš„è¯ï¼Œä¸ç®¡æ˜¯å¦æ–‡ä»¶è¿˜æ˜¯ç›®å½•ï¼Œè¿™ä¸¤ä¸ªæ¥å£è‚¯å®šæ˜¯ä¼šè¿”å› falseã€‚\nè¿™å‡ ä¸ªæ¥å£æ¯”è¾ƒç®€å•ï¼Œæˆ‘ä»¬å°±ä¸å†ä¿®æ”¹ xmake.lua é…ç½®å»æ“ä½œäº†ï¼Œç›´æ¥æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤æ¥å¿«é€Ÿæµ‹è¯•éªŒè¯è¿™äº›æ¥å£ã€‚\nxmake l os.isdir src\rxmake l os.isfile src/main.cpp\rxmake l os.exists build\r xmake l/lua æ’ä»¶ä¼šç›´æ¥è°ƒç”¨ os.isfile ç­‰æ¥å£æ¥è„±ç¦» xmake.lua åšä¸€äº›å¿«é€Ÿçš„æ¨¡å—æ¥å£æµ‹è¯•ï¼ˆå…³äºè¿™å—æˆ‘ä»¬ä¼šåœ¨åé¢çš„å®éªŒä¸­è¯¦ç»†è®²è§£ï¼‰ã€‚\nè¿™é‡Œå¦‚æœè¿è¡Œæ­£å¸¸ï¼Œæˆ‘ä»¬ä¼šåœ¨ç»ˆç«¯ä¸‹çœ‹åˆ°ä¸‰ä¸ª true è¾“å‡ºã€‚\næ‰§è¡Œå¤–éƒ¨ç¨‹åº å…³äº os æ¨¡å—çš„å¦ä¸€ä¸ªæ¯”è¾ƒå¸¸ç”¨çš„æ“ä½œå°±æ˜¯è¿è¡Œå¤–éƒ¨ç¨‹åºï¼Œæ¯”å¦‚æ‰§è¡Œä¸€äº› shell å‘½ä»¤æˆ–è€…é€šè¿‡å…¶å®ƒå‘½ä»¤ç¨‹åºè·å–å…¶è¿è¡Œçš„ç»“æœè¾“å‡ºç­‰ç­‰ã€‚\nxmake å¯¹æ­¤ä¹Ÿæä¾›äº†ä¸€ç³»åˆ—æ¥å£æ¥æ»¡è¶³å„ç§å‘½ä»¤æ‰§è¡Œéœ€æ±‚ï¼Œå…·ä½“ä¸»è¦æœ‰ä¸‹é¢è¿™äº›æ¥å£ã€‚\n   æ¥å£ æ¥å£è¯´æ˜     os.run é™é»˜è¿è¡Œç¨‹åº   os.runv é™é»˜è¿è¡Œç¨‹åºï¼Œå¸¦å‚æ•°åˆ—è¡¨   os.exec å›æ˜¾è¿è¡Œç¨‹åº   os.execv å›æ˜¾è¿è¡Œç¨‹åºï¼Œå¸¦å‚æ•°åˆ—è¡¨   os.iorun è¿è¡Œå¹¶è·å–ç¨‹åºè¾“å‡ºå†…å®¹   os.iorunv è¿è¡Œå¹¶è·å–ç¨‹åºè¾“å‡ºå†…å®¹ï¼Œå¸¦å‚æ•°åˆ—è¡¨    ä»ä¸Šé¢çš„åˆ—è¡¨å¯ä»¥çœ‹å‡ºï¼Œå•çº¯è¿è¡Œçš„å¤–éƒ¨ç¨‹åºï¼Œä¹Ÿç»†åˆ†äº†å„ç§ä½¿ç”¨åœºæ™¯å¯¹åº”çš„ä¸åŒæ¥å£ï¼Œå…·ä½“å·®å¼‚å·²ç»åœ¨ä¸Šé¢è¯¦ç»†è¯´æ˜ã€‚\nå›æ˜¾è¿è¡Œç¨‹åº ä¸‹é¢æˆ‘ä»¬å…ˆæ¥ç®€å•ä»‹ç»å’Œä½¿ç”¨æœ€ç®€å•çš„ os.exec æ¥å£ï¼Œä¿®æ”¹ xmake.lua é…ç½®æ–‡ä»¶ã€‚\ntarget(\u0026quot;ostest\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\rafter_build(function (target)\ros.exec(\u0026quot;echo hello xmake\u0026quot;)\ros.execv(\u0026quot;bash\u0026quot;, {\u0026quot;-c\u0026quot;, \u0026quot;echo hello $WORD\u0026quot;}, {envs = {WORD = \u0026quot;xmake\u0026quot;}})\rend)\r ä¸Šé¢çš„é…ç½®ä¸­ï¼Œæˆ‘ä»¬åœ¨ç¼–è¯‘å®Œæˆåé€šè¿‡ os.exec è°ƒç”¨ echo hello xmake å‘½ä»¤æ¥å›æ˜¾è¾“å‡º hello xmakeï¼Œå¦å¤–è¿˜ä½¿ç”¨äº† os.execv å‘½ä»¤æ¥è°ƒç”¨ bash å­å‘½ä»¤æ¥å®ç°ç›¸åŒçš„è¾“å‡ºã€‚\nè¿™ä¸¤ä¸ªæ¥å£åœ¨ä¼ å‚ä¸Šç¨å¾®æœ‰ä¸€äº›åŒºåˆ«ï¼Œos.exec æ˜¯é€šè¿‡æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„æ–¹å¼ä¼ å‚ï¼Œè€Œ os.execv æ˜¯é€šè¿‡é¢å¤–çš„å‚æ•°åˆ—è¡¨ä¼ å‚ï¼Œè¿™ç§æ–¹å¼æ›´åŠ çš„çµæ´»ï¼Œå¹¶ä¸”è¿˜èƒ½åœ¨ç¬¬ä¸‰ä¸ªå‚æ•°ä¸­ä¼ é€’é¢å¤–çš„å¯é€‰ä¿¡æ¯ã€‚æ¯”å¦‚åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åŒæ—¶ä¼ é€’ WORD=xmake ç¯å¢ƒå˜é‡ç»™å­å‘½ä»¤ï¼Œä½¿å¾— echo å¯ä»¥æ­£å¸¸æ˜¾ç¤ºè¾“å‡º $WORD å˜é‡çš„å€¼ã€‚\næ‰§è¡Œ xmake å‘½ä»¤ï¼ŒæŸ¥çœ‹ç¼–è¯‘åçš„è¾“å‡ºä¿¡æ¯ï¼Œå¦‚æœè¿è¡Œæ­£å¸¸ï¼Œåº”è¯¥ä¼šåƒä¸‹å›¾æ‰€ç¤ºï¼Œæ˜¾ç¤ºä¸¤è¡Œ hello xmake å­—ç¬¦ä¸²ã€‚\né™é»˜è¿è¡Œç¨‹åº æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬åœ¨ç¼–è¯‘é¡¹ç›®çš„è¿‡ç¨‹ä¸­åªæ˜¯æƒ³é™é»˜æ‰§è¡Œä¸€äº›å¤–éƒ¨å‘½ä»¤ï¼Œä¸å›æ˜¾å­å‘½ä»¤è‡ªèº«çš„è¾“å‡ºå†…å®¹ï¼Œå°±å¯ä»¥ä½¿ç”¨ os.run å’Œ os.runv æ¥å£æ¥è¿è¡Œå®ƒä»¬ã€‚\nå…¶ä½¿ç”¨æ–¹å¼å®Œå…¨è·Ÿ os.exec å’Œ os.execv ä¸€è‡´ï¼Œä»…ä»…åªæ˜¯å›æ˜¾å’Œé™é»˜çš„åŒºåˆ«ã€‚ç”±äºå­å‘½ä»¤è¿è¡Œè¿‡ç¨‹ä¸­ä¸ä¼šè¾“å‡ºä»»ä½•ä¿¡æ¯ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åªæœ‰åœ¨è¿è¡Œå¤±è´¥åï¼Œæ‰èƒ½çœ‹åˆ°å®é™…çš„é”™è¯¯è¾“å‡ºä¿¡æ¯ï¼Œè€Œæ­£å¸¸è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œæ˜¯ä¸ä¼šæ˜¾ç¤ºä»»ä½•è¾“å‡ºä¿¡æ¯çš„ã€‚\næŠŠ xmake.lua æ”¹æˆå¦‚ä¸‹é…ç½®å†…å®¹æ¥ç»§ç»­å®éªŒä¸‹è¿™ä¸¤ä¸ªæ¥å£ã€‚\ntarget(\u0026quot;ostest\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\rafter_build(function (target)\ros.run(\u0026quot;echo hello xmake\u0026quot;)\ros.runv(\u0026quot;echo\u0026quot;, {\u0026quot;hello\u0026quot;, \u0026quot;xmake\u0026quot;})\rend)\r è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬æ‰§è¡Œ xmake å‘½ä»¤ç¼–è¯‘ï¼Œé™¤äº†è‡ªèº«ç¼–è¯‘è¾“å‡ºå¤–ï¼Œä¸ä¼šå†çœ‹åˆ°é¢å¤–çš„ hello xmake è¾“å‡ºäº†ï¼Œä¹‹å‰ç¼–è¯‘æ­£å¸¸é€šè¿‡ä¸ä¸­é€”æŠ¥é”™ï¼Œé‚£ä¹ˆå°±è¯´æ˜ os.run å·²ç»è¿è¡ŒæˆåŠŸäº†ã€‚\næ•è·å¤–éƒ¨å‘½ä»¤æ‰§è¡Œç»“æœ æœ€åï¼Œæˆ‘ä»¬å†æ¥è®²è§£ä¸‹ os.iorun å’Œ os.iorunv çš„ä½¿ç”¨ï¼Œè¿™ä¸¤ä¸ªæ¥å£ä¸»è¦ç”¨äºè·å–å­å‘½ä»¤è¿è¡Œå®Œæˆåçš„è¾“å‡ºç»“æœï¼Œä¹Ÿå°±æ˜¯è·å–å®ƒçš„ stdout å’Œ stderr è¾“å‡ºå†…å®¹ï¼Œæ–¹ä¾¿åœ¨è‡ªå®šä¹‰è„šæœ¬ä¸­åšåç»­çš„å¤„ç†ã€‚\nå®ƒä»¬çš„ä¼ å‚å®Œå…¨è·Ÿå…¶å®ƒçš„æ‰§è¡Œæ¥å£ä¸€è‡´ï¼Œä¸»è¦è¿˜æ˜¯å¤šäº†è¿”å›å€¼çš„å·®åˆ«ï¼Œç”¨äºè·å–è¿è¡Œç»“æœï¼Œä¾‹å¦‚ã€‚\ntarget(\u0026quot;ostest\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\rafter_build(function (target)\rlocal stdout, stderr = os.iorun(\u0026quot;echo hello xmake\u0026quot;)\rprint(\u0026quot;stdout: %s\u0026quot;, stdout)\rprint(\u0026quot;stderr: %s\u0026quot;, stderr)\rend)\r è¿™é‡Œï¼Œæˆ‘ä»¬é€šè¿‡è¿è¡Œ os.iorun æ¥å£ï¼Œè¿è¡Œå®Œæˆ echo hello xmake å­å‘½ä»¤åï¼Œè·å–äº†å…¶è¾“å‡ºå†…å®¹ï¼Œç„¶åå†å°†å®ƒä»¬é‡æ–°æ‰“å°äº†å‡ºæ¥ã€‚è®°ä½ï¼Œos.iorun è‡ªèº«ä¹Ÿæ˜¯é™é»˜è¿è¡Œçš„ï¼Œå¹¶ä¸ä¼šè‡ªåŠ¨å›æ˜¾æ‰§è¡Œç»“æœã€‚\næ‰§è¡Œ xmake ç¼–è¯‘åçš„è¾“å‡ºå†…å®¹å¦‚ä¸‹å›¾ï¼Œstdout ç”¨äºè¿”å›æ ‡å‡†è¾“å‡ºï¼Œstderr ç”¨äºè¿”å›é”™è¯¯è¾“å‡ºã€‚\nå†æ¥ä¸ªæ›´åŠ å®é™…ç‚¹çš„ä¾‹å­ï¼Œé€šå¸¸çš„å­å‘½ä»¤è¾“å‡ºæ˜¯å¤šè¡Œçš„ï¼Œæˆ‘ä»¬å¯ä»¥è·å–è¾“å‡ºåï¼ŒæŒ‰è¡Œåˆ†éš”ç„¶åéå†æ¯è¡Œå†…å®¹æ–‡æœ¬ï¼Œå¹¶ä¸”æ˜¾ç¤ºå¯¹åº”çš„è¡Œå·ä¿¡æ¯ï¼Œä¾‹å¦‚ã€‚\ntarget(\u0026quot;ostest\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\rafter_build(function (target)\rlocal stdout = os.iorun(\u0026quot;cat src/main.cpp\u0026quot;)\rfor idx, line in ipairs(stdout:split('\\n')) do\rprint(\u0026quot;%d: %s\u0026quot;, idx, line)\rend\rend)\r è¿™é‡Œï¼Œæˆ‘ä»¬é€šè¿‡ cat å‘½ä»¤æ˜¾ç¤º src/main.cpp æ–‡ä»¶çš„æ‰€æœ‰å†…å®¹ï¼Œç„¶åæˆ‘ä»¬é€šè¿‡ os.iorun è¿è¡Œå¹¶æ•è·è¾“å‡ºåï¼Œé‡æ–°æŒ‰è¡Œæ˜¾ç¤ºäº†å‡ºæ¥ã€‚å¦å¤–ï¼Œæˆ‘ä»¬è¿˜ç”¨åˆ°äº† string æ¨¡å—çš„ split æ¥å£æ¥æŒ‰è¡Œåˆ†éš”å­—ç¬¦ä¸²ã€‚\nå…·ä½“è¿è¡Œ xmake å‘½ä»¤ç¼–è¯‘åçš„è¿è¡Œè¾“å‡ºæ•ˆæœï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚\nå®éªŒæ€»ç»“ åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬ä¸»è¦å­¦ä¹ äº†ä¸€äº› os æ¨¡å—çš„å¸¸ç”¨æ¥å£ï¼Œæ¯”å¦‚å¦‚ä½•åœ¨è‡ªå®šä¹‰è„šæœ¬åŸŸä¸­è°ƒç”¨ os æ¨¡å—æ¥å£å»æ‰§è¡Œä¸€äº›æ–‡ä»¶æ“ä½œï¼Œä¹Ÿå­¦ä¹ äº†å¦‚ä½•åœ¨ xmake.lua ä¸­æ‰§è¡Œå¤–éƒ¨å‘½ä»¤ã€‚\næœ¬å®éªŒçš„å‚è€ƒä»£ç å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ä¸‹è½½ï¼š\nwget https://labfile.oss.aliyuncs.com/courses/2764/code13.zip\r ","id":54,"section":"categories","summary":"å®éªŒ13ç³»ç»Ÿæ“ä½œè¯¦è§£ åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å­¦ä¹ åˆ°å¦‚ä½•åœ¨è‡ªå®šä¹‰è„šæœ¬ä¸­å¯¹æ–‡ä»¶ç³»ç»Ÿæ“ä½œï¼Œä»¥åŠå¦‚ä½•å»æ‰§è¡Œå¤–éƒ¨ shell å‘½ä»¤ç¨‹åºå¹¶è·å–è¿è¡Œåçš„è¾“å‡ºå†…å®¹ã€‚ çŸ¥è¯†ç‚¹","tags":["xmake"],"title":"å®éªŒ13ç³»ç»Ÿæ“ä½œè¯¦è§£","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/app/xmake/%E8%93%9D%E6%A1%A5%E7%BD%91%E8%AF%BE/3xmake%E8%BF%9B%E9%98%B6/%E5%AE%9E%E9%AA%8C13%E7%B3%BB%E7%BB%9F%E6%93%8D%E4%BD%9C%E8%AF%A6%E8%A7%A3/","year":"2021"},{"content":"è‡ªå®šä¹‰è„šæœ¬å’Œè§„åˆ™ åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬ä¼šæ›´åŠ æ·±å…¥åœ°äº†è§£ä»€ä¹ˆæ˜¯è‡ªå®šä¹‰è„šæœ¬ï¼Œä»¥åŠå¦‚ä½•å»æ‹¦æˆª C/C++ æ„å»ºçš„æ•´ä¸ªå¤„ç†æµç¨‹ï¼Œå¹¶ä¸”è¿˜èƒ½å­¦ä¹ åˆ°å¦‚ä½•é€šè¿‡ rule() å»è‡ªå®šä¹‰æ„å»ºè§„åˆ™æ¥å¤„ç†æœªçŸ¥çš„æ–‡ä»¶ã€‚\nçŸ¥è¯†ç‚¹  ä»€ä¹ˆæ˜¯è‡ªå®šä¹‰è„šæœ¬ æ„å»ºè¿‡ç¨‹çš„å‡ ä¸ªåŸºæœ¬å¤„ç†é˜¶æ®µ æ„å»ºè¿‡ç¨‹æ¯ä¸ªé˜¶æ®µçš„æ‹¦æˆªå’Œå¤„ç† è‡ªå®šä¹‰æ„å»ºè§„åˆ™çš„åŸºæœ¬ä½¿ç”¨  è‡ªå®šä¹‰è„šæœ¬ä»‹ç» åœ¨ä¹‹å‰çš„å®éªŒä¸­ï¼Œæˆ‘ä»¬ä¸€ç›´éƒ½æ˜¯åœ¨ xmake.lua çš„æè¿°åŸŸä¸­è¿›è¡Œé…ç½®ï¼Œè¿™å¯¹äºå¤§éƒ¨åˆ†é¡¹ç›®è€Œè¨€ï¼Œå·²ç»è¶³å¤Ÿæ»¡è¶³éœ€æ±‚ï¼Œä½†æ˜¯å¯¹äºä¸€äº›æ›´åŠ å¤æ‚çš„é¡¹ç›®ï¼Œä»…ä»…é€šè¿‡æè¿°åŸŸçš„é…ç½®é€»è¾‘æ˜¯ä¸å¤Ÿç”¨çš„ã€‚æˆ‘ä»¬éœ€è¦æ›´åŠ çµæ´»å¤æ‚çš„é…ç½®é€»è¾‘ï¼Œèƒ½å¤Ÿå¤„ç†ä¸€åˆ‡çš„ç”¨æˆ·å®šåˆ¶åŒ–é…ç½®éœ€æ±‚ï¼Œè¿™ä¸ªæ—¶å€™å°±å¾—åœ¨ xmake çš„è‡ªå®šä¹‰è„šæœ¬åŸŸä¸­è¿›è¡Œé…ç½®äº†ã€‚\nå…³äºä»€ä¹ˆæ˜¯æè¿°åŸŸï¼Œä»€ä¹ˆæ˜¯è‡ªå®šä¹‰è„šæœ¬åŸŸï¼Œæˆ‘ä»¬åœ¨å®éªŒäº”ã€Šxmake åŸºç¡€ä¹‹é…ç½®è¯­æ³•ç®€ä»‹ã€‹ä¸­ï¼Œå·²ç»è¯¦ç»†ä»‹ç»è¿‡äº†ï¼Œè¿™é‡Œå†æ¥ç®€å•çš„å¤ä¹ ä¸‹ï¼š\n æè¿°åŸŸï¼šset_xxxã€add_xxx ç›¸å…³çš„é…ç½®æ¥å£æ‰€åœ¨çš„ä½œç”¨åŸŸã€‚ è„šæœ¬åŸŸï¼šon_xxxã€after_xxx å’Œ before_xxx æ¥å£å‡½æ•°å†…éƒ¨çš„ä½œç”¨åŸŸ  æˆ‘ä»¬å¯ä»¥ä»ä¸‹é¢çš„é…ç½®æ³¨é‡Šä¸­ï¼Œå¤§æ¦‚äº†è§£ä¸‹ã€‚\n-- æè¿°åŸŸ\rtarget(\u0026quot;test\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;) -- æè¿°åŸŸ\ron_load(function (target)\r-- è„šæœ¬åŸŸ\rend)\rafter_build(function (target)\r-- è„šæœ¬åŸŸ\rend)\r åœ¨æ„å»ºé˜¶æ®µæ‰§è¡Œç‰¹å®šè„šæœ¬ xmake çš„ target() ç›®æ ‡é…ç½®å—ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½®ä¸€äº›è‡ªå®šä¹‰çš„è„šæœ¬åŸŸï¼Œåœ¨ xmake æ„å»ºçš„å„ä¸ªé˜¶æ®µä¸­å¤„ç†ä¸€äº›ç”¨æˆ·çš„è‡ªå®šä¹‰é€»è¾‘ã€‚æˆ‘ä»¬å¯ä»¥æŠŠå®ƒä»¬ç†è§£ä¸ºç±»ä¼¼ C/C++ ä¸­çš„ Hook (é’©å­)ã€‚ç›¸å½“äºåœ¨ xmake çš„æ•´ä¸ªæ„å»ºä¸­ï¼Œæ³¨å…¥ä¸€äº›è‡ªå®šä¹‰çš„ lua è„šæœ¬ä»£ç ã€‚\nä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æŒ‡å®š target ç›®æ ‡ç¨‹åºç¼–è¯‘å‰åæ‰§è¡Œä¸€äº›è‡ªå®šä¹‰çš„è„šæœ¬æ“ä½œã€‚åœ¨å¼€å§‹æœ¬å®éªŒå‰ï¼Œæˆ‘ä»¬å…ˆæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤åˆ›å»ºä¸€ä¸ªæ–°çš„ç©ºå·¥ç¨‹ã€‚\ncd Code\rxmake create script_test\r ç„¶åè¿›å…¥ script_test æ–‡ä»¶å¤¹ï¼Œå¼€å§‹ç¼–è¾‘é‡Œé¢çš„ xmake.lua æ–‡ä»¶ï¼Œåœ¨æ„å»ºçš„å‰åé˜¶æ®µåŠ ä¸Šè‡ªå·±çš„ä¸€äº›è‡ªå®šä¹‰è„šæœ¬é€»è¾‘ï¼Œä¾‹å¦‚ã€‚\ntarget(\u0026quot;test\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\rbefore_build(function (target)\rprint(\u0026quot;start building %s\u0026quot;, target:targetfile())\rend)\rafter_build(function (target)\rprint(\u0026quot;finish building %s\u0026quot;, target:targetfile())\rend)\r ä¸Šé¢çš„é…ç½®ä¸­ï¼Œæˆ‘ä»¬é¢å¤–é…ç½®äº† before_build å’Œ after_build ä¸¤ä¸ªè‡ªå®šä¹‰çš„ lua è„šæœ¬åŸŸï¼Œç”¨äºåœ¨å½“å‰ç›®æ ‡ç¨‹åºçš„æ„å»ºå¼€å§‹å’Œç»“æŸä¸¤ä¸ªé˜¶æ®µï¼Œæ‰“å°ä¸€äº›ä¿¡æ¯ã€‚\næ‰§è¡Œ xmake ç¼–è¯‘ä¿¡æ¯ï¼Œä¼šçœ‹åˆ°ä¸‹å›¾çš„ç»“æœï¼Œçº¢çº¿ä½ç½®éƒ¨åˆ†å°±æ˜¯æˆ‘ä»¬åœ¨è„šæœ¬ä¸­è‡ªå®šä¹‰æ˜¾ç¤ºçš„è¾“å‡ºä¿¡æ¯ã€‚\nè¿™é‡Œï¼Œå‡ºäºæ¼”ç¤ºç›®çš„ï¼Œæˆ‘ä»¬ä»…ä»…åªæ˜¯ç®€å•çš„æ˜¾ç¤ºäº†ç›®æ ‡ç¨‹åºçš„å®é™…ç”Ÿæˆè·¯å¾„ï¼Œè€Œåœ¨çœŸæ­£çš„é¡¹ç›®ä¸­ï¼Œå¤§å®¶å¯ä»¥åœ¨é‡Œé¢åšæ›´åŠ å¤æ‚çš„äº‹æƒ…ã€‚\nå¦å¤–ï¼Œåœ¨æ¯ä¸ªè‡ªå®šä¹‰è„šæœ¬çš„é…ç½®å…¥å£ï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½®é¢å¤–çš„å¹³å°ã€æ¶æ„åŒ¹é…æ¨¡å¼ï¼Œä½¿å¾—ä»…ä»…åœ¨ç‰¹å®šå¹³å°è§¦å‘è„šæœ¬ï¼Œä¾‹å¦‚å°† xmake.lua æ–‡ä»¶æ”¹æˆä¸‹é¢çš„é…ç½®ã€‚\ntarget(\u0026quot;test\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\ron_build(function (target)\rprint(\u0026quot;build %s\u0026quot;, target:targetfile())\rend)\ron_build(\u0026quot;linux\u0026quot;, function (target)\rprint(\u0026quot;build %s on $(plat)\u0026quot;, target:targetfile())\rend)\ron_build(\u0026quot;windows\u0026quot;, function (target)\rprint(\u0026quot;build %s on $(plat)\u0026quot;, target:targetfile())\rend)\ron_build(\u0026quot;macosx\u0026quot;, function (target)\rprint(\u0026quot;build %s on $(plat)\u0026quot;, target:targetfile())\rend)\r ä¸Šé¢çš„é…ç½®ï¼Œæˆ‘ä»¬é€šè¿‡è‡ªå®šä¹‰ on_build é…ç½®æ¥å£ï¼Œå®Œå…¨æ›¿æ¢å†…ç½®çš„æ„å»ºè§„åˆ™ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå½“å‰è¿™ä¸ªç›®æ ‡ç¨‹åºå¦‚æœä¸å»å®ç° on_buildï¼Œé‚£ä¹ˆæ•´ä¸ªç¼–è¯‘è¿‡ç¨‹å°±æ˜¯ç©ºæ“ä½œï¼Œå› ä¸º xmake å®Œå…¨å°†å¦‚ä½•å»ç¼–è¯‘å®ƒçš„ä»»åŠ¡æ‰˜ç®¡ç»™äº†æˆ‘ä»¬è®¾ç½®çš„ on_build æ¥å®ç°ã€‚\nè¿™å¯¹äºä¸€äº›å¹¶ä¸æƒ³é‡‡ç”¨å†…ç½®ç¼–è¯‘é€»è¾‘çš„ç‰¹æ®Šç›®æ ‡ç¨‹åºï¼Œæˆ–è€…ä¸€äº›å‹æ ¹ä¸æ˜¯ C/C++ ç¨‹åºä½†æ˜¯ä¹Ÿéœ€è¦å¤„ç†ä¸€äº›ç¼–è¯‘ã€é¢„å¤„ç†é€»è¾‘çš„å…¶å®ƒç¨‹åºè€Œè¨€ï¼Œå°±éå¸¸æœ‰ç”¨äº†ã€‚\nè¿™é‡Œè¿˜æœ‰ä¸€ä¸ªéœ€è¦æ³¨æ„çš„åœ°æ–¹æ˜¯ï¼Œæˆ‘ä»¬å®šä¹‰äº†å››ä¸ª on_buildï¼Œè€Œä¸æ˜¯ä¸€ä¸ªï¼Œä¸‹é¢çš„ä¸‰ä¸ªä¼ é€’äº†é¢å¤–çš„å¹³å°å‚æ•°ï¼Œç”¨æ¥å‘Šè¯‰ xmakeï¼Œåªæœ‰åŒ¹é…åˆ°å®é™…çš„ç¼–è¯‘å¹³å°æ‰ä¼šè¢«æ‰§è¡Œåˆ°ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæˆ‘ä»¬ç°åœ¨çš„éœ€è¦ç¼–è¯‘çš„æ˜¯ Linux ç¨‹åºï¼Œå®é™…ä¸Šä»…ä»…åªä¼šæ‰§è¡Œåˆ° on_build(\u0026quot;linux\u0026quot;, ...) çš„å…¥å£è„šæœ¬ï¼Œå¦å¤–ä¸‰ä¸ªæ˜¯ä¸ä¼šè¢«æ‰§è¡Œåˆ°çš„ã€‚\nè€Œæœ€ä¸Šé¢ä¸å¸¦å¹³å°å‚æ•°çš„ on_build() åˆ™æ˜¯é»˜è®¤çš„é€šç”¨è®¾ç½®ï¼Œä»…ä»…åªæœ‰å½“å‰çš„å¹³å°å®Œå…¨ä¸æ˜¯ä¸‹é¢é…ç½®çš„ linuxï¼Œwindows ä»¥åŠ macosx ä¸‰è€…ä¹‹ä¸€ï¼Œé‚£ä¹ˆæ‰ä¼šè¿›å…¥é»˜è®¤çš„é€šç”¨å…¥å£è„šæœ¬ã€‚\nå…¶å®æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨åœ¨é€šç”¨çš„å…¥å£è„šæœ¬ä¸­ï¼Œä½¿ç”¨ if is_plat() then çš„æ–¹å¼æ¥å®ç°ç›¸åŒçš„ç›®çš„ï¼Œä½†è¿™æ ·çœ‹ä¸Šå»ä¸æ˜¯å¾ˆç²¾ç®€ï¼Œå…·ä½“å¦‚ä½•é…ç½®è¿˜æ˜¯å¾—çœ‹å¤§å®¶å®é™…çš„éœ€æ±‚æ¥å†³å®šã€‚\næ¥ä¸‹æ¥ï¼Œç»§ç»­æ‰§è¡Œä¸€é xmake æŸ¥çœ‹å®é™…çš„ç¼–è¯‘è¾“å‡ºã€‚\nç”±äºæˆ‘ä»¬é€šè¿‡ on_build é‡å†™äº†å†…éƒ¨æ„å»ºé€»è¾‘ï¼Œå¹¶ä¸”ä»…ä»…åªæ˜¯æ˜¾ç¤ºä¸€è¡Œè¾“å‡ºï¼Œå› æ­¤è¿™å›çš„ç¼–è¯‘å…¶å®é™¤äº†é‚£ä¸€è¡Œæ‰“å°è¾“å‡ºå¤–æ²¡æœ‰åšä»»ä½•äº‹æƒ…ã€‚\nä½†æ˜¯ï¼Œä»è¿™è¡Œè¾“å‡ºä¿¡æ¯ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå½“å‰å…¶å®æ‰§è¡Œçš„æ˜¯ on_build(\u0026quot;linux\u0026quot;, ...) é‡Œé¢é…ç½®çš„è‡ªå®šä¹‰è„šæœ¬ï¼Œå› ä¸ºå®éªŒé»˜è®¤å¹³å°æ˜¯ Linux ç³»ç»Ÿã€‚\nåœ¨æºæ–‡ä»¶ç¼–è¯‘é˜¶æ®µæ‰§è¡Œç‰¹å®šè„šæœ¬ è™½ç„¶ï¼Œon_buildã€before_build ç­‰é˜¶æ®µé…ç½®å¯ä»¥è‡ªå®šä¹‰æ„å»ºé€»è¾‘ï¼Œä½†æ˜¯ç²’åº¦ç›¸å¯¹è¿˜æ˜¯å¤ªç²—äº†ï¼Œå…¶å®æˆ‘ä»¬å¯ä»¥æ›´åŠ ç»†ç²’åº¦çš„åœ¨æ¯ä¸ªæºæ–‡ä»¶çš„ç¼–è¯‘é˜¶æ®µï¼Œæ·»åŠ è‡ªå®šä¹‰çš„è„šæœ¬é€»è¾‘ã€‚\nä¾‹å¦‚ï¼Œæˆ‘ä»¬æƒ³åœ¨æ¯ä¸ª C/C++ æºæ–‡ä»¶ç¼–è¯‘ä¹‹å‰çš„é˜¶æ®µï¼Œåšä¸€äº›è‡ªå®šä¹‰çš„é¢„å¤„ç†æ“ä½œï¼Œæ¯”å¦‚æ›¿æ¢ä»£ç é‡Œé¢çš„ç‰¹å®šæ–‡æœ¬ç­‰ç­‰ã€‚ç»§ç»­ä¿®æ”¹ä¹‹å‰çš„ xmake.lua æ”¹æˆä¸‹é¢çš„é…ç½®å†…å®¹ã€‚\ntarget(\u0026quot;test\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\rbefore_build_file(function (target, sourcefile)\rio.gsub(sourcefile, \u0026quot;hello world\u0026quot;, \u0026quot;hello xmake\u0026quot;)\rend)\r è¿™æ¬¡æˆ‘ä»¬åšäº†ä¸€ä»¶ç¨å¾®æœ‰ç‚¹å®é™…æ„ä¹‰çš„äº‹æƒ…ï¼Œå°±æ˜¯åœ¨ç¼–è¯‘æ¯ä¸ª C/C++ ä»£ç ä¹‹å‰ï¼Œé€šè¿‡ io.gsub æ¥å£é¢„å…ˆå°†é‡Œé¢çš„ä»£ç ä¸­åŒ…å«æœ‰ hello world çš„æ–‡æœ¬æ›¿æ¢æˆäº† hello xmakeï¼Œç„¶åç»§ç»­å‚ä¸ç¼–è¯‘ã€‚\nç”±äºæˆ‘ä»¬æ˜¯é€šè¿‡ xmake create åˆ›å»ºçš„ç©ºå·¥ç¨‹ï¼Œé»˜è®¤ç”Ÿæˆçš„ src/main.cpp é‡Œé¢ä¼šæ‰“å° hello world å­—ç¬¦ä¸²ï¼Œå¯ä»¥æ‰§è¡Œ cat ./src/main.cpp ç¡®è®¤ä¸‹ã€‚\nè€Œå½“æˆ‘ä»¬æ‰§è¡Œå®Œ xmake ç¼–è¯‘ä»»åŠ¡åï¼Œå†æ‰§è¡Œ xmake run å‘½ä»¤æŸ¥çœ‹å®é™…çš„è¿è¡Œç»“æœï¼Œä¼šå‘ç°é‡Œé¢çš„è¾“å‡ºå­—ç¬¦ä¸²å·²ç»äº†å˜æˆ hello xmakeï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚\né™¤äº†ä¸Šé¢é…ç½®ä¸­çš„ before_build_fileï¼Œå…¶å®è·Ÿ on_build ç±»ä¼¼ï¼Œæˆ‘ä»¬è¿˜æœ‰å¯¹åº”çš„ on_build_file é…ç½®æ¥é‡å†™å¯¹å•ä¸ªæºæ–‡ä»¶çš„ç¼–è¯‘é€»è¾‘ï¼Œä»¥åŠåœ¨ç¼–è¯‘åæ‰§è¡Œ after_build_file ä¸­é…ç½®çš„è‡ªå®šä¹‰è„šæœ¬ï¼Œç”¨æ³•å®Œå…¨ç›¸åŒï¼Œå› æ­¤è¿™é‡Œå°±ä¸é‡å¤è®²è§£äº†ã€‚\nå…¶å®ƒè‡ªå®šä¹‰è„šæœ¬é…ç½®é˜¶æ®µ é™¤äº†åœ¨æ„å»ºé˜¶æ®µï¼Œæˆ‘ä»¬å¯ä»¥æ’å…¥ä¸€äº›è‡ªå·±çš„è„šæœ¬é€»è¾‘å¤–ï¼Œè¿˜å¯ä»¥é€šè¿‡é…ç½®æ³¨å…¥åˆ°å…¶å®ƒçš„æ“ä½œé˜¶æ®µã€‚å› ä¸º xmake é™¤äº†æ„å»ºï¼Œè¿˜æœ‰æ¸…ç†ã€å®‰è£…ã€å¸è½½ã€æ‰“åŒ…ç­‰å…¶å®ƒçš„åŸºæœ¬æ“ä½œã€‚\nè¿™é‡Œå¯ä»¥ç®€å•åˆ—ä¸¾ä¸‹ï¼Œç›®å‰æˆ‘ä»¬å¯ä»¥æ³¨å…¥å’Œä¿®æ”¹çš„ä¸€äº›åŸºæœ¬æ“ä½œé˜¶æ®µã€‚\n   è‡ªå®šä¹‰è„šæœ¬é…ç½®æ¥å£ æè¿°     on_load è‡ªå®šä¹‰ç›®æ ‡åŠ è½½è„šæœ¬   on_link è‡ªå®šä¹‰é“¾æ¥è„šæœ¬   on_build è‡ªå®šä¹‰ç¼–è¯‘è„šæœ¬   on_build_file è‡ªå®šä¹‰ç¼–è¯‘è„šæœ¬, å®ç°å•æ–‡ä»¶æ„å»º   on_build_files è‡ªå®šä¹‰ç¼–è¯‘è„šæœ¬, å®ç°å¤šæ–‡ä»¶æ„å»º   on_clean è‡ªå®šä¹‰æ¸…ç†è„šæœ¬   on_package è‡ªå®šä¹‰æ‰“åŒ…è„šæœ¬   on_install è‡ªå®šä¹‰å®‰è£…è„šæœ¬   on_uninstall è‡ªå®šä¹‰å¸è½½è„šæœ¬   on_run è‡ªå®šä¹‰è¿è¡Œè„šæœ¬    å…¶ä¸­ï¼Œé™¤äº† on_load ä»¥å¤–ï¼Œå…¶å®ƒçš„æ‰€æœ‰ on_xxx é˜¶æ®µé…ç½®æ¥å£ï¼Œéƒ½æœ‰å¯¹åº”çš„ before_xxx å’Œ after_xxx ç‰ˆæœ¬ï¼Œåœ¨å‰åé˜¶æ®µé…ç½®æ‰§è¡Œè‡ªå®šä¹‰è„šæœ¬ã€‚\nä¸ºäº†äº†è§£ xmake æ˜¯åœ¨å“ªäº›é˜¶æ®µå®é™…æ‰§è¡Œäº†è¿™äº›é…ç½®è„šæœ¬ï¼Œæˆ‘ä»¬ä¿®æ”¹ä¹‹å‰çš„ xmake.luaï¼ŒæŠŠä¸Šé¢çš„ä¸åŒé˜¶æ®µè„šæœ¬éƒ½é…ç½®ä¸Šï¼Œä¾‹å¦‚ã€‚\ntarget(\u0026quot;test\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\rbefore_build(function (target)\rprint(\u0026quot;before_build\u0026quot;)\rend)\rafter_build(function (target)\rprint(\u0026quot;after_build\u0026quot;)\rend)\rbefore_build_file(function (target, sourcefile)\rprint(\u0026quot;before_build_file: %s\u0026quot;, sourcefile)\rend)\ron_build_file(function (target, sourcefile)\rprint(\u0026quot;on_build_file: %s\u0026quot;, sourcefile)\rend)\rafter_build_file(function (target, sourcefile)\rprint(\u0026quot;after_build_file: %s\u0026quot;, sourcefile)\rend)\rbefore_link(function (target)\rprint(\u0026quot;before_link\u0026quot;)\rend)\ron_link(function (target)\rprint(\u0026quot;on_link\u0026quot;)\rend)\rafter_link(function (target)\rprint(\u0026quot;after_link\u0026quot;)\rend)\r ä¸Šé¢çš„é…ç½®ä»£ç ï¼Œæˆ‘ä»¬é…ç½®æ³¨å…¥äº†å¤§éƒ¨åˆ†é˜¶æ®µçš„è„šæœ¬å¤„ç†ï¼Œè€Œ on_runã€on_install è¿™ç§ï¼Œå¾ˆæ˜æ˜¾å°±æ˜¯å¯¹åº” xmake run å’Œ xmake install ç­‰åŸºæœ¬æ“ä½œçš„å¤„ç†ï¼Œè¿™é‡Œå°±ä¸åˆ—ä¸¾ä¸Šå»ï¼Œä¸ç„¶é…ç½®å¤ªé•¿äº†ï¼Œå¤§å®¶å¯ä»¥è‡ªå·±å†åšä¸€äº›ç›¸å…³å°è¯•ã€‚\nè¿™é‡Œæˆ‘ä»¬ä¸»è¦æ˜¯é€šè¿‡é…ç½®ï¼Œæ‹¦æˆªæ•´ä¸ªæ„å»ºæµç¨‹ä¸­ä¼šæ‰§è¡Œåˆ°çš„ä¸€äº›æ­¥éª¤ï¼Œæ¯”å¦‚æ–‡ä»¶ç¼–è¯‘ã€é“¾æ¥é˜¶æ®µç­‰ç­‰ï¼Œé…ç½®å®Œæˆåï¼Œæ‰§è¡Œ xmake æŸ¥çœ‹æ•´ä¸ªç¼–è¯‘è¾“å‡ºã€‚\né€šè¿‡ä¸Šå›¾çš„è¾“å‡ºï¼Œæˆ‘ä»¬å¯ä»¥å¤§æ¦‚çœ‹å‡ºæ•´ä¸ªæ„å»ºçš„æ‰§è¡Œæµç¨‹ã€‚è¿™é‡Œä¼šä¼˜å…ˆæ‰§è¡Œ before_buildï¼Œç„¶åä¼šæ‰§è¡Œæ¯ä¸ªæºæ–‡ä»¶çš„ç¼–è¯‘ï¼Œæ¥ç€æ‰§è¡Œé“¾æ¥è¿‡ç¨‹ï¼Œæœ€åæ˜¯ after_buildã€‚è¿™é‡Œæˆ‘ä»¬æ²¡æœ‰è®¾ç½® on_buildï¼Œæ˜¯å› ä¸ºå¦‚æœè®¾ç½®äº†è¿™ä¸ªæ¥å£ï¼Œå°±ä¼šé‡å†™å†…éƒ¨çš„æ‰€æœ‰æ„å»ºè¿‡ç¨‹ï¼Œä¹Ÿå°±ä¸ä¼šæ‰§è¡Œ on_build_file å’Œ on_link äº†ï¼Œä¸€åˆ‡æ„å»ºæ“ä½œéƒ½éœ€è¦å¤§å®¶è‡ªå·±å»å®Œæˆã€‚\nä¸‹å›¾æè¿°äº†æ•´ä¸ªæ„å»ºè¿‡ç¨‹ä¸­æ¯ä¸ªé˜¶æ®µçš„æ‰§è¡Œæ—¶æœºã€‚\né€šè¿‡å®šä¹‰è§„åˆ™å¤„ç†å…¶å®ƒæ–‡ä»¶ è™½ç„¶æˆ‘ä»¬å¯ä»¥åœ¨ target ä¸­é€šè¿‡ on_build_file ç­‰è‡ªå®šä¹‰è„šæœ¬æ¥å®šåˆ¶åŒ–å¤„ç†ç¼–è¯‘é€»è¾‘ï¼Œä½†æ˜¯å¦‚æœæ¯ä¸ª target éƒ½è¦é…ç½®ç›¸åŒçš„å¤„ç†é€»è¾‘ï¼Œæˆ–è€…è¦å¤„ç†å¤šä¸ªä¸åŒç§ç±»çš„é€»è¾‘ï¼Œå¹¶ä¸”å…¨åœ¨ target ä¸­å»å®šä¹‰å®ç°å®ƒä»¬ï¼Œé‚£ä¹ˆæ•´ä¸ªé…ç½®ä¼šéå¸¸è‡ƒè‚¿å¹¶ä¸”éš¾ä»¥ç»´æŠ¤ã€‚\nå› æ­¤ï¼Œxmake æä¾›äº†ä¸€ç§æ¨¡å—åŒ–çš„æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯é€šè¿‡ rule() è‡ªå®šä¹‰è§„åˆ™ï¼Œç„¶åä½¿ç”¨ add_rules() æ¥å£å®ç°å¯¹å•ä¸ª target ç›®æ ‡åŒæ—¶é…ç½®ç”Ÿæ•ˆå¤šä¸ªä¸åŒçš„ç¼–è¯‘è§„åˆ™ã€‚è¿™äº›è§„åˆ™å¯ä»¥å¤ç”¨ã€å¯¹å¤šä¸ª target ç”Ÿæ•ˆã€‚\nè€Œä¹‹å‰æˆ‘ä»¬åœ¨ target ä¸­çš„é‚£äº›è‡ªå®šä¹‰è„šæœ¬é˜¶æ®µçš„é…ç½®æ¥å£ï¼Œä¾‹å¦‚ on_build ç­‰ï¼Œéƒ½å¯ä»¥åœ¨ rule() ä¸­å®šä¹‰å’Œå®ç°ã€‚å…¶å® xmake å†…éƒ¨çš„ C/C++ ä»£ç ç¼–è¯‘æœ¬èº«ä¹Ÿæ˜¯ä½¿ç”¨ rule(\u0026quot;c++\u0026quot;) è§„åˆ™æ¥å®ç°çš„ï¼Œåªä¸è¿‡é»˜è®¤å°±å·²ç»å¯¹ C/C++ ä»£ç ç”Ÿæ•ˆäº†ï¼Œè€Œç”¨æˆ·åœ¨ xmake.lua ä¸­è‡ªå·±å®šä¹‰é…ç½®çš„è§„åˆ™ï¼Œå°±éœ€è¦æ‰‹åŠ¨æ·»åŠ  add_rules åˆ°å¯¹åº”çš„ target æ‰èƒ½ç”Ÿæ•ˆã€‚\nç›´æ¥è¿™ä¹ˆè¯´ï¼Œä¹Ÿè®¸è¿˜ä¸å¤ªèƒ½å¾ˆæ¸…æ™°ç†è§£ä»€ä¹ˆæ˜¯è‡ªå®šä¹‰è§„åˆ™ï¼Œæˆ‘ä»¬å…ˆæ¥æ”¹é€ ä¸‹ä¹‹å‰çš„é…ç½®æ–‡ä»¶ xmake.luaï¼Œé€šè¿‡å®šä¹‰ rule() çš„æ–¹å¼ï¼Œæ¥å®ç°ç›¸åŒçš„ç›®çš„ï¼Œä¾‹å¦‚ã€‚\nrule(\u0026quot;myrule\u0026quot;)\rbefore_build(function (target)\rprint(\u0026quot;before_build\u0026quot;)\rend)\rafter_build(function (target)\rprint(\u0026quot;after_build\u0026quot;)\rend)\rbefore_build_file(function (target, sourcefile)\rprint(\u0026quot;before_build_file: %s\u0026quot;, sourcefile)\rend)\ron_build_file(function (target, sourcefile)\rprint(\u0026quot;on_build_file: %s\u0026quot;, sourcefile)\rend)\rafter_build_file(function (target, sourcefile)\rprint(\u0026quot;after_build_file: %s\u0026quot;, sourcefile)\rend)\rbefore_link(function (target)\rprint(\u0026quot;before_link\u0026quot;)\rend)\ron_link(function (target)\rprint(\u0026quot;on_link\u0026quot;)\rend)\rafter_link(function (target)\rprint(\u0026quot;after_link\u0026quot;)\rend)\rrule_end()\rtarget(\u0026quot;test\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\radd_rules(\u0026quot;myrule\u0026quot;)\r æˆ‘ä»¬é€šè¿‡æŠ½ç¦» target ä¸­çš„æ‰€æœ‰è‡ªå®šä¹‰è„šæœ¬åˆ° rule(\u0026quot;myrule\u0026quot;) ä¸­ï¼Œç„¶åé€šè¿‡ add_rules(\u0026quot;myrule\u0026quot;) çš„æ–¹å¼å¯¹æŒ‡å®šçš„ target ç”Ÿæ•ˆã€‚\næ‰§è¡Œ xmake -r é‡æ–°ç¼–è¯‘çœ‹çœ‹ï¼Œèƒ½è¾“å‡ºå“ªäº›ä¿¡æ¯ã€‚\næˆ‘ä»¬çœ‹åˆ° before_build è¿˜æœ‰ on_link ç­‰ç›¸å…³çš„é˜¶æ®µéƒ½æ­£å¸¸è¾“å‡ºäº†ï¼Œè·Ÿä¹‹å‰å®Œå…¨ä¸€æ ·ï¼Œä½†æ˜¯ on_build_file ç­‰é˜¶æ®µï¼Œè¿˜æ˜¯æ²¡æœ‰è¾“å‡ºã€‚è¿™æ˜¯å› ä¸ºé€šè¿‡ add_rules() çš„æ–¹å¼åº”ç”¨çš„è§„åˆ™ï¼Œé»˜è®¤æ˜¯ä¸ä¼šå»è¦†ç›–å†…éƒ¨çš„ rule(\u0026quot;c++\u0026quot;) è§„åˆ™ä¸­çš„ cpp æ–‡ä»¶ç¼–è¯‘ï¼Œåªæ˜¯é¢å¤–é™„åŠ äº†ä¸€äº›è‡ªå®šä¹‰è„šæœ¬ã€‚\nä½†æ˜¯ï¼Œå¦‚æœæ˜¯å¤„ç†ä¸€äº›å…¶å®ƒçš„æœªçŸ¥æ–‡ä»¶ï¼Œæ¯”å¦‚ï¼š*.md ç­‰ï¼Œç”±äº xmake å†…éƒ¨æ²¡æœ‰ç›¸å…³çš„è§„åˆ™å¯ä»¥è¯†åˆ«å¤„ç†ï¼Œé‚£ä¹ˆ rule(\u0026quot;myrule\u0026quot;) ä¸­çš„ on_build_file ä¹Ÿå°±ä¼šè¢«æ‰§è¡Œåˆ°ã€‚\nå› æ­¤ï¼Œæˆ‘ä»¬å…ˆæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œåˆ›å»ºä¸€ä¸ª src/test.md æ–‡ä»¶ç”¨äºå®šåˆ¶åŒ–å¤„ç†ã€‚\ntouch src/test.md\r ç„¶åä¿®æ”¹ xmake.lua é…ç½®ï¼Œé€šè¿‡æ·»åŠ  set_extensions(\u0026quot;.md\u0026quot;) åˆ° rule(\u0026quot;myrule\u0026quot;) ä½¿å¾— myrule è§„åˆ™å¯ä»¥è¯†åˆ«åˆ°æ–°åˆ›å»ºçš„ src/test.md æ–‡ä»¶ã€‚\nrule(\u0026quot;myrule\u0026quot;)\rset_extensions(\u0026quot;.md\u0026quot;) -- æŒ‡å®šè¿™ä¸ªè§„åˆ™ä»…å¯¹ md æ–‡ä»¶ç”Ÿæ•ˆ\rbefore_build(function (target)\rprint(\u0026quot;before_build\u0026quot;)\rend)\rafter_build(function (target)\rprint(\u0026quot;after_build\u0026quot;)\rend)\rbefore_build_file(function (target, sourcefile)\rprint(\u0026quot;before_build_file: %s\u0026quot;, sourcefile)\rend)\ron_build_file(function (target, sourcefile)\rprint(\u0026quot;on_build_file: %s\u0026quot;, sourcefile)\rend)\rafter_build_file(function (target, sourcefile)\rprint(\u0026quot;after_build_file: %s\u0026quot;, sourcefile)\rend)\rbefore_link(function (target)\rprint(\u0026quot;before_link\u0026quot;)\rend)\ron_link(function (target)\rprint(\u0026quot;on_link\u0026quot;)\rend)\rafter_link(function (target)\rprint(\u0026quot;after_link\u0026quot;)\rend)\rrule_end()\rtarget(\u0026quot;test\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;, \u0026quot;src/*.md\u0026quot;) -- æ·»åŠ ä¸Š md æ–‡ä»¶\radd_rules(\u0026quot;myrule\u0026quot;)\r æ­£å¦‚ä¸Šé¢çš„é…ç½®ä¸­çœ‹åˆ°ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦åœ¨ xmake.lua ä¸­å°† src/test.md é€šè¿‡ add_files æ·»åŠ è¿›æ¥ï¼Œè¿™æ · myrule è§„åˆ™æ‰èƒ½è¯†åˆ«åˆ°å®ƒã€‚\næ¥ç€æ‰§è¡Œ xmake -r æŸ¥çœ‹è¾“å‡ºï¼Œå¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œè¿™å›æˆ‘ä»¬ä¼šçœ‹åˆ° on_build_file ä¹Ÿè¢«æ‰§è¡Œåˆ°äº†ï¼Œç”¨äº .md æ–‡ä»¶çš„å®šåˆ¶åŒ–å¤„ç†ï¼Œè€Œ c++ æ–‡ä»¶ä¸å—ä»»ä½•å½±å“ã€‚\nè¿™é‡Œï¼Œæˆ‘ä»¬ä»…ä»…åªæ˜¯ç®€å•çš„è°ƒç”¨äº† print æ¥å£ï¼Œå®é™…çš„é¡¹ç›®é…ç½®è¿‡ç¨‹ä¸­ï¼Œå¯ä»¥é€šè¿‡è‡ªå®šä¹‰çš„ rule() è§„åˆ™é…ç½®ï¼Œå®ç°é™¤äº† c++ ä»£ç å¤–çš„å…¶å®ƒä»»ä½•æœªçŸ¥æ–‡ä»¶çš„å¤„ç†å’Œç¼–è¯‘ï¼Œç”šè‡³å¯ä»¥æ‰©å±•ç¼–è¯‘å…¶å®ƒçš„ç¼–è¯‘è¯­è¨€çš„ä»£ç æ–‡ä»¶ã€‚\nåœ¨è‡ªå®šä¹‰è§„åˆ™ä¸­é…ç½®ç›®æ ‡ç¼–è¯‘é€‰é¡¹ åœ¨å®éªŒäº”ã€Šxmake åŸºç¡€ä¹‹é…ç½®è¯­æ³•ç®€ä»‹ã€‹ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“å¯ä»¥é€šè¿‡ on_load è‡ªå®šä¹‰è„šæœ¬åœ¨ target ä¸­æ›´åŠ çµæ´»çš„é…ç½®å„ç§ç¼–è¯‘é€‰é¡¹ï¼Œä¸ä¼šå†å—åˆ°æè¿°åŸŸçš„ä¸€äº›é™åˆ¶ã€‚è€Œåœ¨è‡ªå®šä¹‰è§„åˆ™ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡å®šä¹‰ on_loadï¼Œåœ¨é‡Œé¢åŠ¨æ€æ·»åŠ ä¸€äº›ç¼–è¯‘é€‰é¡¹ç»™ä¸ª target ç¨‹åºã€‚\næˆ‘ä»¬è¿˜æ˜¯æ‹¿åˆšæ‰çš„å·¥ç¨‹é¡¹ç›®ä¸­ myrule ä¸ºä¾‹ï¼Œä¿®æ”¹ä¸‹ xmake.luaã€‚\nrule(\u0026quot;myrule\u0026quot;)\ron_load(function (target)\rtarget:add(\u0026quot;defines\u0026quot;, \u0026quot;MYRULE\u0026quot;)\rtarget:add(\u0026quot;syslinks\u0026quot;, \u0026quot;pthread\u0026quot;)\rif is_plat(\u0026quot;linux\u0026quot;) then\rtarget:add(\u0026quot;defines\u0026quot;, \u0026quot;LINUX\u0026quot;)\rend\rend)\rrule_end()\rtarget(\u0026quot;test\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\radd_rules(\u0026quot;myrule\u0026quot;)\r è¿™é‡Œï¼Œæˆ‘ä»¬ä»…ä»…å¯¹ myrule è§„åˆ™æ·»åŠ äº† on_load è‡ªå®šä¹‰è„šæœ¬ï¼Œå¹¶åœ¨é‡Œé¢åŠ¨æ€çš„è®¾ç½®äº†ä¸€äº›å®å®šä¹‰å’Œé“¾æ¥åº“ï¼Œä¾‹å¦‚ -DMYRULEã€-DLINUX ç­‰ç­‰ã€‚\nç„¶ååªéœ€è¦é€šè¿‡ add_rules(\u0026quot;myrule\u0026quot;) å°†å…¶ç”Ÿæ•ˆåˆ°æŒ‡å®šçš„ target ä¸Šå»å°±è¡Œäº†ã€‚\næ‰§è¡Œ xmake -rv ç¼–è¯‘ï¼Œå¯ä»¥çœ‹åˆ°è¾“å‡ºç»“æœä¸­ï¼Œå·²ç»åŠ ä¸Šäº†åœ¨ on_load ä¸­æ–°åŠ çš„ä¸€äº›é¢å¤–ç¼–è¯‘é€‰é¡¹ã€‚\nå®éªŒæ€»ç»“ åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•é…ç½®è‡ªå®šä¹‰è„šæœ¬åœ¨æ‹¦æˆªç›®æ ‡ç¨‹åºçš„æ•´ä¸ªæ„å»ºè¿‡ç¨‹ï¼Œå®ç°ä¸€äº›å®šåˆ¶åŒ–çš„å¤„ç†é€»è¾‘ï¼Œå¹¶ä¸”å¤§æ¦‚äº†è§£äº†æ„å»ºçš„å‡ ä¸ªåŸºæœ¬æ‰§è¡Œé˜¶æ®µï¼Œä¹Ÿå­¦ä¼šäº†å¦‚ä½•é€šè¿‡è‡ªå®šä¹‰ç¼–è¯‘è§„åˆ™å»å¤„ç†å…¶å®ƒæœªçŸ¥æ–‡ä»¶ã€‚\næœ¬å®éªŒçš„å‚è€ƒä»£ç å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ä¸‹è½½ï¼š\nwget https://labfile.oss.aliyuncs.com/courses/2764/code12.zip\r ","id":55,"section":"categories","summary":"è‡ªå®šä¹‰è„šæœ¬å’Œè§„åˆ™ åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬ä¼šæ›´åŠ æ·±å…¥åœ°äº†è§£ä»€ä¹ˆæ˜¯è‡ªå®šä¹‰è„šæœ¬ï¼Œä»¥åŠå¦‚ä½•å»æ‹¦æˆª C/C++ æ„å»ºçš„æ•´ä¸ªå¤„ç†æµç¨‹ï¼Œå¹¶ä¸”è¿˜èƒ½å­¦ä¹ åˆ°å¦‚ä½•é€šè¿‡ rule() å»è‡ªå®šä¹‰æ„å»º","tags":["xmake"],"title":"å®éªŒ12è‡ªå®šä¹‰è„šæœ¬å’Œè§„åˆ™","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/app/xmake/%E8%93%9D%E6%A1%A5%E7%BD%91%E8%AF%BE/3xmake%E8%BF%9B%E9%98%B6/%E5%AE%9E%E9%AA%8C12%E8%87%AA%E5%AE%9A%E4%B9%89%E8%84%9A%E6%9C%AC%E5%92%8C%E8%A7%84%E5%88%99/","year":"2021"},{"content":"C/C++ åº“æ¥å£å’Œç¼–è¯‘å™¨ç‰¹æ€§æ£€æµ‹ åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬ä¼šå­¦ä¹ åˆ° C/C++ è·¨å¹³å°å¼€å‘ä¸­ä¸€äº›åŸºç¡€çŸ¥è¯†å’Œæ³¨æ„ç‚¹ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨ xmake å»æ£€æµ‹ä¸åŒç¼–è¯‘ç¯å¢ƒä¸­çš„ C/C++ åº“å¤´æ–‡ä»¶ã€åº“æ¥å£æ˜¯å¦å­˜åœ¨ï¼Œä»¥åŠç¼–è¯‘å™¨ç‰¹æ€§ç›¸å…³çš„æ£€æµ‹æ–¹å¼ã€‚\nçŸ¥è¯†ç‚¹  è·¨å¹³å°ç¼–è¯‘å¼€å‘ç›¸å…³åŸºç¡€çŸ¥è¯†ï¼Œä¸åŒç¼–è¯‘å™¨ä¹‹é—´çš„å·®å¼‚æ€§ å¤´æ–‡ä»¶ã€åº“æ¥å£çš„å­˜åœ¨æ€§æ£€æµ‹ C/C++ ä»£ç ç‰‡æ®µçš„æ£€æµ‹ ç¼–è¯‘å™¨ç‰¹æ€§çš„æ”¯æŒåŠ›åº¦æ£€æµ‹  è·¨å¹³å°å¼€å‘ä»‹ç» å¦‚æœ C/C++ é¡¹ç›®åœ¨å¼€å‘å’Œæ„å»ºä¸­è¦è€ƒè™‘è·¨å¹³å°é—®é¢˜ï¼Œéœ€è¦åŒæ—¶æ”¯æŒ Linuxã€macOS å’Œ Windows ç³»ç»Ÿï¼Œç”šè‡³è¿˜è¦æ”¯æŒ Android å’Œ IOS ç­‰ç§»åŠ¨ç«¯ç³»ç»Ÿï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦è€ƒè™‘å¾ˆå¤šè·Ÿå¹³å°ç›¸å…³çš„ä¸€äº›å·®å¼‚åŒ–å› ç´ ï¼Œæ‰èƒ½æ”¯æŒè·¨å¹³å°ï¼Œå…¶æ¶‰åŠå¹¶éœ€è¦è§£å†³çš„ä¸€äº›å¹³å°å·®å¼‚æœ‰å¦‚ä¸‹è¿™äº›ã€‚\n ä»£ç å·®å¼‚ï¼Œæ¯”å¦‚ä¾èµ–çš„ç³»ç»Ÿåº“ API ä¸åŒï¼Œä¸åŒç¼–è¯‘å™¨å¯¹ C++ æ ‡å‡†çš„æ”¯æŒåŠ›åº¦ä¸åŒã€‚ ç¼–è¯‘å·¥å…·é“¾çš„å·®å¼‚ï¼Œä»¥åŠå¯¹åº”çš„ç¼–è¯‘å™¨ç‰¹æ€§ã€ç¼–è¯‘é€‰é¡¹å·®å¼‚ã€‚ è¿è¡Œæ—¶ç¯å¢ƒçš„å·®å¼‚ã€‚  æŠ›å¼€è¿è¡Œç¯å¢ƒä¸è°ˆï¼Œå¦‚æœè¦åœ¨ä¸åŒå¹³å°æä¾›çš„ç¼–è¯‘å·¥å…·é“¾ä¸Šé€šè¿‡ç¼–è¯‘ï¼Œé¦–å…ˆè¦è§£å†³ä»£ç è‡ªèº«æ”¯æŒè·¨å¹³å°çš„é—®é¢˜ï¼Œç„¶åä¸åŒçš„å·¥å…·é“¾ã€ç³»ç»Ÿæä¾›çš„ API æ¥å£å„ä¸ç›¸åŒï¼Œå¾ˆéš¾èƒ½ä¿è¯å†™ä¸€ä»½ä»£ç ï¼Œéšå¤„ç¼–è¯‘ã€‚\nå³ä½¿æœ‰ posix æ¥å£ã€libc åº“æ¥å£ç­‰ä¿è¯ä¸€å®šç¨‹åº¦ä¸Šè°ƒç”¨çš„ API æ˜¯è·¨å¹³å°çš„ï¼Œä½†å®é™…ä¸Šä¸åŒå¹³å°å¯¹è¿™äº›æ¥å£çš„æ”¯æŒåŠ›åº¦éƒ½å„ä¸ç›¸åŒï¼Œå°±æ‹¿ strncasecmp æ¥å£æ¥è¯´ï¼Œgcc å’Œ clang ç¼–è¯‘å™¨é€šå¸¸éƒ½ä¼šæä¾›ï¼Œä½†æ˜¯å¯¹äº msvc ç¼–è¯‘å™¨ï¼Œæ˜¯æ²¡æœ‰è¿™ä¸ªæ¥å£ï¼Œåªæä¾›äº†ç­‰ä»·çš„ _strnicmp æ¥å£ã€‚\nè¿™ä¸ªæ—¶å€™ï¼Œå¦‚æœæˆ‘ä»¬è¦æ”¯æŒè·¨å¹³å°ç¼–è¯‘å’Œè¿è¡Œï¼Œé‚£ä¹ˆå°±éœ€è¦åœ¨ä»£ç ä¸­åˆ¤æ–­å½“å‰çš„ç¼–è¯‘å™¨å’Œå·¥å…·é“¾æ˜¯å¦æä¾›äº†è¿™ä¸ªæ¥å£ï¼Œå¦‚æœæœ‰å°±è°ƒç”¨ï¼Œæ²¡æœ‰å°±ç”¨å…¶å®ƒè§£å†³æ–¹æ¡ˆï¼Œä¾‹å¦‚ã€‚\n#ifdef _MSC_VER\r_strnicmp(s1, s2, n);\r#else\rstrncasecmp(s1, s2, n);\r#endif\r ä½†æ˜¯è¿™æ ·è¿˜æ˜¯ä¸å¯é çš„ï¼Œå› ä¸ºæˆ‘ä»¬ä¸èƒ½ä¿è¯ msvc çš„æ‰€æœ‰ç‰ˆæœ¬éƒ½æä¾›äº† _strnicmp æ¥å£ï¼Œæœ‰å¯èƒ½è€ç‰ˆæœ¬é‡Œé¢ä¹Ÿæ²¡è¿™ä¸ªæ¥å£ï¼ŒåŒæ—¶ä¹Ÿä¸èƒ½ä¿è¯æ‰€æœ‰ gcc å’Œ clang çš„å·¥å…·é“¾éƒ½æä¾›äº† strncasecmpï¼Œæœ‰äº›åµŒå…¥å¼ç³»ç»Ÿçš„äº¤å‰ç¼–è¯‘å·¥å…·é“¾ä¸ºäº†ç²¾ç®€ï¼Œå¯èƒ½ä¼šå»æ‰éƒ¨åˆ† libc æ¥å£ä¹Ÿæ˜¯æœ‰å¯èƒ½çš„ã€‚\nå› æ­¤ï¼Œå•çº¯çš„åˆ¤æ–­ç¼–è¯‘å™¨æ˜¯ä¸è¡Œçš„ï¼Œæˆ‘ä»¬åº”è¯¥ç›´æ¥æ£€æµ‹å½“å‰ä½¿ç”¨çš„ç¼–è¯‘å·¥å…·é“¾é‡Œé¢æœ‰æ²¡æœ‰è¿™ä¸ªæ¥å£ï¼Œå¦‚æœæœ‰å°±ç”¨ï¼Œæ²¡æœ‰å°±ä¸å»ç”¨å®ƒã€‚ä½†æ˜¯ï¼Œè¿™ç§æ£€æµ‹åœ¨ä»£ç ä¸­é€šè¿‡å®æ˜¯å®Œæˆä¸äº†çš„ï¼Œè¿™æ—¶å€™å°±éœ€è¦æ„å»ºå·¥å…·å»æä¾›æ”¯æŒæ‰è¡Œã€‚\nä¾‹å¦‚ï¼Œæˆ‘ä»¬åœ¨ç¼–è¯‘çš„æ—¶å€™ï¼Œæ„å»ºå·¥å…·å…ˆè‡ªåŠ¨æ£€æµ‹å½“å‰çš„ç¼–è¯‘å·¥å…·é“¾é‡Œé¢æ˜¯å¦èƒ½å¤Ÿæ­£å¸¸ä½¿ç”¨ _strnicmp æ¥å£ï¼Œå¦‚æœæ£€æµ‹é€šè¿‡ï¼Œé‚£ä¹ˆå¯ä»¥è‡ªåŠ¨ç»™ç¼–è¯‘å™¨ä¼ é€’ä¸€ä¸ªå®å®šä¹‰ï¼Œä¾‹å¦‚ HAVE_STRNICMPï¼Œè¿™æ ·å°±å¯ä»¥åœ¨ä»£ç ä¸­è¿›è¡Œæ›´å‡†ç¡®çš„åˆ¤æ–­å¤„ç†ã€‚\n#if defined(HAVE_STRNICMP)\r_strnicmp(s1, s2, n);\r#elif defined(HAVE_STRNCASECMP)\rstrncasecmp(s1, s2, n);\r#else\r# error \u0026quot;not supported\u0026quot;\r#endif\r ä¸Šè¿°çš„ä»£ç åˆ¤æ–­é€»è¾‘å·²ç»ç›¸å¯¹æ¯”è¾ƒå¯é ï¼Œä¹Ÿå·²ç»èƒ½å¾ˆå¥½çš„å¤„ç†è·¨å¹³å°äº†ã€‚å¦‚æœå½“å‰ç¼–è¯‘å™¨æ²¡æä¾›å¯¹åº”æ¥å£ï¼Œæˆ‘ä»¬è¦ä¹ˆç›´æ¥æŠ¥é”™ã€æç¤ºä¸æ”¯æŒï¼Œè¦ä¹ˆå¯ä»¥è‡ªå·±å®ç°è¿™ä¸ªæ¥å£æŠŠå®ƒæ”¯æŒä¸Šã€‚\nå› æ­¤ï¼Œä¸ºäº†è®©å¤§å®¶æ›´æ–¹ä¾¿çš„å¤„ç†è·¨å¹³å°ï¼Œxmake å†…ç½®æä¾›äº†å„ç§ä¾¿äºæ£€æµ‹çš„é…ç½®æ¥å£ï¼Œæ–¹ä¾¿ç”¨æˆ·å®šåˆ¶åŒ–é…ç½®æ£€æµ‹ç¼–è¯‘å™¨ç‰¹æ€§ã€å¤´æ–‡ä»¶ã€æ¥å£ã€åº“ã€ç±»å‹ç­‰æ”¯æŒåŠ›åº¦ï¼Œä¸‹é¢æˆ‘ä»¬ä¼šé€ä¸€è¯¦ç»†è®²è§£å¦‚ä½•å»é…ç½® xmake.lua æ¥å®ç°è·¨å¹³å°ç‰¹æ€§æ£€æµ‹ã€‚\né…ç½®åº“å¤´æ–‡ä»¶æ£€æµ‹ å…ˆä»æœ€ç®€å•çš„ä¾‹å­å¼€å§‹ï¼Œå‡è®¾æˆ‘ä»¬ç°åœ¨éœ€è¦ä½¿ç”¨ pthread åº“ï¼Œä½†ä¸ç¡®å®šå½“å‰ç¯å¢ƒå’Œå·¥å…·é“¾æ˜¯å¦å·²ç»æä¾›äº† pthread.h å¤´æ–‡ä»¶ï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡é…ç½®æ£€æµ‹ä¸‹è¿™ä¸ªå¤´æ–‡ä»¶æ˜¯å¦åœ¨ã€‚\nåœ¨é…ç½®æ£€æµ‹å‰ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤åˆ›å»ºä¸€ä¸ªç©ºå·¥ç¨‹ã€‚\ncd Code\rxmake create check\r ç„¶åä¿®æ”¹å…¶ä¸­çš„ xmake.lua æ–‡ä»¶é…ç½®ï¼Œé€šè¿‡ includes æ¥å£å¼•å…¥ xmake å†…ç½®æä¾›çš„ check_cincludes.lua è¾…åŠ©æ¥å£æ–‡ä»¶ï¼Œå¼•å…¥åå°±å¯ä»¥ä½¿ç”¨é‡Œé¢æä¾›çš„ check_cincludes è¾…åŠ©æ¥å£å»æ£€æµ‹å¤´æ–‡ä»¶æ˜¯å¦å­˜åœ¨ã€‚\nincludes(\u0026quot;check_cincludes.lua\u0026quot;)\rtarget(\u0026quot;check\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\rcheck_cincludes(\u0026quot;HAS_PTHREAD_H\u0026quot;, \u0026quot;pthread.h\u0026quot;)\r ä¸Šé¢çš„é…ç½®ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ check_cincludes é…ç½®äº† pthread.h å¤´æ–‡ä»¶çš„æ£€æµ‹ï¼Œå¦‚æœæ£€æµ‹é€šè¿‡ï¼Œé‚£ä¹ˆç¼–è¯‘æ—¶ï¼Œ-DHAS_PTHREAD_H å®å®šä¹‰ä¼šè‡ªåŠ¨ä¼ é€’ç»™ gcc ç¼–è¯‘å™¨ã€‚è¿™æ ·å°±å¯ä»¥åœ¨ä»£ç ä¸­é€šè¿‡è¿™ä¸ªå®å®šä¹‰åˆ¤æ–­å‡ºå½“å‰çš„ç¼–è¯‘ç¯å¢ƒæ˜¯å¦å­˜åœ¨è¿™ä¸ªå¤´æ–‡ä»¶äº†ã€‚\nä¿®æ”¹ src/main.cpp ä¸­çš„ä»£ç ï¼ŒåŠ ä¸Šå¯¹ HAS_PTHREAD_H çš„åˆ¤æ–­æ£€æµ‹ï¼Œä¾‹å¦‚ã€‚\n#ifdef HAS_PTHREAD_H\r# include \u0026lt;pthread.h\u0026gt;\r#else\r# error \u0026quot;pthread.h not found!\u0026quot;\r#endif\rint main(int argc, char** argv)\r{\rreturn 0;\r}\r è¿™é‡Œä»…ä»…åˆ¤æ–­ pthread.h æ˜¯å¦å­˜åœ¨ï¼Œä¸å­˜åœ¨å°±ç›´æ¥æŠ¥é”™ã€‚å½“ç„¶å¦‚æœè¦çœŸæ­£çš„æ”¯æŒè·¨å¹³å°ï¼Œæˆ‘ä»¬åº”è¯¥å¤„ç†çš„æ›´å®Œå–„äº›ï¼Œæ¯”å¦‚åˆ¤æ–­ pthread.h ä¸å­˜åœ¨ï¼Œé‚£å°±ç»§ç»­å°è¯•å…¶å®ƒçš„çº¿ç¨‹æ¥å£ï¼Œæ¯”å¦‚ Windows ä¸‹çš„çº¿ç¨‹ API ç­‰ç­‰ã€‚\nä¸€åˆ‡å‡†å¤‡å°±ç»ªåï¼Œæ‰§è¡Œ xmake å»ç¼–è¯‘è¿™ä¸ªå·¥ç¨‹ï¼Œxmake ä¼šåœ¨ç¼–è¯‘çš„å‰æœŸè‡ªåŠ¨æ£€æµ‹ pthread.h æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨ï¼Œå°±ä¼šçœ‹åˆ°ä¸‹å›¾çº¢çº¿ä½ç½®çš„æ£€æµ‹ç»“æœï¼Œå¹¶ä¸”æ­£å¸¸é€šè¿‡ç¼–è¯‘ã€‚\nåªè¦ç¼–è¯‘æ²¡æŠ¥é”™ï¼Œå°±è¯´æ˜æ£€æµ‹é€šè¿‡å¹¶ä¸” HAS_PTHREAD_H å·²ç»è¢«å®šä¹‰ä¸Šäº†ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å†æ‰§è¡Œ xmake -rv é‡æ–°ç¼–è¯‘æŸ¥çœ‹å®Œæ•´çš„ç¼–è¯‘è¾“å‡ºï¼Œç»§ç»­ç¡®è®¤ä¸‹ -DHAS_PTHREAD_H æ˜¯å¦çœŸçš„è¢«ä¼ é€’åˆ°äº† gcc ç¼–è¯‘å™¨ï¼Œå¦‚å›¾æ‰€ç¤ºã€‚\né…ç½®è‡ªåŠ¨ç”Ÿæˆ config.h ä¹Ÿå¯ä»¥å°†æ£€æµ‹ç»“æœæ°¸ä¹…ä¿å­˜ä¸‹æ¥ï¼Œå¹¶å°†å¯¹åº”æ£€æµ‹åçš„å®å®šä¹‰æ”¾ç½®åœ¨ç‰¹å®šçš„ config.h å¤´æ–‡ä»¶ä¸­ï¼Œè¿™ä¾¿äºæˆ‘ä»¬å°†è‡ªå·±é¡¹ç›®çš„åº“å¤´æ–‡ä»¶å¯¼å‡ºç»™å…¶å®ƒç‹¬ç«‹å·¥ç¨‹ä½¿ç”¨ï¼Œåªéœ€è¦é™„å¸¦æä¾›è¿™ä¸ª config.h å°±è¡Œäº†ã€‚\nä¸ºäº†æ”¯æŒè‡ªåŠ¨ç”Ÿæˆ config.h æ–‡ä»¶ï¼Œåªéœ€è¦ä¿®æ”¹ xmake.luaï¼Œä¾‹å¦‚ã€‚\nincludes(\u0026quot;check_cincludes.lua\u0026quot;)\rtarget(\u0026quot;check\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\radd_configfiles(\u0026quot;config.h.in\u0026quot;)\rset_configdir(\u0026quot;$(buildir)\u0026quot;)\radd_includedirs(\u0026quot;$(buildir)\u0026quot;)\rconfigvar_check_cincludes(\u0026quot;HAS_PTHREAD_H\u0026quot;, \u0026quot;pthread.h\u0026quot;)\r ä¸Šé¢çš„é…ç½®ç›¸æ¯”ä¹‹å‰ç¨å¾®å¤æ‚äº›ï¼Œä½†è¿˜æ˜¯å¾ˆå¥½ç†è§£çš„ï¼Œå…¶ä¸­ add_configfiles ç”¨äºè®¾ç½® config.h.in ä½œä¸ºé…ç½®æ¨¡æ¿æ–‡ä»¶ï¼Œä¸€ä¼šæ£€æµ‹å®Œæˆåï¼Œä¼šæŠŠç»“æœç”Ÿæˆåˆ°å¯¹åº”çš„ config.h ä¸­ï¼Œå…·ä½“ç”Ÿæˆåˆ°å“ªé‡Œï¼Œç”± set_configdir æŒ‡å®šï¼Œè¿™é‡Œæˆ‘ä»¬é…ç½®å°†å…¶ç”Ÿæˆåˆ° build ç›®å½•ä¸‹ã€‚\nè€Œ configvar_check_cincludes ä¹Ÿå°±æ˜¯è·Ÿä¹‹å‰çš„ check_cincludes æ£€æµ‹æ¥å£ç±»ä¼¼ï¼Œå·®åˆ«åœ¨äºï¼Œå‰è€…æ£€æµ‹å®Œä¼šæŠŠç»“æœå­˜å‚¨åˆ° config.hï¼Œè€Œåè€…æ£€æµ‹å®Œä»…ä»…åªä¼šç›´æ¥ä¼ é€’ç»™ç¼–è¯‘å™¨ï¼Œä¸ä¼šæ°¸ä¹…ä¿å­˜ã€‚\né…ç½®å®Œæˆåï¼Œæˆ‘ä»¬ç»§ç»­åœ¨å½“å‰é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»ºå¹¶ç¼–è¾‘ config.h.in æ–‡ä»¶ï¼Œè¿™æ˜¯ä¸€ä¸ªæ¨¡æ¿æ–‡ä»¶ï¼Œxmake ä¼šåŸºäºè¿™ä¸ªæ¨¡æ¿æ–‡ä»¶æä¾›çš„å†…å®¹æ¥ç”Ÿæˆå®é™…çš„ config.hã€‚\nconfig.h.in æ¨¡æ¿æ–‡ä»¶çš„å†…å®¹å¦‚ä¸‹ã€‚\n${define HAS_PTHREAD_H}\r å½“å‰åªéœ€è¦åŠ ä¸€è¡Œä»£ç ï¼Œå®šä¹‰äº†ä¸€ä¸ªæ¨¡æ¿å˜é‡ï¼Œå¦‚æœ xmake æ£€æµ‹ pthread.h é€šè¿‡ï¼Œé‚£ä¹ˆè¿™è¡Œä¼šè¢«è‡ªåŠ¨å±•å¼€æˆä¸‹é¢çš„ä»£ç ï¼Œç„¶åå­˜å‚¨åˆ° config.h æ–‡ä»¶ä¸­å»ã€‚\n#define HAS_PTHREAD_H 1\r å¦‚æœæ£€æµ‹æ²¡é€šè¿‡ï¼Œé‚£ä¹ˆè¿™è¡Œä¼šè¢«è‡ªåŠ¨å±•å¼€ä¸ºä¸‹é¢çš„å®šä¹‰ï¼Œä¹Ÿå°±æ˜¯ä¸å®šä¹‰ HAS_PTHREAD_Hã€‚\n/*#define HAS_PTHREAD_H 0*/\r å¦å¤–ï¼Œé™¤äº†é…ç½® xmake.lua å’Œ config.h.in æ–‡ä»¶ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ”¹ä¸‹ src/main.cpp å°†è‡ªåŠ¨ç”Ÿæˆçš„ config.h å¼•å…¥è¿›æ¥è·å–æ£€æµ‹åçš„å®å®šä¹‰ç»“æœï¼Œä¾‹å¦‚ã€‚\n#include \u0026quot;config.h\u0026quot;\r#ifdef HAS_PTHREAD_H\r# include \u0026lt;pthread.h\u0026gt;\r#else\r# error \u0026quot;pthread.h not found!\u0026quot;\r#endif\rint main(int argc, char** argv)\r{\rreturn 0;\r}\r ç›¸æ¯”ä¹‹å‰çš„ä»£ç ï¼Œè¿™é‡Œè¿˜å¤šäº†ä¸€è¡Œ #include \u0026quot;config.h\u0026quot; æ¥å¼•å…¥ config.h å¤´æ–‡ä»¶è·å–æ£€æµ‹ç»“æœï¼Œä¹Ÿå°±æ˜¯ HAS_PTHREAD_Hã€‚\nåˆ°è¿™é‡Œä¸ºæ­¢ï¼Œæˆ‘ä»¬æ•´ä¸ªé…ç½®è¿‡ç¨‹å°±ç®—å®Œæˆäº†ã€‚ç°åœ¨æ‰§è¡Œ xmake å‘½ä»¤ï¼Œç¡®è®¤æ˜¯å¦èƒ½å¤Ÿé€šè¿‡ç¼–è¯‘ï¼Œå¦‚æœç¼–è¯‘é€šè¿‡ï¼Œè¯´æ˜æ£€æµ‹åˆ°äº† pthread.h æ–‡ä»¶ï¼Œå¹¶ä¸”è·å–åˆ°äº† HAS_PTHREAD_H å®šä¹‰ï¼Œå› æ­¤ä¹Ÿå°±ä¸ä¼šæŠ¥ pthread.h not found! çš„ç¼–è¯‘é”™è¯¯ã€‚\nç¼–è¯‘ç»“æœå¦‚ä¸‹å›¾ã€‚\nä¸Šé¢çº¢çº¿éƒ¨åˆ†æç¤ºæ£€æµ‹æ­£å¸¸é€šè¿‡ï¼Œå¹¶ä¸”è¿˜è‡ªåŠ¨ç”Ÿæˆäº† config.h æ–‡ä»¶ï¼Œè‡³äºå®ƒçš„è¾“å‡ºä½ç½®ï¼Œå°±æ˜¯ä¹‹å‰ xmake.lua é…ç½®ä¸­æŒ‡å®šçš„ build ç›®å½•ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚\næ‰§è¡Œ cat ./build/config.h å‘½ä»¤ï¼ŒæŸ¥çœ‹å®é™…ç”Ÿæˆåˆ° config.h æ–‡ä»¶é‡Œé¢çš„å†…å®¹ï¼Œè¯´æ˜ HAS_PTHREAD_H ç¡®å®è¢«å®šä¹‰è¿›å»äº†ã€‚\næ³¨ï¼šxmake ä¼šä¸¥æ ¼æŒ‰ç…§é…ç½®åœ¨ config.h.in é‡Œé¢çš„å†…å®¹æ ¼å¼ç”Ÿæˆå’Œæ›¿æ¢æ¨¡æ¿å˜é‡ï¼Œä¸ä¼šè‡ªå·±é¢å¤–æ·»åŠ ä¸å­˜åœ¨çš„é…ç½®ï¼Œå…³äºè¿™ä¸ªé…ç½®æ¨¡æ¿ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å‚è€ƒä¸‹ tbox åº“é‡Œé¢çš„ tbox.config.h.in æ–‡ä»¶ï¼Œæ¥æ›´ç›´è§‚åœ°äº†è§£ã€‚\né…ç½®åº“æ¥å£æ£€æµ‹ è™½ç„¶åˆšåˆšå®Œæˆäº†å¤´æ–‡ä»¶çš„è‡ªåŠ¨æ£€æµ‹ï¼Œä½†æ˜¯å³ä½¿æ£€æµ‹é€šè¿‡ï¼Œä¹Ÿä¸ä»£è¡¨è¿™ä¸ªå¤´æ–‡ä»¶é‡Œé¢æœ‰æˆ‘ä»¬éœ€è¦çš„æ¥å£ï¼Œæ¯•ç«Ÿéšç€å¹³å°å’Œç¼–è¯‘ç¯å¢ƒçš„å·®å¼‚ï¼Œå³ä½¿ç›¸åŒçš„å¤´æ–‡ä»¶ï¼Œä¹Ÿä¼šéšç€ä¸€äº›å®å®šä¹‰çš„ä¸åŒï¼Œæ¥å£ä¹Ÿä¼šéšä¹‹å˜åŠ¨ã€‚\nä¸ºäº†æ›´å¥½åœ°å¤„ç†è·¨å¹³å°ï¼Œæˆ‘ä»¬åº”è¯¥æ£€æµ‹æŒ‡å®šå¤´æ–‡ä»¶é‡Œé¢æ˜¯å¦ç¡®å®å­˜åœ¨éœ€è¦çš„æ¥å£ API æ‰è¡Œï¼Œè€Œ xmake ä¹Ÿæä¾›äº†æ¥å£æ£€æµ‹ç›¸å…³çš„è¾…åŠ©æ¥å£ã€‚ç»§ç»­ä¿®æ”¹ xmake.lua æ–‡ä»¶ï¼Œåœ¨ä¹‹å‰çš„é…ç½®åŸºç¡€ä¸Šï¼Œæ–°å¼•å…¥ä¸€ä¸ª check_cfuncs çš„è¾…åŠ©æ¥å£ï¼Œå»å°è¯•ä» signal.h å’Œ setjmp.h å¤´æ–‡ä»¶ä¸­æ£€æµ‹æ˜¯å¦å­˜åœ¨ setjmp æ¥å£ã€‚\nincludes(\u0026quot;check_cfuncs.lua\u0026quot;)\rincludes(\u0026quot;check_cincludes.lua\u0026quot;)\rtarget(\u0026quot;check\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\radd_configfiles(\u0026quot;config.h.in\u0026quot;)\rset_configdir(\u0026quot;$(buildir)\u0026quot;)\radd_includedirs(\u0026quot;$(buildir)\u0026quot;)\rconfigvar_check_cincludes(\u0026quot;HAS_PTHREAD_H\u0026quot;, \u0026quot;pthread.h\u0026quot;)\rconfigvar_check_cfuncs(\u0026quot;HAS_SETJMP\u0026quot;, \u0026quot;setjmp\u0026quot;, {includes = {\u0026quot;signal.h\u0026quot;, \u0026quot;setjmp.h\u0026quot;}})\r è¿™é‡Œä¸ºäº†æ£€æµ‹ C å‡½æ•°æ¥å£ï¼Œéœ€è¦é€šè¿‡ {includes = {}} æŒ‡å®šä»å“ªäº›å¤´æ–‡ä»¶ä¸­å»æ£€æµ‹ï¼ˆè¿˜å¯ä»¥ä¼ é€’ definesã€links ç­‰å‚æ•°æ¥æ‰©å±•æ£€æµ‹ï¼‰ï¼Œè€Œç¬¬äºŒä¸ªå‚æ•°å°±æ˜¯æŒ‡å®šéœ€è¦æ£€æµ‹çš„å‡½æ•°å setjmpã€‚\né™¤äº†æŒ‡å®šå‡½æ•°åï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å†™ä¼ é€’å‚æ•°æ¥æ‰©å±•å‡½æ•°æ£€æµ‹ï¼Œå…·ä½“çœ‹è‡ªå·±çš„æ£€æµ‹éœ€æ±‚ï¼Œå› ä¸ºæœ‰æ—¶å€™å®šä¹‰åœ¨å¤´æ–‡ä»¶çš„æ¥å£å…¶å®ä¸æ˜¯å‡½æ•°ï¼Œæ˜¯å®å®šä¹‰è¿‡çš„ï¼Œè¿™æ—¶å•çº¯çš„æŒ‡å®šå‡½æ•°åï¼Œæ˜¯æ£€æµ‹ä¸è¿‡çš„ï¼Œæˆ‘ä»¬é€šè¿‡ä¼ é€’å‚æ•°è°ƒç”¨æ¥é€šè¿‡æ£€æµ‹ã€‚\nå…·ä½“å¯¹äºè®¾ç½® check_cfuncs çš„å‡½æ•°åæè¿°è§„åˆ™å¦‚ä¸‹ã€‚\n   å‡½æ•°æè¿° è¯´æ˜     sigsetjmp çº¯å‡½æ•°å   sigsetjmp((void*)0, 0) å‡½æ•°è°ƒç”¨   sigsetjmp{int a = 0; sigsetjmp((void*)a, a);} å‡½æ•°å + {}å—    æ¥ä¸‹æ¥æˆ‘ä»¬åœ¨ config.h.in æ–‡ä»¶ä¸­åŠ å…¥è¿™ä¸ªå®å¼€å…³ã€‚\n${define HAS_PTHREAD_H}\r${define HAS_SETJMP}\r åœ¨ src/main.cpp æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬ä¹ŸåŠ ä¸Šå¯¹åº”çš„å®å¼€å…³æ¥åˆ¤æ–­æ˜¯å¦æ£€æµ‹åˆ°ï¼Œå¦‚æœæ£€æµ‹åˆ°å°±å¼•å…¥ setjmp æ¥å£è¿›æ¥ã€‚\n#include \u0026quot;config.h\u0026quot;\r#ifdef HAS_PTHREAD_H\r# include \u0026lt;pthread.h\u0026gt;\r#else\r# error \u0026quot;pthread.h not found!\u0026quot;\r#endif\r#ifdef HAS_SETJMP\r# include \u0026lt;signal.h\u0026gt;\r# include \u0026lt;setjmp.h\u0026gt;\r#else\r# error \u0026quot;setjmp() not found!\u0026quot;\r#endif\rint main(int argc, char** argv)\r{\rreturn 0;\r}\r ç„¶åæ‰§è¡Œ xmake å‘½ä»¤ç¼–è¯‘ï¼ŒæŸ¥çœ‹æ˜¯å¦èƒ½å¤Ÿæ£€æµ‹é€šè¿‡ã€å®Œæˆç¼–è¯‘ï¼Œå› ä¸ºåœ¨ Linux ä¸‹é€šå¸¸éƒ½æ˜¯å­˜åœ¨è¿™ä¸ª setjmp æ¥å£çš„ï¼Œå› æ­¤é€šå¸¸æ˜¯å¯ä»¥ç¼–è¯‘é€šè¿‡çš„ï¼Œå¦‚ä¸‹å›¾ã€‚\nç¼–è¯‘é€šè¿‡åï¼Œæˆ‘ä»¬å†æ¥çœ‹ä¸‹ build/config.h é‡Œé¢çš„å†…å®¹ï¼Œè¿™æ—¶ ${define HAS_SETJMP} æ¨¡æ¿å˜é‡å·²ç»è‡ªåŠ¨å˜æˆäº† #define HAS_SETJMP 1ï¼Œè¯´æ˜æ£€æµ‹é¡ºåˆ©é€šè¿‡ã€‚\né…ç½®ç¼–è¯‘å™¨ç‰¹æ€§æ£€æµ‹ ç”±äºä¸åŒçš„ç¼–è¯‘å™¨å¯¹ C++ æ ‡å‡†çš„æ”¯æŒåŠ›åº¦éƒ½æ˜¯ä¸åŒçš„ï¼Œæœ‰äº›ç¼–è¯‘å™¨å¯èƒ½å¹¶ä¸æ”¯æŒ C++ çš„ä¸€äº›é«˜ç‰ˆæœ¬æ ‡å‡†ä¸­çš„ç‰¹æ€§ï¼Œè¿™æ—¶æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ xmake æä¾›çš„ç¼–è¯‘å™¨ç‰¹æ€§æ£€æµ‹æ¥å£å»æ£€æµ‹å®ƒä»¬ã€‚\nè¿™é‡Œä»¥ C++11 çš„ constexpr ä¸ºä¾‹ï¼Œåœ¨ç¼–è¯‘ä»£ç æ—¶ï¼Œæ£€æµ‹åˆ¤æ–­æ˜¯å¦æ”¯æŒ constexprï¼Œå¦‚æœä¸æ”¯æŒï¼Œæˆ‘ä»¬å°±ä¸ä½¿ç”¨è¿™ä¸ªå…³é”®å­—ã€‚\nä¸ºäº†ç®€åŒ–å®éªŒæ­¥éª¤ï¼Œè¿™é‡Œé‡æ–°ä¿®æ”¹ xmake.lua é…ç½®ï¼Œå»æ‰å¯¹ config.h çš„ä½¿ç”¨ï¼Œç›´æ¥é€šè¿‡ check_features æ¥å£å»å®Œæˆ C++ ç‰¹æ€§çš„æ£€æµ‹ï¼Œä¾‹å¦‚ã€‚\nincludes(\u0026quot;check_features.lua\u0026quot;)\rtarget(\u0026quot;check\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\rcheck_features(\u0026quot;HAS_CONSTEXPR\u0026quot;, \u0026quot;cxx_constexpr\u0026quot;)\r å…¶ä¸­ cxx_constexpr å°±æ˜¯æŒ‡ C++ çš„ constexpr ç‰¹æ€§åç§°ï¼Œå…³äºå®Œæ•´çš„ C++ ç‰¹æ€§åç§°åˆ—è¡¨ï¼Œæˆ‘ä»¬å¯ä»¥åˆ° C++ ç‰¹æ€§åˆ—è¡¨åç§° æŸ¥çœ‹ã€‚\nç„¶åä¿®æ”¹ src/main.cpp ä¸­çš„ä»£ç ï¼Œæ”¹æˆå¦‚ä¸‹å¯¹ constexpr çš„ä½¿ç”¨ã€‚\n#ifdef HAS_CONSTEXPR\rconstexpr int a = 1;\rconstexpr int c = a * 2 + 1;\r#else\r# error \u0026quot;constexpr not supported!\u0026quot;\r#endif\rint main(int argc, char** argv)\r{\rreturn 0;\r}\r è¿™ä¸ªæ—¶å€™ï¼Œå¦‚æœæˆ‘ä»¬æ‰§è¡Œ xmake ç¼–è¯‘åï¼Œä¼šå‘ç° constexpr çš„ç‰¹æ€§å¹¶æ²¡æœ‰æ£€æµ‹é€šè¿‡ï¼Œç¼–è¯‘ä¹Ÿæ˜¯å¤±è´¥çš„ï¼Œå¦‚ä¸‹å›¾ã€‚\né‚£æ˜¯å› ä¸ºè¿™ä¸ªå…³é”®å­—ä»…ä»…åªåœ¨ c++11 æ ‡å‡†ä¹‹åæ‰ç”Ÿæ•ˆï¼Œå› æ­¤éœ€è¦å¯¹ target å¯ç”¨ c++11 æ ‡å‡†ï¼Œå¹¶ä¸”å¯¹äº check_features æ£€æµ‹æ¥å£ï¼Œä¹Ÿéœ€è¦ä¼ é€’ c++11 çš„è¯­è¨€æ ‡å‡†ç»™å®ƒæ‰èƒ½é€šè¿‡æ£€æµ‹ã€‚\nå› æ­¤ç»§ç»­ä¿®æ”¹å®Œå–„ xmake.lua é…ç½®ï¼Œä¿®æ”¹å¦‚ä¸‹ã€‚\nincludes(\u0026quot;check_features.lua\u0026quot;)\rtarget(\u0026quot;check\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\rset_languages(\u0026quot;c++11\u0026quot;)\rcheck_features(\u0026quot;HAS_CONSTEXPR\u0026quot;, \u0026quot;cxx_constexpr\u0026quot;, {languages = \u0026quot;c++11\u0026quot;})\r è®¾ç½®ä¸Š c++11 è¯­è¨€æ ‡å‡†åï¼Œå†æ¥æ‰§è¡Œ xmake å‘½ä»¤å°±èƒ½é¡ºåˆ©é€šè¿‡æ£€æµ‹å’Œç¼–è¯‘äº†ã€‚\né…ç½®è‡ªå®šä¹‰ C/C++ ä»£ç ç‰‡æ®µæ£€æµ‹ è™½ç„¶ï¼Œxmake æä¾›äº†å¾ˆå¤šå†…ç½®çš„è¾…åŠ©æ£€æµ‹æ¥å£ï¼Œå¯ä»¥æ–¹ä¾¿çš„æ£€æµ‹å¤´æ–‡ä»¶ã€åº“æ¥å£ã€ç±»å‹å®šä¹‰ã€ç¼–è¯‘å™¨ç‰¹æ€§ç­‰ç­‰ï¼Œä½†æ˜¯å¯¹äºä¸€äº›æ¯”è¾ƒå¤æ‚çš„æ£€æµ‹ï¼Œå•çº¯é è¿™äº›æ˜¯æ— æ³•æ»¡è¶³çš„ï¼Œè¿™æ—¶æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡ xmake æä¾›çš„é€šç”¨æ£€æµ‹æ¥å£ï¼Œä¹Ÿå°±æ˜¯ C/C++ ä»£ç ç‰‡æ®µæ£€æµ‹ï¼Œæ¥å®ç°ä»»æ„çš„ç”¨æˆ·æ£€æµ‹éœ€æ±‚ã€‚\nå¯ä»¥åœ¨æ£€æµ‹æ¥å£ä¸­ï¼Œä¼ å…¥ä¸€å°æ®µ C/C++ ä»£ç ç‰‡æ®µï¼Œæ¥å®ç°æˆ‘ä»¬æ‰€å¸Œæœ›çš„æ£€æµ‹é€»è¾‘ï¼Œå…¶ä¸­ check_csnippets ç”¨äºæ£€æµ‹ C ä»£ç ç‰‡æ®µï¼Œè€Œ check_cxxsnippets ç”¨äºæ£€æµ‹ C++ ä»£ç ç‰‡æ®µã€‚\nç»§ç»­ä¿®æ”¹ä¹‹å‰çš„ xmake.lua æ–‡ä»¶ï¼ŒåŠ ä¸Šå¯¹è¿™ä¸¤ä¸ªæ¥å£çš„é…ç½®ä½¿ç”¨ï¼Œä¾‹å¦‚ã€‚\nincludes(\u0026quot;check_csnippets.lua\u0026quot;)\rincludes(\u0026quot;check_cxxsnippets.lua\u0026quot;)\rtarget(\u0026quot;check\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\rset_languages(\u0026quot;c++11\u0026quot;)\rcheck_csnippets(\u0026quot;HAS_STATIC_ASSERT\u0026quot;, \u0026quot;_Static_assert(1, \\\u0026quot;\\\u0026quot;);\u0026quot;)\rcheck_cxxsnippets(\u0026quot;HAS_CONSTEXPR\u0026quot;, \u0026quot;constexpr int a = 1;\u0026quot;, {languages = \u0026quot;c++11\u0026quot;})\r é€šè¿‡ä¸Šé¢çš„é…ç½®ï¼Œæˆ‘ä»¬çœ‹åˆ°å…¶ä¸­åŠ äº†ä¸¤ä¸ªä»£ç ç‰‡æ®µï¼Œä¸€ä¸ªæ˜¯ C ä»£ç ç‰‡æ®µï¼Œç”¨æ¥æ£€æµ‹èƒ½å¦ä½¿ç”¨ _Static_assert æ¥å®ç°é™æ€æ–­è¨€ï¼Œè€Œå¦å¤–ä¸€ä¸ªæ˜¯ C++ ä»£ç ç‰‡æ®µï¼Œç”¨æ¥å®ç°è·Ÿä¹‹å‰çš„ç¼–è¯‘å™¨ç‰¹æ€§æ£€æµ‹é…ç½®ä¸€æ ·çš„æ•ˆæœï¼Œä¹Ÿå°±æ˜¯æ£€æµ‹ constexpr æ˜¯å¦å¯ç”¨ã€‚\nä½†æ˜¯è·Ÿä¹‹å‰ä¸åŒçš„æ˜¯ï¼Œæˆ‘ä»¬è¿™é‡Œæ˜¯ç›´æ¥åœ¨é…ç½®ä¸­ä¼ å…¥äº†å®Œæ•´çš„ C++ ä»£ç ç‰‡æ®µï¼Œåœ¨é‡Œé¢å»ä½¿ç”¨ constexprï¼Œç„¶å xmake ä¼šå°è¯•è°ƒç”¨ gcc ç­‰ç¼–è¯‘å™¨å»ç¼–è¯‘å®ƒï¼Œå¦‚æœç¼–è¯‘é€šè¿‡ï¼Œå°±ä¼šå®šä¹‰ HAS_CONSTEXPR å®ï¼Œä¹Ÿå°±æ˜¯é€šè¿‡äº†æ£€æµ‹ã€‚\nåŒæ—¶ä¹Ÿéœ€è¦ä¿®æ”¹ src/main.cpp æ–‡ä»¶ï¼ŒåŠ ä¸Šå¯¹ HAS_STATIC_ASSERT å’Œ HAS_CONSTEXPR çš„å®å®šä¹‰æ£€æµ‹ã€‚\n#ifdef HAS_CONSTEXPR\rconstexpr int a = 1;\rconstexpr int c = a * 2 + 1;\r#else\r# error \u0026quot;constexpr not supported!\u0026quot;\r#endif\r#ifndef HAS_STATIC_ASSERT\r# error \u0026quot;_Static_assert not supported!\u0026quot;\r#endif\rint main(int argc, char** argv)\r{\rreturn 0;\r}\r ç„¶åæ‰§è¡Œ xmake ç¼–è¯‘ï¼Œå¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œå°±ä¼šçœ‹åˆ°ä¸‹å›¾ç¼–è¯‘é€šè¿‡çš„è¾“å‡ºä¿¡æ¯ã€‚\nå®éªŒæ€»ç»“ åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬äº†è§£äº†æ€æ ·æ‰èƒ½å®ç°è·¨å¹³å°å¼€å‘å’Œç¼–è¯‘ï¼Œå¹¶ä¸”ä¸»è¦å­¦ä¹ äº†å¦‚ä½•å»ä½¿ç”¨ xmake æä¾›çš„è¾…åŠ©æ¥å£æ¥é…ç½®æ£€æµ‹ C/C++ çš„å¤´æ–‡ä»¶ã€åº“æ¥å£æ˜¯å¦å­˜åœ¨ï¼Œä»¥åŠæ£€æµ‹æŒ‡å®šçš„ç¼–è¯‘å™¨ç‰¹æ€§å’Œ C/C++ ä»£ç ç‰‡æ®µæ˜¯å¦èƒ½å¤Ÿæ”¯æŒå¹¶ä½¿ç”¨ã€‚\næœ¬å®éªŒçš„å‚è€ƒä»£ç å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ä¸‹è½½ï¼š\nwget https://labfile.oss.aliyuncs.com/courses/2764/code11.zip\r ","id":56,"section":"categories","summary":"C/C++ åº“æ¥å£å’Œç¼–è¯‘å™¨ç‰¹æ€§æ£€æµ‹ åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬ä¼šå­¦ä¹ åˆ° C/C++ è·¨å¹³å°å¼€å‘ä¸­ä¸€äº›åŸºç¡€çŸ¥è¯†å’Œæ³¨æ„ç‚¹ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨ xmake å»æ£€æµ‹ä¸åŒç¼–è¯‘ç¯å¢ƒä¸­çš„ C/C++ åº“å¤´æ–‡ä»¶ã€åº“æ¥å£","tags":["xmake"],"title":"å®éªŒ11C/C++ åº“æ¥å£å’Œç¼–è¯‘å™¨ç‰¹æ€§æ£€æµ‹","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/app/xmake/%E8%93%9D%E6%A1%A5%E7%BD%91%E8%AF%BE/3xmake%E8%BF%9B%E9%98%B6/%E5%AE%9E%E9%AA%8C11ccpp%E5%BA%93%E6%8E%A5%E5%8F%A3%E5%92%8C%E7%BC%96%E8%AF%91%E5%99%A8%E7%89%B9%E6%80%A7%E6%A3%80%E6%B5%8B/","year":"2021"},{"content":"C_C++é¢„ç¼–è¯‘å¤´æ–‡ä»¶é…ç½® åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬ä¼šå­¦ä¹ åˆ° C/C++ é¢„ç¼–è¯‘å¤´æ–‡ä»¶çš„ä¸€äº›åŸºæœ¬æ¦‚å¿µï¼Œäº†è§£å¦‚ä½•åœ¨ xmake ä¸­é…ç½®å¼€å¯å¤´æ–‡ä»¶é¢„ç¼–è¯‘ï¼Œä»¥åŠä¼šåšä¸€äº›å¯¹æ¯”æµ‹è¯•æ¥ç›´è§‚æ„Ÿå—é¢„ç¼–è¯‘å¤´æ–‡ä»¶å¯¹ç¼–è¯‘æ€§èƒ½çš„å½±å“ã€‚\nçŸ¥è¯†ç‚¹  C/C++ é¢„ç¼–è¯‘å¤´æ–‡ä»¶çš„åŸºç¡€æ¦‚å¿µ gcc ç¼–è¯‘å™¨å¯¹é¢„ç¼–è¯‘çš„å¤„ç†ç»†èŠ‚ é¢„ç¼–è¯‘å¤´æ–‡ä»¶å¯¹ç¼–è¯‘é€Ÿåº¦çš„å½±å“æ¯”å¯¹ xmake ä¸­å¦‚ä½•é…ç½®å¼€å¯å¤´æ–‡ä»¶é¢„ç¼–è¯‘  é¢„ç¼–è¯‘å¤´æ–‡ä»¶ä»‹ç» åœ¨ç¼–è¯‘å™¨ç¼–è¯‘æ¯ä¸ª C++ ä»£ç çš„æ—¶å€™ï¼Œéƒ½éœ€è¦é¢å¤–å¤„ç†ä¸€éæ‰€æœ‰è¢«å¼•å…¥çš„å¤´æ–‡ä»¶ï¼Œè€Œ C++ å¤´æ–‡ä»¶çš„å¼•å…¥å°±ä¼šå¸¦æ¥å¤§é‡çš„ç±»å‹å®šä¹‰ï¼ŒC++ æ¨¡æ¿ç±»å®šä¹‰ç­‰ï¼Œéƒ½ä¼šå¯¼è‡´æºæ–‡ä»¶çš„ç¼–è¯‘é€Ÿåº¦éå¸¸çš„æ…¢ã€‚\nå¦‚æœæˆ‘ä»¬ä½¿ç”¨è¿‡ boostã€std ç­‰ C++ åº“ï¼Œå°±åº”è¯¥çŸ¥é“ï¼Œè¿™äº›åº“å¤§éƒ¨åˆ†ç±»å®šä¹‰éƒ½åœ¨å¤´æ–‡ä»¶ä¸­ï¼Œè€Œä¸”å¤§é‡ä½¿ç”¨äº† C++ æ¨¡æ¿ç‰¹æ€§ï¼Œå¼•å…¥ä¸€ä¸ªå¤´æ–‡ä»¶å°±ä¼šä½¿å¾—æ•´ä½“ç¼–è¯‘æ…¢å¾ˆå¤šï¼Œå°¤å…¶æ˜¯è‡ƒè‚¿çš„ boost åº“ã€‚\nå› æ­¤ï¼Œä¸ºäº†ä¼˜åŒ–ç¼–è¯‘é€Ÿåº¦ï¼Œå…¶å®æˆ‘ä»¬ä¸éœ€è¦ç¼–è¯‘æ¯ä¸ªæºæ–‡ä»¶éƒ½å»é‡å¤é¢„å¤„ç†ä¸€éé‡Œé¢çš„å¤´æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå¤§éƒ¨åˆ†é¡¹ç›®å¸¸ç”¨çš„å¤´æ–‡ä»¶æ”¾ç½®åœ¨ä¸€ä¸ªç»Ÿä¸€çš„å¤´æ–‡ä»¶ä¸­ï¼Œæ¯”å¦‚ï¼šstdafx.h ï¼ˆå¦‚æœä½¿ç”¨ vs å¼€å‘è¿‡ C++ ç¨‹åºï¼Œåº”è¯¥ç»å¸¸èƒ½çœ‹åˆ°è¿™ä¸ªæ–‡ä»¶ï¼‰ï¼Œç„¶åè®©ç¼–è¯‘å™¨å…ˆé¢„å…ˆç¼–è¯‘æ‰è¿™ä¸ªå¤´æ–‡ä»¶ï¼Œç„¶åå…¶å®ƒæ‰€æœ‰ä»£ç ä½¿ç”¨çš„æ—¶å€™ï¼Œå°±ä¸å†éœ€è¦é¢å¤–å¼•å…¥ç¼–è¯‘äº†ï¼Œåœ¨é“¾æ¥é˜¶æ®µç›´æ¥å¤ç”¨å°±è¡Œäº†ã€‚\nè¿™æ ·å°±å°†ä¹‹å‰çš„ N æ¬¡ç¼–è¯‘ï¼Œå‡å°‘ä¸ºä»…ä»…ä¸€æ¬¡å¤´æ–‡ä»¶ç¼–è¯‘ï¼Œæå¤§åœ°æå‡äº†ç¼–è¯‘æ•ˆç‡ï¼Œå‡å°‘å¤§é‡çš„å¤´æ–‡ä»¶å†—ä½™ç¼–è¯‘ï¼Œè¿™å°±æ˜¯æ•´ä¸ªé¢„ç¼–è¯‘å¤´æ–‡ä»¶çš„ä½œç”¨å’Œå¤„ç†è¿‡ç¨‹ã€‚è€Œä¸”ç›®å‰å¤§éƒ¨åˆ† C/C++ ä¸»æµç¼–è¯‘å™¨ï¼Œä¾‹å¦‚ï¼šgccã€clangã€msvc ç­‰ï¼Œéƒ½æ˜¯å®Œå…¨æ”¯æŒé€šè¿‡é¢„ç¼–è¯‘å¤´æ–‡ä»¶æ¥ä¼˜åŒ– C/C++ ä»£ç çš„ç¼–è¯‘é€Ÿåº¦ã€‚\nå…³äºé¢„ç¼–è¯‘å¤´æ–‡ä»¶å¤„ç†çš„å¤§æ¦‚æœºåˆ¶å¯ä»¥å‚è€ƒä¸‹å›¾ã€‚\né…ç½®ä½¿ç”¨ C++ é¢„ç¼–è¯‘å¤´æ–‡ä»¶ åœ¨å¼€å§‹å®éªŒå¦‚ä½•ä½¿ç”¨ C++ é¢„ç¼–è¯‘å¤´æ–‡ä»¶ä¹‹å‰ï¼Œå…ˆæ¥åšä¸€äº›å‡†å¤‡å·¥ä½œï¼Œé€šè¿‡å¦‚ä¸‹å‘½ä»¤åˆ›å»ºä¸€ä¸ªç©ºçš„ C++ å·¥ç¨‹ã€‚\ncd Code\rxmake create pcxxheader\r ç„¶åè¿›å…¥ pcxxheader æ–‡ä»¶å¤¹ï¼Œåˆ›å»ºå¹¶ç¼–è¾‘ src/stdafx.h å¤´æ–‡ä»¶ï¼Œå¼•å…¥ä¸€äº›å¸¸ç”¨çš„ C++ å¤´æ–‡ä»¶ã€‚\n#ifndef HEADER_H\r#define HEADER_H\r#include \u0026lt;algorithm\u0026gt;\r#include \u0026lt;deque\u0026gt;\r#include \u0026lt;iostream\u0026gt;\r#include \u0026lt;map\u0026gt;\r#include \u0026lt;memory\u0026gt;\r#include \u0026lt;set\u0026gt;\r#include \u0026lt;utility\u0026gt;\r#include \u0026lt;vector\u0026gt;\r#include \u0026lt;string\u0026gt;\r#include \u0026lt;queue\u0026gt;\r#include \u0026lt;cstdlib\u0026gt;\r#include \u0026lt;utility\u0026gt;\r#include \u0026lt;exception\u0026gt;\r#include \u0026lt;list\u0026gt;\r#include \u0026lt;stack\u0026gt;\r#include \u0026lt;complex\u0026gt;\r#include \u0026lt;fstream\u0026gt;\r#include \u0026lt;cstdio\u0026gt;\r#include \u0026lt;iomanip\u0026gt;\r#endif\r é¢„ç¼–è¯‘å¤´æ–‡ä»¶çš„åå­—å¹¶ä¸ä¸€å®šéå¾—æ˜¯ stdafx.hï¼Œå¯ä»¥å–ä»»æ„åå­—ï¼Œè¿™é‡Œä»…ä»…åªæ˜¯æ²¿ç”¨äº† vs é¡¹ç›®é‡Œé¢çš„å‘½åè€Œå·²ï¼Œå¦å¤–æˆ‘ä»¬çœ‹åˆ°ä¸Šé¢çš„ä»£ç ä¸­ï¼Œå¼•å…¥äº†å¾ˆå¤šçš„å¤´æ–‡ä»¶ï¼Œè¿™ä¸»è¦æ˜¯ä¸ºäº†ä¹‹åä¾¿äºå¯¹æ¯”å¼€å¯é¢„ç¼–è¯‘åçš„ç¼–è¯‘é€Ÿåº¦ã€‚\nåˆ›å»ºå¥½é¢„ç¼–è¯‘å¤´æ–‡ä»¶åï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€äº›å¼•ç”¨äº†è¿™ä¸ªå¤´æ–‡ä»¶çš„ C++ æºæ–‡ä»¶ï¼Œæ¯”å¦‚åˆ›å»ºå¹¶ç¼–è¾‘ src/test1.cpp æ–‡ä»¶ï¼Œæ·»åŠ å¦‚ä¸‹ä»£ç ã€‚\n#include \u0026quot;stdafx.h\u0026quot;\r å½“ç„¶ï¼Œä»…ä»…åˆ›å»ºä¸€ä¸ªï¼Œåé¢æµ‹è¯•çš„æ—¶å€™ï¼Œä¹Ÿè®¸æ•ˆæœä¸ä¼šå¤ªæ˜æ˜¾ï¼Œæˆ‘ä»¬å¯ä»¥å†å¤šåˆ›å»ºä¸€äº›åŒæ ·çš„ C++ æ–‡ä»¶ï¼Œå¯ä»¥æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ã€‚\ncp src/test1.cpp src/test2.cpp\rcp src/test1.cpp src/test3.cpp\rcp src/test1.cpp src/test4.cpp\rcp src/test1.cpp src/test5.cpp\rcp src/test1.cpp src/test6.cpp\rcp src/test1.cpp src/test7.cpp\rcp src/test1.cpp src/test8.cpp\rcp src/test1.cpp src/test9.cpp\rcp src/test1.cpp src/test10.cpp\rcp src/test1.cpp src/test11.cpp\rcp src/test1.cpp src/test12.cpp\rcp src/test1.cpp src/test13.cpp\rcp src/test1.cpp src/test14.cpp\rcp src/test1.cpp src/test15.cpp\rcp src/test1.cpp src/test16.cpp\r ç„¶åå°±å¯ä»¥ç›´æ¥ç¼–è¯‘æˆ‘ä»¬çš„é¡¹ç›®äº†ï¼Œå› ä¸ºè‡ªåŠ¨åˆ›å»ºçš„å·¥ç¨‹åœ¨ xmake.lua é‡Œé¢é…ç½®äº† add_files(\u0026quot;src/*.cpp\u0026quot;) ä¼šè‡ªåŠ¨åŒ¹é…å¼•å…¥æ‰€æœ‰åˆ›å»ºçš„ C++ ä»£ç ï¼Œæ‰€ä»¥å¹¶ä¸éœ€è¦åšä»€ä¹ˆé…ç½®æ”¹åŠ¨ï¼Œå°±å¯ä»¥ç¼–è¯‘é€šè¿‡ã€‚\nä¸è¿‡ç°åœ¨æˆ‘ä»¬è¿˜æ²¡æœ‰å¼€å¯é¢„ç¼–è¯‘é…ç½®ï¼Œä»…ä»…åªæ˜¯æ™®é€šçš„å¤´æ–‡ä»¶å¼•ç”¨å’Œç¼–è¯‘ã€‚æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå¹¶ä¸”è·å–æ­£å¸¸ç¼–è¯‘æƒ…å†µä¸‹çš„æ€»ç¼–è¯‘è€—æ—¶ã€‚\ntime xmake -r -j1\r è¿™é‡Œï¼Œæˆ‘ä»¬è®¾ç½® -j1 å¼€å¯å•ä»»åŠ¡ç¼–è¯‘ï¼Œä¸»è¦æ˜¯ä¸ºäº†é¿å… xmake é»˜è®¤çš„å¹¶è¡Œç¼–è¯‘ä¼˜åŒ–çš„å¹²æ‰°ã€‚\nä¸‹å›¾æ˜¯æ­£å¸¸ç¼–è¯‘æ—¶å€™çš„è€—æ—¶æƒ…å†µï¼Œä»çº¢æ¡†ä¸­å¯ä»¥çœ‹å‡ºï¼Œå¤§æ¦‚ç¼–è¯‘è€—æ—¶ 4.672sã€‚\nç„¶åæˆ‘ä»¬ç¼–è¾‘ xmake.lua æ–‡ä»¶ï¼Œæ·»åŠ  set_pcxxheader(\u0026quot;src/stdafx.h\u0026quot;) çš„é¢„ç¼–è¯‘è®¾ç½®ï¼Œå‘Šè¯‰ç¼–è¯‘å™¨å°† stdafx.h ä½œä¸ºé¢„ç¼–è¯‘å¤´æ–‡ä»¶ï¼Œå¼€å¯é¢„ç¼–è¯‘æ¨¡å¼ã€‚\ntarget(\u0026quot;pcxxheader\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\rset_pcxxheader(\u0026quot;src/stdafx.h\u0026quot;)\r ç„¶åé‡æ–°æ‰§è¡Œåˆšåˆšçš„ç¼–è¯‘å‘½ä»¤ï¼Œç»Ÿè®¡ä¸‹ç¼–è¯‘è€—æ—¶ã€‚\ntime xmake -r -j1\r è¿™æ¬¡çš„ç¼–è¯‘ï¼Œæˆ‘ä»¬ä¼šæ˜æ˜¾æ„Ÿè§‰å˜å¿«äº†å¾ˆå¤šï¼Œä»ä¸‹å›¾çš„çº¢æ¡†ä¸­çœ‹åˆ°ï¼Œæ•´ä½“ç¼–è¯‘è€—æ—¶é™åˆ°äº† 1.593sï¼Œç¼–è¯‘é€Ÿåº¦å¿«äº†å°†è¿‘ 3 å€ï¼Œå¦‚æœå‚ä¸ç¼–è¯‘çš„æºæ–‡ä»¶æ›´å¤šçš„è¯ï¼Œæ•ˆæœä¼šæ›´åŠ æ˜æ˜¾ã€‚\nä¸åŒç¼–è¯‘å™¨å¯¹é¢„ç¼–è¯‘çš„å¤„ç† ä»åˆšåˆšçš„å¯¹æ¯”å®éªŒä¸­ï¼Œæˆ‘ä»¬å‘ç°é‡‡ç”¨é¢„ç¼–è¯‘æ¨¡å¼ï¼Œæ•´ä¸ªé¡¹ç›®ç¡®å®ä¼šå¿«ä¸å°‘ã€‚ç°åœ¨æˆ‘ä»¬ä»ç¼–è¯‘å™¨å±‚é¢ç®€å•äº†è§£ä¸‹ï¼Œgcc ç­‰ç¼–è¯‘å™¨åˆ°åº•æ˜¯æ€ä¹ˆå¤„ç†é¢„ç¼–è¯‘æ–‡ä»¶çš„ã€‚\næˆ‘ä»¬å¯ä»¥é€šè¿‡ xmake -rv å‘½ä»¤ï¼ŒæŸ¥çœ‹å®Œæ•´çš„ç¼–è¯‘è¾“å‡ºæ¥åˆ†æä¼ å…¥ç¼–è¯‘å™¨çš„å‚æ•°é€‰é¡¹ï¼Œè¾“å‡ºå†…å®¹å¦‚ä¸‹å›¾ã€‚\nä»ä¸Šå›¾å¯çŸ¥ï¼Œxmake ä¼šä¼˜å…ˆè°ƒç”¨ gcc å»ç¼–è¯‘ stdafx.h å¤´æ–‡ä»¶ï¼Œç”Ÿæˆ stdafx.pch å‘½åçš„é¢„ç¼–è¯‘å¤´æ–‡ä»¶ã€‚ç„¶åï¼Œåç»­çš„å…¶å®ƒæºæ–‡ä»¶ç¼–è¯‘é€šè¿‡ -include stdafx.h å°†å…¶å¼•å…¥è¿›æ¥ã€‚\nå¤§è‡´çš„æµç¨‹å¦‚ä¸‹ã€‚\ngcc -c -x c++-header -o src/stdafx.pch src/stdafx.h\rgcc -c -include src/stdafx.h -o build/test.o src/test1.cpp\r æˆ‘ä»¬ä¹Ÿå¯ä»¥æ‰‹åŠ¨æ‰§è¡Œä¸Šé¢çš„å‘½ä»¤ï¼Œå°è¯•ç›´æ¥è°ƒç”¨ gcc æ¥å¤„ç†å¤´æ–‡ä»¶é¢„ç¼–è¯‘ï¼Œè¿™é‡Œé¢å¤–ä¼ é€’äº† -x c++-header ç¼–è¯‘é€‰é¡¹ï¼Œæ˜¯ä¸ºäº†å‘Šè¯‰ gcc ç¼–è¯‘å™¨ï¼Œsrc/stdafx.h æ˜¯ C++ å¤´æ–‡ä»¶ï¼Œåº”è¯¥ä½¿ç”¨ C++ ç¼–è¯‘å™¨æ¥ç¼–è¯‘ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ C ç¼–è¯‘å™¨ã€‚\nå¦‚æœæ‰§è¡Œè¿‡ç¨‹ä¸­æ²¡æœ‰æŠ¥ä»»ä½•é”™è¯¯ï¼Œé‚£å°±è¯´æ˜æ‰§è¡ŒæˆåŠŸäº†ã€‚\nè®°ä½ï¼Œç¬¬ä¸€æ¡ stdafx.pch çš„ç¼–è¯‘å‘½ä»¤åªéœ€è¦æ‰§è¡Œä¸€éï¼Œä¹‹åå°±å¯ä»¥é€šè¿‡ -include src/stdafx.h æ¥æŸ¥æ‰¾å¯¹åº”çš„ pch æ–‡ä»¶ï¼Œç›´æ¥ä½¿ç”¨é¢„ç¼–è¯‘åçš„ç»“æœäº†ã€‚\ngcc çš„é¢„ç¼–è¯‘å¤´å¤„ç†æ–¹å¼å…¶å®è·Ÿ clang çš„åŸºæœ¬ç±»ä¼¼ï¼Œå”¯ä¸€çš„åŒºåˆ«å°±æ˜¯ï¼šå®ƒä¸æ”¯æŒ -include-pch å‚æ•°ï¼Œå› æ­¤ä¸èƒ½ç›´æ¥æŒ‡å®šä½¿ç”¨çš„ stdafx.pch æ–‡ä»¶è·¯å¾„ï¼Œä½†æ˜¯ä¼šæœ‰ä¸€äº›æœç´¢è§„åˆ™æ¥æŸ¥æ‰¾å¯¹åº”çš„ pch æ–‡ä»¶ã€‚\n ä» stdafx.h æ‰€åœ¨ç›®å½•ä¸­ï¼ŒæŸ¥æ‰¾ stdafx.pch æ–‡ä»¶æ˜¯å¦å­˜åœ¨ã€‚ ä» -I æŒ‡å®šçš„å¤´æ–‡ä»¶æœç´¢è·¯å¾„ä¸­æŸ¥æ‰¾ stdafx.pchã€‚  é…ç½®ä½¿ç”¨ C é¢„ç¼–è¯‘å¤´æ–‡ä»¶ å…¶å®ï¼Œé™¤äº† C++ é¡¹ç›®å¯ä»¥æ”¯æŒå¤´æ–‡ä»¶é¢„ç¼–è¯‘ï¼ŒC é¡¹ç›®ä¹Ÿæ˜¯åŒæ ·æ”¯æŒçš„ï¼Œåªä¸è¿‡ C ä»£ç æ²¡æœ‰ C++ æ¨¡æ¿è¿™ç§å¤æ‚çš„ç‰¹æ€§ï¼Œç¼–è¯‘åŸæœ¬å°±å¾ˆå¿«ï¼Œå› æ­¤æ˜¯å¦å¼€å¯é¢„ç¼–è¯‘ï¼Œå…¶ä¼˜åŒ–æ•ˆæœæ²¡æœ‰ C++ ä»£ç é‚£ä¹ˆæ˜æ˜¾ã€‚\nä¸è¿‡ï¼Œxmake è¿˜æ˜¯å¯¹ C é¡¹ç›®çš„é¢„ç¼–è¯‘åŒæ—¶åšäº†æ”¯æŒï¼Œç›¸å…³çš„é¢„ç¼–è¯‘é…ç½®æ¥å£åªéœ€è¦ä» set_pcxxheader æ”¹æˆ set_pcheader å°±å¯ä»¥äº†ï¼Œå…¶ä»–é…ç½®ä¸Šæ²¡å•¥å˜åŒ–ã€‚\nä¸‹é¢ï¼Œæˆ‘ä»¬é‡æ–°åˆ›å»ºä¸€ä¸ªåŸºäº C çš„ç©ºå·¥ç¨‹æ¥æµ‹è¯•éªŒè¯ C ä»£ç çš„å¤´æ–‡ä»¶é¢„ç¼–è¯‘æ•ˆæœã€‚\ncd Code\rxmake create -l c pcheader\r ç„¶åè¿›å…¥ pcheader æ–‡ä»¶å¤¹ï¼Œåˆ›å»ºå¹¶ç¼–è¾‘ src/stdafx.h æ–‡ä»¶ï¼Œå¼•å…¥ä¸€äº›å¸¸ç”¨ç³»ç»Ÿå¤´æ–‡ä»¶ã€‚\n#ifndef HEADER_H\r#define HEADER_H\r#include \u0026lt;stdio.h\u0026gt;\r#include \u0026lt;stdlib.h\u0026gt;\r#include \u0026lt;string.h\u0026gt;\r#include \u0026lt;stdint.h\u0026gt;\r#include \u0026lt;pthread.h\u0026gt;\r#endif\r æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ç»§ç»­åˆ›å»ºä¸€äº›ä½¿ç”¨äº†è¿™ä¸ª stdafx.h å¤´æ–‡ä»¶çš„ C ä»£ç ï¼Œæ¯”å¦‚ src/test1.cï¼Œå†…å®¹è·Ÿä¹‹å‰ C++ ä¸­çš„ç±»ä¼¼ã€‚\n#include \u0026quot;stdafx.h\u0026quot;\r æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤å¤šåˆ›å»ºäº›ä»£ç æ–‡ä»¶ã€‚\ncp src/test1.c src/test2.c\rcp src/test1.c src/test3.c\rcp src/test1.c src/test4.c\rcp src/test1.c src/test5.c\rcp src/test1.c src/test6.c\rcp src/test1.c src/test7.c\rcp src/test1.c src/test8.c\rcp src/test1.c src/test9.c\rcp src/test1.c src/test10.c\rcp src/test1.c src/test11.c\rcp src/test1.c src/test12.c\rcp src/test1.c src/test13.c\rcp src/test1.c src/test14.c\rcp src/test1.c src/test15.c\rcp src/test1.c src/test16.c\r ç„¶åå¯ä»¥è·Ÿä¹‹å‰ä¸€æ ·ç¼–è¯‘æµ‹è¯•å¯¹æ¯”ä¸‹ç¼–è¯‘æ•ˆç‡ã€‚\nç»§ç»­æ‰§è¡Œ time xmake -r -j1 æŸ¥çœ‹ç¼–è¯‘è€—æ—¶ï¼Œä»ä¸‹å›¾çº¢æ¡†ä¸­å¯ä»¥çœ‹åˆ°æ€»è€—æ—¶ 1.211sï¼Œè¯´æ˜å³ä½¿æ²¡å¼€é¢„ç¼–è¯‘ï¼Œç¼–è¯‘é€Ÿåº¦ä¹Ÿå·²ç»å¾ˆå¿«äº†ã€‚\nç„¶åï¼Œæˆ‘ä»¬é€šè¿‡ set_pcheader é…ç½®æ¥å£åŠ ä¸Šå¤´æ–‡ä»¶é¢„ç¼–è¯‘è®¾ç½®ï¼Œä¿®æ”¹ xmake.lua å†…å®¹å¦‚ä¸‹ã€‚\ntarget(\u0026quot;pcheader\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.c\u0026quot;)\rset_pcheader(\u0026quot;src/stdafx.h\u0026quot;)\r æˆ‘ä»¬å†é‡æ–°æ‰§è¡Œ time xmake -r -j1 æŸ¥çœ‹ç¼–è¯‘è€—æ—¶ï¼š0.819sï¼Œè¯´æ˜è¿˜æ˜¯å¿«äº†ä¸€ç‚¹çš„ï¼Œä½†æ˜¯ä¼˜åŠ¿ä¸æ˜¯éå¸¸æ˜æ˜¾ã€‚\nå®éªŒæ€»ç»“ åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬äº†è§£äº†ä»€ä¹ˆæ˜¯é¢„ç¼–è¯‘å¤´æ–‡ä»¶ï¼Œå­¦ä¹ äº†å¦‚ä½•é…ç½®ç¼–è¯‘å¤´æ–‡ä»¶æ¥ä¼˜åŒ– C++ ä»£ç çš„ç¼–è¯‘é€Ÿåº¦ï¼Œå¹¶ä¸”çŸ¥é“äº† C ä»£ç ä¹Ÿæ˜¯å¯ä»¥æ”¯æŒé¢„ç¼–è¯‘å¤´æ–‡ä»¶çš„ï¼Œä½†æ˜¯æ•´ä½“ç¼–è¯‘é€Ÿåº¦ä¸ä¼šåƒ C++ é‚£æ ·æå‡è¿™ä¹ˆæ˜æ˜¾ï¼Œå› æ­¤é’ˆå¯¹ C++ é¡¹ç›®æ¥è¯´ï¼Œæˆ‘ä»¬ä½¿ç”¨é¢„ç¼–è¯‘å¤´æ–‡ä»¶è¿˜æ˜¯å¯ä»¥æ”¹å–„ä¸å°‘é¡¹ç›®çš„ç¼–è¯‘æ•ˆç‡ã€‚\næœ¬å®éªŒçš„å‚è€ƒä»£ç å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ä¸‹è½½ï¼š\nwget https://labfile.oss.aliyuncs.com/courses/2764/code10.zip\r ","id":57,"section":"categories","summary":"C_C++é¢„ç¼–è¯‘å¤´æ–‡ä»¶é…ç½® åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬ä¼šå­¦ä¹ åˆ° C/C++ é¢„ç¼–è¯‘å¤´æ–‡ä»¶çš„ä¸€äº›åŸºæœ¬æ¦‚å¿µï¼Œäº†è§£å¦‚ä½•åœ¨ xmake ä¸­é…ç½®å¼€å¯å¤´æ–‡ä»¶é¢„ç¼–è¯‘ï¼Œä»¥åŠä¼šåšä¸€äº›å¯¹æ¯”æµ‹è¯•æ¥","tags":["xmake"],"title":"å®éªŒ10C_Cppé¢„ç¼–è¯‘å¤´æ–‡ä»¶é…ç½®","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/app/xmake/%E8%93%9D%E6%A1%A5%E7%BD%91%E8%AF%BE/2xmake%E5%9F%BA%E7%A1%80/%E5%AE%9E%E9%AA%8C10c_cpp%E9%A2%84%E7%BC%96%E8%AF%91%E5%A4%B4%E6%96%87%E4%BB%B6%E9%85%8D%E7%BD%AE/","year":"2021"},{"content":"C/C++ å­å·¥ç¨‹å’Œç›®å½•ç»“æ„ åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬ä¼šå­¦åˆ°å¦‚ä½•ä½¿ç”¨ xmake å»å®ç°å¯¹æ›´åŠ å¤æ‚çš„å¤§å‹ C/C++ é¡¹ç›®çš„æ„å»ºç»´æŠ¤ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨ includes æ¥å£ï¼Œå¹¶ä¸”è¿˜èƒ½äº†è§£å’ŒæŒæ¡å­å·¥ç¨‹ä¹‹é—´çš„é…ç½®ç»§æ‰¿å…³ç³»ã€‚\nçŸ¥è¯†ç‚¹  å¦‚ä½•è¿›è¡Œå¤§å‹ C/C++ å·¥ç¨‹é¡¹ç›®æ„å»ºç»´æŠ¤ xmake çš„ includes æ¥å£ä½¿ç”¨ å­å·¥ç¨‹é…ç½®ä¹‹é—´çš„ç»§æ‰¿å’Œä¾èµ–å…³ç³»  ä½¿ç”¨ includes å¼•å…¥ç›®å½•å’Œæ–‡ä»¶ åœ¨ä¹‹å‰çš„å®éªŒä¸­ï¼Œæˆ‘ä»¬çš„å·¥ç¨‹é¡¹ç›®æ¯”è¾ƒç®€å•ï¼Œé€šå¸¸ä»…ä»…åªéœ€è¦åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ”¾ç½®ä¸€ä¸ª xmake.lua é…ç½®æ–‡ä»¶ï¼Œå°±å¯ä»¥æ§åˆ¶æ•´ä¸ªé¡¹ç›®çš„ç¼–è¯‘ã€‚\nä½†æ˜¯å¯¹äºä¸€äº›å¤§å‹é¡¹ç›®ï¼Œå…¶æºç çš„ç»„ç»‡ç»“æ„ç›¸å¯¹æ¯”è¾ƒå¤æ‚ï¼Œå±‚çº§ä¹Ÿæ¯”è¾ƒæ·±ï¼Œéœ€è¦å‚ä¸ç¼–è¯‘ç”Ÿæˆçš„ target ç›®æ ‡ä¹Ÿå¯èƒ½æœ‰åå‡ ç”šè‡³ä¸Šç™¾ä¸ªï¼Œè¿™ä¸ªæ—¶å€™å¦‚æœè¿˜æ˜¯éƒ½åœ¨å•ä¸€çš„æ ¹ xmake.lua æ–‡ä»¶ä¸­ç»´æŠ¤ï¼Œå°±æœ‰ç‚¹åƒä¸æ¶ˆäº†ï¼Œä¼šæ˜¾å¾—éå¸¸çš„è‡ƒè‚¿å¹¶ä¸”ä¸å¯ç»´æŠ¤ã€‚\nè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡åœ¨æ¯ä¸ªå­å·¥ç¨‹æ¨¡å—é‡Œé¢ï¼Œå•ç‹¬åˆ›å»º xmake.lua æ¥ç»´æŠ¤å®ƒä»¬ï¼Œç„¶åä½¿ç”¨ xmake æä¾›çš„ includes æ¥å£ï¼Œå°†å®ƒä»¬æŒ‰å±‚çº§å…³ç³»åŒ…å«è¿›æ¥ï¼Œæœ€ç»ˆå˜æˆä¸€ä¸ªæ ‘çŠ¶ç»“æ„ã€‚\nåœ¨è®²è§£å¦‚ä½•ä½¿ç”¨å‰ï¼Œæˆ‘ä»¬å…ˆåšä¸€äº›å‡†å¤‡å·¥ä½œï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤åˆ›å»ºä¸€ä¸ªç¨å¾®å¤æ‚ç‚¹çš„é¡¹ç›®ç»“æ„ã€‚\ncd Code\rxmake create includes_test\rcd includes_test\rmkdir tests\rtouch src/xmake.lua\rcp src/* tests\r æ‰§è¡Œå®Œæˆåï¼Œæ‰§è¡Œ tree . å‘½ä»¤æŸ¥çœ‹å½“å‰çš„é¡¹ç›®ç»“æ„ã€‚\ntree .\r.\râ”œâ”€â”€ src\râ”‚ â”œâ”€â”€ main.cpp\râ”‚ â””â”€â”€ xmake.lua\râ”œâ”€â”€ tests\râ”‚ â”œâ”€â”€ main.cpp\râ”‚ â””â”€â”€ xmake.lua\râ””â”€â”€ xmake.lua\r é€šè¿‡ä¸Šé¢çš„é¡¹ç›®æ¥å£ï¼Œæˆ‘ä»¬å¤§æ¦‚å¯ä»¥çœ‹å‡ºæ¥ï¼Œè¿™é‡Œé¢æœ‰ä¸¤ä¸ªæ¨¡å—ï¼Œä¸€ä¸ªæ˜¯ src ç›®å½•ä¸‹çš„ä¸»ç¨‹åºï¼Œä¸€ä¸ªæ˜¯ tests ç›®å½•ä¸‹çš„æµ‹è¯•ç¨‹åºï¼Œå®ƒä»¬åˆ†åˆ«æœ‰è‡ªå·±çš„ xmake.lua æ¥ç»´æŠ¤æ„å»ºï¼Œç„¶åé€šè¿‡é¡¹ç›®æ ¹ç›®å½•çš„ xmake.lua å°†è¿™ä¸¤ä¸ªæ¨¡å—å…³è”èµ·æ¥ï¼Œæ„æˆä¸€ä¸ªé¡¹ç›®æ ‘ï¼Œå¤§æ¦‚çš„ç»“æ„å¦‚ä¸‹å›¾ã€‚\nå‚ç…§ä¸Šå›¾çš„ç»“æ„ï¼Œæˆ‘ä»¬å¼€å§‹ç¼–å†™å¯¹åº”çš„ xmake.lua é…ç½®å†…å®¹ï¼Œé¦–å…ˆæ˜¯æ ¹ç›®å½•ä¸‹çš„ xmake.luaã€‚\nincludes(\u0026quot;src\u0026quot;, \u0026quot;tests\u0026quot;)\r ç°åœ¨çš„æ ¹é…ç½®å°±éå¸¸ç²¾ç®€äº†ï¼Œå°±ä¸€è¡Œ includes å»å¼•å…¥ src å’Œ tests ç›®å½•ä¸‹çš„å­ xmake.lua é…ç½®ï¼Œä¹‹å‰çš„ target() çš„å®šä¹‰ä¹Ÿæ²¡æœ‰äº†ï¼Œå› ä¸ºæˆ‘ä»¬å·²ç»æŒªåˆ°äº†å­ç›®å½• xmake.lua ä¸­å»åˆ†åˆ«å®šä¹‰å®ƒä»¬ã€‚\næ¥ä¸‹æ¥æˆ‘ä»¬å†æ¥ç¼–è¾‘ä¸‹ src/xmake.lua é‡Œé¢çš„é…ç½®å†…å®¹ï¼Œå®šä¹‰ä¸»ç¨‹åº target ç›®æ ‡ã€‚\ntarget(\u0026quot;hello\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;*.cpp\u0026quot;)\r ç„¶åç¼–è¾‘ tests/xmake.lua å®šä¹‰æµ‹è¯•ç¨‹åº target ç›®æ ‡ã€‚\ntarget(\u0026quot;test\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;*.cpp\u0026quot;)\r åˆ°è¿™é‡Œä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»åŸºæœ¬å®Œæˆäº†ä¸€ä¸ªå¸¦æœ‰ä¸¤ä¸ªå­å·¥ç¨‹çš„ C++ é¡¹ç›®ï¼Œç›¸æ¯”ä¹‹å‰çš„å•çº§ xmake.lua ç»´æŠ¤ï¼Œç°åœ¨çš„ç»“æ„æ›´åŠ å®¹æ˜“æ‰©å±•ï¼Œé€šè¿‡å­å·¥ç¨‹æ‹†åˆ†åï¼Œæ¯ä¸ªå­ xmake.lua ç»´æŠ¤ä¼šæ›´åŠ çš„æ¸…æ™°å’Œç²¾ç®€ã€‚ä¸åŒå­å·¥ç¨‹çš„ target ç›®æ ‡ä¹‹é—´ä¹Ÿå¯ä»¥ç‹¬ç«‹ç»´æŠ¤ï¼Œäº’ä¸å¹²æ‰°äº†ã€‚\næœ€åæ‰§è¡Œ xmake ç¼–è¯‘è¿™ä¸ªå·¥ç¨‹ï¼Œçœ‹çœ‹èƒ½å¦æ­£å¸¸ç¼–è¯‘å¼•å…¥çš„ hello å’Œ test è¿™ä¸¤ä¸ªå­ç›®æ ‡ç¨‹åºï¼Œå¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œä¼šçœ‹åˆ°ä¸‹å›¾çš„è¾“å‡ºç»“æœã€‚\né€šè¿‡ includes å…³è”å­å·¥ç¨‹çš„å¥½å¤„å°±æ˜¯ï¼Œæˆ‘ä»¬ä¸éœ€è¦å†æ‰‹åŠ¨è¿›å…¥æ¯ä¸ªå­å·¥ç¨‹ç›®å½•ä¸‹æ‰§è¡Œ xmake ç¼–è¯‘ï¼Œæ‰€æœ‰çš„ xmake å‘½ä»¤æ“ä½œè¿˜æ˜¯å¯ä»¥åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ç»Ÿä¸€å®Œæˆï¼Œå› ä¸ºé€šè¿‡ includes å¼•å…¥åï¼Œæ•´ä¸ªé¡¹ç›®ä¸ç®¡ç»“æ„å¤šå¤æ‚ï¼Œéƒ½æ˜¯ä¸€ä¸ªæ•´ä½“ï¼Œå› æ­¤å³ä½¿ç”¨æˆ·è¿›å…¥å­ç›®å½•æ‰§è¡Œ xmake å‘½ä»¤ï¼Œå®é™…çš„æ“ä½œå¯¹è±¡è¿˜æ˜¯é’ˆå¯¹å½“å‰çš„æ•´ä¸ªé¡¹ç›®è€Œè¨€çš„ã€‚\næ¨¡å¼åŒ¹é…å®ç°æ‰¹é‡ includes é»˜è®¤æƒ…å†µä¸‹é€šè¿‡ includes(\u0026quot;tests\u0026quot;) å¼•ç”¨å­ç›®å½•ï¼Œå°±å¯ä»¥ç›´æ¥å¯¼å…¥å­ç›®å½•ä¸‹ xmake.lua é…ç½®ï¼Œå¦‚æœè¦å¯¼å…¥å…¶å®ƒæ–‡ä»¶åçš„é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥æŒ‡å®šæ–‡ä»¶å…¨ååˆ° includesï¼Œä¾‹å¦‚ includes(\u0026quot;tests/xmake.lua\u0026quot;)ã€‚\nåŸºäºæ­¤ï¼Œå†åŠ ä¸Š includes çš„æ¨¡å¼åŒ¹é…æ”¯æŒï¼Œæˆ‘ä»¬å°±å¯ä»¥å®ç°æ‰¹é‡å¯¼å…¥å½“å‰å·¥ç¨‹çš„æ‰€æœ‰å­ xmake.luaï¼Œè€Œä¸å†éœ€è¦æŒ¨ä¸ªè¿›å…¥å­ç›®å½•æ‰‹åŠ¨å»é…ç½®å¼•å…¥ã€‚\nä¿®æ”¹é¡¹ç›®çš„æ ¹ xmake.lua çš„å†…å®¹æ”¹ä¸ºå¦‚ä¸‹é…ç½®ã€‚\nincludes(\u0026quot;*/xmake.lua\u0026quot;)\r é€šè¿‡ */xmake.lua æ¨¡å¼åŒ¹é…ï¼Œxmake ä¼šè‡ªåŠ¨éå†å½“å‰æ‰€æœ‰ä¸€çº§å­ç›®å½•ä¸‹çš„ xmake.lua æ–‡ä»¶ï¼Œå°†å…¶å¼•å…¥ã€‚æ•´ä¸ªæ¨¡å¼åŒ¹é…çš„ç”¨æ³•è·Ÿ add_files æ˜¯å®Œå…¨ä¸€è‡´çš„ï¼Œå› æ­¤æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ **/xmake.lua æ¥å®ç°é€’å½’æ¨¡å¼åŒ¹é…ï¼Œå…·ä½“ä½¿ç”¨å“ªä¸ªï¼Œå°±çœ‹å¤§å®¶è‡ªå·±çš„å®é™…é¡¹ç›®éœ€æ±‚äº†ã€‚\næ”¹å®Œåï¼Œæˆ‘ä»¬é‡æ–°æ‰§è¡Œ xmake -rï¼Œå¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œé‚£ä¹ˆç¼–è¯‘æ•ˆæœåº”è¯¥è·Ÿä¹‹å‰å®Œå…¨ç›¸åŒã€‚\næ ¹ xmake.lua é…ç½® ç°åœ¨ï¼Œæˆ‘ä»¬æ•´ä½“çš„é¡¹ç›®ç»“æ„å·²ç»é€šè¿‡ includes æ–¹å¼å°†æ‰€æœ‰çš„å­å·¥ç¨‹å…¨éƒ¨å…³è”åˆ°äº†ä¸€èµ·ï¼Œä½¿å¾—æ¯ä¸ª target éƒ½è¢«æ”¾ç½®åœ¨å•ç‹¬çš„å­å·¥ç¨‹ç›®å½•ä¸­å»ç»´æŠ¤ã€‚\nä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬æœ‰ä¸€äº›é€šç”¨çš„é…ç½®ï¼Œéœ€è¦å¾—è¿™ä¸ªé¡¹ç›®çš„æ‰€æœ‰å­ target ç›®æ ‡éƒ½ç”Ÿæ•ˆï¼Œé‚£ä¹ˆï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨æ ¹ xmake.lua çš„æ ¹åŸŸå»é…ç½®å®ƒä»¬ï¼Œå­ç›®å½•ä¸‹çš„ target åŒæ ·å¯ä»¥è¢«ç»§æ‰¿åˆ°ã€‚\nä¾‹å¦‚ï¼Œæˆ‘ä»¬ç»§ç»­å®Œå–„é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ xmake.lua æ–‡ä»¶ã€‚\nset_project(\u0026quot;hello\u0026quot;)\rset_version(\u0026quot;1.0.1\u0026quot;)\radd_rules(\u0026quot;mode.release\u0026quot;, \u0026quot;mode.debug\u0026quot;)\rset_warnings(\u0026quot;all\u0026quot;, \u0026quot;error\u0026quot;)\rset_languages(\u0026quot;c++11\u0026quot;)\radd_defines(\u0026quot;ROOT\u0026quot;)\rincludes(\u0026quot;*/xmake.lua\u0026quot;)\r æˆ‘ä»¬åœ¨ä¸Šè¿°çš„æ ¹é…ç½®ä¸­ï¼ŒåŠ äº†å¾ˆå¤šçš„å¸¸ç”¨é…ç½®ï¼Œæ¯”å¦‚æ·»åŠ äº† debugã€release çš„ç¼–è¯‘è§„åˆ™ï¼Œè®¾ç½®å·¥ç¨‹åå’Œç‰ˆæœ¬ï¼ˆå¯é€‰çš„ï¼‰ï¼Œè®¾ç½® C++ è¯­è¨€æ ‡å‡†åˆ° c++11ï¼Œè®¾ç½®ç¼–è¯‘è­¦å‘Šä¸ºä¸¥æ ¼æ£€æµ‹å’ŒæŠ¥é”™ï¼Œå¦å¤–æ·»åŠ äº†ä¸€ä¸ªé¢å¤–çš„å®å®šä¹‰å¼€å…³ï¼š-DROOTã€‚\nè¿™äº›æ ¹é…ç½®ä¼šå¯¹ includes é‡Œé¢çš„æ‰€æœ‰å­ target ç›®æ ‡éƒ½ç”Ÿæ•ˆï¼Œå±äºå…¨å±€é¡¹ç›®é…ç½®ã€‚è¿™ä¹Ÿæ˜¯æˆ‘ä»¬æ¨èçš„åšæ³•ï¼Œå°±æ˜¯åœ¨æ ¹ xmake.lua ä¸­ä»…ä»…é…ç½®ä¸€äº›å¯¹æ‰€æœ‰ target éƒ½é€šç”¨çš„è®¾ç½®ï¼Œè€Œ target ç›¸å…³çš„ç‰¹å®šé…ç½®å°±å•ç‹¬æ”¾åˆ°å­å·¥ç¨‹ xmake.lua å»é…ç½®å®ƒä»¬ã€‚\næ‰§è¡Œ xmake -v æŸ¥çœ‹å½“å‰çš„ç¼–è¯‘è¾“å‡ºæ•ˆæœï¼Œå¦‚ä¸‹å›¾ã€‚\nè¿™å›ï¼Œæˆ‘ä»¬çœ‹åˆ° src å’Œ tests ç›®å½•ä¸‹çš„ä¸¤ä¸ªç›®æ ‡ç¨‹åºçš„ C++ æºæ–‡ä»¶åœ¨ç¼–è¯‘çš„æ—¶å€™ï¼Œéƒ½è¢«åŠ ä¸Šäº† -DROOT -std=c++ å’Œ -Wall -Werror ç­‰ç¼–è¯‘é€‰é¡¹ï¼Œè¯´æ˜æ ¹ç›®å½•ä¸‹çš„é…ç½®å¯¹æ‰€æœ‰å­ target ç›®æ ‡ç¨‹åºéƒ½ç”Ÿæ•ˆäº†ã€‚\nå­ xmake.lua é…ç½® å…¨å±€æ ¹é…ç½®å®Œæˆäº†ï¼Œæ¥ä¸‹æ¥éœ€è¦å¼€å§‹å¯¹æ¯ä¸ªå­ target è¿›è¡Œä¸€äº›ç‰¹å®šçš„é…ç½®ï¼Œè¿™äº›é…ç½®å¯ä»¥åˆ†åˆ«æ”¾ç½®åœ¨ target æ‰€åœ¨çš„å­ xmake.lua æ–‡ä»¶ä¸­ã€‚\næˆ‘ä»¬åœ¨æ¯ä¸ªå­å·¥ç¨‹ç›®å½•ä¸­å•ç‹¬é…ç½®çš„ xmake.luaï¼Œé‡Œé¢çš„æ‰€æœ‰é…ç½®ä¸ä¼šå¹²æ‰°çˆ¶ xmake.luaï¼Œåªå¯¹å®ƒä¸‹é¢çš„æ›´ç»†ç²’åº¦çš„å­å·¥ç¨‹ç”Ÿæ•ˆï¼Œå°±è¿™æ ·ä¸€å±‚å±‚æŒ‰ tree çŠ¶ç”Ÿæ•ˆä¸‹å»ã€‚\næ•´ä¸ªç»§æ‰¿ç»“æ„å¯ä»¥å‚è€ƒä¸‹å›¾æ‰€ç¤ºã€‚\nä¸ºäº†å®Œæˆä¸Šå›¾çš„å­å·¥ç¨‹ç»“æ„ï¼Œèƒ½å¤Ÿæ›´åŠ ç›´è§‚çš„æ„Ÿå—å¦‚ä½•å»é…ç½®å­å·¥ç¨‹ï¼Œæˆ‘ä»¬éœ€è¦å†å¯¹ä¹‹å‰çš„é…ç½®æ–‡ä»¶åšä¸€äº›è°ƒæ•´ï¼Œåœ¨ src ç›®å½•ä¸‹é¢å¤–æ–°å¢ä¸¤ä¸ªå­å·¥ç¨‹ï¼šfoo å’Œ bar ç›®æ ‡ç¨‹åºã€‚\nä¸ºæ­¤å…ˆæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œåˆ›å»ºè¿™ä¸¤ä¸ªå­å·¥ç¨‹ã€‚\ncd ~/Code/includes_test\rmkdir src/foo src/bar\rcp src/main.cpp src/foo\rcp src/main.cpp src/bar\rrm src/main.cpp\rtouch src/foo/xmake.lua\rtouch src/bar/xmake.lua\r åˆ›å»ºå®Œæˆåçš„ç›®å½•ç»“æ„å¦‚ä¸‹æ‰€ç¤ºï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢å›¾ç‰‡ä¸­æ‰€å±•ç¤ºçš„ç»“æ„ã€‚\n.\râ”œâ”€â”€ src\râ”‚ â”œâ”€â”€ bar\râ”‚ â”‚ â”œâ”€â”€ main.cpp\râ”‚ â”‚ â””â”€â”€ xmake.lua\râ”‚ â”œâ”€â”€ foo\râ”‚ â”‚ â”œâ”€â”€ main.cpp\râ”‚ â”‚ â””â”€â”€ xmake.lua\râ”‚ â””â”€â”€ xmake.lua\râ”œâ”€â”€ tests\râ”‚ â”œâ”€â”€ main.cpp\râ”‚ â””â”€â”€ xmake.lua\râ””â”€â”€ xmake.lua\r ç„¶åæˆ‘ä»¬ç¼–è¾‘ src/xmake.lua æ–‡ä»¶ï¼Œåˆ é™¤ä¹‹å‰çš„é…ç½®å†…å®¹ï¼Œå¹¶åœ¨æ–‡ä»¶ä¸­æ–°é…ç½®ä¸€ä¸ªå…¨å±€çš„å®å®šä¹‰ -DHELLOï¼Œç„¶åç»§ç»­é€šè¿‡ includes(\u0026quot;*/xmake.lua\u0026quot;) å¼•ç”¨ä¸‹çº§å­é…ç½®æ–‡ä»¶ï¼Œä¾‹å¦‚ã€‚\nadd_defines(\u0026quot;HELLO\u0026quot;)\rincludes(\u0026quot;*/xmake.lua\u0026quot;)\r ç”±äºæ ¹é…ç½®æ²¡æœ‰é€šè¿‡é€’å½’åŒ¹é…å¼•å…¥æ‰€æœ‰ xmake.luaï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨è¿™é‡Œéœ€è¦é€šè¿‡ includes å†å¼•å…¥ä¸‹çº§ç›®å½•ï¼Œå½“ç„¶å¦‚æœæ ¹é…ç½®ä¸­æ˜¯é€šè¿‡ **/xmake.lua é€’å½’å¼•å…¥äº†æ‰€æœ‰é…ç½®æ–‡ä»¶ï¼Œé‚£ä¹ˆè¿™é‡Œå°±å¯ä»¥çœç•¥äº†ã€‚\næ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ç¼–è¾‘ src/foo/xmake.lua æ–‡ä»¶ï¼Œæ”¹æˆå¦‚ä¸‹é…ç½®ã€‚\nadd_defines(\u0026quot;FOO\u0026quot;)\rtarget(\u0026quot;foo\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;*.cpp\u0026quot;)\r ç„¶åç¼–è¾‘ src/bar/xmake.lua æ–‡ä»¶ï¼Œæ”¹æˆå¦‚ä¸‹é…ç½®ã€‚\nadd_defines(\u0026quot;BAR\u0026quot;)\rtarget(\u0026quot;bar\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;*.cpp\u0026quot;)\r æœ€åçš„è¿™ä¸¤ä¸ªå­å·¥ç¨‹é…ç½®æ–‡ä»¶ï¼Œæˆ‘ä»¬å®é™…å®šä¹‰äº†ä¸¤ä¸ªå¯æ‰§è¡Œç›®æ ‡ç¨‹åºï¼šfoo å’Œ barï¼Œå¹¶ä¸”åœ¨å®ƒä»¬çš„å­å…¨å±€ä½œç”¨åŸŸåˆ†åˆ«åŠ äº† -DFOO å’Œ -DBAR å®å®šä¹‰ã€‚\néœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè™½ç„¶è¿™ä¸¤ä¸ªå®å®šä¹‰æ˜¯åœ¨ xmake.lua çš„å…¨å±€æ ¹ä½œç”¨åŸŸé…ç½®ï¼Œä½†æ˜¯ä»…ä»…åªå¯¹å½“å‰ xmake.lua ä»¥åŠå®ƒä»¬çš„å­ xmake.lua ç”Ÿæ•ˆï¼Œå¯¹äºçˆ¶ xmake.lua ä¸­çš„å…¶å®ƒ target å’Œå…¶å®ƒåŒçº§ xmake.lua é‡Œé¢çš„ target éƒ½æ˜¯æ²¡æœ‰å½±å“çš„ã€‚\nç®€å•çš„è¯´ï¼Œæ•´ä¸ªé…ç½®ä½œç”¨ä¼˜å…ˆæŒ‰ xmake.lua çš„å¼•ç”¨è·¯å¾„ç»“æ„ tree çŠ¶å±‚æ¬¡ç»§æ‰¿é…ç½®ï¼Œç„¶åæ¯ä¸ª xmake.lua é‡Œé¢æ‰€æœ‰ target ç»§æ‰¿å½“å‰é…ç½®æ–‡ä»¶çš„æ ¹è®¾ç½®ã€‚\nå¯¹äº†ï¼Œè¿˜æœ‰ tests/xmake.lua æˆ‘ä»¬ä¹Ÿéœ€è¦ä¿®æ”¹ä¸€ä¸‹ï¼ŒåŠ ä¸Š -DTEST çš„å®å®šä¹‰é…ç½®ã€‚\nadd_defines(\u0026quot;TEST\u0026quot;)\rtarget(\u0026quot;test\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;*.cpp\u0026quot;)\r æ•´ä¸ªé…ç½®ç»§æ‰¿æ•ˆæœï¼Œæˆ‘ä»¬å¯ä»¥é‡æ–°çœ‹ä¸‹ä¹‹å‰çš„å›¾ã€‚\næ‰§è¡Œ xmake -rv æ¥éªŒè¯åˆšåˆšçš„é…ç½®ç»“æœã€‚\nä»ä¸Šå›¾çš„å®é™…ç¼–è¯‘è¾“å‡ºçœ‹åˆ°ï¼Œfoo ç¨‹åºç»§æ‰¿äº†æ ¹æ–‡ä»¶é…ç½®çš„ -DROOTï¼Œçˆ¶æ–‡ä»¶é…ç½®ä¸­çš„ -DHELLOï¼Œä»¥åŠè‡ªèº«é…ç½®æ–‡ä»¶ä¸­çš„å…¨å±€è®¾ç½® -DFOOï¼Œå› æ­¤æœ€ç»ˆç»“æœæ˜¯ -DROOT -DHELLO -DFOOï¼Œè€Œ bar ä¹Ÿå°±æ˜¯ -DROOT -DHELLO -DBARï¼Œå¦å¤– test ç›®æ ‡è·Ÿå®ƒä»¬å®Œå…¨ä¸åœ¨ä¸€ä¸ªç»§æ‰¿è·¯å¾„ä¸Šï¼Œå› æ­¤äº’ä¸å¹²æ‰°ï¼Œåªæœ‰ -DROOT -DTESTã€‚\nç„¶åï¼Œæˆ‘ä»¬å†æ‰§è¡Œ xmake run å‘½ä»¤çœ‹çœ‹è¿è¡Œæ•ˆæœã€‚\né»˜è®¤æƒ…å†µä¸‹ï¼Œxmake ä¼šè¿è¡Œå½“å‰é¡¹ç›®é‡Œé¢å®šä¹‰çš„æ‰€æœ‰å¯æ‰§è¡Œç›®æ ‡ç¨‹åºã€‚\nè·¨ xmake.lua é—´ç›®æ ‡ä¾èµ– åªè¦æ˜¯é€šè¿‡ includes å¼•ç”¨çš„æ‰€æœ‰ xmake.luaï¼Œå…¶ä¸­çš„ target å®šä¹‰å³ä½¿åœ¨ä¸åŒçš„å­ xmake.lua ä¸­ï¼Œxmake ä¹Ÿä¼šå°†å®ƒä»¬å…¨éƒ¨åŠ è½½è¿›æ¥ï¼Œå› æ­¤è¿™äº› target ä¹‹é—´çš„ä¾èµ–å…³ç³»è¿˜æ˜¯å¯ä»¥æ­£å¸¸é…ç½®ï¼Œå“ªæ€•æ˜¯è·¨ xmake.lua ä¹Ÿä¸ä¼šæœ‰ä»»ä½•å½±å“ã€‚\næ¯”å¦‚ï¼Œæˆ‘ä»¬è®© test ç¨‹åºå»ä¾èµ–å¦å¤–ä¸¤ä¸ªå­ç¨‹åº foo å’Œ barï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¹‹å‰çš„ä¾èµ–é…ç½®æ–¹å¼å»é…ç½®å…³è”ä¾èµ–ã€‚\nåªéœ€è¦ä¿®æ”¹ tests/xmake.lua é‡Œé¢çš„é…ç½®å†…å®¹ï¼Œæ·»åŠ ä¸Šè¿™ä¸¤ä¸ªä¾èµ–ç›®æ ‡å³å¯ã€‚\nadd_defines(\u0026quot;TEST\u0026quot;)\rtarget(\u0026quot;test\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;*.cpp\u0026quot;)\radd_deps(\u0026quot;foo\u0026quot;, \u0026quot;bar\u0026quot;)\r ç„¶åæ‰§è¡Œ xmake -r å»é‡æ–°ç¼–è¯‘ï¼Œå¦‚æœä¾èµ–å·²ç»ç”Ÿæ•ˆï¼Œé‚£ä¹ˆåœ¨é“¾æ¥ test ç¨‹åºä¹‹å‰ï¼Œfoo å’Œ bar ä¼šä¼˜å…ˆç¼–è¯‘å’Œå®Œæˆé“¾æ¥ï¼Œå¦‚ä¸‹å›¾ã€‚\nå®éªŒæ€»ç»“ åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•ä½¿ç”¨ includes æ¥å£å»ç»„ç»‡ç¼–è¯‘å¸¦æœ‰å¤šçº§å­å·¥ç¨‹çš„ C/C++ é¡¹ç›®å·¥ç¨‹ï¼Œå¹¶å­¦ä¹ äº† includes çš„åŸºæœ¬ç”¨æ³•ï¼Œä¹Ÿäº†è§£ xmake åœ¨å¤šçº§ xmake.lua ä¸­çš„é…ç½®ç»§æ‰¿å…³ç³»ã€‚\næœ¬å®éªŒçš„å‚è€ƒä»£ç å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ä¸‹è½½ï¼š\nwget https://labfile.oss.aliyuncs.com/courses/2764/code9.zip\r ","id":58,"section":"categories","summary":"C/C++ å­å·¥ç¨‹å’Œç›®å½•ç»“æ„ åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬ä¼šå­¦åˆ°å¦‚ä½•ä½¿ç”¨ xmake å»å®ç°å¯¹æ›´åŠ å¤æ‚çš„å¤§å‹ C/C++ é¡¹ç›®çš„æ„å»ºç»´æŠ¤ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨ includes æ¥å£ï¼Œå¹¶ä¸”è¿˜èƒ½äº†è§£å’ŒæŒæ¡å­å·¥ç¨‹ä¹‹é—´","tags":["xmake"],"title":"å®éªŒ9C/C++ å­å·¥ç¨‹å’Œç›®å½•ç»“æ„","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/app/xmake/%E8%93%9D%E6%A1%A5%E7%BD%91%E8%AF%BE/2xmake%E5%9F%BA%E7%A1%80/%E5%AE%9E%E9%AA%8C9c_cpp%E5%AD%90%E5%B7%A5%E7%A8%8B%E5%92%8C%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84/","year":"2021"},{"content":"å†…ç½®å˜é‡ åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å­¦ä¹ åˆ° xmake å†…ç½®å˜é‡çš„åŸºç¡€ä½¿ç”¨ï¼Œä»¥åŠå¦‚ä½•è·Ÿç¯å¢ƒå˜é‡ã€shellã€è‡ªå®šä¹‰é€‰é¡¹é…ç½®äº¤äº’æ¥åŠ¨æ€é…ç½®é¡¹ç›®å·¥ç¨‹ã€‚\nçŸ¥è¯†ç‚¹  äº†è§£ xmake å¸¸ç”¨å†…ç½®å˜é‡ æ„å»ºé…ç½®ä¸ç¯å¢ƒå˜é‡ã€shell ç­‰äº¤äº’  å†…ç½®å˜é‡ä»‹ç» xmake æä¾›äº† $(varname) çš„è¯­æ³•ï¼Œæ¥æ”¯æŒåœ¨é…ç½®å­—ç¬¦ä¸²ä¸­ç›´æ¥ä¼ é€’å†…ç½®å˜é‡ï¼Œä¾‹å¦‚ï¼š\nadd_cxflags(\u0026quot;-I$(projectdir)\u0026quot;)\r å®ƒä¼šåœ¨å®é™…ç¼–è¯‘æ—¶ï¼Œå°†å†…ç½®çš„ projectdir å˜é‡è½¬æ¢ä¸ºå®é™…çš„é¡¹ç›®æ ¹ç›®å½•ï¼š-I/home/shiyanlou/helloã€‚\né…ç½®ä¼ é€’é¡¹ç›®æ ¹ç›®å½• åœ¨è¿›å…¥æœ¬å®éªŒå‰ï¼Œæˆ‘ä»¬å…ˆåˆ é™¤ä¸‹ä¹‹å‰çš„ hello é¡¹ç›®ç›®å½•ï¼ˆå¦‚æœå­˜åœ¨çš„è¯ï¼‰ï¼Œç„¶ååˆ›å»ºä¸€ä¸ªæ–°çš„ hello å·¥ç¨‹ã€‚\ncd ~/Code\rrm -rf hello\rxmake create hello\r ç„¶åè¿›å…¥åˆ›å»ºçš„ hello é¡¹ç›®ç›®å½•ï¼Œç›´æ¥æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å¿«é€Ÿæ‰“å°è¾“å‡ºå†…ç½®å˜é‡è¿›è¡Œæµ‹è¯•ã€‚\ncd hello\rxmake l print '$(projectdir)'\r ä¸Šé¢çš„å‘½ä»¤ï¼Œç›¸å½“äºç›´æ¥è°ƒç”¨äº† xmake å†…ç½®æ¥å£ print å»æ‰“å°è¾“å‡ºå½“å‰é¡¹ç›®å¯¹åº”çš„ $(projectdir) å†…ç½®å˜é‡çš„å€¼ï¼Œä¹Ÿå°±æ˜¯é¡¹ç›®çš„æ ¹ç›®å½•è·¯å¾„ã€‚\nè¿™ä¸ªå˜é‡ä¼šéšç€ä¸åŒçš„é¡¹ç›®è‡ªåŠ¨é€‚é…å¯¹åº”çš„é¡¹ç›®è·¯å¾„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åœ¨æè¿°åŸŸé…ç½®ä¸­ç›´æ¥åµŒå…¥è¿™ä¸ªå˜é‡æ¥ä½¿ç”¨ã€‚\næ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°† xmake.lua ä¿®æ”¹æˆå¦‚ä¸‹å†…å®¹ã€‚\ntarget(\u0026quot;hello\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\radd_includedirs(\u0026quot;$(projectdir)/inc\u0026quot;)\r é€šè¿‡ä¸Šé¢çš„é…ç½®ï¼Œæˆ‘ä»¬å¯ä»¥å¤§æ¦‚çœ‹å‡ºï¼Œ$(projectdir) å†…ç½®å˜é‡å¯ç”¨äºåœ¨ä¼ å‚æ—¶å¿«é€Ÿè·å–å’Œæ‹¼æ¥å˜é‡å­—ç¬¦ä¸²ï¼Œä½¿å¾—ä¼ é€’ includedirs æ—¶ï¼Œå¯ä»¥è·å–åˆ°ç›¸å¯¹äºé¡¹ç›®æ ¹ç›®å½•çš„è·¯å¾„å­—ç¬¦ä¸²ï¼Œä¹Ÿå°±æ˜¯ -I/home/shiyanlou/Code/hello/incã€‚\nåœ¨æ‰§è¡Œç¼–è¯‘å‰ï¼Œæˆ‘ä»¬è¿˜éœ€è¦åˆ›å»ºç¼ºå¤±çš„ inc ç›®å½•ï¼Œå¹¶ä¸”åœ¨é‡Œé¢åˆ›å»ºä¸€ä¸ªç©ºå¤´æ–‡ä»¶ã€‚\nmkdir inc\rtouch inc/stub.h\r ç„¶åæ‰§è¡Œç¼–è¯‘ï¼Œå¹¶æŸ¥çœ‹è¯¦ç»†ç¼–è¯‘è¾“å‡ºç¡®è®¤é…ç½®çš„å¤´æ–‡ä»¶æœç´¢è·¯å¾„æ˜¯å¦ç”Ÿæ•ˆã€‚\nxmake -rv\r å¦‚æœèƒ½å¤Ÿçœ‹åˆ°ä¸‹å›¾çº¢çº¿éƒ¨åˆ†ç¼–è¯‘é€‰é¡¹ï¼Œåˆ™è¯´æ˜å†…ç½®å˜é‡ç¡®å®é…ç½®æˆåŠŸäº†ã€‚\né™¤äº†è·å–é¡¹ç›®æ ¹è·¯å¾„å¤–ï¼Œxmake è¿˜æä¾›äº†ä¸€äº›å…¶å®ƒçš„å†…ç½®å˜é‡ï¼Œç”¨äºå¿«é€Ÿè·å–å„ç§åŸºæœ¬è·¯å¾„å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ä¸‹é¢å‡ ä¸ªä¹Ÿæ˜¯æ¯”è¾ƒå¸¸ç”¨çš„è·¯å¾„ã€‚\n $(buildir)ï¼šå®é™…æ„å»ºè¾“å‡ºç›®å½•ã€‚ $(tmpdir)ï¼šä¸´æ—¶ç›®å½•ã€‚ $(curdir)ï¼šå½“å‰è¿è¡Œç›®å½•ã€‚ $(scriptdir)ï¼šå½“å‰ xmake.lua é…ç½®è„šæœ¬æ‰€åœ¨ç›®å½•ã€‚ $(programdir)ï¼šxmake å®‰è£…ç¨‹åºçš„ lua è„šæœ¬æ ¹ç›®å½•ã€‚  è·å–ç¯å¢ƒå˜é‡ é™¤äº†è·å–å„ç§åŸºæœ¬è·¯å¾„å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡ $(env varname) å†…ç½®å˜é‡ï¼Œåœ¨å­—ç¬¦ä¸²ä¸­å¿«é€Ÿè·å–æŒ‡å®šç¯å¢ƒå˜é‡ã€‚\nä¾‹å¦‚è·å–ç¯å¢ƒå˜é‡ä¸­çš„ $HOME è·¯å¾„ä¼ é€’åˆ° xmake.lua é…ç½®ä¸­å»ã€‚\ntarget(\u0026quot;hello\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\radd_includedirs(\u0026quot;$(env HOME)\u0026quot;)\r æ‰§è¡Œ xmake -rv æŸ¥çœ‹ä¼ å…¥ gcc çš„å¤´æ–‡ä»¶æœç´¢ç›®å½•æ˜¯å¦å¸¦ä¸Šäº† $HOME è·¯å¾„ã€‚\nä¸Šå›¾çº¢çº¿ä½ç½®çš„ -I/home/shiyanlou å°±æ˜¯æˆ‘ä»¬é€šè¿‡è·å– $HOME ç¯å¢ƒå˜é‡å¾—åˆ°çš„å­—ç¬¦ä¸²ï¼Œè‡³äºå¦‚ä½•è·å–å½“å‰ç»ˆç«¯ä¸‹çš„æ‰€æœ‰ç¯å¢ƒå˜é‡ï¼Œxmake ä¹Ÿæä¾›äº†æ¥å£å¯ä»¥ç›´æ¥å¿«é€ŸæŸ¥çœ‹ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å³å¯ï¼Œè¿™ä¸ªå‘½ä»¤ä¼šæ‰“å°æ‰€æœ‰çš„ç¯å¢ƒå˜é‡ã€‚\nxmake l os.getenvs\r ä¹Ÿå¯ä»¥æŒ‡å®šæŸ¥çœ‹ç‰¹å®šç¯å¢ƒå˜é‡çš„å†…å®¹ã€‚\nxmake l os.getenv HOME\r å…¶æ•ˆæœè·Ÿ echo $HOME æ˜¯ä¸€æ ·çš„ï¼Œä½†è¿™ä¸ªå‘½ä»¤æ›´åŠ é€šç”¨ï¼Œå…¶å†…éƒ¨å®é™…å°±æ˜¯è°ƒç”¨äº† xmake çš„å†…ç½®æ¥å£ os.getenv(\u0026quot;HOME\u0026quot;)ï¼Œå…³äº os ç›¸å…³å†…ç½®æ¥å£ï¼Œæˆ‘ä»¬ä¼šåœ¨åé¢çš„å®éªŒä¸­è¯¦ç»†è®²è§£ã€‚\næ‰§è¡Œè·å– shell è¾“å‡ºå†…å®¹ è™½ç„¶åœ¨è„šæœ¬åŸŸï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ os.run ç­‰æ¥å£å¿«é€Ÿæ‰§è¡Œå…¶å®ƒ shell ç¨‹åºï¼Œä½†è¿™å¯¹åˆå­¦è€…æ¥è¯´ï¼Œä½¿ç”¨èµ·æ¥è¿˜æ˜¯ç¹çäº›ï¼Œå› æ­¤ xmake ä¹Ÿæä¾›äº† $(shell command) å†…ç½®å˜é‡çš„æ–¹å¼ï¼Œåœ¨æè¿°åŸŸé…ç½®ä¸­å¿«é€Ÿæ‰§è¡Œ shell å‘½ä»¤ï¼Œå¹¶åµŒå…¥æ‰§è¡Œè¾“å‡ºç»“æœåˆ°é…ç½®å­—ç¬¦ä¸²ä¸­ã€‚\nä¾‹å¦‚ï¼Œç°åœ¨æœ‰ä¸ªéœ€æ±‚ï¼Œæˆ‘ä»¬æƒ³ç”¨åœ¨ç¼–è¯‘ Linux ç¨‹åºæ—¶ï¼Œè°ƒç”¨ pkg-config è·å–åˆ°å®é™…çš„ç¬¬ä¸‰æ–¹é“¾æ¥åº“åï¼Œä¹Ÿå¯ä»¥è¿™ä¹ˆé…ç½®ã€‚\ntarget(\u0026quot;hello\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\rif is_plat(\u0026quot;linux\u0026quot;) then\radd_ldflags(\u0026quot;$(shell pkg-config --libs sqlite3)\u0026quot;)\rend\r åœ¨æ‰§è¡Œç¼–è¯‘å‰ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å®‰è£… libsqlite3 åº“åˆ°ç³»ç»Ÿã€‚\nsudo apt update\rsudo apt install -y libsqlite3-dev\r æ‰§è¡Œ xmake -rv å‘½ä»¤ç¼–è¯‘å°±å¯ä»¥çœ‹åˆ°æ•ˆæœäº†ï¼Œå¦‚å›¾ã€‚\nä¸Šå›¾çº¢çº¿éƒ¨åˆ†å°±æ˜¯æ‰§è¡Œäº†æˆ‘ä»¬é…ç½®ä¸­ä¼ å…¥çš„ shell å‘½ä»¤è·å–çš„è¾“å‡ºç»“æœã€‚\nä¸è¿‡é€šè¿‡æ‰§è¡Œå¤–éƒ¨ shell å‘½ä»¤æ¥é›†æˆä¾èµ–åº“ï¼Œæˆ‘ä»¬å¹¶ä¸æ¨èï¼Œè¿™é‡Œåªæ˜¯å‡ºäºæ¼”ç¤ºç›®çš„ï¼Œxmake æ›´æ¨èä½¿ç”¨ä¹‹å‰å®éªŒä¸­ä»‹ç»çš„ find_packages æˆ–è€… add_requires é…ç½®æ¥å£æ¥é›†æˆä¾èµ–åº“ã€‚\nè¯»å–é…ç½®é€‰é¡¹ å…¶å®ï¼Œé™¤äº† xmake å†…ç½®çš„è¿™äº›å˜é‡ä»¥å¤–ï¼Œåªè¦æ˜¯åœ¨ xmake f/config é…ç½®å‘½ä»¤ä¸­çš„æ‰€æœ‰å‚æ•°é€‰é¡¹é…ç½®ï¼Œéƒ½æ˜¯å¯ä»¥é€šè¿‡å†…ç½®å˜é‡çš„æ–¹å¼æ¥è·å–ä½¿ç”¨ã€‚\næ¯”å¦‚ xmake f --plat=linux é…ç½®äº†ç›®æ ‡å¹³å°ï¼Œé‚£ä¹ˆå°±èƒ½å¤Ÿé€šè¿‡ $(plat) å†…ç½®å˜é‡æ¥è·å–ï¼›é€šè¿‡ xmake f --mode=debug é…ç½®äº†ç¼–è¯‘æ¨¡å¼ï¼Œé‚£ä¹ˆå°±å¯ä»¥é€šè¿‡ $(mode) æ¥è·å–åˆ°ã€‚\næ‰€æœ‰çš„é…ç½®é€‰é¡¹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ xmake f --help æ¥æŸ¥çœ‹é…ç½®èœå•åˆ—è¡¨è·å–åˆ°ï¼Œæ¯”è¾ƒå¸¸ç”¨çš„æœ‰ $(plat)ã€$(arch)ã€$(host) å’Œ $(mode) ç­‰ï¼Œè€Œä¹‹å‰è¯´çš„ $(buildir) ä¹Ÿæ˜¯å…¶ä¸­ä¸€å‘˜ï¼Œå¯¹åº”é…ç½®é¡¹ xmake f -o buildirã€‚\næ¥ä¸‹æ¥ä¿®æ”¹ä¹‹å‰çš„ xmake.lua å°è¯•å¦‚ä½•ä½¿ç”¨è¿™äº›å˜é‡ï¼Œå…·ä½“ä¿®æ”¹å¦‚ä¸‹ã€‚\ntarget(\u0026quot;hello\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\rset_targetdir(\u0026quot;$(projectdir)/bin/$(plat)/$(arch)/$(mode)\u0026quot;)\r è¿™é‡Œï¼Œæˆ‘ä»¬é€šè¿‡ set_targetdir æ¥å£ä¿®æ”¹é»˜è®¤çš„ç›®æ ‡ç¨‹åºè¾“å‡ºè·¯å¾„ï¼Œå°†å…¶ç¼–è¯‘ç”Ÿæˆåˆ°é¡¹ç›®æ ¹ç›®å½•çš„ bin ç›®å½•ä¸‹ï¼Œå¹¶ä¸”æ ¹æ®ä¸åŒçš„å¹³å°ã€æ¶æ„å’Œç¼–è¯‘æ¨¡å¼è‡ªåŠ¨åˆ†å­ç›®å½•å­˜æ”¾ã€‚\næ‰§è¡Œå‘½ä»¤ xmake -rv è¿›è¡Œç¼–è¯‘ï¼Œç„¶åæ‰§è¡Œ tree bin æŸ¥çœ‹å®é™…ç”Ÿæˆçš„è·¯å¾„æ¥å£ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚\næ³¨ï¼šè¿™é‡Œåªä¿®æ”¹äº†å¯æ‰§è¡Œç›®æ ‡ç¨‹åºçš„å­˜å‚¨è·¯å¾„ï¼Œè€Œ build ç›®å½•è¿˜æ˜¯æ²¡æœ‰è¢«ä¿®æ”¹ï¼Œå› ä¸º build ç›®å½•ä¸‹è¿˜ä¼šå­˜å‚¨æ„å»ºè¿‡ç¨‹ä¸­çš„å…¶å®ƒçš„ä¸€äº›ä¸­é—´å¯¹è±¡æ–‡ä»¶ã€‚\nè¯»å–è‡ªå®šä¹‰é€‰é¡¹é…ç½® æ—¢ç„¶ä»»æ„çš„ xmake f/config é…ç½®é€‰é¡¹å‚æ•°éƒ½å¯ä»¥é€šè¿‡å†…ç½®å˜é‡çš„æ–¹å¼è·å–åˆ°ï¼Œé‚£ä¹ˆæˆ‘ä»¬è‡ªå®šä¹‰çš„é…ç½®é€‰é¡¹ï¼Œä¹Ÿå¯ä»¥ç”¨åŒæ ·çš„æ–¹å¼è·å–åˆ°ã€‚\nåœ¨ä¸Šä¸€èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬å·²ç»åˆæ­¥äº†è§£äº†å¦‚ä½•è‡ªå®šä¹‰é…ç½®é€‰é¡¹ myoptï¼Œç°åœ¨ç»§ç»­åœ¨ä¹‹å‰çš„é…ç½®åŸºç¡€ä¸Šï¼Œé€šè¿‡å†…ç½®å˜é‡çš„æ–¹å¼è·å–ä¼ å…¥ myopt ä¸­çš„å€¼ã€‚\nä¿®æ”¹ xmake.lua é…ç½®ï¼Œåœ¨é‡Œé¢æ–°å¢ myopt é€‰é¡¹å®šä¹‰ï¼Œç„¶åæ·»åŠ ä¸€ä¸ªå®å®šä¹‰æ¥è·å– myopt çš„é…ç½®å€¼ï¼Œæ ¹æ®ä¼ å…¥çš„é…ç½®å‚æ•°ï¼ŒåŠ¨æ€åˆ‡æ¢å®å®šä¹‰å¼€å…³å€¼ã€‚\noption(\u0026quot;myopt\u0026quot;)\rset_showmenu(true)\rset_description(\u0026quot;The test config option\u0026quot;)\roption_end()\rtarget(\u0026quot;hello\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\radd_defines(\u0026quot;$(myopt)\u0026quot;)\r æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œä¼ å…¥ TEST1 åˆ° myopt é€‰é¡¹å‚æ•°ï¼Œæ¥å®šä¹‰ -DTEST1 å®ã€‚\nxmake f --myopt=TEST1\rxmake -rv\r ä¸‹å›¾çº¢çº¿æ ‡æ³¨ä½ç½®çš„ç¼–è¯‘å‚æ•°å°±æ˜¯æˆ‘ä»¬é€šè¿‡ myopt åŠ¨æ€ä¼ å…¥çš„å®å®šä¹‰ã€‚\nç»§ç»­æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œä¼ å…¥ TEST2 åˆ° myopt é€‰é¡¹å‚æ•°ï¼Œå°†å®å®šä¹‰ä¿®æ”¹ä¸º -DTEST2ã€‚\nxmake f --myopt=TEST2\rxmake -rv\r ç»“æœå¦‚ä¸‹ï¼Œå®å®šä¹‰åˆè¢«æ”¹æˆäº† -DTEST2ã€‚\nå®éªŒæ€»ç»“ åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬äº†è§£äº†ä»€ä¹ˆæ˜¯å†…ç½®å˜é‡ï¼Œå¹¶ä¸”å­¦ä¹ äº†å¦‚ä½•å»ä½¿ç”¨å†…ç½®å˜é‡è·å– shell è¾“å‡ºã€ç¯å¢ƒå˜é‡å’Œè‡ªå®šä¹‰é€‰é¡¹å€¼æ¥é…ç½®é¡¹ç›®ã€‚\næœ¬å®éªŒçš„å‚è€ƒä»£ç å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ä¸‹è½½ï¼š\nwget https://labfile.oss.aliyuncs.com/courses/2764/code8.zip\r ","id":59,"section":"categories","summary":"å†…ç½®å˜é‡ åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å­¦ä¹ åˆ° xmake å†…ç½®å˜é‡çš„åŸºç¡€ä½¿ç”¨ï¼Œä»¥åŠå¦‚ä½•è·Ÿç¯å¢ƒå˜é‡ã€shellã€è‡ªå®šä¹‰é€‰é¡¹é…ç½®äº¤äº’æ¥åŠ¨æ€é…ç½®é¡¹ç›®å·¥ç¨‹ã€‚ çŸ¥è¯†ç‚¹ äº†è§£ xmake","tags":["xmake"],"title":"å®éªŒ8å†…ç½®å˜é‡","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/app/xmake/%E8%93%9D%E6%A1%A5%E7%BD%91%E8%AF%BE/2xmake%E5%9F%BA%E7%A1%80/%E5%AE%9E%E9%AA%8C8%E5%86%85%E7%BD%AE%E5%8F%98%E9%87%8F/","year":"2021"},{"content":"æ¡ä»¶åˆ¤æ–­ åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬ä¼šå­¦ä¹ åˆ° xmake æ¡ä»¶åˆ¤æ–­è¯­å¥çš„åŸºç¡€ç”¨æ³•ï¼Œä»¥åŠå¸¸ç”¨çš„å¹³å°ã€æ¶æ„ç­‰åˆ¤æ–­æ¥å£ï¼Œå¦å¤–è¿˜ä¼šå­¦ä¹ å¦‚ä½•åˆ¤æ–­è‡ªå®šä¹‰é€‰é¡¹çš„å€¼æ¥æ§åˆ¶ç¼–è¯‘ã€‚\nçŸ¥è¯†ç‚¹  xmake å¸¸ç”¨æ¡ä»¶åˆ¤æ–­æ¥å£ xmake æ¡ä»¶åˆ¤æ–­è¯­æ³• å¦‚ä½•è‡ªå®šä¹‰é…ç½®é€‰é¡¹  æ¡ä»¶åˆ¤æ–­è¯­æ³•ç®€ä»‹ ç”±äº xmake æ˜¯åŸºäº lua è„šæœ¬çš„ï¼Œæ‰€ä»¥ä¸ç®¡æ˜¯åœ¨æè¿°åŸŸè¿˜æ˜¯è„šæœ¬åŸŸä¸­çš„é…ç½®ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥é€šè¿‡åŸºç¡€çš„ lua æ¡ä»¶åˆ¤æ–­è¯­æ³•å»æ§åˆ¶é…ç½®é€»è¾‘ã€‚\næ•´ä¸ªæ¡ä»¶æ§åˆ¶çš„è¯­æ³•é€»è¾‘å¤§æ¦‚å¦‚ä¸‹ã€‚\nif expr then\r-- ...\relseif not expr then\r-- ...\relse\r-- ...\rend\r æ•´ä¸ªè¯­æ³•ç»“æ„éå¸¸çš„ç®€å•ï¼Œå¹¶ä¸”åŒæ—¶é€‚ç”¨äºæè¿°åŸŸé…ç½®å’Œè„šæœ¬åŸŸé…ç½®ï¼Œå…¶ä¸­ expr éƒ¨åˆ†ä¸ºæ¡ä»¶åˆ¤æ–­è¡¨è¾¾å¼ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ notï¼Œand å’Œ or ä¸‰ä¸ªé€»è¾‘å…³é”®å­—ç»„åˆæˆå„ç§å¤æ‚çš„é€»è¾‘æ¡ä»¶ï¼Œä¾‹å¦‚ã€‚\nif a \u0026gt; b and not c or d then\r-- ...\rend\r ä¸è¿‡ï¼Œå¯¹äºæ„å»ºé…ç½®ï¼Œæˆ‘ä»¬ä¸éœ€è¦å†™è¿™ä¹ˆå¤æ‚çš„æ¡ä»¶ï¼Œé€šå¸¸ä»…ä»…åªéœ€è¦åˆ¤æ–­ä¸‹å¹³å°ã€æ¶æ„ç­‰åŸºç¡€æ¡ä»¶æ¥æ§åˆ¶ç¼–è¯‘é…ç½®å°±è¡Œäº†ã€‚å› æ­¤ä¸ºäº†ç®€åŒ–æ¡ä»¶åˆ¤æ–­ï¼Œxmake æä¾›äº†ä¸€äº›å†…ç½®çš„æ¡ä»¶åˆ¤æ–­æ¥å£ï¼Œç”¨æ¥å¿«é€Ÿåˆ¤æ–­å®ƒä»¬ï¼Œå¹¶ä¸”ä¹Ÿç®€åŒ–äº†æ•´ä¸ªæ¡ä»¶åˆ¤æ–­çš„é€»è¾‘ï¼Œä¸‹é¢æˆ‘ä»¬æ¥è¯¦ç»†è®²è§£ä¸‹ã€‚\nåˆ¤æ–­å½“å‰ç›®æ ‡å¹³å° åœ¨æ„å»ºé…ç½®ä¸­ï¼Œå¦‚æœè¦æ”¯æŒè·¨å¹³å°æ„å»ºï¼Œé‚£ä¹ˆæœ€å¸¸ç”¨çš„è«è¿‡äºåˆ¤æ–­å½“å‰ç¨‹åºç¼–è¯‘åçš„è¿è¡Œå¹³å°äº†ï¼Œä¹Ÿå°±æ˜¯é€šè¿‡åˆ¤æ–­æˆ‘ä»¬ç¼–è¯‘ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶å’Œåº“ç¨‹åºå®é™…çš„è¿è¡Œå¹³å°ç¯å¢ƒï¼Œæ¥æ§åˆ¶ç¼–è¯‘é…ç½®ã€‚\nåœ¨å¼€å§‹å®éªŒå‰ï¼Œæˆ‘ä»¬å…ˆæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤åˆ›å»ºä¸€ä¸ªæ–°çš„ç©ºå·¥ç¨‹ï¼Œç„¶ååœ¨é‡Œé¢åˆ›å»ºä¸€ä¸ª src/linux/stub.cpp çš„ç©ºä»£ç æ–‡ä»¶ã€‚\ncd Code\rxmake create condition\rcd condition \u0026amp;\u0026amp; mkdir src/linux\rtouch src/linux/stub.cpp\r å…¶å·¥ç¨‹æ–‡ä»¶ç»“æ„å¦‚ä¸‹ã€‚\n.\râ”œâ”€â”€ src\râ”‚ â”œâ”€â”€ linux\râ”‚ â”‚ â””â”€â”€ stub.cpp\râ”‚ â””â”€â”€ main.cpp\râ””â”€â”€ xmake.lua\r åœ¨å‡†å¤‡å·¥ä½œåšå¥½åï¼Œæˆ‘ä»¬å¼€å§‹ç¼–è¾‘ xmake.lua ä¿®æ”¹æˆä¸‹é¢çš„é…ç½®ã€‚\ntarget(\u0026quot;test\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\rif is_plat(\u0026quot;linux\u0026quot;) then\radd_defines(\u0026quot;LINUX\u0026quot;)\radd_files(\u0026quot;src/linux/*.cpp\u0026quot;)\rend\r åœ¨ä¸Šé¢çš„é…ç½®ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡å†…ç½®çš„æ¡ä»¶åˆ¤æ–­æ¥å£ is_plat(\u0026quot;linux\u0026quot;) æ¥åˆ¤æ–­å½“å‰çš„ç›®æ ‡å¹³å°æ˜¯å¦ä¸º Linuxï¼Œå¦‚æœå½“å‰æ­£åœ¨ä¸º Linux ç¨‹åºåšç¼–è¯‘ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¼šåˆ‡å…¥é‡Œé¢çš„ if åˆ†æ”¯ï¼Œé¢å¤–ç¼–è¯‘ src/linux/*.cpp ç­‰é’ˆå¯¹ Linux å¹³å°ç‰¹æœ‰çš„æºæ–‡ä»¶ï¼Œå¹¶ä¸”åŒæ—¶æ·»åŠ ä¸Š -DLINUX å®å®šä¹‰ã€‚\nç”±äºå®éªŒç¯å¢ƒå°±æ˜¯ Linux ç³»ç»Ÿï¼Œå¹¶ä¸”ç¼–è¯‘çš„ç›®æ ‡ç¨‹åºä¹Ÿæ˜¯é’ˆå¯¹ Linux å¹³å°çš„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æ‰§è¡Œ xmake å‘½ä»¤ç¼–è¯‘ç¡®è®¤ src/linux/*.cpp æºæ–‡ä»¶æ˜¯å¦çœŸçš„å‚ä¸äº†ç¼–è¯‘ã€‚\nä¸Šå›¾çº¢çº¿ä½ç½®çš„æºæ–‡ä»¶å°±æ˜¯æˆ‘ä»¬åˆšåˆšé…ç½®çš„ä»…å¯¹ Linux å¹³å°æ‰ä¼šå‚ä¸ç¼–è¯‘çš„ä»£ç æ–‡ä»¶ï¼Œæˆ‘ä»¬å†æ¥æ‰§è¡Œ xmake -rv æŸ¥çœ‹è¯¦ç»†çš„ç¼–è¯‘è¾“å‡ºï¼Œ-DLINUX ä¹Ÿè¢«æ­£å¸¸ä¼ é€’è¿›äº† gcc ç¼–è¯‘å™¨ã€‚\nå¦å¤–éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œç›®æ ‡ç¼–è¯‘å¹³å°æ˜¯å¯ä»¥é€šè¿‡ xmake f -p linux æ˜¾å¼è®¾ç½®çš„ï¼Œå®ƒä¼šè·Ÿ is_plat(\u0026quot;linux\u0026quot;) ä¿æŒä¸€è‡´ï¼Œå¦‚æœç¼–è¯‘å‰æ²¡æœ‰é…ç½®è¿‡å¹³å°ï¼Œé‚£ä¹ˆé»˜è®¤ä¼šä½¿ç”¨å½“å‰ä¸»æœºå¹³å°æ¥ä½œä¸ºç›®æ ‡ç¼–è¯‘å¹³å°ã€‚\nè€Œæ˜¾å¼æŒ‡å®šç¼–è¯‘å¹³å°ï¼Œé€šå¸¸åœ¨äº¤å‰ç¼–è¯‘æ—¶å€™éå¸¸æœ‰ç”¨ï¼Œä¾‹å¦‚åœ¨ Linux ç³»ç»Ÿä¸Šä½¿ç”¨ Android NDK ç¼–è¯‘ android åº“ç¨‹åºï¼Œå°±å¯ä»¥é€šè¿‡ xmake f -p android åˆ‡æ¢ Android ç›®æ ‡å¹³å°ç¼–è¯‘ï¼Œè¿™ä¸ªæ—¶å€™å°±æ˜¯å¯¹åº”æ¡ä»¶é…ç½® is_plat(\u0026quot;android\u0026quot;) è€Œä¸æ˜¯ Linuxã€‚\nç”±äº Android ä¹Ÿæ˜¯åŸºäº Linux ç³»ç»Ÿï¼Œæ‰€ä»¥æœ‰äº›é…ç½®æ˜¯å¯ä»¥è·Ÿ Linux ä¿æŒä¸€è‡´çš„ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ is_plat(\u0026quot;android\u0026quot;, \u0026quot;linux\u0026quot;) æ¥åˆ¤æ–­å¤šä¸ªå¹³å°ï¼Œå®ƒä»¬ä¹‹é—´æ˜¯å±äºæˆ–çš„å…³ç³»ã€‚\nif is_plat(\u0026quot;linux\u0026quot;, \u0026quot;android\u0026quot;) then\radd_defines(\u0026quot;LINUX\u0026quot;)\radd_files(\u0026quot;src/linux/*.cpp\u0026quot;)\rend\r å…³äº Android ç­‰å…¶å®ƒå¹³å°çš„åˆ‡æ¢ç¼–è¯‘è¯¦æƒ…ï¼Œå¯ä»¥çœ‹ä¸‹ å®˜æ–¹æ–‡æ¡£ï¼Œè¿™é‡Œå°±ä¸å¤šåšä»‹ç»äº†ã€‚\nè€Œç›®å‰ xmake æ”¯æŒçš„æ‰€æœ‰å¹³å°å¯ä»¥ç®€å•åˆ—ä¸¾ä¸‹ï¼š\n Windows Cross Linux macOS Android Iphoneos Watchos Freebsd  åˆ¤æ–­ç¼–è¯‘æŒ‡ä»¤æ¶æ„ ç¼–è¯‘æŒ‡ä»¤æ¶æ„æŒ‡çš„æ˜¯ç”Ÿæˆçš„ç›®æ ‡ç¨‹åºå®é™…æ‰§è¡Œçš„æŒ‡ä»¤æ¶æ„ï¼Œä¾‹å¦‚ï¼šx86_86ã€i386ã€armv7 ç­‰æŒ‡ä»¤é›†ã€‚\nåœ¨ Windows ç³»ç»Ÿä¸Šé€šå¸¸æ˜¯ x64ã€x86 æŒ‡ä»¤é›†ï¼Œè€Œåœ¨ Linux/macOS ç³»ç»Ÿä¸Šé€šå¸¸æ˜¯ x86_64ã€i386 æŒ‡ä»¤é›†ï¼Œå¦å¤–åœ¨ä¸€äº›åµŒå…¥å¼è®¾å¤‡ã€ç§»åŠ¨ç«¯æ“ä½œç³»ç»Ÿä¸Šé€šå¸¸æ˜¯ armv7ã€arm64ã€mips ç­‰æŒ‡ä»¤æ¶æ„ã€‚\né€šè¿‡åˆ¤æ–­æŒ‡ä»¤æ¶æ„ï¼Œæˆ‘ä»¬å¯ä»¥é’ˆå¯¹æ€§é…ç½®å¤„ç†ä¸åŒæ¶æ„çš„ç¼–è¯‘å®ã€ä»£ç ä»¥åŠç‰¹æ®Šç¼–è¯‘ä¼˜åŒ–é€‰é¡¹ç­‰ã€‚æ¯”å¦‚å¯ä»¥åˆ¤æ–­å½“å‰ç¼–è¯‘æŒ‡ä»¤æ¶æ„å¦‚æœæ˜¯ x86_64 çš„è¯ï¼Œå°±å†é¢å¤–ç¼–è¯‘ src/x86_64/stub.S æ±‡ç¼–æ–‡ä»¶ï¼Œé‡Œé¢å¯ä»¥é’ˆå¯¹è¿™ä¸ªæ¶æ„å®ç°ä¸€äº›ç‰¹æ®Šçš„æ±‡ç¼–ä¼˜åŒ–ä»£ç ã€‚\nå°† condition/xmake.lua ä¿®æ”¹ä¸ºå¦‚ä¸‹é…ç½®ã€‚\ntarget(\u0026quot;test\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\rif is_plat(\u0026quot;linux\u0026quot;) then\radd_defines(\u0026quot;LINUX\u0026quot;)\radd_files(\u0026quot;src/linux/*.cpp\u0026quot;)\rend\rif is_arch(\u0026quot;x86_64\u0026quot;) then\radd_files(\u0026quot;src/x86_64/*.S\u0026quot;)\rend\r æˆ‘ä»¬æ–°å¢äº†å¯¹ x86_64 æ¶æ„çš„åˆ¤æ–­å»ç¼–è¯‘ä¸€äº›ç‰¹å®šçš„æ±‡ç¼–ä»£ç ï¼Œå½“ç„¶è¿™é‡Œæˆ‘ä»¬ä»…ä»…ä¸ºäº†æ¼”ç¤ºï¼Œæ‰€ä»¥åªæ˜¯é€šè¿‡ä¸‹é¢çš„å‘½ä»¤åˆ›å»ºä¸€ä¸ªç©ºçš„æ±‡ç¼–ä»£ç æ–‡ä»¶ï¼Œé‡Œé¢æ²¡æœ‰æ·»åŠ ä»»ä½•å®ç°ã€‚\nmkdir src/x86_64\rtouch src/x86_64/stub.S\r æˆ‘ä»¬å†æ¥å¼ºåˆ¶æ‰§è¡Œä¸‹ç¼–è¯‘ï¼Œçœ‹ä¸‹ç¼–è¯‘è¾“å‡ºï¼Œç”±äºå½“å‰çš„å®éªŒç¯å¢ƒå°±æ˜¯ Linux ç³»ç»Ÿçš„ x86_64 æ¶æ„ï¼Œæ‰€ä»¥ä¼šè§¦å‘æ–°åŠ çš„æ¡ä»¶é…ç½®ï¼Œç»“æœå¦‚ä¸‹å›¾çº¢çº¿ä½ç½®æ‰€ç¤ºã€‚\nåˆ¤æ–­å®¿ä¸»å¹³å°æ¶æ„ é™¤äº†ä¸Šè¿°çš„ç›®æ ‡ç¨‹åºå®é™…è¿è¡Œå¹³å°å’Œæ¶æ„ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬è¿˜éœ€è¦åˆ¤æ–­å½“å‰å®¿ä¸»ç¯å¢ƒçš„ç³»ç»Ÿå¹³å°å’ŒæŒ‡ä»¤æ¶æ„ï¼ˆä¹Ÿå°±æ˜¯ç¼–è¯‘å™¨å®é™…è¿è¡Œçš„ç³»ç»Ÿå¹³å°ï¼‰ã€‚\næ›´ç›´è§‚ç‚¹è¯´ï¼Œæ¯”å¦‚æˆ‘ä»¬åœ¨ Linux ä¸Šç¼–è¯‘ç”Ÿæˆ Android ç³»ç»Ÿçš„ so åº“ç¨‹åºï¼Œé‚£ä¹ˆ Linux å°±æ˜¯å®¿ä¸»å¹³å°ï¼Œè€Œ android å°±æ˜¯å®é™…çš„ç›®æ ‡ç¨‹åºå¹³å°ï¼Œè¿™é€šå¸¸åœ¨äº¤å‰ç¼–è¯‘ç¯å¢ƒä¸­ï¼Œæ›´éœ€è¦åšå¦‚æ­¤åŒºåˆ†ã€‚\nä½†æ˜¯å¯¹äºç¼–è¯‘çš„ç›®æ ‡ç¨‹åºä¹Ÿæ˜¯åœ¨å½“å‰ç³»ç»Ÿç¯å¢ƒä¸‹è¿è¡Œçš„ï¼Œé‚£ä¹ˆå®¿ä¸»å¹³å°å’Œç›®æ ‡å¹³å°æ˜¯å®Œå…¨ä¸€è‡´çš„ã€‚\nå¯ä»¥é€šè¿‡ is_host() é…ç½®æ¥å£æ¥åˆ¤æ–­å®¿ä¸»å¹³å°ï¼Œxmake ä¸ä¼šä» xmake f -p/--plat ä¸­å»å–ç›®æ ‡å¹³å°çš„å®é™…å€¼ï¼Œå› ä¸ºå®¿ä¸»å¹³å°åœ¨ xmake è¿è¡Œæ—¶å€™å°±æ˜¯å›ºå®šçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥ä» os.host() å’Œ os.arch() æ¥å£å»å–å¯¹åº”çš„å€¼ï¼Œä¾‹å¦‚æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œç›´æ¥æŸ¥çœ‹å½“å‰çš„å®¿ä¸»å¹³å°å’Œæ¶æ„æ˜¯å¤šå°‘ã€‚\nxmake l os.host\rxmake l os.arch\r è¿è¡Œç»“æœå¦‚ä¸‹å›¾ã€‚\nè‡³äºåˆšåˆšæ‰€è¯´çš„äº¤å‰ç¼–è¯‘ï¼Œä¹Ÿå°±æ˜¯åœ¨å½“å‰ä¸»æœºç¯å¢ƒä¸‹ä½¿ç”¨äº¤å‰ç¼–è¯‘å·¥å…·é“¾ç”Ÿæˆåªèƒ½åœ¨å…¶å®ƒè®¾å¤‡æ‰èƒ½è¿è¡Œçš„ç›®æ ‡ç¨‹åºï¼Œå¦‚æœåœ¨ Linux ä¸Šç¼–è¯‘ Android ç¨‹åºæˆ–è€…ç¼–è¯‘å…¶å®ƒ armï¼Œmips ç­‰æ¶æ„çš„åµŒå…¥å¼ç›®æ ‡ç¨‹åºï¼Œè¿™äº›ç¼–è¯‘åçš„ç›®æ ‡ç¨‹åºåœ¨å½“å‰çš„å®¿ä¸»ç¯å¢ƒæ˜¯æ²¡åŠæ³•æ‰§è¡Œçš„ï¼Œåªèƒ½åœ¨å¯¹åº”çš„è®¾å¤‡ä¸Šæ‰èƒ½è¿è¡Œã€‚\nè¿™ä¸ªæ—¶å€™ï¼Œå®¿ä¸»å¹³å°å°±æ˜¯æˆ‘ä»¬çš„ Linux ç³»ç»Ÿå¹³å°ï¼Œä¹Ÿå°±æ˜¯äº¤å‰ç¼–è¯‘å·¥å…·é“¾çš„æ‰§è¡Œç¯å¢ƒï¼Œè€Œç›®æ ‡å¹³å°å°±æ˜¯å¯¹åº”ç¨‹åºæ‰€åœ¨è®¾å¤‡ä¸Šçš„ç³»ç»Ÿå¹³å°ï¼Œå®ƒå¹¶ä¸ä¸€å®šæ˜¯å®¿ä¸»ç³»ç»Ÿçš„ Linux ç¯å¢ƒã€‚\né™¤äº†ä¸€äº›å·²çŸ¥çš„ Androidï¼ŒIphoneos ç­‰ç‰¹å®šç³»ç»Ÿå¹³å°ï¼Œå…¶å®ƒå„ç§äº¤å‰ç¼–è¯‘å·¥å…·é“¾å¹³å°ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥ç»Ÿä¸€ä½¿ç”¨ xmake -p cross äº¤å‰ç¼–è¯‘å¹³å°æ¥ç¼–è¯‘ã€‚\nè¿™é‡Œä¸ºäº†æ¼”ç¤ºå®¿ä¸»å¹³å°å’Œç›®æ ‡å¹³å°çš„åŒºåˆ«ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ xmake f -p cross å‘½ä»¤åˆ‡æ¢åˆ° cross äº¤å‰ç¼–è¯‘å¹³å°ä¸‹æ‰§è¡Œ xmake -r é‡æ–°ç¼–è¯‘ï¼Œè¿™ä¸ªæ—¶å€™ç›®æ ‡å¹³å°å°±ä¸å†æ˜¯ Linux äº†ã€‚è¿™é‡Œç”±äºåˆ‡æ¢äº†å¹³å°ï¼Œå› æ­¤æˆ‘ä»¬è¿½åŠ  -c å¼ºåˆ¶è§¦å‘ä¸‹ç¼–è¯‘ç¯å¢ƒçš„æ£€æµ‹ã€‚\nxmake f -p cross -c\rxmake -r\r ç”±äºè¿™ä¸ªæ—¶å€™æˆ‘ä»¬çš„é…ç½®è¿˜æ˜¯åˆ¤æ–­çš„ç›®æ ‡å¹³å°ï¼Œä½†å·²ç»é€šè¿‡å‘½ä»¤åˆ‡æ¢åˆ°äº† cross ç¼–è¯‘å¹³å°ä¸‹ï¼Œæ‰€ä»¥ä¸å†æ˜¯ Linux å’Œ x86_64 äº†ï¼Œå®é™…çš„ç¼–è¯‘å°±ä¼šå˜æˆä¸‹å›¾æ‰€ç¤ºã€‚\nLinux å’Œ x86_64 ç›¸å…³çš„ä»£ç æ–‡ä»¶å°±ä¸å†å‚ä¸ç¼–è¯‘äº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°†ä¹‹å‰çš„é…ç½®æ”¹æˆåˆ¤æ–­å®¿ä¸»å¹³å°å’Œæ¶æ„ã€‚\ntarget(\u0026quot;test\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\rif is_host(\u0026quot;linux\u0026quot;) then\radd_defines(\u0026quot;LINUX\u0026quot;)\radd_files(\u0026quot;src/linux/*.cpp\u0026quot;)\rend\rif os.arch() == \u0026quot;x86_64\u0026quot; then\radd_files(\u0026quot;src/x86_64/*.S\u0026quot;)\rend\r ç„¶åæˆ‘ä»¬å†åˆ‡åˆ° cross å¹³å°ï¼Œæ‰§è¡Œç›¸åŒçš„ç¼–è¯‘ã€‚\nxmake f -p cross -c\rxmake -r\r è¿™å›æˆ‘ä»¬çœ‹åˆ°ï¼ŒLinux å’Œ x86_64 çš„ä»£ç é‡æ–°å‚ä¸äº†ç¼–è¯‘ï¼Œè¿™æ˜¯å› ä¸ºè™½ç„¶ç¼–è¯‘å¹³å°åˆ‡æ¢åˆ°äº† cross äº¤å‰ç¼–è¯‘ï¼Œä½†æ˜¯å®é™… xmake è¿è¡Œçš„å®¿ä¸»å¹³å°è¿˜æ˜¯æˆ‘ä»¬çš„ Linux å®éªŒç¯å¢ƒï¼Œæ°¸è¿œä¸ä¼šæ”¹å˜ã€‚\nåˆ¤æ–­ç¼–è¯‘æ¨¡å¼ è™½ç„¶ xmake æä¾›äº†é»˜è®¤çš„ç¼–è¯‘æ¨¡å¼è§„åˆ™å¯ä»¥è®©å¤§å®¶å¾ˆæ–¹ä¾¿çš„é€šè¿‡ xmake f -m debug åˆ‡æ¢å„ç§ç¼–è¯‘æ¨¡å¼ï¼Œä¸è¿‡æœ‰æ—¶å€™å†…ç½®çš„ mode.debugï¼Œmode.release ç­‰ç¼–è¯‘æ¨¡å¼ä¸ä¸€å®šå®Œå…¨æ»¡è¶³éœ€æ±‚ã€‚è¿™ä¸ªæ—¶å€™ï¼Œå°±éœ€è¦å¤§å®¶è‡ªå·±æ¥åˆ¤æ–­å½“å‰å¤„äºä»€ä¹ˆç¼–è¯‘æ¨¡å¼ï¼Œç„¶åè‡ªå·±å»æ§åˆ¶ç¼–è¯‘ä¼˜åŒ–ã€è°ƒè¯•ç¬¦å·ç­‰å„ç§ç¼–è¯‘é€‰é¡¹çš„å¼€å¯å’Œå…³é—­ã€‚\nä¸‹é¢ï¼Œæˆ‘ä»¬å°†å°è¯•å®Œå…¨ä½¿ç”¨ is_mode() æ¥è‡ªå®šä¹‰åˆ¤æ–­é…ç½® debug å’Œ release ç¼–è¯‘æ¨¡å¼ä¸‹çš„ä¸€äº›ç‰¹å®šç¼–è¯‘é€‰é¡¹ï¼Œå®ç°å’Œå†…ç½®çš„ add_rules(\u0026quot;mode.release\u0026quot;, \u0026quot;mode.debug\u0026quot;) ç¼–è¯‘è§„åˆ™ä¸€æ ·çš„æ§åˆ¶æ•ˆæœã€‚\nç»§ç»­ä¿®æ”¹ condition/xmake.lua æ–‡ä»¶çš„é…ç½®ä¸ºå¦‚ä¸‹æ‰€ç¤ºã€‚\nif is_mode(\u0026quot;release\u0026quot;) then\rset_symbols(\u0026quot;hidden\u0026quot;)\rset_optimize(\u0026quot;fastest\u0026quot;)\rset_strip(\u0026quot;all\u0026quot;)\relseif is_mode(\u0026quot;debug\u0026quot;) then\rset_symbols(\u0026quot;debug\u0026quot;)\rset_optimize(\u0026quot;none\u0026quot;)\rend\rtarget(\u0026quot;test\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\r è¿™æ¬¡æˆ‘ä»¬é€šè¿‡ is_mode() æ¥æ¡ä»¶åˆ¤æ–­å½“å‰ç¼–è¯‘æ¨¡å¼æ˜¯å¦ä¸º debug è¿˜æ˜¯ releaseï¼Œç„¶ååˆ†åˆ«è®¾ç½®ä¸åŒçš„ç¼–è¯‘é€‰é¡¹ï¼Œå¹¶ä¸”æŠŠè¿™äº›é€‰é¡¹è®¾ç½®åˆ°å…¨å±€æ ¹åŸŸï¼Œè¿™æ ·å¯ä»¥å¯¹æ‰€æœ‰ target ç”Ÿæ•ˆï¼Œä¹Ÿå°±é¿å…äº†æ¯ä¸ª target éƒ½å»é‡å¤è®¾ç½®ä¸€éã€‚\nå¦‚æœæ˜¯ release ç¼–è¯‘ï¼Œä¹Ÿå°±æ˜¯ xmake é»˜è®¤çš„ç¼–è¯‘æ¨¡å¼ï¼Œé‚£ä¹ˆé…ç½®ä¸­ï¼Œæˆ‘ä»¬å¯ç”¨äº† fastest ä¼˜åŒ–ç¼–è¯‘ï¼Œå¹¶ä¸”å»é™¤äº†æ‰€æœ‰è°ƒè¯•ç¬¦å·ä¿¡æ¯ï¼Œç›¸å¯¹äº gcc ç¼–è¯‘é€‰é¡¹å°±æ˜¯ -fvisibility=hidden -fvisibility-inlines-hidden -O3ã€‚\næ‰§è¡Œå¦‚ä¸‹å‘½ä»¤åˆ‡æ¢åˆ° release ç¼–è¯‘æ¨¡å¼è¿›è¡ŒéªŒè¯ã€‚\nxmake f -m release\rxmake -rv\r è€Œå¦‚æœå¯ç”¨äº† debug ç¼–è¯‘æ¨¡å¼ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¼šå¼€å¯è°ƒè¯•ç¬¦å·ä¿¡æ¯ï¼Œå¹¶ä¸”ç¦ç”¨æ‰€æœ‰ä¼˜åŒ–ç¼–è¯‘ï¼Œä¹Ÿå°±æ˜¯ç›¸å¯¹äº gcc ä¸­çš„ -g -O0 ç¼–è¯‘é€‰é¡¹ã€‚\næ‰§è¡Œå¦‚ä¸‹å‘½ä»¤åˆ‡åˆ° debug ç¼–è¯‘æ¨¡å¼è¿›è¡ŒéªŒè¯ã€‚\nxmake f -m debug\rxmake -rv\r åˆ¤æ–­è‡ªå®šä¹‰é…ç½®é€‰é¡¹ é™¤äº†ä½¿ç”¨ xmake æä¾›çš„ä¸€äº›å†…ç½®æ¡ä»¶åˆ¤æ–­æ¥å£æ¥åšæ¡ä»¶å¤–ï¼Œä¸ºäº†æ›´åŠ çµæ´»çš„æ‰©å±•æ€§ï¼Œxmake æä¾›äº†ä¸€ç§å¯ä»¥è®©å¤§å®¶è‡ªç”±æ‰©å±•é…ç½®é€‰é¡¹çš„æ–¹å¼ï¼Œä½¿å¾—åœ¨ xmake.lua ä¸­æ›´åŠ å®šåˆ¶åŒ–çš„åˆ¤æ–­é…ç½®é¡¹ã€‚\nä¾‹å¦‚ï¼Œæˆ‘ä»¬è‡ªå®šä¹‰ä¸€ä¸ªé…ç½®é¡¹ --myopt åˆ°å‘½ä»¤è¡Œã€‚\nxmake f --myopt=hello\r å½“ç„¶ï¼Œç°åœ¨ç›´æ¥æ‰§è¡Œè‚¯å®šä¼šæŠ¥é”™çš„ï¼Œå› ä¸ºæˆ‘ä»¬è¿˜æ²¡æœ‰å»å®šä¹‰è¿™ä¸ªé€‰é¡¹ã€‚\né¦–å…ˆï¼Œæˆ‘ä»¬åœ¨ condition/xmake.lua æ–‡ä»¶å¼€å¤´çš„å…¨å±€ä½œç”¨åŸŸéƒ¨åˆ†åŠ å…¥ä¸‹é¢çš„é…ç½®ã€‚\noption(\u0026quot;myopt\u0026quot;)\rset_showmenu(true)\rset_description(\u0026quot;The test config option\u0026quot;)\roption_end()\r å…¶ä¸­ï¼Œset_showmenu(true) ç”¨äºå¯ç”¨å¯¹å¤–å¯¼å‡ºï¼Œè¿™æ · help å¸®åŠ©èœå•ä¸­æ‰èƒ½çœ‹åˆ°è¿™ä¸ªé€‰é¡¹ï¼Œç”¨æˆ·æ‰èƒ½åœ¨å‘½ä»¤ä¸‹ä½¿ç”¨ã€‚\næ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼ŒæŸ¥çœ‹æ˜¯å¦å·²ç»æœ‰äº†è¿™ä¸ªé€‰é¡¹ã€‚ç”¨ grep myopt æ¥å¿«é€Ÿå®šä½æ–°åˆ›å»ºçš„é…ç½®é€‰é¡¹ã€‚\nxmake f --help | grep myopt\r ç°åœ¨èƒ½å¤Ÿåœ¨å¸®åŠ©èœå•ä¸­çœ‹åˆ°è‡ªå®šä¹‰é€‰é¡¹äº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥åœ¨ xmake.lua ä¸­å»åˆ¤æ–­å®šä¹‰çš„é…ç½®é€‰é¡¹æ¥æ§åˆ¶ç¼–è¯‘äº†ã€‚ä¾‹å¦‚æˆ‘ä»¬åˆ¤æ–­ myopt çš„é…ç½®å€¼å¦‚æœæ˜¯ helloï¼Œé‚£ä¹ˆå°±æ·»åŠ  -DHELLO çš„å®å®šä¹‰å‚ä¸ç¼–è¯‘ã€‚\noption(\u0026quot;myopt\u0026quot;)\rset_showmenu(true)\rset_description(\u0026quot;The test config option\u0026quot;)\roption_end()\rtarget(\u0026quot;test\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\rif is_config(\u0026quot;myopt\u0026quot;, \u0026quot;hello\u0026quot;) then\radd_defines(\u0026quot;HELLO\u0026quot;)\rend\r ä¸Šé¢å°±æ˜¯æˆ‘ä»¬çš„å®Œæ•´é…ç½®ï¼Œé€šè¿‡ is_config(\u0026quot;myopt\u0026quot;, \u0026quot;hello\u0026quot;) æ¥åˆ¤æ–­è‡ªå®šä¹‰é€‰é¡¹é…ç½® myopt å½“å‰æ˜¯å¦ä¸º helloï¼Œå¦‚æœæ˜¯å°±ä¼šè‡ªåŠ¨è¿½åŠ  -DHELLO å®å®šä¹‰ã€‚\næ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œè®¾ç½® myopt é…ç½®å€¼åï¼ŒæŸ¥çœ‹ç¼–è¯‘è¾“å‡ºã€‚\nxmake f --myopt=hello\rxmake -rv\r å¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œé‚£ä¹ˆå°±ä¼šçœ‹åˆ°çº¢çº¿ä½ç½®çš„ -DHELLO å·²ç»è¢«ä¼ å…¥äº† gcc ç¼–è¯‘å™¨ã€‚\nè€Œå¦‚æœæˆ‘ä»¬æ¸…é™¤ myopt é…ç½®ï¼Œé‚£ä¹ˆ -DHELLO å®å®šä¹‰ä¹Ÿå°±ä¸ä¼šè¢«è®¾ç½®ä¸Šã€‚\nxmake f -c\rxmake -rv\r å¯ä»¥çœ‹åˆ°ä¸‹å›¾ä¸­å·²ç»æ²¡æœ‰ -DHELLO äº†ã€‚\nå®éªŒæ€»ç»“ åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•å»åˆ¤æ–­æ¡ä»¶è¯­å¥æ§åˆ¶ç¼–è¯‘é€»è¾‘ï¼Œä¹Ÿäº†è§£äº†ä¸€äº› xmake å†…ç½®çš„å¹³å°ã€æ¶æ„åˆ¤æ–­æ¥å£ï¼Œå¦å¤–è¿˜å­¦ä¼šäº†å¦‚ä½•åˆ¤æ–­è‡ªå®šä¹‰çš„é€‰é¡¹å¼€å…³ã€‚\næœ¬å®éªŒçš„å‚è€ƒä»£ç å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ä¸‹è½½ï¼š\nwget https://labfile.oss.aliyuncs.com/courses/2764/code7.zip\r ","id":60,"section":"categories","summary":"æ¡ä»¶åˆ¤æ–­ åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬ä¼šå­¦ä¹ åˆ° xmake æ¡ä»¶åˆ¤æ–­è¯­å¥çš„åŸºç¡€ç”¨æ³•ï¼Œä»¥åŠå¸¸ç”¨çš„å¹³å°ã€æ¶æ„ç­‰åˆ¤æ–­æ¥å£ï¼Œå¦å¤–è¿˜ä¼šå­¦ä¹ å¦‚ä½•åˆ¤æ–­è‡ªå®šä¹‰é€‰é¡¹çš„å€¼æ¥æ§åˆ¶ç¼–è¯‘ã€‚ çŸ¥","tags":["xmake"],"title":"å®éªŒ7æ¡ä»¶åˆ¤æ–­","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/app/xmake/%E8%93%9D%E6%A1%A5%E7%BD%91%E8%AF%BE/2xmake%E5%9F%BA%E7%A1%80/%E5%AE%9E%E9%AA%8C7%E6%9D%A1%E4%BB%B6%E5%88%A4%E6%96%AD/","year":"2021"},{"content":"å®éªŒ6ç›®æ ‡ä¾èµ– åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬ä¼šå­¦ä¹ åˆ°å¦‚ä½•æ§åˆ¶å¤šä¸ªç¨‹åºçš„ç¼–è¯‘é¡ºåºï¼Œå¦‚ä½•è®¾ç½®ä¾èµ–æ¥ç»§æ‰¿ç¼–è¯‘é…ç½®ï¼Œä»¥åŠåŠ¨æ€åº“å’Œé™æ€åº“çš„ç¼–è¯‘ä½¿ç”¨ã€‚\nçŸ¥è¯†ç‚¹  å¤šä¸ª C++ ç¨‹åºé—´çš„ç¼–è¯‘é¡ºåºæ§åˆ¶ ä¾èµ–ç¼–è¯‘çš„é…ç½®ç»§æ‰¿ åŠ¨æ€åº“ã€é™æ€åº“çš„ç¼–è¯‘å’Œä½¿ç”¨ Phony ç»„åˆå¤šä¸ªç¼–è¯‘ç›®æ ‡ç¨‹åº  å¤šç›®æ ‡ç¨‹åºçš„ä¾èµ–ç¼–è¯‘ åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œxmake åœ¨ç¼–è¯‘å¤šä¸ªç›®æ ‡ç¨‹åºæ—¶ï¼Œä¼šé€šè¿‡å¤šä»»åŠ¡å¹¶è¡Œç¼–è¯‘æ¥æå‡é¡¹ç›®çš„æ•´ä½“ç¼–è¯‘æ•ˆç‡ï¼Œä¸è¿‡æ¯ä¸ª target ç›®æ ‡ç¨‹åºå®é™…çš„ç¼–è¯‘é¡ºåºæ˜¯æœªå®šä¹‰çš„ã€‚\nç„¶è€Œæœ‰æ—¶å€™ï¼ŒæŸäº›é¡¹ç›®å·¥ç¨‹ä¸­çš„å¤šä¸ªç›®æ ‡ç¨‹åºä¹‹é—´æ˜¯æœ‰ä¾èµ–å…³ç³»çš„ï¼Œå¦‚æœä¸æ§åˆ¶ç¼–è¯‘é¡ºåºï¼Œé‚£ä¹ˆæœ‰å¯èƒ½ä¼šé”™è¯¯åœ°ä¼˜å…ˆç¼–è¯‘ä¸€äº›éœ€è¦æ»åçš„ç¨‹åºï¼Œå°±ä¼šå¯¼è‡´ç¼–è¯‘å‡ºé”™ã€‚\nè¿™ç§æƒ…å†µä¸‹é€šè¿‡ add_deps() é…ç½®æ¥å£å»æ§åˆ¶æŒ‡å®š target çš„ç¼–è¯‘ä¾èµ–é¡ºåºï¼Œå¯¹ä¸€äº›ä¾èµ–é™æ€åº“ã€åŠ¨æ€åº“çš„å¯æ‰§è¡Œç¨‹åºéå¸¸æœ‰ç”¨ã€‚\né“¾æ¥å’Œç¼–è¯‘çš„ä¾èµ–æ§åˆ¶ ä¸ºäº†äº†è§£å¦‚ä½•ä½¿ç”¨ add_deps æ¥æ§åˆ¶ç¼–è¯‘ä¾èµ–é¡ºåºï¼Œæˆ‘ä»¬å…ˆé‡æ–°åˆ›å»ºä¸ª deps_test çš„ç©ºå·¥ç¨‹ã€‚\ncd ~/Code\rxmake create deps_test\r ç„¶åä¿®æ”¹ deps_test/xmake.lua é…ç½®ã€‚\ntarget(\u0026quot;test1\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\radd_deps(\u0026quot;test2\u0026quot;)\rtarget(\u0026quot;test2\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\radd_deps(\u0026quot;test3\u0026quot;)\rtarget(\u0026quot;test3\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\r ä¸Šè¿°é…ç½®ï¼Œæˆ‘ä»¬ä½¿ç”¨ add_deps å°†ä¸‰ä¸ª target ç›®æ ‡ç¨‹åºçš„ä¾èµ–é¡ºåºè°ƒæ•´ä¸ºï¼štest1 ä¾èµ– test2ï¼Œ test2 ä¾èµ– test3ã€‚\né‚£ä¹ˆæ‰§è¡Œç¼–è¯‘çš„æ—¶å€™çš„ï¼Œtest3 ä¼šä¼˜å…ˆç¼–è¯‘ï¼Œç„¶åæ˜¯ç¼–è¯‘ test2ï¼Œæœ€åæ‰ç¼–è¯‘ test1ã€‚\næ‰§è¡Œ xmake æŸ¥çœ‹å®é™…çš„ç¼–è¯‘é¡ºåºã€‚\né€šè¿‡ä¸Šå›¾ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ€åä¸‰ä¸ªç¨‹åºçš„å®é™…é“¾æ¥é¡ºåºç¡®å®å·²ç»æŒ‰ç…§åˆšåˆšè®¾ç½®çš„ä¾èµ–é¡ºåºè¿›è¡Œæ‰§è¡Œäº†ï¼Œä¸è¿‡å…¶ C++ æºæ–‡ä»¶è¿˜æ˜¯åœ¨æœ€å¼€å§‹å°±æ‰§è¡Œç¼–è¯‘äº†ã€‚\nè¿™æ˜¯ç”±äº xmake è¦ä¼˜åŒ–ç¼–è¯‘é€Ÿåº¦ï¼Œåœ¨ç¼–è¯‘é“¾æ¥æ—¶å€™ï¼Œå‡å®šä¸€ä¸ªäº‹å®ï¼Œé‚£å°±æ˜¯æ‰€æœ‰ä¸åŒç›®æ ‡çš„ C/C++ æºæ–‡ä»¶ä¹‹é—´æ˜¯ä¸éœ€è¦ä¾èµ–é¡ºåºçš„ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥å…¨éƒ¨å¹¶è¡ŒåŒ–å¤„ç†ç¼–è¯‘ã€‚\nä»…ä»…åªæœ‰åœ¨é“¾æ¥é˜¶æ®µæ‰éœ€è¦å¤„ç†ä¾èµ–é¡ºåºï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥æœ€å¤§åŒ–çš„å°†å¤§é‡æºç çš„ç¼–è¯‘å…¨éƒ¨å¹¶è¡ŒåŒ–ï¼Œè€Œä¸æ˜¯ç¼–è¯‘é“¾æ¥å®Œæˆä¸€ä¸ª targetï¼Œå†å»å®é™…å¤„ç†ç¬¬äºŒä¸ª target ç¨‹åºçš„æºç ç¼–è¯‘å’Œé“¾æ¥ï¼Œè¿™ä¼šåœ¨æ¯ä¸ª target çš„é“¾æ¥é˜¶æ®µå¯¼è‡´ä¸€æ®µæ—¶é—´çš„ä¸²è¡ŒåŒ–å’Œåœæ»ï¼Œå‡æ…¢ç¼–è¯‘é€Ÿåº¦ã€‚\nç®€å•æ¥è¯´ï¼Œä¹Ÿå°±æ˜¯å³ä½¿è®¾ç½® add_depsï¼Œxmake é»˜è®¤ä¹Ÿä»…ä»…æ§åˆ¶é“¾æ¥çš„ä¾èµ–é¡ºåºï¼Œä¸æ§åˆ¶æºç ç¼–è¯‘çš„ä¾èµ–é¡ºåºã€‚\nä¸è¿‡ï¼Œä¸‡äº‹æ€»æœ‰ä¾‹å¤–ï¼Œå¦‚æœç¨‹åºç¡®å®è¿˜æ˜¯éœ€è¦æ¯ä¸ª target çš„æºç éƒ½è¦ä¸¥æ ¼æŒ‰ç…§ add_deps æŒ‡å®šçš„ä¾èµ–é¡ºåºå»æ§åˆ¶ç¼–è¯‘ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦è®¾ç½®ä¸‹ç¼–è¯‘ç­–ç•¥ï¼Œç¦ç”¨è·¨ç›®æ ‡å¹¶è¡Œç¼–è¯‘å³å¯ï¼Œä¾‹å¦‚ä¸‹é¢çš„é…ç½®ã€‚\nset_policy(\u0026quot;build.across_targets_in_parallel\u0026quot;, false)\rtarget(\u0026quot;test1\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\radd_deps(\u0026quot;test2\u0026quot;)\rtarget(\u0026quot;test2\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\radd_deps(\u0026quot;test3\u0026quot;)\rtarget(\u0026quot;test3\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\r æˆ‘ä»¬é€šè¿‡å…¨å±€è®¾ç½®ç¦ç”¨ build.across_targets_in_parallel ç­–ç•¥ï¼Œå°±å¯ä»¥å®Œå…¨ä¸²è¡ŒåŒ– target é—´çš„æºç ç¼–è¯‘é¡ºåºï¼Œä¸å†è·¨ç›®æ ‡å¹¶è¡Œç¼–è¯‘æºç ã€‚\nç”±äºå®é™…æºç å’Œé…ç½®æ²¡æœ‰å‘ç”Ÿæ”¹å˜ï¼Œé»˜è®¤çš„ xmake ç¼–è¯‘å‘½ä»¤ä¸ä¼šè§¦å‘é‡æ–°ç¼–è¯‘ï¼Œæ‰€ä»¥æˆ‘ä»¬é€šè¿‡æ‰§è¡Œ xmake -r å¼ºåˆ¶é‡æ–°ç¼–è¯‘ï¼Œæ¥ç›´è§‚æ„Ÿå—ä¸‹ç¦ç”¨è¿™ä¸ªç­–ç•¥åçš„æ•ˆæœã€‚\nå¯ä»¥å¯¹æ¯”ä¸‹ä¸Šå›¾çš„ç¼–è¯‘é¡ºåºè·Ÿä¹‹å‰çš„ç¼–è¯‘é¡ºåºï¼Œè¿˜æ˜¯æœ‰æ˜æ˜¾åŒºåˆ«çš„ï¼Œè¿™æ¬¡æˆ‘ä»¬ä¸ä»…é“¾æ¥é¡ºåºï¼Œç”šè‡³è¿æºç ä¹Ÿéƒ½ä¸¥æ ¼æŒ‰ç…§ test3ï¼Œtest2ï¼Œtest1 çš„é¡ºåºæ¥ç¼–è¯‘äº†ï¼Œtest1 çš„æºç å¿…é¡»è¦ç­‰å¾… test2 å®é™…å®Œæˆé“¾æ¥åæ‰ä¼šå»ç¼–è¯‘ã€‚\né™æ€åº“çš„ä¾èµ–ç¼–è¯‘å’Œç»§æ‰¿ äº†è§£äº†ä¾èµ–é¡ºåºçš„æ§åˆ¶åï¼Œæ¥ä¸‹æ¥å¼€å§‹é‡ç‚¹è®²è§£å¦‚ä½•å®ç°é™æ€åº“å’Œå¯æ‰§è¡Œç¨‹åºçš„ç»„åˆç¼–è¯‘ï¼Œé€šå¸¸æˆ‘ä»¬å¼€å‘ä¸€ä¸ªé™æ€åº“ç¨‹åºï¼Œéƒ½ä¼šåŒæ—¶å†™ä¸€ä¸ªå¯æ‰§è¡Œç¨‹åºå»é“¾æ¥å¹¶ä½¿ç”¨åº“é‡Œé¢çš„æ¥å£ã€‚\nè¿™ä¸ªæ—¶å€™ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨ add_links å’Œ add_linkdirs å»é“¾æ¥ä¾èµ–çš„é™æ€åº“å°±ä¼šæ¯”è¾ƒç¹çï¼Œæ—¢ç„¶è¿™ä¸¤è€…ä¹‹é—´åŸæœ¬å°±æ˜¯æœ‰ä¾èµ–å…³ç³»çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åœ¨é…ç½® add_deps åï¼Œé€šè¿‡å¯æ‰§è¡Œç¨‹åºå»è‡ªåŠ¨é›†æˆå¯¹åº”çš„é™æ€åº“çš„é“¾æ¥ä¿¡æ¯æ¥ç®€åŒ–é…ç½®ã€‚\næ•´ä¸ªç®€åŒ–æµç¨‹å¤§æ¦‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œé€šè¿‡é…ç½® add_deps å¯ä»¥é›†æˆä¾èµ–çš„é™æ€åº“ç›®æ ‡ç¨‹åºä¸­çš„å¤§éƒ¨åˆ†é“¾æ¥ä¿¡æ¯ï¼Œå› æ­¤ä»…ä»…åªéœ€è¦é€šè¿‡å…³è”ä¾èµ–ï¼Œå°±èƒ½å¤Ÿè‡ªåŠ¨é›†æˆå’Œä½¿ç”¨é™æ€åº“ã€‚\næˆ‘ä»¬å¯ä»¥é€šè¿‡ xmake æä¾›çš„æ¨¡æ¿å·¥ç¨‹åˆ›å»ºä¸€ä¸ªå¸¦æœ‰é™æ€åº“çš„ç©ºå·¥ç¨‹ï¼Œé‡Œé¢é»˜è®¤å°±æä¾›äº†ä¸¤ä¸ª target ç›®æ ‡ç¨‹åºï¼Œä¸€ä¸ªé™æ€åº“å’Œä¸€ä¸ªå¯æ‰§è¡Œç¨‹åºã€‚\ncd Code\rxmake create -t static foo\r foo/xmake.lua é…ç½®å†…å®¹å¦‚ä¸‹ã€‚\ntarget(\u0026quot;foo\u0026quot;)\rset_kind(\u0026quot;static\u0026quot;)\radd_files(\u0026quot;src/interface.cpp\u0026quot;)\rtarget(\u0026quot;foo_demo\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_deps(\u0026quot;foo\u0026quot;)\radd_files(\u0026quot;src/main.cpp\u0026quot;)\r å…¶ä¸­ foo å°±æ˜¯é™æ€åº“ç›®æ ‡ç¨‹åºï¼Œè€Œ foo_demo æ˜¯å¯æ‰§è¡Œç›®æ ‡ç¨‹åºï¼Œå®ƒä»¬ä¹‹é—´é€šè¿‡ add_deps(\u0026quot;foo\u0026quot;) è¿›è¡Œä¾èµ–å…³è”ï¼Œä½¿å¾— foo_demo å¯ä»¥è‡ªåŠ¨é›†æˆ foo é™æ€åº“ï¼Œè€Œä¸å†éœ€è¦é¢å¤–æ·»åŠ  add_linkdirsã€add_links ç­‰é…ç½®ä¿¡æ¯ã€‚\nä¾èµ–é…ç½®çš„å¯è§æ€§è®¾ç½® add_deps é™¤äº†èƒ½å¤Ÿè‡ªåŠ¨ç»§æ‰¿é™æ€åº“ä¾èµ–çš„é“¾æ¥ä¿¡æ¯ï¼Œè¿˜å¯ä»¥ç»§æ‰¿ä¸€äº›å…¶å®ƒçš„é…ç½®ä¿¡æ¯ï¼Œæ¯”å¦‚ï¼šadd_includedirsã€add_defines ç­‰å¤§éƒ¨åˆ†é…ç½®éƒ½æ˜¯å¯ä»¥è¢«ç»§æ‰¿çš„ã€‚\nä¸è¿‡åªæœ‰è¿™äº›é…ç½®è¢«è®¾ç½®äº† publicã€interface ç­‰å¯¹å¤–å¯è§æ€§è®¾ç½®ï¼Œæ‰èƒ½å¤Ÿæ”¯æŒå¯¹å…¶å®ƒ target å¯¼å‡ºé…ç½®è¢«ç»§æ‰¿ã€‚\næ¯”å¦‚æˆ‘ä»¬å°† foo/xmake.lua æ”¹ä¸ºä¸‹é¢çš„é…ç½®ï¼Œæ¥è¿›ä¸€æ­¥å¯¼å‡º foo åº“çš„ä¸€äº›å¤´æ–‡ä»¶æœç´¢è·¯å¾„å’Œå®å®šä¹‰ã€‚\ntarget(\u0026quot;foo\u0026quot;)\rset_kind(\u0026quot;static\u0026quot;)\radd_files(\u0026quot;src/interface.cpp\u0026quot;)\radd_defines(\u0026quot;TEST\u0026quot;, {public = true})\radd_includedirs(\u0026quot;src\u0026quot;, {interface = true})\rtarget(\u0026quot;foo_demo\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_deps(\u0026quot;foo\u0026quot;)\radd_files(\u0026quot;src/main.cpp\u0026quot;)\r é€šè¿‡è®¾ç½® {public = true} å°† -DTEST çš„å®å®šä¹‰è®¾ç½®å…¬å¼€ç»™å…¶å®ƒä¾èµ–çš„å­ target ç»§æ‰¿ï¼Œå¹¶ä¸” foo è‡ªèº«ä¹Ÿä¼šè¢«å®šä¹‰ã€‚\nè€Œ add_includedirs(\u0026quot;src\u0026quot;, {interface = true}) ä¼šæŠŠ src ä½œä¸ºå¤´æ–‡ä»¶æœç´¢ç›®å½•ï¼Œä»¥æ¥å£çš„æ–¹å¼ä»…ä»…å¼€æ”¾ç»™å…¶å®ƒ target ç»§æ‰¿ï¼Œè€Œ foo è‡ªèº«ä¸ä¼šå»è®¾ç½®å®ƒã€‚\nå…³äºå¯è§æ€§ï¼Œxmake ä¸»è¦æä¾›ä¸‹é¢ä¸‰ç§ï¼Œé»˜è®¤æƒ…å†µä¸‹çš„é…ç½®éƒ½æ˜¯ç§æœ‰çš„ï¼Œä¸å¯¹å¤–å¯è§çš„ã€‚\n   å±æ€§ æè¿°     private é»˜è®¤è®¾ç½®ï¼Œä½œä¸ºå½“å‰ target çš„ç§æœ‰é…ç½®ï¼Œä¸ä¼šè¢«ä¾èµ–çš„å…¶å®ƒ target æ‰€ç»§æ‰¿   public å…¬æœ‰é…ç½®ï¼Œå½“å‰ target ä¾èµ–çš„å­ target éƒ½ä¼šè¢«è®¾ç½®   interface æ¥å£è®¾ç½®ï¼Œä»…è¢«ä¾èµ–çš„å­ target æ‰€ç»§æ‰¿è®¾ç½®ï¼Œå½“å‰ target ä¸å‚ä¸    æ‰§è¡Œ xmake -rv å‘½ä»¤ç¼–è¯‘è¾“å‡ºæŸ¥çœ‹å®é™…çš„ç»§æ‰¿æ•ˆæœï¼Œå…¶ä¸­ -DTEST åº”è¯¥ä¼šåŒæ—¶è®¾ç½®åˆ° foo å’Œ foo_demo çš„æ‰€æœ‰æºæ–‡ä»¶ç¼–è¯‘ï¼Œè€Œ -Isrc ä¼šä»…ä»…è¢«è®¾ç½®åˆ° foo_demo çš„æºæ–‡ä»¶ç¼–è¯‘ã€‚\nçº§è”ä¾èµ–ç»§æ‰¿ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å†æ¥å°è¯•ä¸‹æ›´åŠ å¤æ‚çš„åœºæ™¯ï¼Œå°†ä¾èµ–ç»§æ‰¿çš„å±‚çº§åŠ æ·±ä¸€å±‚ï¼Œfoo_demo ä¾èµ– foo é™æ€åº“ï¼Œè€Œ foo ä¾èµ– bar é™æ€åº“ï¼Œå¹¶ä¸”æˆ‘ä»¬æŠŠé¢å¤–çš„ public å¯¼å‡ºé…ç½®æ”¾ç½®åˆ° bar ç›®æ ‡ç¨‹åºä¸­ï¼Œæ¯”å¦‚ä¸‹é¢è¿™æ ·ã€‚\ntarget(\u0026quot;bar\u0026quot;)\rset_kind(\u0026quot;static\u0026quot;)\radd_files(\u0026quot;src/interface.cpp\u0026quot;)\radd_defines(\u0026quot;TEST\u0026quot;, {public = true})\radd_includedirs(\u0026quot;src\u0026quot;, {interface = true})\rtarget(\u0026quot;foo\u0026quot;)\rset_kind(\u0026quot;static\u0026quot;)\radd_files(\u0026quot;src/interface.cpp\u0026quot;)\radd_deps(\u0026quot;bar\u0026quot;)\rtarget(\u0026quot;foo_demo\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_deps(\u0026quot;foo\u0026quot;)\radd_files(\u0026quot;src/main.cpp\u0026quot;)\r è¿™ä¸ªæ—¶å€™ï¼Œxmake åœ¨ç¼–è¯‘æœ€ç»ˆçš„ foo_demo æ—¶å€™ï¼Œä¹Ÿä¼šè‡ªåŠ¨ç»§æ‰¿ foo å’Œ bar é‡Œé¢çš„é™æ€åº“ä¿¡æ¯ï¼Œå¹¶ä¸”ç»§æ‰¿ä¸Š public å’Œ interface çš„å¯¼å‡ºé…ç½®ï¼Œä¹Ÿå°±æ˜¯è¯´ add_deps çš„ç»§æ‰¿æ˜¯å®Œå…¨æ”¯æŒçº§è”ä¾èµ–çš„ï¼Œå®é™…æ•ˆæœè§ä¸‹å›¾ã€‚\nåŠ¨æ€åº“çš„ä¾èµ–ç¼–è¯‘ é™¤äº†é™æ€åº“ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ä¾èµ–ç»§æ‰¿çš„æ–¹å¼å°†åŠ¨æ€åº“å’Œå¯æ‰§è¡Œç¨‹åºè¿›è¡Œå…³è”ï¼Œåªéœ€è¦æŠŠä¹‹å‰çš„ xmake.lua é‡Œé¢çš„ foo ç›®æ ‡ç±»å‹æ”¹æˆ sharedï¼Œå°±èƒ½ç¼–è¯‘ç”ŸæˆåŠ¨æ€åº“ï¼Œå¹¶ä¸”è‡ªåŠ¨å…³è”ä¸Šå¯æ‰§è¡Œç¨‹åºã€‚\næˆ‘ä»¬æ”¹æˆä¸‹é¢çš„é…ç½®ã€‚\ntarget(\u0026quot;foo\u0026quot;)\rset_kind(\u0026quot;shared\u0026quot;)\radd_files(\u0026quot;src/interface.cpp\u0026quot;)\radd_defines(\u0026quot;TEST\u0026quot;, {public = true})\radd_includedirs(\u0026quot;src\u0026quot;, {interface = true})\rtarget(\u0026quot;foo_demo\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_deps(\u0026quot;foo\u0026quot;)\radd_files(\u0026quot;src/main.cpp\u0026quot;)\r ç„¶åæ‰§è¡Œç¼–è¯‘è¿è¡Œã€‚\nxmake\rxmake run\r xmake ä¼šç”Ÿæˆä¸€ä¸ª libfoo.so åŠ¨æ€åº“ç¨‹åºï¼Œç„¶å foo_demo ä¼šè‡ªåŠ¨é“¾æ¥ä¸Šè¿™ä¸ª so åº“ï¼Œç„¶åè¿è¡Œçš„æ—¶å€™ï¼Œä¹Ÿèƒ½å¤Ÿè‡ªåŠ¨åŠ è½½ä¸Šå®ƒã€‚\nè‡³äºä¸ºä»€ä¹ˆèƒ½å¤Ÿè‡ªåŠ¨åŠ è½½ä¸Šç¼–è¯‘ç”Ÿæˆçš„ so åº“ï¼Œé‚£æ˜¯å› ä¸ºé€šè¿‡ add_deps(\u0026quot;foo\u0026quot;) é…ç½®çš„ä¾èµ–ç»§æ‰¿å…³ç³»ï¼Œåœ¨ foo_demo é“¾æ¥çš„æ—¶å€™ï¼Œé™¤äº†è‡ªåŠ¨åŠ äº† -Lxx -lfoo ç­‰é“¾æ¥ä¿¡æ¯å¤–ï¼Œè¿˜é¢å¤–è¿½åŠ äº† rpath ä¿¡æ¯ç”¨æ¥è®¾ç½®åŠ¨æ€åº“çš„åŠ è½½è·¯å¾„ä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯ä¸‹å›¾çº¢æ¡†ä¸­çš„ -Wl,-rpath=$ORIGINã€‚\nè¿™ä¸ªé“¾æ¥é€‰é¡¹çš„æ„æ€å°±æ˜¯é…ç½®å¯æ‰§è¡Œç¨‹åºè¿è¡Œæ—¶ï¼Œå¯ä»¥æœç´¢å½“å‰è¿è¡Œç›®å½•ä¸‹çš„æ‰€æœ‰ä¾èµ–çš„ so åº“ï¼Œå¦‚æœå­˜åœ¨å°±å¯ä»¥æ­£å¸¸åŠ è½½è¿™äº› so åº“ã€‚\nå¦å¤–ï¼Œä»ä¸Šå›¾ä¸­æˆ‘ä»¬çœ‹åˆ° -DTEST -Isrc ç­‰ public å¯¼å‡ºé…ç½®ä¹ŸåŒæ ·è¢«ç»§æ‰¿äº†è¿›æ¥ã€‚\nä½¿ç”¨ Phony ç›®æ ‡ç»„åˆå¤šä¸ªä¾èµ–ç¨‹åº åœ¨ä¹‹å‰çš„å®éªŒä¸­æˆ‘ä»¬è®²åˆ° target çš„åŸºç¡€ç›®æ ‡ç±»å‹ï¼Œé™¤äº† binaryã€static å’Œ shared ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªç‰¹æ®Šçš„ç›®æ ‡ç±»å‹ phonyï¼Œå®ƒç”¨äºè®¾ç½®ç»™å®š target ä½œä¸ºä¸€ä¸ªç©ºçš„ç›®æ ‡å¯¹è±¡ï¼Œå¹¶ä¸ä¼šå‚ä¸å®é™…çš„æºç ç¼–è¯‘ã€‚\nè™½ç„¶ä¸ä¼šå‚ä¸å®é™…ç¼–è¯‘ï¼Œä½†æ˜¯å®ƒå¯ä»¥å’Œ add_deps é…åˆä½¿ç”¨ï¼Œç”¨æ¥ç»„åˆä¸€äº›éœ€è¦ä¸€èµ·ç¼–è¯‘çš„å‡ ä¸ª targetï¼Œå®ç°ä¸€ç»„ target ç›®æ ‡åŒæ—¶ç¼–è¯‘ã€‚\næˆ‘ä»¬å†æ¥ç»§ç»­ä¿®æ”¹ xmake.luaï¼Œå°† group ç›®æ ‡è®¾ç½®æˆ phony ç›®æ ‡ç±»å‹ï¼Œæœ¬èº«ä¸å‚ä¸ç¼–è¯‘ï¼Œä½†æ˜¯é€šè¿‡ add_deps(\u0026quot;foo\u0026quot;, \u0026quot;bar\u0026quot;) å…³è”ä¸Š foo å’Œ bar è¿™ä¸¤ä¸ªç›®æ ‡ç¨‹åºï¼Œç›¸å½“äºå°†å®ƒä»¬ç»„åˆåˆ°ä¸€èµ·åŒæ—¶è¢« group ç›®æ ‡ä¾èµ–ï¼Œä¾‹å¦‚ã€‚\ntarget(\u0026quot;foo\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\rtarget(\u0026quot;bar\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\rtarget(\u0026quot;baz\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\rtarget(\u0026quot;group\u0026quot;)\rset_kind(\u0026quot;phony\u0026quot;)\radd_deps(\u0026quot;foo\u0026quot;, \u0026quot;bar\u0026quot;)\r å› æ­¤ï¼Œæˆ‘ä»¬åªéœ€è¦æ‰§è¡Œ xmake build group æŒ‡å®šç¼–è¯‘ group ç›®æ ‡ï¼Œå°±ä¼šè§¦å‘ foo å’Œ bar è¿™ä¸¤ä¸ªç¨‹åºçš„ç¼–è¯‘ï¼Œè€Œ bar ç›®æ ‡ç”±äºæ²¡æœ‰è¢«ä¾èµ–ï¼Œæ‰€ä»¥å°±ä¸ä¼šè¢«ç¼–è¯‘ã€‚\nç¼–è¯‘åçš„å®é™…ç»“æœå¦‚ä¸‹å›¾ã€‚\nå®éªŒæ€»ç»“ åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬ä¸»è¦å­¦ä¹ äº†å¦‚ä½•å»è®¾ç½®ä¾èµ–ç¼–è¯‘æ¥æ§åˆ¶å¤šä¸ªç›®æ ‡ç¨‹åºçš„ç¼–è¯‘é¡ºåºï¼Œä¹Ÿå­¦ä¼šäº†å¦‚ä½•å»ç»§æ‰¿å…¶å®ƒç›®æ ‡ç¨‹åºå¯¼å‡ºçš„é…ç½®ä»¥åŠå¦‚ä½•å»ç¼–è¯‘ä½¿ç”¨åŠ¨æ€åº“ã€é™æ€åº“ç¨‹åºã€‚\næœ¬å®éªŒçš„å‚è€ƒä»£ç å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ä¸‹è½½ï¼š\nwget https://labfile.oss.aliyuncs.com/courses/2764/code6.zip\r ","id":61,"section":"categories","summary":"å®éªŒ6ç›®æ ‡ä¾èµ– åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬ä¼šå­¦ä¹ åˆ°å¦‚ä½•æ§åˆ¶å¤šä¸ªç¨‹åºçš„ç¼–è¯‘é¡ºåºï¼Œå¦‚ä½•è®¾ç½®ä¾èµ–æ¥ç»§æ‰¿ç¼–è¯‘é…ç½®ï¼Œä»¥åŠåŠ¨æ€åº“å’Œé™æ€åº“çš„ç¼–è¯‘ä½¿ç”¨ã€‚ çŸ¥è¯†ç‚¹ å¤šä¸ª C++ ç¨‹","tags":["xmake"],"title":"å®éªŒ6ç›®æ ‡ä¾èµ–","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/app/xmake/%E8%93%9D%E6%A1%A5%E7%BD%91%E8%AF%BE/2xmake%E5%9F%BA%E7%A1%80/%E5%AE%9E%E9%AA%8C6%E7%9B%AE%E6%A0%87%E4%BE%9D%E8%B5%96/","year":"2021"},{"content":"é…ç½®è¯­æ³•ç®€ä»‹ åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å¤§æ¦‚äº†è§£ xmake.lua çš„è¯­æ³•è®¾è®¡ç†å¿µï¼Œä»¥åŠä¸€äº›åŸºæœ¬é…ç½®çš„å†™æ³•ï¼Œé€šè¿‡æœ¬èŠ‚å®éªŒï¼ŒåŸºæœ¬ä¸Šèƒ½æŒæ¡å¦‚ä½•å»ç¼–å†™åˆç†çš„ xmake.lua é…ç½®æ¥ç®€åŒ–å·¥ç¨‹é…ç½®ã€‚\nçŸ¥è¯†ç‚¹  xmake.lua çš„é…ç½®è¯­æ³•å’Œè®¾è®¡ç†å¿µ æè¿°åŸŸå’Œè„šæœ¬åŸŸé…ç½®çš„åŸºæœ¬æ¦‚å¿µ å¤šç›®æ ‡ç¨‹åºçš„ç¼–è¯‘é…ç½® å…¨å±€é…ç½®ä½œç”¨åŸŸçš„æ¦‚å¿µ  é…ç½®è¯­æ³•ç®€ä»‹ xmake çš„å·¥ç¨‹æè¿°æ–‡ä»¶ xmake.lua è™½ç„¶åŸºäº lua è¯­æ³•ï¼Œä½†æ˜¯ä¸ºäº†ä½¿å¾—æ›´åŠ æ–¹ä¾¿ç®€æ´å¾—ç¼–å†™é¡¹ç›®æ„å»ºé€»è¾‘ï¼Œxmake å¯¹å…¶è¿›è¡Œäº†ä¸€å±‚å°è£…ï¼Œä½¿å¾—ç¼–å†™ xmake.lua ä¸ä¼šåƒç¼–å†™ makefile é‚£æ ·ç¹çï¼Œç”šè‡³æ¯” cmake çš„ CMakelists.txt çš„ DSL è¯­æ³•è¿˜æ›´åŠ çš„ç®€æ´ç›´è§‚ï¼Œå­¦ä¹ æˆæœ¬æ›´ä½ã€‚\nåŸºæœ¬ä¸Šå†™ä¸ªç®€å•çš„å·¥ç¨‹æ„å»ºæè¿°ï¼Œåªéœ€ä¸‰è¡Œå°±èƒ½å®Œæ•´æ„å»ºä¸€ä¸ª C/C++ å·¥ç¨‹ï¼Œä¾‹å¦‚ã€‚\ntarget(\u0026quot;test\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.c\u0026quot;)\r é…ç½®åˆ†ç¦» xmake.lua é‡‡ç”¨äºŒå…«åŸåˆ™å®ç°äº†æè¿°åŸŸã€è„šæœ¬åŸŸä¸¤å±‚åˆ†ç¦»å¼é…ç½®ã€‚\nä»€ä¹ˆæ˜¯äºŒå…«åŸåˆ™å‘¢ï¼Œç®€å•æ¥è¯´ï¼Œå¤§éƒ¨åˆ†é¡¹ç›®çš„é…ç½®ï¼Œ80% çš„æƒ…å†µä¸‹ï¼Œéƒ½æ˜¯äº›åŸºç¡€çš„å¸¸è§„é…ç½®ï¼Œæ¯”å¦‚ï¼šadd_cxflagsã€add_links ç­‰ï¼Œåªæœ‰å‰©ä¸‹ä¸åˆ° 20% çš„åœ°æ–¹æ‰éœ€è¦é¢å¤–ç¼–å†™ä¸€äº›å¤æ‚çš„é€»è¾‘è„šæœ¬æ¥æ»¡è¶³ä¸€äº›ç‰¹æ®Šçš„é…ç½®éœ€æ±‚ã€‚\nè€Œè¿™å‰©ä½™çš„ 20% é…ç½®é€šå¸¸æ¯”è¾ƒå¤æ‚ï¼Œå¦‚æœç›´æ¥å……æ–¥åœ¨æ•´ä¸ª xmake.lua é‡Œé¢ï¼Œä¼šæŠŠæ•´ä¸ªé¡¹ç›®çš„é…ç½®å¼„çš„å¾ˆæ··ä¹±ï¼Œä¸å…·æœ‰è‰¯å¥½çš„å¯è¯»æ€§ã€‚\nå› æ­¤ï¼Œxmake é€šè¿‡æè¿°åŸŸã€è„šæœ¬åŸŸä¸¤ç§ä¸åŒçš„é…ç½®æ–¹å¼ï¼Œæ¥éš”ç¦» 80% çš„ç®€å•é…ç½®ä»¥åŠ 20% çš„å¤æ‚é…ç½®ï¼Œä½¿å¾—æ•´ä¸ª xmake.lua çœ‹èµ·æ¥éå¸¸çš„æ¸…æ™°ç›´è§‚ï¼Œå¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§éƒ½è¾¾åˆ°æœ€ä½³ã€‚\næˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹å›¾å¤§è‡´äº†è§£å“ªäº›é…ç½®åŒºåŸŸæ˜¯æè¿°åŸŸé…ç½®ï¼Œå“ªäº›æ˜¯è„šæœ¬åŸŸã€‚\nä¹Ÿå¯ä»¥é€šè¿‡ä¸‹é¢æè¿°çš„ç‰¹å¾æ¥å¿«é€ŸåŒºåˆ†ï¼š\n æè¿°åŸŸï¼šä½¿ç”¨ set_xxã€add_xxx ç­‰é…ç½®æ¥å£è¿›è¡Œçš„é…ç½®åŒºåŸŸã€‚ è„šæœ¬åŸŸï¼šä½¿ç”¨ on_xxã€after_xxx å’Œ before_xxx ç­‰é…ç½®æ¥å£çš„å†…éƒ¨åŒºåŸŸã€‚  æè¿°é…ç½®åŸŸ å¯¹äºåˆšå…¥é—¨çš„æ–°æ‰‹ï¼Œæˆ–è€…ä»…ä»…æ˜¯ç»´æŠ¤ä¸€äº›ç®€å•çš„å°é¡¹ç›®ï¼Œåªä½¿ç”¨æè¿°é…ç½®å°±å·²ç»å¯ä»¥å®Œå…¨æ»¡è¶³éœ€æ±‚äº†ï¼Œä¾‹å¦‚ä¸‹é¢çš„é…ç½®ã€‚\ntarget(\u0026quot;hello\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;*.c\u0026quot;)\radd_defines(\u0026quot;DEBUG\u0026quot;)\radd_syslinks(\u0026quot;pthread\u0026quot;)\r ä¸€çœ¼æœ›å»ï¼Œå…¶å®å°±æ˜¯ä¸ª set_xxx å’Œ add_xxx çš„é…ç½®é›†ï¼Œè€Œ target(\u0026quot;test\u0026quot;) ç”¨æ¥å®šä¹‰ç›®æ ‡ç¨‹åºï¼Œæ‰€æœ‰çš„é…ç½®éƒ½ä¼šå¯¹å½“å‰å®šä¹‰çš„ target ç›®æ ‡ç”Ÿæ•ˆã€‚\nå¯¹äºæ–°æ‰‹ï¼Œè¿™æ ·çš„é…ç½®ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥ä¸æŠŠå®ƒå½“åš lua è„šæœ¬ï¼Œä»…ä»…ä½œä¸ºæ™®é€šçš„ï¼Œä½†æœ‰ä¸€äº›åŸºç¡€è§„åˆ™çš„é…ç½®æ–‡ä»¶å°±è¡Œäº†ï¼Œæ‰€ä»¥å³å¤§å®¶å®Œå…¨æ²¡å­¦è¿‡ lua ä¹Ÿæ˜¯æ²¡æœ‰å…³ç³»çš„ã€‚\nè¿™å›æˆ‘ä»¬ä¸é€šè¿‡æ¨¡æ¿å·¥ç¨‹ï¼Œç›´æ¥æ‰‹å·¥åˆ›å»ºä¸€ä¸ªç©ºé¡¹ç›®æ¥å®éªŒæè¿°åŸŸé…ç½®ã€‚é¦–å…ˆæ–°å»ºä¸€ä¸ªç©ºç›®å½•ï¼Œç„¶åå†™ä¸ªè¾“å‡ºæŒ‡å®šå­—ç¬¦ä¸²çš„ C ä¾‹å­ä»£ç ï¼ˆå¦‚æœä¹‹å‰å·²ç»å­˜åœ¨ hello ç›®å½•ï¼Œå¯ä»¥å…ˆæ‰§è¡Œ rm -rf hello åˆ é™¤å®ƒï¼‰ã€‚\ncd Code\rmkdir hello\rcd hello \u0026amp;\u0026amp; vim main.c\r ç„¶åç¼–è¾‘ main.c ç¼–å†™å¦‚ä¸‹ä»£ç ã€‚\n#include \u0026lt;stdio.h\u0026gt;\rint main(int argc, char** argv)\r{\rprintf(\u0026quot;hello %s\\n\u0026quot;, WORD);\rreturn 0;\r}\r C ä»£ç å†™å¥½åï¼Œåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ‰§è¡Œ vim xmake.lua å¼€å§‹å†™é…ç½®æ–‡ä»¶ï¼Œæˆ‘ä»¬è¿™é‡Œä»…ä»…ä½¿ç”¨æè¿°åŸŸé…ç½®ã€‚\ntarget(\u0026quot;hello\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;*.c\u0026quot;)\radd_defines(\u0026quot;WORD=\\\u0026quot;foo\\\u0026quot;\u0026quot;)\r æ‰€æœ‰çš„é…ç½®éƒ½ä¼šå¯¹ target(\u0026quot;hello\u0026quot;) å®šä¹‰çš„ hello ç›®æ ‡ç¨‹åºç”Ÿæ•ˆï¼Œè¿™é‡Œä»…ä»…æ·»åŠ äº†ä¸€ä¸ª -DWORD=\u0026quot;foo\u0026quot; çš„å®å®šä¹‰ã€‚\næœ€åï¼Œæˆ‘ä»¬æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ç¼–è¯‘è¿è¡Œç¨‹åºã€‚\nxmake\rxmake run\r å¦‚æœæ­£å¸¸çœ‹åˆ° hello foo çš„è¾“å‡ºï¼Œè¯´æ˜æ·»åŠ çš„å®å®šä¹‰é…ç½®ç¡®å®æ­£å¸¸ç”Ÿæ•ˆäº†ã€‚\næè¿°åŸŸè™½ç„¶æ”¯æŒ lua çš„è„šæœ¬è¯­æ³•ï¼Œä½†åœ¨æè¿°åŸŸå°½é‡ä¸è¦å†™å¤ªå¤æ‚çš„ lua è„šæœ¬ï¼Œæ¯”å¦‚ä¸€äº›è€—æ—¶çš„å‡½æ•°è°ƒç”¨å’Œ for å¾ªç¯ï¼Œå› ä¸ºæè¿°åŸŸç›®çš„ä¸»è¦æ˜¯ä¸ºäº†ç®€åŒ–è®¾ç½®é…ç½®é¡¹ã€‚\nè„šæœ¬é…ç½®åŸŸ å¦‚æœå¤§å®¶å·²ç»å®Œå…¨ç†Ÿæ‚‰äº† xmake çš„æè¿°åŸŸé…ç½®ï¼Œå¹¶ä¸”æ„Ÿè§‰æœ‰äº›æ»¡è¶³ä¸äº†é¡¹ç›®ä¸Šçš„ä¸€äº›ç‰¹æ®Šé…ç½®ç»´æŠ¤ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åœ¨è„šæœ¬åŸŸåšæ›´åŠ å¤æ‚çš„é…ç½®é€»è¾‘ã€‚\nåªè¦æ˜¯ç±»ä¼¼ï¼šon_xxxã€after_xxx å’Œ before_xxx ç­‰å­—æ ·çš„é…ç½®æ¥å£å†…éƒ¨çš„è„šæœ¬ï¼Œéƒ½æ˜¯å±äºè„šæœ¬åŸŸã€‚\nç»§ç»­ä¿®æ”¹ hello/xmake.lua é…ç½®ï¼Œåœ¨ç¼–è¯‘å®Œæˆåè¾“å‡ºç›®æ ‡ç¨‹åºçš„å®é™…å­˜å‚¨è·¯å¾„ï¼Œé…ç½®ä¿®æ”¹å¦‚ä¸‹ã€‚\ntarget(\u0026quot;hello\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;*.c\u0026quot;)\radd_defines(\u0026quot;WORD=\\\u0026quot;foo\\\u0026quot;\u0026quot;)\rafter_build(function (target)\rprint(\u0026quot;my path: %s\u0026quot;, target:targetfile())\rend)\r ä¸Šé¢çš„é…ç½®ä¸­ï¼Œafter_build() å®šä¹‰çš„å†…éƒ¨ä»£ç åŒºåŸŸå°±æ˜¯è„šæœ¬é…ç½®åŸŸï¼Œå¯ä»¥åœ¨é‡Œé¢å†™å„ç§å¤æ‚çš„ lua è„šæœ¬æ¥å®ç°æ›´çµæ´»çš„é…ç½®éœ€æ±‚ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä»…ä»…é€šè¿‡ print å†…ç½®æ¥å£å»æ‰“å°è¾“å‡º target:targetfile() çš„å†…å®¹ï¼Œä¹Ÿå°±æ˜¯ç›®æ ‡ç¨‹åºçš„å®é™…è¾“å‡ºè·¯å¾„ã€‚\næ‰§è¡Œ xmake ç¼–è¯‘ç»“æŸï¼Œä¼šåœ¨ç¼–è¯‘æœ€åé¢è¾“å‡ºé…ç½®ä¿¡æ¯ï¼Œä¾‹å¦‚ä¸‹å›¾çš„çº¢æ¡†éƒ¨åˆ†ã€‚\nxmake è¿˜å¯¹æ¯ä¸ª target æä¾›äº† on_load é˜¶æ®µï¼Œæ¯ä¸ªç›®æ ‡ç¨‹åºçš„é…ç½®éƒ½ä¼šåŠ è½½è¿™é‡Œé¢çš„è„šæœ¬ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸ªè„šæœ¬åŸŸä¸­ï¼Œå®ç°æ›´åŠ çµæ´»å¤æ‚çš„åŸºç¡€é…ç½®è„šæœ¬ã€‚\nä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä¹‹å‰åœ¨æè¿°åŸŸä¸­å®šä¹‰çš„å®å®šä¹‰æ”¾ç½®åœ¨ on_load é‡Œé¢å»åŠ¨æ€é…ç½®ã€‚\ntarget(\u0026quot;hello\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;*.c\u0026quot;)\ron_load(function (target)\rtarget:add(\u0026quot;defines\u0026quot;, \u0026quot;WORD=\\\u0026quot;foo\\\u0026quot;\u0026quot;)\rend)\r ä¸Šé¢çš„é…ç½®è·Ÿä¹‹å‰åœ¨æè¿°åŸŸçš„é…ç½®å®Œå…¨ç­‰ä»·ï¼Œä»»ä½• set_xxxã€add_xxx ç­‰æè¿°åŸŸæ¥å£ï¼Œåœ¨è„šæœ¬åŸŸä¸­éƒ½å¯ä»¥é€šè¿‡ target é‡Œé¢çš„ target:set(\u0026quot;xxx\u0026quot;, ...) å’Œ target:add(\u0026quot;xxx\u0026quot;, ...) æ¨¡å—æ¥å£ï¼Œæ›´åŠ çµæ´»çš„è°ƒç”¨å’Œé…ç½®ã€‚\næˆ‘ä»¬å¯ä»¥å†æ‰§è¡Œ xmake -rv è¿›è¡Œç¼–è¯‘ï¼ŒæŸ¥çœ‹ç¼–è¯‘è¾“å‡ºï¼Œ-DWORD=\\\u0026quot;foo\\\u0026quot; ä¹Ÿè¢«ä¼ å…¥çš„ gcc ç¼–è¯‘å™¨ï¼Œè¯´æ˜åŠ¨æ€çš„åœ¨è„šæœ¬åŸŸè®¾ç½®å®å®šä¹‰ä¹Ÿç”Ÿæ•ˆäº†ã€‚\nåˆ†ç¦»è„šæœ¬åŸŸé…ç½®è„šæœ¬ å¯¹äºä¸€äº›ç®€çŸ­çš„é…ç½®è„šæœ¬ï¼Œåƒä¸Šé¢è¿™æ ·å†…ç½®å†™å°±è¶³å¤Ÿäº†ï¼Œå¦‚æœéœ€è¦å®ç°æ›´åŠ å¤æ‚çš„è„šæœ¬é…ç½®é€»è¾‘ï¼Œé‚£ä¹ˆè·Ÿæè¿°åŸŸé…ç½®å……æ–¥åœ¨ä¸€ä¸ª xmake.lua é‡Œé¢ï¼Œå°±ä¼šæ˜¾å¾—å¾ˆè‡ƒè‚¿ã€‚è¿™ä¸ªæ—¶å€™å¯ä»¥æŠŠè„šæœ¬åŸŸçš„é…ç½®åˆ†ç¦»åˆ°ç‹¬ç«‹çš„ lua æ–‡ä»¶ä¸­å»ç»´æŠ¤ï¼Œè¿™ä¹Ÿæ˜¯æè¿°åŸŸå’Œè„šæœ¬åŸŸè®¾è®¡çš„åˆè¡·ï¼Œå¯ä»¥æŠŠå¤æ‚çš„é€»è¾‘ç‹¬ç«‹å‡ºæ¥å•ç‹¬ç»´æŠ¤ã€‚\nè¿™é‡Œè¿˜æ˜¯ä»¥åˆšæ‰çš„é…ç½®ä¸ºä¾‹ï¼Œç¨å¾®åšä¸€äº›ä¿®æ”¹ï¼ŒæŠŠ on_load() é‡Œé¢çš„æ‰€æœ‰é…ç½®ç‹¬ç«‹åˆ°å•ç‹¬çš„ modules/load.lua è„šæœ¬æ–‡ä»¶ä¸­å»ï¼Œæ•´ä¸ªå·¥ç¨‹çš„ç›®å½•ç»“æ„å¦‚ä¸‹ã€‚\n.\râ”œâ”€â”€ main.c\râ”œâ”€â”€ modules\râ”‚ â””â”€â”€ load.lua\râ””â”€â”€ xmake.lua\r æ¥ä¸‹æ¥ä½¿ç”¨ vim ç¼–è¾‘ modules/load.lua æ–‡ä»¶ï¼Œå°†ä¹‹å‰ on_load é‡Œé¢çš„é…ç½®æŒªè¿›æ¥ï¼Œä¾‹å¦‚ã€‚\nfunction main(target)\rtarget:add(\u0026quot;defines\u0026quot;, \u0026quot;WORD=\\\u0026quot;foo\\\u0026quot;\u0026quot;)\rend\r å¯ä»¥çœ‹åˆ°ï¼Œé‡Œé¢çš„é…ç½®è·Ÿä¹‹å‰çš„è„šæœ¬æ²¡ä»€ä¹ˆä¸åŒï¼Œä»…ä»…åŠ äº†ä¸ª main å‡½æ•°ä½œä¸ºä¸»å…¥å£ï¼Œè€Œä¹‹å‰åœ¨ on_load(function (target) end) ä¸­å®šä¹‰çš„æ˜¯åŒ¿åçš„å…¥å£å‡½æ•°ã€‚\næœ€åä¿®æ”¹åŸæ¥çš„ xmake.lua é…ç½®ï¼Œå°† on_load() é‡Œé¢çš„é…ç½®æŒ‡å‘åˆ°åˆšåˆšåˆ›å»ºçš„ modules/load.lua æ–‡ä»¶å³å¯ã€‚\ntarget(\u0026quot;hello\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;*.c\u0026quot;)\ron_load(\u0026quot;modules.load\u0026quot;)\r è¿™é‡Œä½¿ç”¨ modules.load çš„æ ¼å¼å»å¼•ç”¨å½“å‰ modules ç›®å½•ä¸‹çš„ load.lua æ–‡ä»¶ï¼Œå…¶ä¸­æ¯ä¸ª . å¯¹åº”ä¸€çº§å­ç›®å½•ã€‚è‡³äºä¸ºä»€ä¹ˆä¸ç”¨è·¯å¾„åˆ†éš”ç¬¦ï¼Œæ˜¯ä¸ºäº†è·Ÿ import å¯¼å…¥æ¥å£ ä¿æŒä¸€è‡´ï¼Œéƒ½æ˜¯ç”¨æ¥å¯¼å…¥æŒ‡å®šçš„ lua è„šæœ¬æ¨¡å—ã€‚å…³äº import æ¥å£ï¼Œæˆ‘ä»¬ä¼šåœ¨åé¢çš„å®éªŒä¸­è¯¦ç»†è®²è§£ã€‚\næ‰§è¡Œå¦‚ä¸‹å‘½ä»¤éªŒè¯ç¼–è¯‘å’Œè¿è¡Œæ˜¯å¦é€šè¿‡ã€‚\nxmake\rxmake run\r ç¼–è¯‘å’Œè¿è¡Œæ˜¯å¦é€šè¿‡å¯ä»¥å¯¹ç…§ä¸‹é¢çš„å›¾ç‰‡ç»“æœã€‚\nå¤šç›®æ ‡ç¨‹åºé…ç½® åœ¨ä¹‹å‰çš„å®éªŒä¸­ï¼Œæˆ‘ä»¬çš„å·¥ç¨‹éƒ½åªæœ‰ä¸€ä¸ªç›®æ ‡ç¨‹åºï¼Œä¹Ÿå°±æ˜¯ä»…ä»…å®šä¹‰äº†ä¸€ä¸ª target()ï¼Œä½†å®é™…çš„é¡¹ç›®ï¼Œå¯èƒ½éœ€è¦åŒæ—¶ç¼–è¯‘å¤šä¸ªç›®æ ‡ç¨‹åºã€‚\nè¿™ç§æƒ…å†µä¸‹åªéœ€è¦åœ¨ xmake.lua ä¸­å†é¢å¤–å¤šé…ç½®ä¸€ä¸ª target() çš„å®šä¹‰å—å°±è¡Œäº†ï¼Œæ¯ä¸ª target(\u0026quot;test\u0026quot;) å®šä¹‰å”¯ä¸€å¯¹åº”ä¸€ä¸ªç›®æ ‡ç¨‹åºï¼Œå®ƒå¯ä»¥æ˜¯å¯æ‰§è¡Œç¨‹åºï¼Œä¹Ÿå¯ä»¥æ˜¯é™æ€åº“ã€åŠ¨æ€åº“ç¨‹åºç›®æ ‡ã€‚\né€šè¿‡ç¼©è¿›çš„æ–¹å¼ï¼Œå¯ä»¥æ˜¾å¼åŒºåˆ†å“ªäº›è®¾ç½®æ˜¯å¯¹å“ªä¸ª target ç›®æ ‡ç”Ÿæ•ˆï¼Œå½“ç„¶ç¼©è¿›é…ç½®åªæ˜¯è¯­æ³•é£æ ¼çš„çº¦å®šï¼Œä½¿å¾—é…ç½®æ›´åŠ ç®€æ´ï¼Œå¯è¯»æ€§æ›´å¥½ï¼Œä½†è¿™å¹¶ä¸æ˜¯å¼ºåˆ¶è¦æ±‚çš„ã€‚\nç°åœ¨ç»§ç»­ä¿®æ”¹ä¹‹å‰çš„ xmake.lua é…ç½®ï¼Œé‡Œé¢å®šä¹‰ä¸¤ä¸ªæ‰§è¡Œç¨‹åºç›®æ ‡ï¼Œè€Œå®é™…çš„ C ä»£ç æˆ‘ä»¬è¿˜æ˜¯å¤ç”¨ä¹‹å‰çš„ main.cã€‚\ntarget(\u0026quot;test1\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;*.c\u0026quot;)\radd_defines(\u0026quot;WORD=\\\u0026quot;TEST1\\\u0026quot;\u0026quot;)\rtarget(\u0026quot;test2\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;*.c\u0026quot;)\radd_defines(\u0026quot;WORD=\\\u0026quot;TEST2\\\u0026quot;\u0026quot;)\r é€šè¿‡ä¸Šé¢çš„é…ç½®çœ‹åˆ°ï¼Œæˆ‘ä»¬è¿˜å¯¹æ¯ä¸ª target é¢å¤–æ·»åŠ äº†ä¸åŒçš„å®å®šä¹‰ï¼Œ-DTEST1 å®šä¹‰ç»™ test1 ç›®æ ‡ç¨‹åºï¼Œ-DTEST2 å®šä¹‰ç»™ test2 ç›®æ ‡ç¨‹åºã€‚\néœ€è¦æ³¨æ„ï¼Œæ‰€æœ‰çš„ set_xx å’Œ add_xx è®¾ç½®éƒ½æ˜¯é’ˆå¯¹ä¸Šé¢æœ€è¿‘çš„ target() å®šä¹‰çš„ç‰¹å®šç›®æ ‡ç¨‹åºï¼Œè€Œä¸æ˜¯å…¨å±€çš„ã€‚\næˆ‘ä»¬å¯ä»¥æŠŠå®ƒç†è§£ä¸ºå­—å…¸çš„ key/value è®¾ç½®ï¼Œä¸Šé¢çš„é…ç½®ç­‰ä»·äºä¸‹é¢çš„ä¼ªæè¿° json å®šä¹‰ã€‚\n\u0026quot;test1\u0026quot;:\r{\r\u0026quot;kind\u0026quot; = \u0026quot;binary\u0026quot;,\r\u0026quot;files\u0026quot; = \u0026quot;*.c\u0026quot;,\r\u0026quot;defines\u0026quot; = \u0026quot;WORD=\\\u0026quot;TEST1\\\u0026quot;\u0026quot;\r},\r\u0026quot;test2\u0026quot;\r{\r\u0026quot;kind\u0026quot; = \u0026quot;binary\u0026quot;,\r\u0026quot;files\u0026quot; = \u0026quot;*.c\u0026quot;,\r\u0026quot;defines\u0026quot; = \u0026quot;WORD=\\\u0026quot;TEST2\\\u0026quot;\u0026quot;\r}\r ä¹Ÿå¯ä»¥æ˜¾å¼çš„åŠ ä¸Š target_end() æ¥æ˜ç¡®æ¯ä¸ª target å®šä¹‰å—çš„ä½œç”¨èŒƒå›´ï¼Œæ¯”å¦‚ä¸‹é¢è¿™æ ·ã€‚\ntarget(\u0026quot;test1\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;*.c\u0026quot;)\radd_defines(\u0026quot;WORD=\\\u0026quot;TEST1\\\u0026quot;\u0026quot;)\rtarget_end()\rtarget(\u0026quot;test2\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;*.c\u0026quot;)\radd_defines(\u0026quot;WORD=\\\u0026quot;TEST2\\\u0026quot;\u0026quot;)\rtarget_end()\r æ‰§è¡Œ xmake æ¥å°è¯•ç¼–è¯‘è¿™ä¸¤ä¸ªç›®æ ‡ç¨‹åºï¼Œå¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬å®é™…ç¼–è¯‘é“¾æ¥ç”Ÿæˆäº†ä¸¤ä¸ªå¯æ‰§è¡Œç¨‹åºï¼štest1 å’Œ test2ã€‚\nå†æ‰§è¡Œ xmake -rv æŸ¥çœ‹è¯¦ç»†è¾“å‡ºï¼Œè¿™ä¸¤ä¸ªå®å®šä¹‰å·²ç»åˆ†åˆ«ä¼ å…¥äº†å¯¹åº”çš„ target ä¸­å»ã€‚\nåˆ†åˆ«è¿è¡Œè¿™ä¸¤ä¸ªå¯æ‰§è¡Œç¨‹åºæŸ¥çœ‹è¾“å‡ºã€‚\nxmake run test1\rxmake run test2\r å¦‚æœçœ‹åˆ°ä¸‹é¢çš„è¾“å‡ºï¼Œè¯´æ˜æˆ‘ä»¬ç¡®å®å·²ç»å°†ä¸åŒçš„ WORD å®å®šä¹‰åˆ†åˆ«ä¼ å…¥äº† test1 å’Œ test2 è¿™ä¸¤ä¸ªç¨‹åºä¸­å»ã€‚\nå…¨å±€é…ç½®å’Œå­é…ç½® å¦‚æœæˆ‘ä»¬çš„é¡¹ç›®å·¥ç¨‹éœ€è¦å‚ä¸ç¼–è¯‘çš„ç›®æ ‡ç¨‹åºå¾ˆå¤šï¼Œä¸æ­¢ä¸€ä¸¤ä¸ªï¼Œæœ‰å¯èƒ½åå‡ ä¸ªï¼Œå¦‚æœæ¯ä¸ª target éƒ½å•ç‹¬é…ç½®ä¸€éï¼Œé‚£ä¹ˆæ•´ä¸ª xmake.lua ä¸­ä¼šæœ‰å¾ˆå¤šçš„é‡å¤é…ç½®å­˜åœ¨ï¼Œéå¸¸å†—ä½™ï¼Œæ¯•ç«Ÿä¸å¯èƒ½æ¯ä¸ª target çš„é…ç½®éƒ½æ˜¯å®Œå…¨ä¸åŒçš„ï¼Œå¤šå°‘æ€»ä¼šæœ‰ä¸€äº›å…±äº«çš„é€šç”¨é…ç½®ã€‚\næˆ‘ä»¬å¯ä»¥æŠŠæ¯ä¸ª target ä¸­éƒ½ä¼šä½¿ç”¨åˆ°çš„é€šç”¨é…ç½®æŠ½ç¦»å‡ºæ¥ï¼Œæ”¾åœ¨æœ€ä¸Šé¢çš„å…¨å±€é…ç½®åŸŸä¸­è®¾ç½®ï¼Œè¿™æ ·å°±ä¼šå¯¹æ‰€æœ‰ target éƒ½ç”Ÿæ•ˆäº†ã€‚\nåœ¨ä¹‹å‰çš„é…ç½®ä¸­ï¼Œåœ¨å…¨å±€æ ¹åŸŸåŠ ä¸Šä¸€äº›é€šç”¨é…ç½®ï¼Œæ¯”å¦‚æ”¹æˆä¸‹é¢çš„å†…å®¹ã€‚\nadd_defines(\u0026quot;ROOT\u0026quot;)\rset_optimize(\u0026quot;fastest\u0026quot;)\rset_languages(\u0026quot;c99\u0026quot;)\radd_includedirs(\u0026quot;/tmp\u0026quot;)\rtarget(\u0026quot;test1\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;*.c\u0026quot;)\radd_defines(\u0026quot;WORD=\\\u0026quot;TEST1\\\u0026quot;\u0026quot;)\rtarget(\u0026quot;test2\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;*.c\u0026quot;)\radd_defines(\u0026quot;WORD=\\\u0026quot;TEST2\\\u0026quot;\u0026quot;)\r æ‰§è¡Œ xmake -rv è¿›è¡Œç¼–è¯‘ï¼Œä»è¾“å‡ºä¸­çœ‹åˆ°çº¢æ¡†é‡Œé¢çš„éƒ¨åˆ†ï¼Œå¯ä»¥ç¡®è®¤åœ¨å…¨å±€æ ¹åŸŸçš„è¿™äº›è®¾ç½®å¯¹æ¯ä¸ª target éƒ½ç”Ÿæ•ˆäº†ï¼Œè€Œ -DWORD= çš„å®å®šä¹‰è®¾ç½®åœ¨ä¸åŒçš„ target ä¸­è¿˜æ˜¯ä¸ç›¸åŒçš„ï¼Œå› ä¸ºå®ƒä»¬æ˜¯åœ¨ç‰¹å®š target åŸŸä¸­åˆ†åˆ«è®¾ç½®çš„ã€‚\nè‡³äºä¸ºä»€ä¹ˆè¦æŠ½ç¦»é€šç”¨è®¾ç½®åˆ°å…¨å±€æ ¹åŸŸï¼Œåœ¨å‰é¢ä¹Ÿè§£é‡Šäº†åŸå› ï¼Œå°±æ˜¯ä¸ºäº†ç®€åŒ– xmake.lua çš„é…ç½®ï¼Œè¿™ä¹Ÿæ˜¯ xmake çš„åˆè¡·ï¼Œè®©å·¥ç¨‹é¡¹ç›®çš„æ„å»ºé…ç½®èƒ½å¤Ÿå°½å¯èƒ½çš„ç®€æ´å¯è¯»ï¼Œè¿™æ ·æ–¹ä¾¿ç»´æŠ¤ä¹Ÿæ›´åŠ å‹å¥½ã€‚\nå¦‚æœä¸æ”¾åœ¨æ ¹åŸŸï¼Œè€Œæ˜¯æ¯ä¸ª target éƒ½å»å•ç‹¬é…ç½®ä¸€éï¼Œæˆ‘ä»¬å¯ä»¥å¯¹æ¯”ä¸‹çœ‹çœ‹ï¼Œè¿™æ˜¯éå¸¸å†—ä½™è‡ƒè‚¿çš„ï¼Œå¯è¯»æ€§ä¹Ÿå¾ˆå·®ï¼Œå°±å¦‚ä¸‹é¢çš„é…ç½®ï¼ˆä¸è¦è¿™æ ·å»å†™ï¼‰ã€‚\ntarget(\u0026quot;test1\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;*.c\u0026quot;)\radd_defines(\u0026quot;WORD=\\\u0026quot;TEST1\\\u0026quot;\u0026quot;)\radd_defines(\u0026quot;ROOT\u0026quot;)\rset_optimize(\u0026quot;fastest\u0026quot;)\rset_languages(\u0026quot;c99\u0026quot;)\radd_includedirs(\u0026quot;/tmp\u0026quot;)\rtarget(\u0026quot;test2\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;*.c\u0026quot;)\radd_defines(\u0026quot;WORD=\\\u0026quot;TEST2\\\u0026quot;\u0026quot;)\radd_defines(\u0026quot;ROOT\u0026quot;)\rset_optimize(\u0026quot;fastest\u0026quot;)\rset_languages(\u0026quot;c99\u0026quot;)\radd_includedirs(\u0026quot;/tmp\u0026quot;)\r æ‰€ä»¥ï¼Œæˆ‘ä»¬è¦è®°ä½ï¼Œå¦‚æœæœ‰é€šç”¨çš„è®¾ç½®ï¼Œè¯·å°½å¯èƒ½è®¾ç½®åˆ°å…¨å±€ä½œç”¨åŸŸä¸­å¯¹æ‰€æœ‰ target ç”Ÿæ•ˆï¼Œè€Œç‰¹æ®Šé…ç½®æ‰åœ¨æŒ‡å®šçš„ target ä¸­å»å•ç‹¬é…ç½®å®ƒä»¬ã€‚\nå®éªŒæ€»ç»“ åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬äº†è§£äº† xmake.lua çš„è¯­æ³•è®¾è®¡ç†å¿µï¼Œä»¥åŠåŸºæœ¬çš„é…ç½®æ–¹å¼ï¼Œå¹¶ä¸”å­¦ä¹ äº†ä»€ä¹ˆæ˜¯æè¿°åŸŸå’Œè„šæœ¬åŸŸï¼Œä¹Ÿå­¦ä¹ äº†å¦‚ä½•å»é…ç½®ç¼–è¯‘å¤šä¸ªç›®æ ‡ç¨‹åºï¼Œå¦å¤–è¿˜çŸ¥é“äº†æ€ä¹ˆé€šè¿‡å…¨å±€è®¾ç½®å»ç®€åŒ–é…ç½®å†…å®¹ã€‚\næœ¬å®éªŒçš„å‚è€ƒä»£ç å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ä¸‹è½½ï¼š\nwget https://labfile.oss.aliyuncs.com/courses/2764/code5.zip\r ","id":62,"section":"categories","summary":"é…ç½®è¯­æ³•ç®€ä»‹ åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å¤§æ¦‚äº†è§£ xmake.lua çš„è¯­æ³•è®¾è®¡ç†å¿µï¼Œä»¥åŠä¸€äº›åŸºæœ¬é…ç½®çš„å†™æ³•ï¼Œé€šè¿‡æœ¬èŠ‚å®éªŒï¼ŒåŸºæœ¬ä¸Šèƒ½æŒæ¡å¦‚ä½•å»ç¼–å†™åˆç†çš„ xmake.lua é…ç½®æ¥ç®€åŒ–å·¥","tags":["xmake"],"title":"å®éªŒ5é…ç½®è¯­æ³•ç®€ä»‹","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/app/xmake/%E8%93%9D%E6%A1%A5%E7%BD%91%E8%AF%BE/2xmake%E5%9F%BA%E7%A1%80/%E5%AE%9E%E9%AA%8C5%E9%85%8D%E7%BD%AE%E8%AF%AD%E6%B3%95%E7%AE%80%E4%BB%8B/","year":"2021"},{"content":"C/C++ ä¾èµ–åŒ…çš„é›†æˆå’Œä½¿ç”¨ åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å­¦ä¹ åˆ°å¦‚ä½•å¿«é€Ÿé›†æˆç¬¬ä¸‰æ–¹çš„ C/C++ ä¾èµ–åŒ…ï¼Œä»¥åŠä¸ç¬¬ä¸‰æ–¹åŒ…ä»“åº“çš„æ¥å…¥é›†æˆã€‚\nçŸ¥è¯†ç‚¹  xmake åŒ…ç®¡ç†çš„æ•´ä½“æ¶æ„æµç¨‹ ç³»ç»Ÿåº“ä»¥åŠç¬¬ä¸‰æ–¹åº“çš„å¿«é€Ÿé›†æˆ Conan åŒ…ç®¡ç†çš„ä»‹ç» è¯­ä¹‰ç‰ˆæœ¬çš„é…ç½®è¯´æ˜ ä¾èµ–åŒ…çš„å®‰è£…å’Œå¸è½½ zlib åº“çš„é›†æˆå’Œä½¿ç”¨  C/C++ ä¾èµ–åº“ä»‹ç» C/C++ åº“ä¸åƒå…¶å®ƒæ–°çš„é«˜çº§è¯­è¨€é‚£æ ·å®˜æ–¹æä¾›å¥½ç”¨çš„ä¾èµ–åŒ…ç®¡ç†å’Œé›†æˆï¼Œæ•´ä¸ªç”Ÿæ€æ¯”è¾ƒæ‚ä¹±ä¸ç»Ÿä¸€ï¼Œé›†æˆèµ·æ¥éå¸¸çš„ä¸æ–¹ä¾¿ï¼Œè¿™ä¹Ÿæ˜¯ C/C++ å¼€å‘çš„ç—›ç‚¹ä¹‹ä¸€ã€‚\næˆ‘ä»¬ç»å¸¸éœ€è¦åˆ°å¤„æ‰¾åº“ï¼Œç ”ç©¶å¦‚ä½•ç¼–è¯‘ã€å®‰è£…å®ƒä»¬ï¼Œå¹¶ä¸”å¦‚ä½•å»é›†æˆä½¿ç”¨ï¼Œå¦‚æœéœ€è¦è·¨å¹³å°ï¼Œé‡åˆ°çš„é—®é¢˜å¯èƒ½è¿˜æ›´å¤šç‚¹ï¼Œä¸ºäº†é›†ä¸­ç®¡ç†è¿™äº›ä¾èµ–åŒ…ï¼Œç°åœ¨å¸‚é¢ä¸Šå·²ç»æœ‰ä¸å°‘æˆç†Ÿçš„ç¬¬ä¸‰æ–¹åŒ…ç®¡ç†å™¨æ¥ç»´æŠ¤å’Œè§£å†³è¿™äº›é—®é¢˜ï¼Œæ¯”å¦‚ï¼šconanï¼Œvcpkgï¼Œhomebrew ç­‰ç­‰ï¼Œä¸è¿‡æˆ‘ä»¬è¿˜æ˜¯éœ€è¦æœ‰ä¸€ç§æ›´åŠ æ–¹ä¾¿çš„é›†æˆæ–¹å¼å°†å…¶ä¸æˆ‘ä»¬çš„ C/C++ é¡¹ç›®å·¥ç¨‹è¿›è¡Œå…³è”é›†æˆï¼Œæ‰èƒ½ä½¿ç”¨å®ƒä»¬ã€‚\nä¸ºæ­¤ï¼Œxmake å†…ç½®äº†å¯¹è¿™äº›ç¬¬ä¸‰æ–¹åŒ…ç®¡ç†ä»“åº“çš„é›†æˆï¼Œå¦å¤– xmake è¿˜æœ‰è‡ªå·±çš„åŒ…ä¾èµ–ä»“åº“æ¥æ›´å¥½çš„è§£å†³ä¾èµ–åŒ…é›†æˆé—®é¢˜ï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹é¢çš„å®éªŒä¸­é€ä¸€è®²è§£ã€‚\nç›´æ¥é›†æˆä½¿ç”¨ç³»ç»Ÿåº“ é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆä»æœ€ç®€å•çš„é›†æˆæ–¹å¼å¼€å§‹ï¼Œå°è¯•ç›´æ¥é›†æˆç³»ç»Ÿä¸­å·²ç»å®‰è£…çš„ç¬¬ä¸‰æ–¹åº“ï¼Œç”±äº zlib åº“åœ¨å¤§å¤šæ•° Linux ç³»ç»Ÿç¯å¢ƒä¸­éƒ½æ˜¯å†…ç½®äº†çš„ï¼Œå¹¶ä¸”åœ¨æœ¬å®éªŒç¯å¢ƒä¹Ÿæ˜¯å·²ç»å­˜åœ¨çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å…ˆä»é›†æˆ zlib åº“å¼€å§‹å®éªŒã€‚\nç”±äº zlib æ˜¯ C åº“ï¼Œä¸ºäº†æ–¹ä¾¿èµ·è§ï¼Œè¿™å›æˆ‘ä»¬æ¥åˆ›å»ºä¸€ä¸ª C å·¥ç¨‹æ¥å°è¯•å®ƒï¼Œåªéœ€è¦åœ¨åˆ›å»ºå·¥ç¨‹çš„æ—¶å€™æŒ‡å®šä¸‹è¯­è¨€å³å¯ï¼Œä¾‹å¦‚ã€‚\ncd ~/Code\rxmake create -l c crc32\r -l c å‚æ•°æŒ‡å®šå½“å‰åˆ›å»ºçš„ crc32 å·¥ç¨‹æ˜¯åŸºäº C è¯­è¨€çš„ï¼Œå…¶ç›®å½•ç»“æ„å¦‚ä¸‹ï¼Œè·Ÿä¹‹å‰çš„ hello é¡¹ç›®å¾ˆç›¸ä¼¼ï¼Œä»…ä»…åªæ˜¯ main.cpp æºæ–‡ä»¶å˜æˆäº† main.cã€‚\nè¿›å…¥ crc32 ç›®å½•ä¸­ï¼Œæ‰§è¡Œ vim src/main.c ç¼–è¾‘æºæ–‡ä»¶ï¼Œç¼–å†™ä¸€ä¸ªç®€å•å®ç”¨ã€ä½¿ç”¨ zlib åº“ä¸­ crc32() æ¥å£å»è®¡ç®— crc32 çš„ä¾‹å­ï¼Œä»£ç å¦‚ä¸‹ã€‚\n#include \u0026lt;stdio.h\u0026gt;\r#include \u0026lt;zlib.h\u0026gt;\rint main(int argc, char** argv)\r{\rprintf(\u0026quot;crc32: %x!\\n\u0026quot;, crc32(0, argv[1], strlen(argv[1])));\rreturn 0;\r}\r ä¸Šè¿°ä»£ç é€šè¿‡è®¡ç®—è¾“å…¥å­—ç¬¦ä¸²å†…å®¹çš„ crc32 å€¼ï¼Œç„¶åå›æ˜¾è¾“å‡ºåˆ°ç»ˆç«¯ä¸Šï¼Œæˆ‘ä»¬å…ˆå°è¯•ä¸‹ç›´æ¥æ‰§è¡Œ xmake å‘½ä»¤å»ç¼–è¯‘å®ƒã€‚\né€šè¿‡ä¸Šå›¾ï¼Œæˆ‘ä»¬çœ‹åˆ°ç¼–è¯‘é“¾æ¥é˜¶æ®µæŠ¥é”™äº†ï¼Œç¼ºå°‘ crc32 ç¬¦å·ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬è¿˜æ²¡é›†æˆé“¾æ¥ zlib åº“ï¼Œç»§ç»­ä¿®æ”¹ xmake.lua æ–‡ä»¶æ‰‹åŠ¨åŠ ä¸Š zlib åº“ä»¥åŠå®ƒç³»ç»Ÿåº“æœç´¢è·¯å¾„ã€‚\ntarget(\u0026quot;crc32\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.c\u0026quot;)\radd_links(\u0026quot;z\u0026quot;)\radd_linkdirs(\u0026quot;/usr/lib/x86_64-linux-gnu\u0026quot;)\r ç„¶åé‡æ–°æ‰§è¡Œ xmake ç¼–è¯‘è¿™ä¸ªå·¥ç¨‹ï¼Œè¿™å›çœ‹åˆ°ç¼–è¯‘é€šè¿‡äº†ã€‚\nå¦‚æœæˆ‘ä»¬æ‰§è¡Œ xmake -rv å‘½ä»¤ï¼Œæ˜¯å¯ä»¥çœ‹åˆ°è¯¦ç»†ç¼–è¯‘è¾“å‡ºé‡Œé¢å·²ç»å¸¦ä¸Šäº† -L/usr/lib/x86_64-linux-gnu -lz çš„åº“é“¾æ¥é€‰é¡¹ã€‚\næ³¨ï¼šè¿™é‡Œæ²¡æœ‰é¢å¤–æ·»åŠ å¤´æ–‡ä»¶æœç´¢è·¯å¾„ï¼Œæ˜¯å› ä¸º zlib.h æ˜¯åœ¨ /usr/include ç›®å½•ä¸‹ï¼Œè¿™ä¸ªç›®å½• xmake ä¼šå†…ç½®è‡ªåŠ¨æ·»åŠ å¯¹åº”çš„ -I é€‰é¡¹åˆ° gccã€‚\næ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°è¯•æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤è¿è¡Œè¿™ä¸ªç¨‹åºã€‚\nxmake run crc32 somedata\r å¦‚æœè¿è¡Œæ­£å¸¸ï¼Œä¼šçœ‹åˆ°ç±»ä¼¼ä¸‹é¢çš„è¿è¡Œç»“æœï¼Œè¯´æ˜æˆ‘ä»¬å·²ç»æ­£å¸¸é›†æˆä½¿ç”¨äº†ç³»ç»Ÿè‡ªå¸¦çš„ zlib åº“ã€‚\nè‡ªåŠ¨æŸ¥æ‰¾ç³»ç»Ÿåº“ åœ¨ä¸ŠèŠ‚ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ add_linkdirs(\u0026quot;/usr/lib/x86_64-linux-gnu\u0026quot;) æ–¹å¼æ¥é›†æˆç³»ç»Ÿä¾èµ–åº“ï¼Œè™½ç„¶å¯ä»¥ä½¿ç”¨ä½†ä¸æ˜¯éå¸¸é€šç”¨ï¼Œå› ä¸ºå¸¦æœ‰ xmake.lua çš„ C/C++ é¡¹ç›®æœ‰å¯èƒ½ä¼šåœ¨å…¶å®ƒ Linux ç¯å¢ƒç”šè‡³åœ¨å…¶å®ƒç³»ç»Ÿä¸Šç¼–è¯‘ï¼Œzlib åº“å¹¶ä¸ä¸€å®šå®‰è£…åœ¨è¿™ä¸ªç›®å½•ä¸‹ã€‚\nä¸ºäº†æ›´åŠ é€šç”¨åŒ–çš„é€‚é…ç³»ç»Ÿåº“è·¯å¾„ï¼Œå¯ä»¥ä½¿ç”¨ find_packages æ¥è‡ªåŠ¨æŸ¥æ‰¾ zlib åº“æ‰€åœ¨çš„ä½ç½®ï¼Œé€šè¿‡è¿™ç§æ–¹å¼é›†æˆä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆå°è¯•ç›´æ¥æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œæ¥æ¢æµ‹ zlib åº“çš„ä½ç½®ä¿¡æ¯ï¼Œå¯¹è¿™ä¸ªæ¥å£è¿”å›çš„ä¿¡æ¯æœ‰ä¸ªå¤§æ¦‚çš„äº†è§£ã€‚\nxmake l find_packages zlib\r å¦‚æœæˆ‘ä»¬æˆåŠŸæ‰¾åˆ°ç³»ç»Ÿè·¯å¾„ä¸‹å®‰è£…çš„ zlib åº“ï¼Œé‚£ä¹ˆä¼šçœ‹åˆ°ç±»ä¼¼ä¸‹å›¾çš„ç»“æœã€‚\né‡Œé¢æœ‰é“¾æ¥åº“åã€é“¾æ¥åº“çš„æœç´¢è·¯å¾„ï¼Œæœ‰å¯èƒ½è¿˜ä¼šæœ‰å¤´æ–‡ä»¶çš„æœç´¢è·¯å¾„ç­‰ä¿¡æ¯ï¼Œå› æ­¤æˆ‘ä»¬åªéœ€è¦æŠŠè¿™äº›ä¿¡æ¯è‡ªåŠ¨æ¢æµ‹åˆ°åè®¾ç½®åˆ°å¯¹åº”çš„ç›®æ ‡ç¨‹åºä¸­ï¼Œå°±å¯ä»¥å®ç°è‡ªåŠ¨é›†æˆå®‰è£…åœ¨ç³»ç»Ÿç¯å¢ƒçš„ä¾èµ–åº“äº†ã€‚\næ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ç»§ç»­ä¿®æ”¹ xmake.luaï¼Œåœ¨ target å®šä¹‰ä¸‹é¢æ–°å¢ä¸€ä¸ª on_load() è„šæœ¬å—ï¼Œåœ¨é‡Œé¢è°ƒç”¨ find_packages(\u0026quot;zlib\u0026quot;) å°†æ¢æµ‹åˆ°çš„ zlib åº“ä¿¡æ¯ç›´æ¥åŠ¨æ€è®¾ç½®åˆ° target é‡Œé¢å»å°±è¡Œäº†ï¼Œå¦‚ä¸‹é…ç½®ä»£ç ã€‚\ntarget(\u0026quot;crc32\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.c\u0026quot;)\radd_links(\u0026quot;z\u0026quot;)\radd_linkdirs(\u0026quot;/usr/lib/x86_64-linux-gnu\u0026quot;)\ron_load(function (target)\rtarget:add(find_packages(\u0026quot;zlib\u0026quot;))\rend)\r ä¿®æ”¹å®Œæˆåæ‰§è¡Œ xmake -rvï¼Œå…¶ç¼–è¯‘è¾“å‡ºåº”è¯¥è·Ÿä¹‹å‰çš„è¾“å‡ºå®Œå…¨ä¸€è‡´æ‰å¯¹ã€‚\nä¸è¿‡éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼šxmake é»˜è®¤ä¼šç¼“å­˜ä¾èµ–åŒ…çš„æ£€æµ‹ç»“æœï¼Œå¹¶ä¸æ˜¯æ¯æ¬¡ç¼–è¯‘éƒ½ä¼šé‡æ–°æ£€æµ‹ï¼Œå¦‚æœä¹‹å‰æ£€æµ‹å¤±è´¥ï¼Œé‚£ä¹ˆç»“æœä¹Ÿä¼šç¼“å­˜ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥æ‰§è¡Œ xmake f -c åœ¨é…ç½®æ—¶å€™ï¼Œå¿½ç•¥ä¹‹å‰çš„ç¼“å­˜å†…å®¹ï¼Œå°±ä¼šè‡ªåŠ¨é‡æ–°è§¦å‘å„ç§æ£€æµ‹ã€‚\nè¿œç¨‹åº“ä¸‹è½½é›†æˆ æˆ‘ä»¬ç°åœ¨è™½ç„¶èƒ½å¤Ÿè‡ªåŠ¨æ£€æµ‹å’Œé›†æˆç³»ç»Ÿç¯å¢ƒçš„ C/C++ åº“ï¼Œä½†æ˜¯å¦‚æœéœ€è¦çš„åº“åœ¨å½“å‰ç¯å¢ƒä¸­è¿˜æ²¡æœ‰å®‰è£…ï¼Œé‚£ä¹ˆè¿˜æ˜¯éœ€è¦æ‰‹åŠ¨çš„å»å®‰è£…å®ƒä»¬ï¼Œå¦‚æœæœ‰äº›åº“å®‰è£…éå¸¸å¤æ‚å®¹æ˜“å‡ºé”™ï¼Œé‚£ä¹ˆæ•´ä¸ªè¿‡ç¨‹ä¹Ÿæ˜¯å¾ˆæŠ˜è…¾çš„ã€‚\nå› æ­¤ xmake æä¾›äº†ä¾èµ–åŒ…çš„è‡ªåŠ¨è¿œç¨‹ä¸‹è½½ä»¥åŠå®‰è£…é›†æˆåŠŸèƒ½ï¼Œå®ƒä¸ä»…æ”¯æŒ conanã€vcpkgã€homebrew ç­‰ç¬¬ä¸‰æ–¹åŒ…ç®¡ç†ä»“åº“ï¼Œè¿˜æ”¯æŒè‡ªå»ºçš„åˆ†å¸ƒå¼ç§æœ‰åŒ…ç®¡ç†ä»“åº“ï¼Œå¹¶ä¸” xmake ä¹Ÿæä¾›äº†å®˜æ–¹çš„ C/C++ åŒ…ä»“åº“ã€‚\nå…¶å¤§è‡´æµç¨‹å¯ä»¥é€šè¿‡ä¸‹é¢è¿™ä¸ªå›¾æ¥ç›´è§‚çš„äº†è§£ã€‚\nå¦‚æœæš‚æ—¶çœ‹ä¸æ‡‚ä¸Šå›¾çš„æµç¨‹ï¼Œæ²¡æœ‰å…³ç³»ï¼Œæˆ‘ä»¬å…ˆæ¥ä¸ªç®€å•çš„ä¾‹å­ä½“éªŒä¸‹å¦‚ä½•è¿œç¨‹ä¸‹è½½ä¾èµ–åŒ…å¹¶æŠŠå®ƒé›†æˆåˆ°é¡¹ç›®ä¸­å»ï¼Œè¿˜æ˜¯æ‹¿ä¹‹å‰çš„ zlib ä¸ºä¾‹ï¼Œæˆ‘ä»¬å…ˆå‡è®¾å½“å‰ç³»ç»Ÿç¯å¢ƒä¸­æ²¡æœ‰è¿™ä¸ªåº“å­˜åœ¨ï¼Œæƒ³è¦ä»ç½‘ä¸Šæ‹‰å–å¯¹åº”ç‰ˆæœ¬è¿›è¡Œé›†æˆã€‚\nè¿˜æ˜¯æ‹¿ä¹‹å‰çš„ crc32 å·¥ç¨‹åšä¸‹ä¿®æ”¹ï¼Œç¼–è¾‘é‡Œé¢çš„ xmake.lua æ–‡ä»¶ï¼Œä¿®æ”¹ä¸ºä¸‹é¢çš„å†…å®¹ã€‚\nadd_requires(\u0026quot;zlib\u0026quot;, {system = false})\rtarget(\u0026quot;crc32\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.c\u0026quot;)\radd_packages(\u0026quot;zlib\u0026quot;)\r å…¶ä¸­ add_requires() æ¥å£æŒ‡å®šå½“å‰é¡¹ç›®éœ€è¦å“ªäº›åŒ…ï¼Œé…ç½®è¿™ä¸ªç¼–è¯‘æ—¶å€™ä¼šè§¦å‘ä¸€æ¬¡ä¾èµ–åŒ…çš„å®‰è£…ï¼Œè€Œ add_packages() ç”¨æ¥é…ç½®å¯¹ç‰¹å®š target ç›®æ ‡é›†æˆæŒ‡å®šçš„ä¾èµ–åŒ…ï¼Œè¿™ä¸¤è€…éœ€è¦é…åˆä½¿ç”¨ï¼Œç¼ºä¸€ä¸å¯ã€‚\næ¥ä¸‹æ¥ï¼Œæ‰§è¡Œ xmake é‡æ–°æ¥ç¼–è¯‘é¡¹ç›®ï¼Œå¦‚æœå‡ºç°ä¸‹é¢çš„æç¤ºä¿¡æ¯ï¼Œè¯´æ˜æˆ‘ä»¬é…ç½®çš„ zlib åŒ…æœ‰åœ¨å®˜æ–¹ä»“åº“ä¸­è¢«æ”¶å½•ï¼Œå¹¶ä¸”å½“å‰å¹³å°æ”¯æŒè¿™ä¸ªä¾èµ–åŒ…çš„é›†æˆã€‚\nå¦‚æœå®‰è£…å®Œæˆå¹¶ä¸”ç¼–è¯‘æˆåŠŸä¼šæ˜¾ç¤ºä¸‹é¢çš„ä¿¡æ¯ã€‚\néœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œä¸Šé¢çš„é…ç½®ä¸­æˆ‘ä»¬é¢å¤–åŠ ä¸Šäº† {system = false} æ˜¯å› ä¸ºå½“å‰çš„å®éªŒç¯å¢ƒä¸­å·²ç»å­˜åœ¨äº† zlib åº“ï¼Œæ‰€ä»¥ add_requires(\u0026quot;zlib\u0026quot;) é»˜è®¤ä¼šä¼˜å…ˆè‡ªåŠ¨æ£€æµ‹ç³»ç»Ÿç¯å¢ƒä¸­çš„ zlib åº“ï¼Œå¦‚æœå­˜åœ¨å°±ç›´æ¥ä½¿ç”¨ï¼Œä¹Ÿå°±æ˜¯å†…ç½®äº† find_packages(\u0026quot;zlib\u0026quot;) çš„é€»è¾‘ã€‚\nè€Œè¿™é‡Œå‡ºäºæ¼”ç¤ºè¿œç¨‹ä¸‹è½½çš„é€»è¾‘ï¼Œæˆ‘ä»¬é€šè¿‡é…ç½® {system = false} å¼ºåˆ¶è§¦å‘è¿œç¨‹ä¸‹è½½ï¼Œäººä¸ºå¿½ç•¥äº†ç³»ç»Ÿåº“çš„æ¢æµ‹é€»è¾‘ï¼Œåœ¨å®é™…é¡¹ç›®ä¸­ï¼Œå¤§å®¶å¯æ ¹æ®è‡ªå·±çš„éœ€æ±‚æ¥å†³å®šæ˜¯å¦é…ç½®è¿™ä¸ªé€‰é¡¹ã€‚\nå¦å¤–ä¸€ä¸ªæ³¨æ„äº‹é¡¹æ˜¯ï¼Œæˆ‘ä»¬çš„åŒ…æ£€æµ‹ç»“æœéƒ½æ˜¯æœ‰æœ¬åœ°ç¼“å­˜çš„ï¼Œç¬¬äºŒæ¬¡ç¼–è¯‘å¹¶ä¸ä¼šå†è§¦å‘ä¾èµ–åŒ…çš„ä¸‹è½½å®‰è£…ï¼Œä¼šç›´æ¥å‚ä¸é›†æˆç¼–è¯‘ã€‚\næ‰€ä»¥å†æ¬¡æ‰§è¡Œ xmake -rv é‡æ–°ç¼–è¯‘çœ‹çœ‹ï¼Œè¿™æ¬¡å¹¶ä¸ä¼šå†å»å®‰è£… zlib åº“äº†ï¼ŒåŒæ ·å¯ä»¥æ­£å¸¸é›†æˆ zlib æ¥é‡æ–°ç¼–è¯‘é¡¹ç›®ï¼Œæ•ˆæœå¦‚å›¾ã€‚\nä¸Šå›¾ä¸­çº¢çº¿éƒ¨åˆ†å°±æ˜¯æˆ‘ä»¬ä»è¿œç¨‹ä»“åº“é›†æˆçš„ zlib åº“å¤´æ–‡ä»¶å’Œé“¾æ¥ä¿¡æ¯ã€‚\nå¸è½½å’Œé‡è£…ä¾èµ–åŒ… å¦‚æœæˆ‘ä»¬æƒ³è¦å¸è½½ä¹‹å‰çš„ä¾èµ–åŒ…ï¼Œåªéœ€è¦æ‰§è¡Œå¸è½½å‘½ä»¤ã€‚\nxmake require --uninstall zlib\r å¦‚æœçœ‹åˆ°ä¸‹å›¾ï¼Œè¯´æ˜å·²ç»æˆåŠŸå¸è½½äº†å®‰è£…åŒ…ã€‚\nä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè™½ç„¶å¸è½½äº†åŒ…ï¼Œä½†æ˜¯å½“å‰é¡¹ç›®çš„é…ç½®ç¼“å­˜è¿˜åœ¨ï¼Œå¦‚æœç»§ç»­æ‰§è¡Œ xmake å‘½ä»¤ï¼Œè¿˜æ˜¯ä¼šä½¿ç”¨ç¼“å­˜çš„ zlib åŒ…ä¿¡æ¯ã€‚\nå› æ­¤å¯ä»¥æ·»åŠ  -c å‚æ•°ç»™ xmake configï¼Œä¹Ÿå°±æ˜¯æ‰§è¡Œä¸‹ xmake f -c å‘½ä»¤ï¼Œå¼ºåˆ¶å¿½ç•¥ç¼“å­˜é…ç½®ï¼Œè§¦å‘ä¾èµ–åŒ…çš„é‡æ–°æ£€æµ‹é€»è¾‘ã€‚\nç”±äº xmake.lua ä¸­è¿˜æ˜¯é…ç½®äº† zlib åŒ…ä¾èµ–ï¼Œå› æ­¤è¿™æ¬¡ä¼šè§¦å‘é‡æ–°å®‰è£…é€»è¾‘ï¼ˆä¸è¿‡ä¸ä¼šå†é‡æ–°ä¸‹è½½äº†ï¼Œè€Œæ˜¯ç›´æ¥è§£å‹å®‰è£…ä¹‹å‰ç¼“å­˜çš„ zlib åŒ…ï¼‰ï¼Œæ•ˆæœå¦‚å›¾ã€‚\nè¯­ä¹‰ç‰ˆæœ¬è®¾ç½® xmake çš„ä¾èµ–åŒ…ç®¡ç†æ˜¯å®Œå…¨æ”¯æŒè¯­ä¹‰ç‰ˆæœ¬é€‰æ‹©çš„ï¼Œä¾‹å¦‚ï¼š\u0026quot;~1.6.1\u0026quot;ï¼Œå¯¹äºè¯­ä¹‰ç‰ˆæœ¬çš„å…·ä½“æè¿°è§ï¼šhttps://semver.org/ã€‚\nè¿™é‡Œï¼Œæˆ‘ä»¬åœ¨ä¹‹å‰çš„ xmake.lua åŸºç¡€ä¸Šï¼Œæ–°å¢ä¸¤ä¸ªä¾èµ–åº“ï¼Œå¹¶ä¸”è®¾ç½®ä¸Šä¸åŒçš„è¯­ä¹‰ç‰ˆæœ¬ï¼Œä¾‹å¦‚ã€‚\nadd_requires(\u0026quot;zlib\u0026quot;, {system = false})\radd_requires(\u0026quot;tbox 1.6.*\u0026quot;, \u0026quot;pcre2 \u0026gt;10.0\u0026quot;)\rtarget(\u0026quot;crc32\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.c\u0026quot;)\radd_packages(\u0026quot;zlib\u0026quot;, \u0026quot;tbox\u0026quot;, \u0026quot;pcre2\u0026quot;)\r å…¶ä¸­ tbox åº“ æˆ‘ä»¬ä¼šé›†æˆåŒ¹é… 1.6 ä¸‹é¢çš„æ‰€æœ‰å¯ç”¨å­ç‰ˆæœ¬ï¼Œè€Œ pcre2 æ­£åˆ™åº“æˆ‘ä»¬ä¼šé›†æˆåŒ¹é… \u0026gt;10.0 çš„å¯ç”¨ç‰ˆæœ¬ã€‚é…ç½®å¥½åï¼Œç»§ç»­æ‰§è¡Œ xmake å®‰è£…ä¾èµ–åº“ç¼–è¯‘ï¼Œå¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œä¼šçœ‹åˆ°ç±»ä¼¼ä¸‹é¢çš„ç»“æœè¾“å‡ºã€‚\nå†æ¥æ‰§è¡Œ xmake -rv æŸ¥çœ‹å®Œæ•´å‘½ä»¤è¾“å‡ºï¼Œçœ‹çœ‹æ˜¯å¦çœŸçš„é›†æˆä¸Šäº†è¿™ä¸¤ä¸ªåº“ã€‚\nä¸Šå›¾çº¢æ¡†éƒ¨åˆ†ï¼Œå°±æ˜¯æˆ‘ä»¬æ–°ä¸‹è½½é›†æˆçš„ä¸¤ä¸ªä¾èµ–åº“çš„è·¯å¾„å’Œç¼–è¯‘é“¾æ¥é€‰é¡¹ï¼Œè¯´æ˜æˆ‘ä»¬å·²ç»é¡ºåˆ©é›†æˆä¸Šäº†ï¼Œè‡³äº C ä»£ç é‡Œé¢å¦‚ä½•å»ä½¿ç”¨å®ƒä»¬ï¼Œè¿™é‡Œå°±ä¸å†è¿‡å¤šä»‹ç»äº†ï¼Œå¤§å®¶åœ¨å®éªŒåå¯ä»¥è‡ªè¡Œç ”ç©¶ã€‚\nå½“ç„¶ï¼Œå¦‚æœæˆ‘ä»¬å¯¹å½“å‰çš„ä¾èµ–åŒ…çš„ç‰ˆæœ¬æ²¡æœ‰ç‰¹æ®Šè¦æ±‚ï¼Œé‚£ä¹ˆä¹Ÿå¯ä»¥ä¸è®¾ç½®ç‰ˆæœ¬ï¼Œxmake ä¼šé»˜è®¤æ‹‰å–å®‰è£…å½“å‰å¯ä»¥è·å¾—çš„æœ€æ–°ç‰ˆæœ¬åŒ…ã€‚\nå¦‚æœå½“å‰ä¾èµ–åŒ…æœ‰ git ä»“åº“ï¼Œä¹Ÿå¯ä»¥é›†æˆ git ä»“åº“çš„ master/dev åˆ†æ”¯ä¾èµ–åŒ…ï¼Œåªéœ€è¦æŠŠç‰ˆæœ¬å·æ¢æˆå¯¹åº”çš„åˆ†æ”¯åå°±è¡Œäº†ï¼Œä¾‹å¦‚ã€‚\nadd_requires(\u0026quot;tbox master\u0026quot;)\radd_requires(\u0026quot;tbox dev\u0026quot;)\r åç»­ç¼–è¯‘æ“ä½œè·Ÿä¹‹å‰çš„ç±»ä¼¼ï¼Œè¿™é‡Œå°±ä¸å†é‡å¤å®éªŒäº†ã€‚\næŸ¥çœ‹ä¾èµ–åº“ä¿¡æ¯ æˆ‘ä»¬å¯ä»¥æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œå¿«é€ŸæŸ¥çœ‹é€šè¿‡ add_requires(\u0026quot;zlib\u0026quot;) é…ç½®çš„ä¾èµ–åŒ…ä¿¡æ¯ï¼Œæ¯”å¦‚æŸ¥çœ‹å®é™…çš„å®‰è£…è·¯å¾„ã€ç¼“å­˜ç›®å½•ã€å¯é€‰é…ç½®ä¿¡æ¯ç­‰ã€‚\nxmake require --info zlib\r ç›¸å…³çš„åŒ…ä¿¡æ¯è¯´æ˜å¯ä»¥å‚è€ƒä¸‹é¢çš„å›¾ç‰‡ã€‚\nConan ä»“åº“ä¾èµ–åŒ…çš„é›†æˆ è™½ç„¶ xmake å†…ç½®çš„åŒ…ä»“åº“åŠŸèƒ½å·²ç»å¾ˆå®Œå–„ï¼Œä½†æ¯•ç«Ÿç”Ÿæ€è¿˜æ²¡å®Œå…¨å»ºç«‹èµ·æ¥ï¼Œæ”¶å½•çš„åŒ…è¿˜ä¸æ˜¯å¾ˆå¤šï¼Œå¦‚æœç”¨æˆ·éœ€è¦çš„ C/C++ ä¾èµ–åŒ…åœ¨æˆ‘ä»¬çš„åŒ…ä»“åº“ä¸­æ‰¾ä¸åˆ°ï¼Œé‚£ä¹ˆè¿˜å¯ä»¥ç›´æ¥é›†æˆä½¿ç”¨ç¬¬ä¸‰æ–¹ä»“åº“ä¸­æä¾›çš„åŒ…ï¼Œä¾‹å¦‚ï¼šConanã€Vcpkgã€Homebrew ç­‰ä»“åº“ï¼Œxmake éƒ½æ˜¯æ”¯æŒçš„ã€‚\nè¿™é‡Œæˆ‘ä»¬æ¥é‡ç‚¹å°è¯•ä¸‹é›†æˆ Conan ä¸­æä¾›çš„åŒ…ï¼Œå› ä¸ºç›¸æ¯” Vcpkgã€Homebrew ç­‰ä»“åº“ï¼ŒConan æ”¯æŒæ›´åŠ å®Œå–„ï¼Œä¸ä»…è‡ªèº«è·¨å¹³å°ï¼Œæä¾›çš„åŒ…ä¹Ÿæ˜¯æ”¯æŒå¤šä¸ªä¸åŒå¹³å°çš„ï¼Œæ”¶å½•çš„åŒ…æ•°é‡ä¹Ÿéå¸¸å¤šã€‚\nåœ¨ä½¿ç”¨ Conan ä¹‹å‰ï¼Œé¦–å…ˆéœ€è¦å®‰è£…å®ƒåˆ°ç³»ç»Ÿç¯å¢ƒä¸­ï¼Œç”±äº conan æ˜¯åŸºäº python çš„ï¼Œå› æ­¤å¯ä»¥é€šè¿‡ pip å·¥å…·æ¥å®‰è£…å®ƒï¼Œåªéœ€è¦æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ã€‚\nsudo pip install --upgrade pip\rsudo pip install conan\rsource ~/.profile\r ç„¶åæˆ‘ä»¬å¯ä»¥é€šè¿‡æ‰§è¡Œ conan --version ç¡®è®¤ä¸‹æ˜¯å¦å®‰è£…æˆåŠŸï¼Œå¦‚æœæˆåŠŸï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°å¯¹åº”çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œå¦‚å›¾ã€‚\næ¥ä¸‹æ¥ï¼Œä½¿ç”¨ vim ç¼–è¾‘ä¹‹å‰çš„ crc32/xmake.lua æ–‡ä»¶ï¼Œæ”¹æˆå¦‚ä¸‹é…ç½®ã€‚\nadd_requires(\u0026quot;CONAN::zlib/1.2.11@conan/stable\u0026quot;, {alias = \u0026quot;zlib\u0026quot;})\rtarget(\u0026quot;crc32\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.c\u0026quot;)\radd_packages(\u0026quot;zlib\u0026quot;)\r è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ CONAN:: ä½œä¸º conan åŒ…ä»“åº“çš„å‘½åç©ºé—´ï¼Œè®© xmake å°†å…¶ä½œä¸º conan ä¾èµ–åŒ…æ¥å¤„ç†åç»­çš„æ¢æµ‹ã€ä¸‹è½½å’Œå®‰è£…é€»è¾‘ã€‚xmake å†…éƒ¨ä¼šè‡ªåŠ¨è°ƒç”¨ conan å»å®‰è£…æŒ‡å®šçš„ zlib åŒ…ï¼Œå¹¶ä¸”é›†æˆè¿›æ¥ï¼Œå› æ­¤è¿™é‡Œçš„ zlib/1.2.11@conan/stable åŒ…æè¿°æ ¼å¼ä¹Ÿæ˜¯å®Œå…¨åŸºäº conan è‡ªèº«çš„è§„èŒƒï¼Œå¤§å®¶å¯ä»¥ç›´æ¥åˆ° conan å®˜æ–¹æ–‡æ¡£ æŸ¥çœ‹å¦‚ä½•è®¾ç½®ã€‚\nè€Œåé¢çš„ {alias = \u0026quot;zlib\u0026quot;} éƒ¨åˆ†æ˜¯ add_requires æ¥å£å¯¹äºæ¯ä¸ªåŒ…çš„æ‰©å±•é…ç½®ï¼Œè¿™é‡Œ alias ç”¨æ¥è®¾ç½®åŒ…çš„åˆ«åï¼Œæ–¹ä¾¿ä¹‹åæ¯ä¸ª target ä¸­æ›´åŠ ç²¾ç®€çš„å»é›†æˆï¼Œä¾‹å¦‚ï¼šadd_packages(\u0026quot;zlib\u0026quot;)ï¼Œè€Œä¸æ˜¯æ¯æ¬¡éƒ½æ˜¯ç”¨å…¨åã€‚\né…ç½®å®Œæˆåï¼Œæ‰§è¡Œ xmake å»ç¼–è¯‘è¿™ä¸ªé›†æˆäº† conan ä¾èµ–åŒ…çš„é¡¹ç›®ï¼Œæ•´ä¸ªä¾èµ–åŒ…çš„ä¸‹è½½å®‰è£…æµç¨‹ï¼Œè·Ÿä¹‹å‰å®Œå…¨ä¸€è‡´ï¼Œå¦‚å›¾ã€‚\nå¦‚æœå®‰è£…æˆåŠŸï¼Œå¯ä»¥ç»§ç»­æ‰§è¡Œ xmake -rv æ¥æŸ¥çœ‹ xmake å®é™…é“¾æ¥çš„ conan åŒ…è·¯å¾„ä¿¡æ¯ã€‚\né€šè¿‡ä¸Šå›¾å¯ä»¥çœ‹åˆ°ï¼Œxmake ç›´æ¥å¼•ç”¨äº†å®‰è£…åœ¨ conan è‡ªèº«ä»“åº“ç›®å½•ä¸‹çš„ zlib åº“ï¼Œè¯´æ˜æ•´ä¸ªé›†æˆæµç¨‹å·²ç»é€šè¿‡ã€‚\nå®éªŒæ€»ç»“ åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬ä¸»è¦å­¦ä¹ äº†å¦‚ä½•æŸ¥æ‰¾é›†æˆä¾èµ–åº“ï¼Œå¦‚ä½•é›†æˆä½¿ç”¨ xmake å®˜æ–¹åŒ…ä»“åº“ä¸­æä¾›çš„ C/C++ ä¾èµ–åŒ…ï¼Œå¦å¤–æˆ‘ä»¬ä¹Ÿå­¦ä¹ äº†å¦‚ä½•æ¥å…¥ Conan ç­‰ç¬¬ä¸‰æ–¹åŒ…ä»“åº“ä¸­çš„ä¾èµ–åŒ…ã€‚\næœ¬å®éªŒçš„å‚è€ƒä»£ç å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ä¸‹è½½ï¼š\nwget https://labfile.oss.aliyuncs.com/courses/2764/code4.zip\r ","id":63,"section":"categories","summary":"C/C++ ä¾èµ–åŒ…çš„é›†æˆå’Œä½¿ç”¨ åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å­¦ä¹ åˆ°å¦‚ä½•å¿«é€Ÿé›†æˆç¬¬ä¸‰æ–¹çš„ C/C++ ä¾èµ–åŒ…ï¼Œä»¥åŠä¸ç¬¬ä¸‰æ–¹åŒ…ä»“åº“çš„æ¥å…¥é›†æˆã€‚ çŸ¥è¯†ç‚¹ xmake åŒ…ç®¡ç†çš„æ•´ä½“æ¶æ„æµç¨‹ ç³»ç»Ÿ","tags":["xmake"],"title":"å®éªŒ2C/C++ ä¾èµ–åŒ…çš„é›†æˆå’Œä½¿ç”¨","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/app/xmake/%E8%93%9D%E6%A1%A5%E7%BD%91%E8%AF%BE/1xmake%E5%85%A5%E9%97%A8/002ccpp%E4%BE%9D%E8%B5%96%E5%8C%85%E7%9A%84%E9%9B%86%E6%88%90%E5%92%8C%E4%BD%BF%E7%94%A8/","year":"2021"},{"content":"C_C++é¡¹ç›® åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å­¦ä¹ åˆ°ä¸€äº›ç¼–è¯‘å™¨å’Œé“¾æ¥å™¨ç›¸å…³çš„åŸºæœ¬æ¦‚å¿µï¼Œå¹¶ä¸”æŒæ¡ xmake.lua ä¸­çš„ä¸€äº›åŸºç¡€é…ç½®ï¼Œæ¯”å¦‚ï¼šC/C++ å¤´æ–‡ä»¶ã€é“¾æ¥åº“çš„é…ç½®ï¼Œç¼–è¯‘ä¼˜åŒ–çš„ç›¸å…³é…ç½®ï¼Œæºæ–‡ä»¶çš„æ¨¡å¼åŒ¹é…ç­‰ç­‰ã€‚\nçŸ¥è¯†ç‚¹  ç¼–è¯‘å™¨ã€é“¾æ¥å™¨åŸºç¡€æ¦‚å¿µ xmake.lua åŸºæœ¬é…ç½®å’Œä¿®æ”¹ ç¼–è¯‘ä¼˜åŒ–ç›¸å…³é€‰é¡¹çš„é…ç½® C/C++ å¤´æ–‡ä»¶ã€é“¾æ¥åº“ç›¸å…³é…ç½® C/C++ æºæ–‡ä»¶çš„æ·»åŠ å’Œè¿‡æ»¤é…ç½®  åœ¨è®²è§£æœ¬èŠ‚å®éªŒä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆç®€å•äº†è§£ä¸‹ C/C++ ç¨‹åºçš„å¤§è‡´æ„å»ºæµç¨‹ï¼Œå®ƒä¸»è¦åˆ†ä¸ºï¼šé¢„ç¼–è¯‘ã€ç¼–è¯‘å’Œé“¾æ¥ä¸‰ä¸ªé˜¶æ®µï¼Œè€Œè¿™ä¸‰ä¸ªé˜¶æ®µä¼šä½¿ç”¨ä¸åŒçš„å·¥å…·å»å¤„ç†ã€‚\n é¢„ç¼–è¯‘ï¼šä½¿ç”¨é¢„ç¼–è¯‘å™¨å»å¤„ç† C/C++ æºæ–‡ä»¶ä¸­å¤´æ–‡ä»¶ã€å®å®šä¹‰ç­‰ã€‚ ç¼–è¯‘ï¼šä½¿ç”¨ç¼–è¯‘å™¨å¯¹å¤„ç†åçš„ C/C++ æºæ–‡ä»¶è¿›è¡Œæºç ç¼–è¯‘ç”Ÿæˆ .o å¯¹è±¡æ–‡ä»¶ã€‚ é“¾æ¥ï¼šä½¿ç”¨é“¾æ¥å™¨å°†ç¼–è¯‘ç”Ÿæˆçš„ .o å¯¹è±¡æ–‡ä»¶è¿›è¡Œå®Œæ•´é“¾æ¥ç”Ÿæˆæœ€ç»ˆçš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚  å¤§è‡´çš„ç¼–è¯‘é“¾æ¥æµç¨‹å¯ä»¥å‚è€ƒä¸‹å›¾ã€‚\nä»å›¾ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°é“¾æ¥å™¨é™¤äº†ä¼šå»é“¾æ¥æ‰€æœ‰ .o å¯¹è±¡æ–‡ä»¶å¤–ï¼Œå¦‚æœæä¾›äº† .a é™æ€åº“å’Œ .so åŠ¨æ€åº“ï¼Œé‚£ä¹ˆé“¾æ¥å™¨ä¹Ÿä¼šå¯¹å®ƒä»¬è¿›è¡Œé“¾æ¥ã€‚\né€šå¸¸æˆ‘ä»¬ä½¿ç”¨çš„ä¸€äº›ç¬¬ä¸‰æ–¹ C/C++ åº“ä»¥åŠç³»ç»Ÿåº“ï¼Œéƒ½æ˜¯é€šè¿‡é™æ€åº“æˆ–è€…åŠ¨æ€åº“çš„æ–¹å¼æä¾›ï¼Œè¿™ä¸¤è€…çš„åŒºåˆ«åœ¨äºï¼š\n é™æ€åº“ï¼šé“¾æ¥åä¼šç›´æ¥æŠŠé‡Œé¢æ‰€æœ‰çš„ä»£ç éƒ½åˆå¹¶ç”Ÿæˆåˆ°å¯æ‰§è¡Œç¨‹åºä¸­ã€‚ åŠ¨æ€åº“ï¼šé“¾æ¥åä»…ä»…å°†åŠ¨æ€åº“ä¸­å¯¼å‡ºçš„å‡½æ•°æä¾›ç»™å¯æ‰§è¡Œç¨‹åºè°ƒç”¨ï¼Œå®é™…è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œè¿˜æ˜¯ä¼šå•ç‹¬åŠ è½½è¿™ä¸ªåŠ¨æ€åº“ã€‚  å› æ­¤ï¼Œä½¿ç”¨é™æ€åº“å®Œæ•´é“¾æ¥åçš„ç¨‹åºå¤§å°é€šå¸¸æ¯”ä½¿ç”¨åŠ¨æ€åº“çš„ç¨‹åºå¤§å¾ˆå¤šï¼Œä½†è¿™ä¹Ÿæœ‰è‡ªå·±çš„ä¼˜åŠ¿ï¼Œå°±æ˜¯ä¾èµ–å°‘ã€ä¾¿äºå‡çº§ç»´æŠ¤å’Œéƒ¨ç½²ã€‚\nç¼–è¯‘å™¨å’Œé“¾æ¥å™¨ ç›®å‰å¸‚é¢ä¸Šå¸¸ç”¨çš„ç¼–è¯‘å™¨æœ‰ï¼šgccï¼Œclangï¼Œmsvc ç­‰ï¼Œè€Œè¿™é‡Œä¸»è¦ä½¿ç”¨ gcc ä½œä¸ºæˆ‘ä»¬çš„ç¼–è¯‘å™¨ï¼Œå¯ä»¥åœ¨ä¹‹å‰çš„ hello å·¥ç¨‹ä¸‹æ‰§è¡Œ xmake -rv æŸ¥çœ‹å½“å‰ä½¿ç”¨çš„ç¼–è¯‘å™¨å’Œé“¾æ¥å™¨ã€‚\nä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼Œgcc å°±æ˜¯æˆ‘ä»¬å½“å‰ä½¿ç”¨çš„ç¼–è¯‘å™¨ï¼Œå®ƒå¯ä»¥ç›´æ¥ç¼–è¯‘ .cpp æºæ–‡ä»¶åˆ° .o æ–‡ä»¶ï¼Œè€Œ g++ å°±æ˜¯æˆ‘ä»¬ä½¿ç”¨çš„é“¾æ¥å™¨ï¼Œç”¨æ¥å°†æ‰€æœ‰ç”Ÿæˆçš„ .o æ–‡ä»¶é“¾æ¥æˆå¯æ‰§è¡Œæ–‡ä»¶ã€‚\nå…¶ä¸­éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå…¶å® g++ ä¹Ÿä»…ä»…åªæ˜¯ä¸ªç¼–è¯‘å™¨å‰ç«¯ï¼Œå®ƒå®é™…ä¸Šä¼šå»å†…éƒ¨è°ƒç”¨çœŸå®çš„ ld é“¾æ¥å™¨ç¨‹åºï¼Œç›¸æ¯”ç›´æ¥ä½¿ç”¨ ldï¼Œæˆ‘ä»¬ä½¿ç”¨ g++ æ¥é“¾æ¥çš„ä¸€ä¸ªå¥½å¤„æ˜¯ï¼Œå®ƒä¼šè‡ªåŠ¨æœç´¢å’Œé“¾æ¥å†…ç½®æä¾›çš„ libc++ ç­‰ä¾èµ–åº“ï¼Œè¿™ä¼šçœäº‹ä¸å°‘ï¼Œä¹Ÿæ›´é€šç”¨ï¼Œå¦åˆ™å¦‚æœç›´æ¥ä½¿ç”¨ ld çš„è¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªèƒ½è‡ªå·±å¤„ç†å¯¹è¿™äº›ä¾èµ–çš„æœç´¢è·¯å¾„ç­‰é…ç½®é€‰é¡¹äº†ã€‚\nè€Œå…³äºå®é™…çš„å†…éƒ¨é“¾æ¥å™¨ï¼Œæ¯”è¾ƒå¸¸ç”¨çš„æœ‰ ld.bfdã€ld.gold å’Œ lldï¼Œå…¶ä¸­ bfd ç”¨çš„æœ€å¤šï¼Œè€Œ lld æ˜¯ llvm æ–°å‡ºçš„é“¾æ¥å™¨ï¼Œé“¾æ¥é€Ÿåº¦æ›´åŠ å¿«ï¼Œå…³äºè¿™å—ç»†èŠ‚ä¸æœ¬å®éªŒå…³ç³»ä¸å¤§ï¼Œå°±ä¸å†è¿‡å¤šå±•å¼€è®¨è®ºäº†ã€‚\nxmake.lua åŸºç¡€é…ç½® æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¼€å§‹é€ä¸€ä»‹ç» xmake çš„é…ç½®æ–‡ä»¶ xmake.lua é‡Œé¢çš„ä¸€äº›åŸºç¡€é…ç½®æ¥å£ä½¿ç”¨æ–¹å¼ï¼Œåªè¦å¤§æ¦‚æŒæ¡äº†è¿™äº›é…ç½®ï¼ŒåŸºæœ¬ä¸Šå¸¸è§„çš„ C/C++ é¡¹ç›®ç¼–è¯‘å’Œç»´æŠ¤éƒ½èƒ½å¿«é€Ÿæå®šäº†ã€‚\né…ç½®ç›®æ ‡ç±»å‹ é¦–å…ˆï¼Œæˆ‘ä»¬æ¥ä»‹ç»ä¸‹ xmake æ”¯æŒçš„å‡ ç§åŸºç¡€ç›®æ ‡ç±»å‹ï¼Œç›®å‰ä¸»è¦ä¹Ÿå°±æ˜¯å››ç§ç±»å‹ã€‚\n   å€¼ æè¿°     phony ç©ºç›®æ ‡ç¨‹åº   binary äºŒè¿›åˆ¶ç¨‹åº   static é™æ€åº“ç¨‹åº   shared åŠ¨æ€åº“ç¨‹åº    å¯æ‰§è¡Œç¨‹åºç±»å‹ æ¯”å¦‚æˆ‘ä»¬ä¹‹å‰ä¸€ç›´åœ¨ç”¨çš„å¯æ‰§è¡Œç›®æ ‡ç¨‹åºç±»å‹ binaryï¼Œå¯ä»¥é€šè¿‡ set_kind(\u0026quot;binary\u0026quot;) æ¥è®¾ç½®ï¼Œå¦‚ä¸‹é¢çš„é…ç½®ã€‚\ntarget(\u0026quot;hello\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\r é™æ€åº“ç¨‹åºç±»å‹ æˆ‘ä»¬æ¥ä¸‹æ¥å°è¯•ç¼–è¯‘ç”Ÿæˆä¸€ä¸ªå¸¦æœ‰é™æ€åº“çš„ç›®æ ‡ç¨‹åºï¼Œç›´æ¥ä½¿ç”¨ xmake æ¥åˆ›å»ºä¸ªç©ºå·¥ç¨‹ï¼Œä¾‹å¦‚ã€‚\ncd ~/Code\rxmake create -t static hello_static\r -t static å‚æ•°ç”¨äºæŒ‡å®šå½“å‰å·¥ç¨‹ç±»å‹ä¸ºé™æ€åº“ï¼Œåé¢æ˜¯å·¥ç¨‹é¡¹ç›®åï¼Œç”Ÿæˆåçš„é¡¹ç›®ç»“æ„å¦‚ä¸‹ã€‚\nå…¶ä¸­ï¼Œé¡¹ç›®æ ¹ç›®å½•ä¸‹è¿˜æ˜¯ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ª xmake.lua ç”¨äºç»´æŠ¤æ•´ä¸ªé¡¹ç›®æ„å»ºï¼Œè€Œ src æºç ç›®å½•ä¸‹ interface.cpp å°±æ˜¯ç”¨æ¥å‚ä¸é™æ€åº“ç¼–è¯‘ï¼Œmain.cpp ç”¨æ¥ç”Ÿæˆå¯æ‰§è¡Œç¨‹åºï¼Œåœ¨é‡Œé¢è°ƒç”¨é™æ€åº“çš„æ¥å£ã€‚\næˆ‘ä»¬å¯ä»¥è¿›å…¥ hello_static é¡¹ç›®æ ¹ç›®å½•åï¼Œæ‰§è¡Œ gvim ./xmake.lua æŸ¥çœ‹ä¸‹é‡Œé¢çš„å†…å®¹ï¼Œå¤§è‡´å¦‚ä¸‹ã€‚\né‡Œé¢æœ‰ä¸¤ä¸ªç¼–è¯‘ç›®æ ‡ï¼Œé€šè¿‡ target() å®šä¹‰ç»´æŠ¤ï¼Œä¸€ä¸ªæ˜¯ static é™æ€åº“ç±»å‹ï¼Œä¸€ä¸ªæ˜¯ binary å¯æ‰§è¡Œç¨‹åºç±»å‹ï¼Œå®ƒä»¬ä¹‹é—´é€šè¿‡ add_deps(\u0026quot;hello_static\u0026quot;) è¿›è¡Œä¾èµ–å…³è”ï¼Œè¿™æ · xmake åœ¨ç¼–è¯‘çš„æ—¶å€™ï¼Œä¼šä¼˜å…ˆç¼–è¯‘ä¾èµ–çš„é™æ€åº“ï¼Œå¹¶ä¸”æŠŠé™æ€åº“è‡ªåŠ¨é›†æˆåˆ°å¯¹åº”çš„å¯æ‰§è¡Œç¨‹åºä¸Šå»ã€‚\næ‰§è¡Œ xmake å¯¹è¿™ä¸ªå·¥ç¨‹è¿›è¡Œç¼–è¯‘ï¼Œå¦‚æœè¾“å‡ºç»“æœè·Ÿä¸‹å›¾åŸºæœ¬ä¸€è‡´ï¼Œè¯´æ˜æˆ‘ä»¬æˆåŠŸç”Ÿæˆäº†ä¸€ä¸ªé“¾æ¥é™æ€åº“çš„ç›®æ ‡ç¨‹åºã€‚\nç„¶åæˆ‘ä»¬æ‰§è¡Œ xmake run è¿è¡Œä¸‹è¿™ä¸ªç¨‹åºã€‚\nåŠ¨æ€åº“ç¨‹åºç±»å‹ åŠ¨æ€åº“çš„åˆ›å»ºè·Ÿé™æ€åº“ç±»ä¼¼ï¼Œåªéœ€è¦æŠŠç±»å‹åæ”¹æˆ shared å°±è¡Œäº†ï¼Œä¾‹å¦‚ã€‚\ncd ~/Code\rxmake create -t shared hello_shared\r ç”Ÿæˆçš„å·¥ç¨‹ç»“æ„å’Œ xmake.lua å†…å®¹éƒ½è·Ÿé™æ€åº“çš„åŸºæœ¬ä¸€è‡´ï¼Œå”¯ä¸€çš„åŒºåˆ«å°±æ˜¯ç›®æ ‡ç±»å‹å˜æˆäº† sharedã€‚\nadd_rules(\u0026quot;mode.debug\u0026quot;, \u0026quot;mode.release\u0026quot;)\rtarget(\u0026quot;hello_shared\u0026quot;)\rset_kind(\u0026quot;shared\u0026quot;) -- è®¾ç½®ä¸ºåŠ¨æ€åº“ç›®æ ‡ç¨‹åº\radd_files(\u0026quot;src/interface.cpp\u0026quot;)\rtarget(\u0026quot;hello_shared_demo\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_deps(\u0026quot;hello_shared\u0026quot;)\radd_files(\u0026quot;src/main.cpp\u0026quot;)\r ç„¶åæˆ‘ä»¬æ‰§è¡Œä¸‹ç¼–è¯‘å’Œè¿è¡Œã€‚\ncd hello_shared\rxmake\rxmake run\r ç¼–è¯‘è¿è¡Œç»“æœä¹Ÿè·Ÿé™æ€åº“åŸºæœ¬ä¸€è‡´ã€‚\nPhony ç›®æ ‡ç±»å‹ å…¶ä¸­ï¼Œphony æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ç›®æ ‡ç¨‹åºç±»å‹ï¼Œä½¿ç”¨å®ƒå®šä¹‰çš„ target ç›®æ ‡ä¸ä¼šç”Ÿæˆä»»ä½•å®é™…çš„ç¨‹åºæ–‡ä»¶ï¼Œä¹Ÿä¸ä¼šæ‰§è¡Œä»»ä½•ç¼–è¯‘æ“ä½œï¼Œé€šå¸¸ç”¨äºç»„åˆå…¶å®ƒç›®æ ‡ç¨‹åºçš„ä¾èµ–å…³ç³»ï¼Œå®ç°å…³è”ç¼–è¯‘ã€‚\nä¸ºäº†æ›´å¥½çš„ç†è§£ phony ç±»å‹ï¼Œæˆ‘ä»¬è¿™å›æ‰‹å·¥åˆ›å»ºä¸ªå¸¦æœ‰ phony ç›®æ ‡çš„å·¥ç¨‹è¿›è¡Œæµ‹è¯•ï¼Œé¦–å…ˆåˆ›å»ºä¸ªç©ºç›®å½•ã€‚\ncd ~/Code\rmkdir phony_test\rcd phony_test\r ç„¶åæ‰§è¡Œ vim ./xmake.lua ç¼–è¾‘ xmake.lua å†™å…¥ä¸‹é¢çš„å†…å®¹ã€‚\ntarget(\u0026quot;foo\u0026quot;)\rset_kind(\u0026quot;phony\u0026quot;)\r å¯ä»¥çœ‹åˆ°ï¼Œè¿™è¾¹æˆ‘ä»¬æ²¡æœ‰æ·»åŠ ä»»ä½•æºæ–‡ä»¶ï¼Œè¿™ä¸ª foo ç›®æ ‡ä»…ä»…åªæ˜¯ä¸ªç©ºç›®æ ‡ç¨‹åºï¼Œæ‰§è¡Œç¼–è¯‘ä¹Ÿæ˜¯ç©ºæ‰§è¡Œï¼Œä¸ä¼šæœ‰ä»»ä½•æºæ–‡ä»¶å‚ä¸ç¼–è¯‘ã€‚\nè€Œå…³äºä½¿ç”¨ phony ç›®æ ‡è·Ÿå…¶å®ƒç›®æ ‡ç¨‹åºçš„å…³è”ç¼–è¯‘ï¼Œæˆ‘ä»¬ä¼šåœ¨å®éªŒ 6 ã€Šxmake åŸºç¡€ä¹‹ç›®æ ‡ä¾èµ–ã€‹ä¸­è¯¦ç»†è®²è§£ã€‚\næ·»åŠ  C/C++ ç¼–è¯‘é€‰é¡¹ åœ¨å®éªŒ 2 ã€Šxmake çš„åŸºæœ¬å‘½ä»¤ä½¿ç”¨ã€‹ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº†é€šè¿‡å‘½ä»¤è¡Œçš„æ–¹å¼å¿«é€Ÿæ·»åŠ  C/C++ ç¼–è¯‘é€‰é¡¹ï¼Œä¸è¿‡è¿™ç§æ–¹å¼ä¸é€‚åˆæ°¸ä¹…ä¿å­˜å’Œå¯¹å¤–å‘å¸ƒï¼Œä»…ä»…ç”¨äºæœ¬åœ°ç¼–è¯‘ã€‚å¦‚æœæˆ‘ä»¬æƒ³å°†è‡ªå·±çš„é¡¹ç›®å‘å¸ƒåæä¾›ç»™å…¶ä»–ç”¨æˆ·ç¼–è¯‘ï¼Œé‚£ä¹ˆå°±éœ€è¦åœ¨ xmake.lua ä¸­å»è®¾ç½®è¿™äº›ç¼–è¯‘é€‰é¡¹ã€‚\nè¿›å…¥ä¹‹å‰åˆ›å»ºçš„ hello ç¨‹åºç›®å½•ï¼Œç„¶åä½¿ç”¨ vim xmake.lua ç¼–è¾‘é‡Œé¢çš„ xmake.lua æ–‡ä»¶ï¼Œä¿®æ”¹æˆå¦‚ä¸‹å†…å®¹ã€‚\nadd_rules(\u0026quot;mode.debug\u0026quot;, \u0026quot;mode.release\u0026quot;)\rtarget(\u0026quot;hello\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\radd_cxflags(\u0026quot;-DTEST1\u0026quot;)\r é€šè¿‡ add_cxflags(\u0026quot;-DTEST1\u0026quot;) è®¾ç½®å°±èƒ½å¯¹æ‰€æœ‰çš„ C/C++ ä»£ç å®šä¹‰ä¸Š TEST1 å®å¼€å…³ï¼Œç„¶åé€šè¿‡æ‰§è¡Œ xmake -v æŸ¥çœ‹å®Œæ•´ç¼–è¯‘å‘½ä»¤ä¸­ï¼Œæ˜¯å¦çœŸçš„ç”Ÿæ•ˆäº†ã€‚\nä¸Šå›¾ä¸­ï¼Œæˆ‘ä»¬ç¡®å®å¯ä»¥çœ‹åˆ° -DTEST1 è¢«ä¼ é€’åˆ°äº† gcc ç¼–è¯‘å™¨è¿›è¡Œå®å®šä¹‰ã€‚\nå¦å¤–åœ¨ä¸Šå›¾ä¸­ï¼Œæˆ‘ä»¬è¿˜çœ‹åˆ°äº†ä¸€äº›ç¼–è¯‘é€‰é¡¹çš„è‡ªåŠ¨æ£€æµ‹ï¼Œè¿™æ˜¯ç”±äºé€šè¿‡ add_cxflags() ç­‰è®¾ç½®æ¥å£æ·»åŠ çš„é€‰é¡¹éƒ½æ˜¯ç‰¹å®šæŸäº›ç¼–è¯‘å™¨çš„ï¼Œå¹¶ä¸ä¸€å®šæ˜¯å®Œå…¨è·¨ç¼–è¯‘é€šç”¨çš„ï¼Œå› æ­¤ xmake ä¼šå»æ£€æµ‹ç”¨æˆ·çš„è®¾ç½®ï¼Œå¦‚æœä¸æ”¯æŒçš„é€‰é¡¹è¢«è®¾ç½®è¿›å»ï¼Œxmake ä¼šæ£€æµ‹å¤±è´¥å¹¶æç¤ºè­¦å‘Šä¿¡æ¯ç„¶åå¿½ç•¥å®ƒã€‚\næ·»åŠ å®å®šä¹‰ é™¤äº†å¯ä»¥é€šè¿‡ add_cxflags æ–¹å¼æ·»åŠ å®å®šä¹‰ï¼Œå…¶å® xmake è¿˜æä¾›äº†å†…ç½®çš„é…ç½®æ¥å£ add_defines å»æ›´æ–¹ä¾¿è®¾ç½®å®ƒï¼Œè¿™ä¸ªé…ç½®æ¥å£ç›¸æ¯” add_cxflags ä½¿ç”¨åŸå§‹ç¼–è¯‘é€‰é¡¹çš„æ–¹å¼æ›´åŠ çš„é€šç”¨ï¼Œè·¨ç¼–è¯‘å™¨ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬æ›´åŠ æ¨èçš„é…ç½®æ–¹å¼ã€‚è¿™ä¸ªæ¥å£ä¼šè‡ªåŠ¨å¤„ç†å„ç§ç¼–è¯‘çš„æ”¯æŒæ–¹å¼ï¼Œæ‰€ä»¥ä¸ä¼šè§¦å‘ flags çš„è‡ªåŠ¨æ£€æµ‹æœºåˆ¶ï¼Œæ›´åŠ çš„å¿«é€Ÿå¯é ã€‚\næˆ‘ä»¬è¿˜æ˜¯åŸºäºä¹‹å‰çš„ hello é¡¹ç›®çš„é…ç½®ï¼Œåšä¸€äº›ä¿®æ”¹ï¼Œé€šè¿‡ add_defines(\u0026quot;TEST2\u0026quot;) æ·»åŠ æ–°çš„å®å®šä¹‰å¼€å…³ TEST2ã€‚\nadd_rules(\u0026quot;mode.debug\u0026quot;, \u0026quot;mode.release\u0026quot;)\rtarget(\u0026quot;hello\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\radd_cxflags(\u0026quot;-DTEST1\u0026quot;)\radd_defines(\u0026quot;TEST2\u0026quot;)\r ç„¶åï¼Œæˆ‘ä»¬é‡æ–°æ‰§è¡Œ xmake -v å»ç¼–è¯‘æŸ¥çœ‹æ–°å¢çš„å®å®šä¹‰æ˜¯å¦ç”Ÿæ•ˆï¼Œå¦‚å›¾ã€‚\nä»å›¾ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œç›¸æ¯”ä¹‹å‰çš„è¾“å‡ºï¼Œæ–°å¢åŠ äº†ä¸€ä¸ª -DTEST2 å®å®šä¹‰å‚æ•°é€‰é¡¹ä¼ å…¥äº† gccï¼Œè¯´æ˜æˆ‘ä»¬çš„é…ç½®ç¡®å®ç”Ÿæ•ˆäº†ã€‚\nå¤´æ–‡ä»¶è·¯å¾„å’Œé“¾æ¥åº“é…ç½® xmake ä¹Ÿæä¾›äº†æ–¹ä¾¿çš„é…ç½®æ¥å£å»é…ç½®å¤´æ–‡ä»¶æœç´¢è·¯å¾„ã€é“¾æ¥åº“ã€åº“æœç´¢è·¯å¾„ï¼Œåˆ†åˆ«æ˜¯å¦‚ä¸‹å‡ ä¸ªæ¥å£ã€‚\n add_includedirsï¼šæ·»åŠ å¤´æ–‡ä»¶æœç´¢ç›®å½•ã€‚ add_linkdirsï¼šæ·»åŠ åº“æœç´¢ç›®å½•ã€‚ add_linksï¼šæ·»åŠ é“¾æ¥åº“ã€‚ add_syslinksï¼šæ·»åŠ ç³»ç»Ÿé“¾æ¥åº“ã€‚  ä¸Šè¿°å‡ ä¸ªæ¥å£éƒ½æ˜¯è·¨ç¼–è¯‘å™¨é…ç½®ï¼Œç›¸æ¯”ç›´æ¥è®¾ç½®åˆ° ldflags æ›´åŠ çš„é€šç”¨ã€‚è‡³äº add_syslinks å’Œ add_links è¿™ä¸¤ä¸ªçš„åŒºåˆ«å°±æ˜¯ï¼šadd_syslinks é€šå¸¸ç”¨äºæ·»åŠ ä¸€äº›ç³»ç»Ÿä¾èµ–åº“ï¼Œæ¯”å¦‚ pthreadï¼Œè¿™æ · xmake ä¼šæŠŠè¿™äº›ç³»ç»Ÿåº“é“¾æ¥æ”¾ç½®çš„æ›´é åäº›ã€‚è¿™æ˜¯å› ä¸ºé“¾æ¥å™¨åœ¨å¤„ç†åº“é“¾æ¥æ—¶å€™ï¼Œæ˜¯ä¼šä¾èµ–é¡ºåºçš„ï¼Œæ”¾ç½®åœ¨æœ€å·¦è¾¹çš„é“¾æ¥ä¼šä¼˜å…ˆå¤„ç†ï¼Œä¾‹å¦‚ libfoo åº“ä¾èµ– libpthread åº“ä¸­çš„ç¬¦å·ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¿…é¡»ä¸¥æ ¼æŒ‰ç…§è¿™ä¸ªé¡ºåºæ·»åŠ é“¾æ¥åº“ä¾èµ– -lfoo -lpthreadï¼Œå¦åˆ™é“¾æ¥å™¨å°±ä¼šæŠ¥æ‰¾ä¸åˆ° pthread åº“ç¬¦å·çš„é”™è¯¯ã€‚\nè€Œé“¾æ¥åº“å’Œå¤´æ–‡ä»¶æœç´¢è·¯å¾„ï¼Œé¡¾åæ€ä¹‰ï¼Œå°±æ˜¯è®¾ç½®åå‘Šè¯‰ç¼–è¯‘å™¨ã€é“¾æ¥å™¨åº”è¯¥ä»è¿™äº›ç›®å½•ä½ç½®å°è¯•æŸ¥æ‰¾æŒ‡å®šçš„é“¾æ¥åº“å’Œå¤´æ–‡ä»¶ã€‚\nç»§ç»­é…ç½® hello å·¥ç¨‹ä¸­çš„ xmake.lua æ–‡ä»¶ã€‚\nadd_rules(\u0026quot;mode.debug\u0026quot;, \u0026quot;mode.release\u0026quot;)\rtarget(\u0026quot;hello\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\radd_cxflags(\u0026quot;-DTEST1\u0026quot;)\radd_defines(\u0026quot;TEST2\u0026quot;)\radd_links(\u0026quot;z\u0026quot;)\radd_syslinks(\u0026quot;pthread\u0026quot;)\radd_linkdirs(\u0026quot;/tmp\u0026quot;)\radd_includedirs(\u0026quot;/tmp\u0026quot;)\r ç„¶åæ‰§è¡Œ xmake -v æŸ¥çœ‹ç¼–è¯‘è¾“å‡ºï¼Œé‡Œé¢çš„çº¢æ¡†éƒ¨åˆ†å°±æ˜¯æ–°è®¾ç½®çš„ç¼–è¯‘é€‰é¡¹ï¼š\n -I/tmpï¼šæ·»åŠ å¤´æ–‡ä»¶æœç´¢è·¯å¾„ã€‚ -L/tmpï¼šæ·»åŠ é“¾æ¥åº“æœç´¢è·¯å¾„ã€‚ -lz -lpthreadï¼šæ·»åŠ çš„é“¾æ¥åº“ï¼Œç”±äºæˆ‘ä»¬æ˜¯é€šè¿‡ add_links æ·»åŠ çš„ zlib åº“ï¼Œè€Œ pthread åº“æ˜¯ä½œä¸ºç³»ç»Ÿåº“æ·»åŠ çš„ï¼Œæ‰€ä»¥è¢«æ”¾ç½®åœ¨ pthread çš„å·¦è¾¹ä¼˜å…ˆé“¾æ¥ã€‚  è®¾ç½®è¯­è¨€æ ‡å‡† æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ set_languages æ¥å£è®¾ç½®ç›®æ ‡ä»£ç ç¼–è¯‘æ—¶å€™çš„è¯­è¨€æ ‡å‡†ï¼Œæ¯”å¦‚æ˜¯åŸºäº c99 æ ‡å‡†ï¼Œè¿˜æ˜¯ c++11ã€c++14 æ ‡å‡†ç­‰ã€‚\nç›®å‰ xmake æ”¯æŒçš„è¯­è¨€æ ‡å‡†ä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªï¼š\n   å€¼ æè¿°     ansi c è¯­è¨€æ ‡å‡†: ansi   c89 c è¯­è¨€æ ‡å‡†: c89   gnu89 c è¯­è¨€æ ‡å‡†: gnu89   c99 c è¯­è¨€æ ‡å‡†: c99   gnu99 c è¯­è¨€æ ‡å‡†: gnu99   c++98 c++ è¯­è¨€æ ‡å‡†: c++98   gnu++98 c++ è¯­è¨€æ ‡å‡†: gnu++98   c++11 c++ è¯­è¨€æ ‡å‡†: c++11   gnu++11 c++ è¯­è¨€æ ‡å‡†: gnu++11   c++14 c++ è¯­è¨€æ ‡å‡†: c++14   gnu++14 c++ è¯­è¨€æ ‡å‡†: gnu++14   c++1z c++ è¯­è¨€æ ‡å‡†: c++1z   gnu++1z c++ è¯­è¨€æ ‡å‡†: gnu++1z   c++17 c++ è¯­è¨€æ ‡å‡†: c++17   gnu++17 c++ è¯­è¨€æ ‡å‡†: gnu++17    å¹¶ä¸” c æ ‡å‡†å’Œ c++ æ ‡å‡†å¯åŒæ—¶è¿›è¡Œè®¾ç½®ï¼Œä¾‹å¦‚ï¼š\n-- è®¾ç½® c ä»£ç æ ‡å‡†ï¼šc99ï¼Œ c++ ä»£ç æ ‡å‡†ï¼šc++11\rset_languages(\u0026quot;c99\u0026quot;, \u0026quot;c++11\u0026quot;)\r å°†è¿™ä¸ªé…ç½®æ·»åŠ åˆ°åˆšåˆšä¿®æ”¹çš„ xmake.lua æ–‡ä»¶ä¸­å»ï¼Œå°±è·Ÿä¸Šä¸€èŠ‚çš„é…ç½®æ–¹å¼ä¸€æ ·ï¼Œæ”¾ç½®åˆ° target(\u0026quot;hello\u0026quot;) é…ç½®åŸŸä¸‹é¢ï¼Œç„¶åæ‰§è¡Œ xmake -v çœ‹ä¸‹ç¼–è¯‘è¾“å‡ºç»“æœã€‚\nç”±äºå½“å‰æ²¡ C ä»£ç ï¼Œæ‰€ä»¥å®é™…åªæœ‰ C++11 çš„æ ‡å‡†è®¾ç½®ç”Ÿæ•ˆäº†ï¼Œä¹Ÿå°±æ˜¯ä¸Šå›¾çº¢æ¡†ä½ç½®çš„ç¼–è¯‘é€‰é¡¹ -std=c++11ã€‚\nè®¾ç½®ç¼–è¯‘ä¼˜åŒ– å…¶å®ï¼Œxmake é»˜è®¤åˆ›å»ºçš„å·¥ç¨‹ xmake.lua æ–‡ä»¶ä¸­ï¼Œå·²ç»è®¾ç½®äº† add_rules(\u0026quot;mode.debug\u0026quot;, \u0026quot;mode.release\u0026quot;) è¿™ä¸¤ä¸ªç¼–è¯‘è§„åˆ™ï¼Œè€Œé»˜è®¤ xmake ç¼–è¯‘å°±æ˜¯ release æ¨¡å¼ç¼–è¯‘ï¼Œå®ƒä¼šå¼€å¯æ‰€æœ‰å†…ç½®çš„ç¼–è¯‘ä¼˜åŒ–é€‰é¡¹ï¼Œå¹¶ä¸éœ€è¦ç”¨æˆ·è®¾ç½®ä»€ä¹ˆã€‚\nä¸Šå›¾çº¢æ¡†çš„éƒ¨åˆ†éƒ½æ˜¯ç¼–è¯‘ä¼˜åŒ–ç›¸å…³çš„ä¸€äº›é€‰é¡¹ï¼Œæ¯”å¦‚æœ€ç›´æ¥çš„ -O3 ä¼˜åŒ–ï¼Œè¿˜æœ‰ -fvisibility=hidden -fvisibility-inlines-hidden ç”¨äºå»é‡ä¸€äº›ç¬¦å·å­—ç¬¦ä¸²æ•°æ®ï¼Œä½¿å¾—ç¼–è¯‘åçš„ç¨‹åºæ›´å°ã€‚\nå½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä¸ä½¿ç”¨ xmake æä¾›çš„å†…ç½®ç¼–è¯‘è§„åˆ™ï¼Œè‡ªå·±æ§åˆ¶åº”è¯¥å¦‚ä½•ä¼˜åŒ–ç¼–è¯‘ï¼Œæ¯”å¦‚ç»§ç»­æ”¹æˆä¸‹é¢é…ç½®ã€‚\ntarget(\u0026quot;hello\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/*.cpp\u0026quot;)\radd_cxflags(\u0026quot;-DTEST1\u0026quot;)\radd_defines(\u0026quot;TEST2\u0026quot;)\radd_links(\u0026quot;z\u0026quot;)\radd_syslinks(\u0026quot;pthread\u0026quot;)\radd_linkdirs(\u0026quot;/tmp\u0026quot;)\radd_includedirs(\u0026quot;/tmp\u0026quot;)\rset_languages(\u0026quot;c99\u0026quot;, \u0026quot;c++11\u0026quot;)\rif is_mode(\u0026quot;release\u0026quot;) then\rset_optimize(\u0026quot;fastest\u0026quot;)\rset_strip(\u0026quot;all\u0026quot;)\rset_symbols(\u0026quot;hidden\u0026quot;)\rend\r æˆ‘ä»¬å»é™¤äº† mode.release çš„ç¼–è¯‘è§„åˆ™ï¼Œé€šè¿‡ is_mode(\u0026quot;release\u0026quot;) è‡ªå·±åˆ¤æ–­å’Œæ§åˆ¶ä¼˜åŒ–ç¼–è¯‘ï¼Œå¯ä»¥è¾¾åˆ°è·Ÿä¹‹å‰ä¸€æ ·çš„ä¼˜åŒ–æ•ˆæœã€‚\nå…¶ä¸­ set_optimize(\u0026quot;fastest\u0026quot;) å°±æ˜¯æ·»åŠ  -O3 çš„ç¼–è¯‘ä¼˜åŒ–å¼€å…³ï¼Œè€Œ set_strip(\u0026quot;all\u0026quot;) å’Œ set_symbols(\u0026quot;hidden\u0026quot;) ç”¨äºå»æ‰è°ƒè¯•ç¬¦å·æ•°æ®ï¼Œä½¿å¾—ç¨‹åºæ›´å°ã€‚\né…ç½®å®Œæˆä»¥åå†æ‰§è¡Œ xmake -v çœ‹çœ‹ï¼Œæœ€åçš„ç¼–è¯‘è¾“å‡ºé‡Œé¢è¿™äº›ç¼–è¯‘ä¼˜åŒ–é€‰é¡¹è¿˜æ˜¯åŒæ ·å­˜åœ¨çš„ã€‚\næ·»åŠ æºæ–‡ä»¶ åœ¨æœ¬å®éªŒæœ€åï¼Œå†è®²è§£ä¸‹å¦‚ä½•æ·»åŠ æºæ–‡ä»¶å‚ä¸ç¼–è¯‘ï¼Œå…¶å®ä¹‹å‰çš„é…ç½®ä¸­ï¼Œæˆ‘ä»¬å·²ç»å¤§æ¦‚çŸ¥é“ï¼Œå¯ä»¥é€šè¿‡ä½¿ç”¨ add_files æ¥å£æ¥æ·»åŠ æºæ–‡ä»¶ï¼Œè¿™é‡Œè¿›ä¸€æ­¥äº†è§£ä¸‹è¿™ä¸ªé…ç½®æ¥å£çš„ä½¿ç”¨ã€‚\nå…¶å®è¿™ä¸ªæ¥å£è¿˜æ˜¯å¾ˆå¼ºå¤§çš„ï¼Œä¸ä»…ä»…æ”¯æŒå•ä¸ªæºæ–‡ä»¶çš„æ·»åŠ ï¼Œè¿˜å¯ä»¥æ”¯æŒé€šè¿‡æ¨¡å¼åŒ¹é…çš„æ–¹å¼æ‰¹é‡æ·»åŠ æºæ–‡ä»¶ï¼Œå¹¶ä¸”æ”¯æŒåŒæ—¶æ·»åŠ ä¸åŒè¯­è¨€çš„æºæ–‡ä»¶ï¼Œä¸è¿‡è¿™é‡Œä¸»è¦è®²è§£å¯¹ C/C++ æºæ–‡ä»¶çš„æ·»åŠ ã€‚\næˆ‘ä»¬å…ˆæ¥çœ‹ä¸ªå®ä¾‹ï¼Œç®€å•äº†è§£ä¸‹ç”¨æ³•ã€‚\nadd_files(\u0026quot;src/test_*.c\u0026quot;, \u0026quot;src/**.cpp\u0026quot;)\r å…¶ä¸­é€šé…ç¬¦ * è¡¨ç¤ºåŒ¹é…å½“å‰ç›®å½•ä¸‹æºæ–‡ä»¶ï¼Œè€Œ ** åˆ™é€’å½’åŒ¹é…å¤šçº§ç›®å½•ä¸‹çš„æºæ–‡ä»¶ã€‚\nåœ¨ä¹‹å‰çš„é…ç½®ä¸­ï¼Œæˆ‘ä»¬æ˜¯ç”¨ add_files(\u0026quot;src/*.cpp\u0026quot;) ä»…ä»…åŒ¹é… src å•çº§ç›®å½•ä¸‹çš„ c++ æºæ–‡ä»¶ï¼Œç°åœ¨æœ‰äº†å¤§è‡´çš„äº†è§£åï¼Œç¼–è¾‘ hello/xmake.lua æ–‡ä»¶æ¥å®éªŒå¦‚ä½•é€’å½’æ·»åŠ æºæ–‡ä»¶ï¼Œå°†è¯¥æ–‡ä»¶æ”¹ä¸ºä¸‹é¢çš„é…ç½®ã€‚\nadd_rules(\u0026quot;mode.debug\u0026quot;, \u0026quot;mode.release\u0026quot;)\rtarget(\u0026quot;hello\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;**.cpp\u0026quot;)\r ç„¶åæˆ‘ä»¬åœ¨ hello/src/test ç›®å½•ä¸‹ï¼Œé€šè¿‡ä¸‹é¢çš„å‘½ä»¤æ–°åˆ›å»ºä¸€ä¸ª C++ çš„ç©ºä»£ç æ–‡ä»¶ï¼Œç”¨æ¥æµ‹è¯•éªŒè¯é€’å½’æ¨¡å¼åŒ¹é…ã€‚\ncd ~/Code/hello\rmkdir -p src/test\rtouch src/test/stub.cpp\r åˆ›å»ºå¥½åæ‰§è¡Œ xmake ç¼–è¯‘å·¥ç¨‹ï¼Œå¦‚æœé¡ºåˆ©å°±å¯ä»¥çœ‹åˆ°æ–°æ·»åŠ çš„ stub.cpp æ–‡ä»¶ä¹Ÿå‚ä¸äº†ç¼–è¯‘ï¼Œå¦‚ä¸‹å›¾ã€‚\nè¿‡æ»¤æºæ–‡ä»¶ æ¨¡å¼åŒ¹é…çš„æ–¹å¼è™½ç„¶å¾ˆæ–¹ä¾¿ï¼Œä½†å¦‚æœæºç ç›®å½•å±‚çº§ç»“æ„å¤æ‚ï¼Œåœ¨æ·»åŠ è¿‡ç¨‹ä¸­ï¼Œéœ€è¦æ’é™¤ä¸€äº›ä¸éœ€è¦çš„æ–‡ä»¶æ—¶ï¼Œå°±ä¸æ˜¯é‚£ä¹ˆçµæ´»äº†ï¼Œä¸è¿‡ xmake ä¹Ÿæä¾›äº†åœ¨æ¨¡å¼åŒ¹é…è¿‡ç¨‹ä¸­æ’é™¤ä¸€æ‰¹æ–‡ä»¶çš„æ–¹å¼ï¼ŒåŒæ ·è¿˜æ˜¯è¿™ä¸ªé…ç½®æ¥å£ï¼Œæˆ‘ä»¬åªéœ€è¦é€šè¿‡ | ç¬¦å·æŒ‡å®šåé¢çš„æ’é™¤åŒ¹é…æ¨¡å¼å³å¯ï¼Œä¾‹å¦‚ã€‚\ntarget(\u0026quot;hello\u0026quot;)\rset_kind(\u0026quot;binary\u0026quot;)\radd_files(\u0026quot;src/**.cpp|test/*.cpp\u0026quot;)\r å…¶ä¸­åˆ†éš”ç¬¦ | ä¹‹åçš„éƒ½æ˜¯éœ€è¦æ’é™¤çš„æ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶ä¹ŸåŒæ ·æ”¯æŒåŒ¹é…æ¨¡å¼ï¼Œå¹¶ä¸”å¯ä»¥åŒæ—¶æ·»åŠ å¤šä¸ªè¿‡æ»¤æ¨¡å¼ï¼Œåªè¦ä¸­é—´ç”¨ | åˆ†å‰²å°±è¡Œäº†ï¼Œè€Œè¿™é‡Œçš„é…ç½®å°±æ˜¯åœ¨ src/**.cpp åŸºç¡€ä¸Šï¼Œå¿½ç•¥æ‰å…¶ä¸­ test å­ç›®å½•ä¸‹æ‰€æœ‰çš„ C++ æºæ–‡ä»¶ï¼Œæœ€ç»ˆçš„ç»“æœä¹Ÿå°±æ˜¯ä»…ä»…ç¼–è¯‘ src/main.cppã€‚\næˆ‘ä»¬å†æ¥æ‰§è¡Œä¸‹ xmake -r é‡æ–°ç¼–è¯‘éªŒè¯ä¸‹ç»“æœï¼Œå¦‚ä¸‹å›¾ã€‚\nä¸Šå›¾ä¸­ï¼Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬æˆåŠŸè¿‡æ»¤æ‰äº† src/test/stub.cpp ä»…ä»…ç¼–è¯‘ src/main.cppã€‚\nè¿˜æœ‰éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œä¸ºäº†ä½¿å¾—æè¿°ä¸Šæ›´åŠ çš„ç²¾ç®€ï¼Œ| ä¹‹åçš„è¿‡æ»¤æè¿°éƒ½æ˜¯åŸºäºå‰ä¸€ä¸ªæ¨¡å¼ï¼šsrc/**.cpp ä¸­ * æ‰€åœ¨çš„ç›®å½•ä½œä¸ºæ ¹ç›®å½•ï¼Œä¹Ÿå°±æ˜¯ src ç›®å½•çš„åŸºç¡€ä¸Šæ¥è¿‡æ»¤åŒ¹é…çš„ï¼Œæ‰€ä»¥åé¢çš„è¿‡æ»¤å­æ¨¡å¼åªéœ€è¦è®¾ç½® test/*.cpp è€Œä¸æ˜¯ src/test/*.cppã€‚\nå®éªŒæ€»ç»“ åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ äº†ç¼–è¯‘é“¾æ¥çš„åŸºæœ¬æ¦‚å¿µï¼Œå¦‚ä½•å»é…ç½®å¤´æ–‡ä»¶å’Œé“¾æ¥åº“ï¼Œå¦‚ä½•å»æ·»åŠ ç¼–è¯‘ä¼˜åŒ–é€‰é¡¹ã€å®å®šä¹‰ä»¥åŠå¦‚ä½•æ·»åŠ æºæ–‡ä»¶ç­‰ä¸€äº› xmake çš„å¸¸ç”¨é…ç½®ï¼Œé€šè¿‡è¿™äº›é…ç½®ï¼Œæˆ‘ä»¬åŸºæœ¬ä¸Šå·²ç»å¯ä»¥è§£å†³å¤§éƒ¨åˆ† C/C++ åŸºç¡€å·¥ç¨‹çš„ç¼–è¯‘éœ€æ±‚ã€‚\næœ¬å®éªŒçš„å‚è€ƒä»£ç å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ä¸‹è½½ï¼š\nwget https://labfile.oss.aliyuncs.com/courses/2764/code3.zip\r ","id":64,"section":"categories","summary":"C_C++é¡¹ç›® åœ¨æœ¬èŠ‚å®éªŒä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å­¦ä¹ åˆ°ä¸€äº›ç¼–è¯‘å™¨å’Œé“¾æ¥å™¨ç›¸å…³çš„åŸºæœ¬æ¦‚å¿µï¼Œå¹¶ä¸”æŒæ¡ xmake.lua ä¸­çš„ä¸€äº›åŸºç¡€é…ç½®ï¼Œæ¯”å¦‚ï¼šC/C++ å¤´æ–‡ä»¶ã€é“¾æ¥åº“çš„é…ç½®","tags":["xmake"],"title":"å®éªŒ1C_C++é¡¹ç›®å¸¸ç”¨é…ç½®æè¿°","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/app/xmake/%E8%93%9D%E6%A1%A5%E7%BD%91%E8%AF%BE/1xmake%E5%85%A5%E9%97%A8/001c_cpp%E9%A1%B9%E7%9B%AE%E5%B8%B8%E7%94%A8%E9%85%8D%E7%BD%AE%E6%8F%8F%E8%BF%B0/","year":"2021"},{"content":"xmake å…¥é—¨  note:è¿™æ˜¯xmakeçš„ä½œè€…åœ¨è“æ¡¥ç½‘è¯¾ä¸Šé¢å¼€è®¾çš„ä¸€é—¨è¯¾ç¨‹çš„ç¬”è®°\n çŸ¥è¯†ç‚¹  xmake å­å‘½ä»¤ä»‹ç»å’Œä½¿ç”¨ xmake çš„å¸®åŠ©èœå•ä»‹ç» å¦‚ä½•é…ç½®ç¼–è¯‘ï¼Œç¼–è¯‘å™¨å·¥å…·é“¾çš„åˆ‡æ¢ xmake çš„è‡ªæˆ‘æ›´æ–°å‡çº§  ä¸€ â€‹\tåœ¨ä»‹ç» xmake å‘½ä»¤è¡Œç¨‹åºçš„å„ç§å­å‘½ä»¤å‰ï¼Œæˆ‘ä»¬å…ˆä»‹ç»ä¸‹ xmake çš„ help èœå•ï¼Œæ‰€æœ‰ xmake å‘½ä»¤å‚æ•°éƒ½æ˜¯å¯ä»¥ä»è¿™ä¸ªèœå•ä¸­æ‰¾åˆ°ï¼Œå¹¶ä¸”æœ‰ç›¸åº”çš„æè¿°å’Œå‚æ•°å€¼è¯´æ˜ã€‚\nå› æ­¤ï¼Œåœ¨è¿˜ä¸ç†Ÿæ‚‰æ€ä¹ˆä½¿ç”¨æŸä¸ªå­å‘½ä»¤çš„æ—¶å€™ï¼Œéƒ½å¯ä»¥é€šè¿‡æŸ¥çœ‹å¯¹åº”çš„å¸®åŠ©èœå•é‡Œé¢çš„å‚æ•°è¯´æ˜ï¼Œæ¥å¿«é€Ÿæ‰¾åˆ°æƒ³è¦çš„æŸä¸ªè®¾ç½®å‚æ•°çš„ä½¿ç”¨æ–¹å¼ã€‚\nä¸»èœå• xmake çš„æ•´ä¸ªå‘½ä»¤è¡Œæ ¼å¼å¦‚ä¸‹ã€‚\nxmake [task] [options] [target]\r ä¸»è¦ç”± [task]ã€[options] è¿˜æœ‰ [target] ç»„æˆï¼Œå…¶ä¸­ [] éƒ¨åˆ†è¡¨ç¤ºå¯é€‰è¾“å…¥ï¼Œé‡Œé¢çš„ task å°±æ˜¯å­å‘½ä»¤ä»»åŠ¡åï¼Œxmake æä¾›äº†å¾ˆå¤šçš„å†…ç½®å­å‘½ä»¤ä»¥åŠæ’ä»¶ä»»åŠ¡å­å‘½ä»¤ï¼Œå¯ä»¥é€šè¿‡æ‰§è¡Œ xmake --help åœ¨ä¸»èœå•é‡Œé¢æŸ¥çœ‹å…·ä½“æœ‰å“ªäº›å­å‘½ä»¤ï¼Œæ•´ä¸ªä¸»èœå•çš„åˆ—è¡¨å†…å®¹å¦‚ä¸‹ã€‚\nè€Œ options å°±æ˜¯æŒ‡çš„ä¸Šå›¾ä¸­çš„å‚æ•°é€‰é¡¹ï¼Œé™¤äº†ä¸»èœå•çš„å‚æ•°é€‰é¡¹ï¼Œæ¯ä¸ªå­å‘½ä»¤ä¹Ÿæœ‰å¯¹åº”çš„å‚æ•°é€‰é¡¹ï¼Œæ¯”å¦‚ xmake build --help å°±æ˜¯ build å­å‘½ä»¤çš„å¸®åŠ©èœå•ã€‚\næœ€åé¢çš„ target æŒ‡çš„æ˜¯å½“å‰çš„å‘½ä»¤æ˜¯é’ˆå¯¹å“ªä¸ªç›®æ ‡ç¨‹åºçš„ï¼Œè¿™ä¸ªä¹Ÿæ˜¯å¯é€‰çš„å‚æ•°ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰å‘½ä»¤éƒ½æœ‰ï¼Œä¸»è¦æ˜¯ buildã€install ç­‰è¿™äº›åŸºç¡€å‘½ä»¤æ‰æä¾›ï¼Œç”¨äºæŒ‡å®šç¼–è¯‘ã€å®‰è£…å¯¹åº”çš„ç›®æ ‡ç¨‹åºï¼Œè€Œé»˜è®¤ä¸æŒ‡å®šï¼Œåˆ™ä¼šç¼–è¯‘å®‰è£…æ‰€æœ‰ç¨‹åºã€‚\nåœ¨ä¸Šå›¾ä¸­çš„ Actions åŒºåŸŸçš„å­å‘½ä»¤ï¼Œå°±æ˜¯ç”¨äºè·Ÿæ„å»ºç›¸å…³çš„æ‰€æœ‰å†…ç½®å‘½ä»¤ï¼Œè€Œ Plugins åŒºåŸŸçš„å­å‘½ä»¤ï¼Œæ˜¯æ‰©å±•çš„æ’ä»¶å‘½ä»¤ã€‚è¿™é‡Œæˆ‘ä»¬ä¸»è¦ç®€å•ä»‹ç»ä¸‹ Actions å‘½ä»¤ï¼Œå…¶å®å¾ˆå¤šåœ¨å®éªŒ 1 ã€Šxmake çš„åŸºæœ¬ä½¿ç”¨ã€‹ä¸­éƒ½å·²ç»ä½¿ç”¨è¿‡ã€‚\n configï¼šé…ç½®ç¼–è¯‘éœ€è¦çš„å‚æ•°ï¼Œæ¯”å¦‚å¹³å°ã€æ¶æ„ç­‰ã€‚ globalï¼šå…¨å±€é…ç½®ç¼–è¯‘å‚æ•°ã€‚ buildï¼šæ„å»ºç¨‹åºã€‚ runï¼šè¿è¡Œç›®æ ‡ç¨‹åºã€‚ installï¼šå®‰è£…ç¼–è¯‘åçš„ç›®æ ‡ç¨‹åºã€‚ uninstallï¼šå¸è½½ä¹‹å‰å®‰è£…çš„ç¨‹åºæ–‡ä»¶ã€‚ packageï¼šæ‰“åŒ…ç¼–è¯‘ç”Ÿæˆçš„åº“å’Œå¤´æ–‡ä»¶ã€‚ cleanï¼šæ¸…ç†ç¼–è¯‘è¿‡ç¨‹ä¸­ç”Ÿæˆçš„ä¸´æ—¶æ–‡ä»¶ã€‚ requireï¼šæ‰‹åŠ¨æ‹‰å–ç¬¬ä¸‰æ–¹ä¾èµ–åº“ã€‚ updateï¼šxmake ç¨‹åºè‡ªæ›´æ–°ã€‚  build å­å‘½ä»¤ build å­å‘½ä»¤ä¹Ÿå°±æ˜¯é»˜è®¤çš„æ„å»ºå‘½ä»¤ï¼Œç”±äºè¿™ä¸ªå‘½ä»¤æœ€å¸¸ç”¨ï¼Œå› æ­¤å³ä½¿ç”¨æˆ·ä¸å®Œæ•´è¿è¡Œ xmake buildï¼Œä»…ä»…æ‰§è¡Œ xmake å°±å¯ä»¥ç¼–è¯‘é¡¹ç›®ï¼Œä¸¤è€…æ˜¯å®Œå…¨ç­‰ä»·çš„ã€‚\nå¦‚æœæˆ‘ä»¬è¦æŸ¥çœ‹æ„å»ºå‘½ä»¤å…·ä½“æœ‰å“ªäº›å‚æ•°é€‰é¡¹ï¼Œå¯ä»¥æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤æ¥æŸ¥çœ‹ï¼Œå‚æ•°åˆ—è¡¨å¦‚ä¸‹ï¼š\nxmake build --help\r æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå®ƒä¸»è¦åˆ†äº†ä¸¤å¤§ç±»ï¼Œä¸ŠåŠæ®µ Common options éƒ¨åˆ†æ˜¯é€šç”¨é€‰é¡¹ï¼Œæ‰€æœ‰å­å‘½ä»¤éƒ½ä¼šå­˜åœ¨è¿™äº›é€‰é¡¹ï¼Œä¸‹åŠæ®µ Command options (build) å°±æ˜¯ build å­å‘½ä»¤ç‰¹æœ‰çš„é€‰é¡¹åˆ—è¡¨ã€‚\nè¿™é‡Œä»…ä»…ä»‹ç»æ¯”è¾ƒå¸¸ç”¨çš„å‡ ä¸ªé€‰é¡¹ã€‚\n -v/--verboseï¼šæŸ¥çœ‹è¯¦ç»†å®Œæ•´çš„ç¼–è¯‘å‘½ä»¤ã€‚ -r/--rebuildï¼šå¼ºåˆ¶é‡æ–°ç¼–è¯‘æ‰€æœ‰ä»£ç ã€‚ -j/--jobsï¼šæŒ‡å®šå¤šä»»åŠ¡ç¼–è¯‘çš„å¹¶è¡Œä»»åŠ¡æ•°ã€‚ -w/--warningï¼šç¼–è¯‘è¿‡ç¨‹ä¸­æ˜¾ç¤ºç¼–è¯‘è­¦å‘Šä¿¡æ¯ã€‚  æŸ¥çœ‹è¯¦ç»†ç¼–è¯‘é€‰é¡¹ é€šè¿‡æ·»åŠ  -v å‚æ•°ï¼Œåœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­ï¼ŒæŸ¥çœ‹å®Œæ•´çš„ç¼–è¯‘é€‰é¡¹ï¼Œè¿™æ˜¯éå¸¸æœ‰ç”¨çš„ï¼Œå¯ä»¥æ’æŸ¥å’Œç¡®è®¤è®¾ç½®çš„ç¼–è¯‘é€‰é¡¹æ˜¯å¦ç”Ÿæ•ˆï¼Œæˆ‘ä»¬å¯ä»¥è¿›å…¥ä¹‹å‰çš„ hello é¡¹ç›®ä¸­æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ã€‚\nxmake -rv\r è¿™é‡Œæˆ‘ä»¬è¿˜åŒæ—¶è¿½åŠ  -r é€‰é¡¹ï¼Œ-r å’Œ -v å¯ä»¥ç»„åˆåœ¨ä¸€èµ·å˜æˆ -rv åŒæ—¶ç”Ÿæ•ˆï¼ˆè¿™æ˜¯ç”±äº xmake é‡‡ç”¨çš„æ˜¯ unix çš„å‘½ä»¤å‚æ•°é£æ ¼ï¼‰ï¼Œä¹Ÿå°±æ˜¯é‡æ–°ç¼–è¯‘å¹¶ä¸”æ˜¾ç¤ºè¯¦ç»†å‘½ä»¤è¾“å‡ºï¼Œå…·ä½“æ•ˆæœå¦‚å›¾ã€‚\nconfigå­å‘½ä»¤ config å­å‘½ä»¤ä¸»è¦ç”¨äºåœ¨ç¼–è¯‘å‰ï¼Œå¯¹é¡¹ç›®è¿›è¡Œä¸€äº›å‚æ•°é…ç½®ï¼Œæ¯”å¦‚åˆ‡æ¢å¹³å°ã€æ¶æ„ä»¥åŠç¼–è¯‘æ¨¡å¼ç­‰ï¼Œå¯ç”¨äºä¿®æ”¹ç¼–è¯‘è¿‡ç¨‹ä¸­çš„å„ç§è¡Œä¸ºï¼Œå½“ç„¶é‡Œé¢å¾ˆå¤šé…ç½®æ˜¯å¯ä»¥ç›´æ¥åœ¨ xmake.lua ä¸­é…ç½®æ¥æ°¸ä¹…ç”Ÿæ•ˆçš„ï¼Œä¸è¿‡è¿™é‡Œé€šè¿‡é…ç½®å‘½ä»¤ï¼Œä¹Ÿå¯ä»¥é’ˆå¯¹å½“å‰ç¼–è¯‘ä¸´æ—¶ç”Ÿæ•ˆï¼Œé…ç½®ç»“æœä¹Ÿä¼šè¢«ç¼“å­˜ã€‚\néœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ¯æ¬¡çš„é…ç½®éƒ½æ˜¯å®Œæ•´é…ç½®ï¼Œä¼šå®Œå…¨è¦†ç›–ä¸Šä¸€æ¬¡çš„é…ç½®ç»“æœã€‚\nåˆ‡æ¢åˆ°è°ƒè¯•ç¼–è¯‘æ¨¡å¼ ç¼–è¯‘æ¨¡å¼çš„åˆ‡æ¢ï¼Œåœ¨å®éªŒ 1 ã€Šxmake çš„åŸºæœ¬ä½¿ç”¨ã€‹ä¸­å·²ç»è®²è§£è¿‡ï¼Œåªéœ€è¦æ‰§è¡Œã€‚\nxmake f -m debug\r éœ€è¦æç¤ºçš„ä¸€ç‚¹æ˜¯ï¼Œxmake f æ˜¯ xmake config çš„ç®€å†™ï¼Œç”¨æ¥ç®€åŒ–è¾“å…¥æé«˜æ•ˆç‡ï¼Œå…¶å®ƒå­å‘½ä»¤ä¹Ÿéƒ½æ˜¯æœ‰ç®€å†™çš„ï¼Œå¤§å®¶å¯ä»¥åœ¨å¸®åŠ©èœå•ä¸­æŸ¥çœ‹ã€‚\nåˆ‡æ¢ç¼–è¯‘è¾“å‡ºç›®å½• é»˜è®¤ç¼–è¯‘ xmake ä¼šåœ¨å½“å‰é¡¹ç›®æ ¹ç›®å½•ä¸‹ç”Ÿæˆ build å­ç›®å½•ä½œä¸ºç¼–è¯‘è¾“å‡ºç›®å½•ï¼Œå¦‚æœä¸æƒ³ç”Ÿæˆåˆ°å½“å‰ç›®å½•ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢çš„é…ç½®å‘½ä»¤åˆ‡æ¢åˆ°å…¶å®ƒè¾“å‡ºç›®å½•ä¸‹ã€‚\nå¦‚æœé…ç½®æˆåŠŸï¼Œé€šè¿‡ä¸‹é¢çš„å‘½ä»¤æŸ¥çœ‹å½“å‰çš„é…ç½®ä¿¡æ¯ï¼Œç¡®è®¤æ˜¯å¦ç”Ÿæ•ˆã€‚\næ·»åŠ  C/C++ ç¼–è¯‘é€‰é¡¹ é€šè¿‡é…ç½®å‘½ä»¤ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å‘½ä»¤è¡Œä¸­å¿«é€Ÿæ·»åŠ ä¸€äº›è‡ªå®šä¹‰çš„ C/C++ ç¼–è¯‘é€‰é¡¹ï¼Œå…¶ä¸­ä¸»è¦æ¶‰åŠè¿™ä¸‰ä¸ªé€‰é¡¹ã€‚\n --cflagsï¼šä»…ä»…æ·»åŠ  C ç¼–è¯‘é€‰é¡¹ã€‚ --cxxflagsï¼šä»…ä»…æ·»åŠ  C++ ç¼–è¯‘é€‰é¡¹ã€‚ --cxflagsï¼šåŒæ—¶æ·»åŠ  C/C++ ç¼–è¯‘é€‰é¡¹ã€‚  å¦‚æœä½ çš„é¡¹ç›®ä¸­æ—¢æœ‰ C ä»£ç ï¼Œä¹Ÿæœ‰ C++ ä»£ç ï¼Œé‚£ä¹ˆä½¿ç”¨ --cxflags æ¥åŒæ—¶è®¾ç½®ä¼šæ›´åŠ æ–¹ä¾¿ï¼Œä½¿ç”¨æ–¹å¼å¦‚ä¸‹ã€‚\nxmake f --cxflags=\u0026quot;-DTEST\u0026quot;\rxmake -rv\r æˆ‘ä»¬é€šè¿‡æ‰§è¡Œ xmake -rv å¼ºåˆ¶é‡æ–°ç¼–è¯‘å¹¶ä¸”æ˜¾ç¤ºè¯¦ç»†è¾“å‡ºï¼Œæ¥ç¡®è®¤æ˜¯å¦æ·»åŠ ç”Ÿæ•ˆï¼Œä¸‹å›¾çº¢æ¡†éƒ¨åˆ†ä¸­çš„ -DTEST è¯´æ˜æˆ‘ä»¬æ·»åŠ çš„ TEST å®å®šä¹‰ç¡®å®ä¼ å…¥äº† gcc ç¼–è¯‘å™¨ã€‚\næ·»åŠ é“¾æ¥åº“å’Œæœç´¢è·¯å¾„ åŒæ ·ï¼Œé™¤äº† C/C++ ä»£ç ç¼–è¯‘ï¼Œæœ€åçš„é“¾æ¥å™¨é˜¶æ®µçš„é€‰é¡¹ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ --ldflags å‘½ä»¤å‚æ•°æ·»åŠ è®¾ç½®ï¼Œä¾‹å¦‚\nxmake f --ldflags=\u0026quot;-L/tmp -lpthread\u0026quot;\rxmake -rv\r æˆ‘ä»¬é€šè¿‡æ·»åŠ é¢å¤–çš„ pthread é“¾æ¥åº“ï¼ŒåŒæ—¶æ–°å¢äº† /tmp çš„åº“æœç´¢ç›®å½•ï¼Œæœ€åç”Ÿæ•ˆçš„æ•ˆæœå¦‚ä¸‹ã€‚\nå¦å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ --links å’Œ --linkdirs è¾¾åˆ°åŒæ ·çš„æ•ˆæœã€‚\nxmake f --links=\u0026quot;pthread\u0026quot; --linkdirs=\u0026quot;/tmp\u0026quot;\rxmake -rv\r åˆ‡æ¢åˆ° clang ç¼–è¯‘å™¨ é»˜è®¤æƒ…å†µä¸‹ï¼Œåœ¨ Linux ç¯å¢ƒä¸­ï¼Œxmake ä¼šä¼˜å…ˆä½¿ç”¨ gcc ç¼–è¯‘å™¨ï¼Œä¸è¿‡æˆ‘ä»¬ä¹Ÿå¯ä»¥å¾ˆæ–¹ä¾¿åœ°åˆ‡æ¢ä½¿ç”¨å…¶å®ƒçš„ç¼–è¯‘å™¨ï¼Œæ¯”å¦‚ clangï¼Œä¸è¿‡åœ¨ä½¿ç”¨ clang ç¼–è¯‘å™¨ä¹‹å‰ï¼Œéœ€è¦æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤å®‰è£…å®ƒã€‚\nsudo apt update\rsudo apt install -y clang\r å®‰è£…å®Œæˆåï¼Œæ‰§è¡Œ clang --version å‘½ä»¤æ¥ç¡®è®¤ clang æ˜¯å¦å®‰è£…æˆåŠŸã€‚\nå¦‚æœå®‰è£…æˆåŠŸï¼Œæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤åˆ‡æ¢åˆ° clang ç¼–è¯‘å·¥å…·é“¾ï¼Œç„¶åæ‰§è¡Œç¼–è¯‘ã€‚\nxmake f --toolchain=clang\rxmake -rv\r æˆ‘ä»¬å¯ä»¥çœ‹ä¸‹æ‰§è¡Œçš„è¯¦ç»†è¾“å‡ºï¼Œçº¢æ¡†éƒ¨åˆ†æ˜¾ç¤ºçš„ /usr/bin/clang è¯´æ˜å½“å‰çš„ç¼–è¯‘ç¡®å®ä½¿ç”¨äº† clang ç¼–è¯‘å™¨è€Œä¸æ˜¯ gcc äº†\næˆ‘ä»¬å†é€šè¿‡ xmake run è¿è¡Œä¸‹ç¼–è¯‘å¥½çš„ç›®æ ‡ç¨‹åºã€‚\næ­£å¸¸æ˜¾ç¤º hello world!ï¼Œä¸€åˆ‡è¿è¡Œæ­£å¸¸ã€‚\né‡ç½®æ‰€æœ‰é…ç½® ç»è¿‡ä¹‹å‰çš„ä¸€äº›é…ç½®ï¼Œæˆ‘ä»¬ç¼“å­˜äº†ä¸å°‘ç¼–è¯‘é…ç½®ï¼Œå¦‚æœæƒ³é‡ç½®æ‰€æœ‰é…ç½®åˆ°æœ€åˆçš„é»˜è®¤çŠ¶æ€ï¼Œé‚£ä¹ˆå¯ä»¥æ·»åŠ  -c é€‰é¡¹æ¥é‡ç½®æ‰€æœ‰ã€‚é»˜è®¤é…ç½®ä¸‹ï¼Œä¹Ÿå°±æ˜¯ release ç¼–è¯‘æ¨¡å¼ï¼Œä¼šå¿½ç•¥æœ¬åœ°çš„é…ç½®ç¼“å­˜ï¼Œåƒä¹‹å‰çš„ç¼–è¯‘è¾“å‡ºè·¯å¾„ã€æ–°å¢çš„ç¼–è¯‘é€‰é¡¹é…ç½®éƒ½ä¼šè¢«å¿½ç•¥ã€‚\nxmake f -c\rxmake -rv\r é‡ç½®é…ç½®åï¼Œæˆ‘ä»¬é‡æ–°ç¼–è¯‘å½“å‰å·¥ç¨‹ï¼Œå¯ä»¥çœ‹ä¸‹é‡Œé¢çš„è¯¦ç»†ç¼–è¯‘é€‰é¡¹ï¼Œå·²ç»å®Œå…¨è¿˜åŸå›å»äº†ï¼Œåˆšåˆšè®¾ç½®çš„ clang ç¼–è¯‘å™¨é‡æ–°å˜æˆäº† gcc ç¼–è¯‘å™¨ã€‚\nshow å­å‘½ä»¤ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ­¤å‘½ä»¤ï¼ŒæŸ¥çœ‹å½“å‰å·¥ç¨‹çš„åŸºæœ¬ä¿¡æ¯ï¼Œä»¥åŠ xmake è‡ªèº«çš„ä¸€äº›åŸºæœ¬ä¿¡æ¯ï¼Œè¿™é€šå¸¸æ˜¯éå¸¸æœ‰ç”¨çš„ï¼Œæ¯”å¦‚å¯ä»¥çŸ¥é“å½“å‰é¡¹ç›®æœ‰å“ªäº›ç›®æ ‡ç¨‹åºï¼Œå½“å‰çš„ç¼–è¯‘æ¶æ„å’Œæ¨¡å¼æ˜¯ä»€ä¹ˆï¼Œä»¥åŠ xmake çš„ä¸´æ—¶ç›®å½•ã€ç¼“å­˜ç›®å½•å’Œå®‰è£…è·¯å¾„åœ¨å“ªé‡Œç­‰ç­‰ã€‚\nxmake show\r æ˜¾ç¤ºçš„ä¸€äº›ä¿¡æ¯å¦‚ä¸‹å›¾ã€‚\né™¤äº†é¡¹ç›®å’Œ xmake è‡ªèº«åŸºæœ¬ä¿¡æ¯ï¼Œshow å‘½ä»¤è¿˜å¯ä»¥æ˜¾ç¤ºæŒ‡å®š target ç›®æ ‡çš„åŸºæœ¬ä¿¡æ¯ï¼Œæ¯”å¦‚æˆ‘ä»¬æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤æŸ¥çœ‹ä¸‹åœ¨ xmake.lua æ–‡ä»¶ä¸­å®šä¹‰çš„ target(\u0026quot;hello\u0026quot;) ç›®æ ‡ç¨‹åºçš„åŸºæœ¬ä¿¡æ¯ã€‚\nxmake show -t hello\r é€šè¿‡ä¸Šå›¾ï¼Œæˆ‘ä»¬èƒ½å¤§è‡´äº†è§£è¿™ä¸ª hello ç¨‹åºçš„å¯æ‰§è¡Œæ–‡ä»¶çš„å®é™…ç”Ÿæˆè·¯å¾„åœ¨å“ªé‡Œï¼Œç¼–è¯‘è¿‡ç¨‹ä¸­çš„ .o æ–‡ä»¶åœ¨å“ªé‡Œï¼Œä»¥åŠæ˜¯åœ¨ xmake.lua å“ªä¸ªä½ç½®å®šä¹‰çš„ã€‚\nupdateå­å‘½ä»¤ å¦‚æœ xmake æœ‰æ–°ç‰ˆæœ¬å‘å¸ƒï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨è‡ªæ›´æ–°å‘½ä»¤å¿«é€Ÿæ›´æ–°ç‰ˆæœ¬ï¼Œåªéœ€è¦æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ã€‚\nxmake update -f\r è¿™é‡Œæˆ‘ä»¬é¢å¤–åŠ ä¸Šäº† -f/--force å‚æ•°ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬å½“å‰ç¯å¢ƒçš„ xmake å·²ç»æ˜¯æœ€æ–°ç‰ˆæœ¬ï¼Œé€šå¸¸ä¸éœ€è¦æ›´æ–°ï¼Œä¸ºäº†æ¼”ç¤ºè¿™ä¸ªæ›´æ–°æ“ä½œï¼Œæˆ‘ä»¬é€šè¿‡è¿™ä¸ªå‚æ•°æ¥å¼ºåˆ¶é‡æ–°æ›´æ–°ä¸€éå½“å‰çš„æœ€æ–°ç‰ˆæœ¬ã€‚\næ›´æ–°å®Œæˆåï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ‰§è¡Œ xmake --version ç¡®è®¤ä¸‹ç‰ˆæœ¬æ˜¯å¦ä¸ºæœ€æ–°ç‰ˆæœ¬ï¼Œå®é™…çš„ç‰ˆæœ¬å·ç”±äºæ—¶é—´å…³ç³»ï¼Œä¼šæœ‰æ‰€å˜åŠ¨ï¼Œæ¯•ç«Ÿ xmake çš„ç‰ˆæœ¬è¿­ä»£è¿˜æ˜¯æŒºé¢‘ç¹çš„ã€‚\n","id":65,"section":"categories","summary":"xmake å…¥é—¨ note:è¿™æ˜¯xmakeçš„ä½œè€…åœ¨è“æ¡¥ç½‘è¯¾ä¸Šé¢å¼€è®¾çš„ä¸€é—¨è¯¾ç¨‹çš„ç¬”è®° çŸ¥è¯†ç‚¹ xmake å­å‘½ä»¤ä»‹ç»å’Œä½¿ç”¨ xmake çš„å¸®åŠ©èœå•ä»‹ç» å¦‚ä½•é…ç½®ç¼–è¯‘ï¼Œç¼–è¯‘å™¨å·¥å…·é“¾çš„åˆ‡","tags":["xmake"],"title":"å®éªŒ0xmakeå…¥é—¨","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/app/xmake/%E8%93%9D%E6%A1%A5%E7%BD%91%E8%AF%BE/1xmake%E5%85%A5%E9%97%A8/000xmake%E5%85%A5%E9%97%A8/","year":"2021"},{"content":"ç»§æ‰¿ä¸é¢å‘å¯¹è±¡è®¾è®¡ æ¡æ¬¾32ï¼šç¡®å®šä½ çš„publicç»§æ‰¿å¡‘æ¨¡å‡ºâ€œis-aâ€ï¼ˆæ˜¯ä¸€ç§ï¼‰å…³ç³» ç»“è®º â€œpublicç»§æ‰¿å…³ç³»â€æ„å‘³is-aã€‚é€‚ç”¨äºbase classesèº«ä¸Šçš„æ¯ä¸€ä»¶äº‹æƒ…ä¸€å®šä¹Ÿé€‚ç”¨äºderived classesèº«ä¸Šï¼Œæ¯ä¸€ä¸ªderived classeså¯¹è±¡ä¹Ÿæ˜¯ä¸€ä¸ªbase classå¯¹è±¡\nå­˜åœ¨äºclassesä¹‹é—´çš„ä¸‰ç§å…³ç³»ï¼š  is-a ï¼ˆæ˜¯ä¸€ä¸ªï¼‰Aæ˜¯B has-aï¼ˆæœ‰ä¸€ä¸ªï¼Œæ¡æ¬¾38ï¼‰Aæœ‰B is-implemented-in-term-of(æ ¹æ®æŸç‰©å®ç°å‡ºï¼Œæ¡æ¬¾39)  æ¡æ¬¾33ï¼šé¿å…é®æ©ç»§æ‰¿è€Œæ¥çš„åç§° ç»“è®º  derived classeså†…çš„åç§°ä¼šé®æ©base classeså†…çš„åç§°ã€‚åœ¨publicç»§æ‰¿ä¸‹ä»æ¥æ²¡æœ‰äººå¸Œæœ›å¦‚æ­¤ã€‚ ä¸ºäº†è®©è¢«é®æ©çš„åç§°å†è§å¤©æ—¥ï¼Œå¯ä»¥ä½¿ç”¨usingå£°æ˜å¼æˆ–è½¬äº¤å‡½æ•°ã€‚  æ¡æ¬¾34ï¼šåŒºåˆ†æ¥å£ç»§æ‰¿å’Œå®ç°ç»§æ‰¿ ç»“è®º   æ¥å£ç»§æ‰¿å’Œå®ç°ç»§æ‰¿ä¸åŒã€‚åœ¨publicç»§æ‰¿ä¹‹ä¸‹ï¼Œderived classesæ€»æ˜¯ç»§æ‰¿base classçš„æ¥å£ã€‚\n  pure vitrualï¼ˆçº¯è™šå‡½æ•°ï¼‰åªå…·ä½“æŒ‡å®šæ¥å£ç»§æ‰¿ã€‚\n  impure vitrual(éçº¯å‡½æ•°)å…·ä½“æŒ‡å®šæŒ‡å®šæ¥å£ç»§æ‰¿å’Œç¼ºçœå®ç°ç»§æ‰¿ï¼ˆå¯ä»¥è¦†å†™ï¼‰ã€‚\n  non-virtualï¼ˆæˆå‘˜å‡½æ•°ï¼‰å…·ä½“æŒ‡å®šæ¥å£ç»§æ‰¿ä»¥åŠå¼ºåˆ¶æ€§å®ç°ç»§æ‰¿ã€‚\n  æ¡æ¬¾35ï¼šè€ƒè™‘virtualå‡½æ•°ä»¥å¤–çš„å…¶ä»–é€‰æ‹© ç»“è®º  virtualå‡½æ•°çš„æ›¿ä»£æ–¹æ¡ˆåŒ…æ‹¬NVIæ‰‹æ³•åŠStrategyï¼ˆç­–ç•¥ï¼‰è®¾è®¡æ¨¡å¼çš„å¤šç§å½¢å¼ã€‚NVIæ‰‹æ³•è‡ªèº«æ˜¯ä¸€ç§ç‰¹æ®Šå½¢å¼çš„Template Methodè®¾è®¡æ¨¡å¼ã€‚ å°†æœºèƒ½ä»æˆå‘˜å‡½æ•°ç§»åˆ°classå¤–éƒ¨å‡½æ•°ï¼Œå¸¦æ¥çš„ä¸€ä¸ªç¼ºç‚¹æ˜¯ï¼Œéæˆå‘˜å‡½æ•°æ— æ³•è®¿é—®classçš„non-publicæˆå‘˜ã€‚ trl::functionå¯¹è±¡çš„è¡Œä¸ºå°±åƒä¸€èˆ¬å‡½æ•°æŒ‡é’ˆã€‚è¿™æ ·çš„å¯¹è±¡å¯æ¥çº³â€œä¸ç»™å®šä¹‹ç›®æ ‡ç­¾åå¼å…¼å®¹â€çš„æ‰€æœ‰å¯è°ƒç”¨ç‰©  æ¡æ¬¾36ï¼šç»ä¸é‡æ–°å®šä¹‰ç»§æ‰¿è€Œæ¥çš„non-virtualå‡½æ•° åŸå›  è¿å\u0026quot;is-a\u0026quot;çš„ç»§æ‰¿ä½“ç³»\næ¡æ¬¾37ï¼š ç»ä¸é‡æ–°å®šä¹‰ç»§æ‰¿è€Œæ¥çš„ç¼ºçœå‚æ•°å€¼ ç»“è®º ç»å¯¹ä¸è¦é‡æ–°å®šä¹‰ä¸€ä¸ªç»§æ‰¿è€Œæ¥çš„ç¼ºçœå‚æ•°å€¼ï¼Œå› ä¸ºç¼ºçœå‚æ•°å€¼éƒ½æ˜¯é™æ€ç»‘å®šï¼Œè€Œvirtualå‡½æ•°\u0026mdash;ä½ å”¯ä¸€åº”è¯¥è¦†å†™çš„ä¸œè¥¿\u0026mdash;-å´æ˜¯åŠ¨æ€ç»‘å®šã€‚\nåŸå›  ä½ åªèƒ½ç»§æ‰¿ä¸¤ç§å‡½æ•°ï¼švirtual å’Œ non-virtualå‡½æ•°ã€‚ç„¶è€Œé‡æ–°å®šä¹‰ä¸€ä¸ªç»§æ‰¿è€Œæ¥çš„non-virtualå‡½æ•°æ°¸è¿œæ˜¯é”™è¯¯ï¼ˆæ¡æ¬¾36ï¼‰\nvirtualå‡½æ•°ç³»åŠ¨æ€ç»‘å®šï¼Œè€Œç¼ºçœå‚æ•°å€¼å´æ˜¯é™æ€ç»‘å®šã€‚\næ¡æ¬¾38ï¼šé€šè¿‡å¤åˆå¡‘æ¨¡å‡ºâ€œhas-aâ€æˆ–â€œæ ¹æ®æŸç‰©å®ç°å‡ºâ€ ç»“è®º  å¤åˆå…³ç³»çš„æ„ä¹‰å’Œpublicç»§æ‰¿å…³ç³»å®Œå…¨ä¸åŒ åœ¨åº”ç”¨åŸŸï¼Œåœ¨å¤åˆæ„å‘³has-aï¼ˆæœ‰ä¸€ä¸ªï¼‰ã€‚åœ¨å®ç°åŸŸï¼Œå¤åˆæ„å‘³is-implemented-in-terms-of(æ ¹æ®æŸç‰©å®ç°å‡º)ã€‚  å†…å®¹ ç»§æ‰¿å…³ç³» å¤åˆå…³ç³»\nåœ¨ç¨‹åºå‘˜ä¹‹é—´ï¼Œå¤åˆè¿™ä¸ªè¯æœ‰å¾ˆå¤šåŒä¹‰è¯ï¼Œè­¬å¦‚åˆ†å±‚ã€å†…å«ã€èšåˆã€å†…åµŒã€‚\nåº”ç”¨åŸŸ ç›¸å½“äºå¡‘é€ çš„ä¸–ç•Œä¸­çš„æŸäº›äº‹ç‰©ï¼Œä¾‹å¦‚äººã€æ±½è½¦\nå®ç°åŸŸ å®ç°ç»†èŠ‚ä¸Šçš„äººå·¥åˆ¶å“ï¼Œä¾‹å¦‚ç¼“å†²åŒºã€äº’æ–¥å™¨ã€æŸ¥æ‰¾æ ‘\næ¡æ¬¾39ï¼šæ˜æ™ºè€Œå®¡æ…åœ°ä½¿ç”¨privateç»§æ‰¿ ç»“è®º  privateç»§æ‰¿å…³ç³»æ„å‘³ç€is-implemented-in-terms-of(æ ¹æ®æŸç‰©å®ç°å‡º)ã€‚å®ƒé€šå¸¸æ¯”å¤åˆçš„çº§åˆ«ä½ã€‚ä½†æ˜¯å½“derived classéœ€è¦è®¿é—®protected base classçš„æˆå‘˜ï¼Œæˆ–éœ€è¦é‡æ–°å®šä¹‰ç»§æ‰¿è€Œæ¥çš„virtualå‡½æ•°æ—¶ï¼Œè¿™ä¹ˆè®¾è®¡æ˜¯åˆç†çš„ã€‚ å’Œå¤åˆä¸åŒï¼Œprivateç»§æ‰¿å¯ä»¥é€ æˆempty baseæœ€ä¼˜åŒ–ã€‚è¿™å¯¹è‡´åŠ›äºâ€œå¯¹è±¡å°ºå¯¸æœ€å°åŒ–â€çš„ç¨‹åºåº“å¼€å‘è€…è€Œè¨€ï¼Œå¯èƒ½å¾ˆé‡è¦ã€‚  åŸå›  C++å°†publicç»§æ‰¿è§†ä¸ºis-aå…³ç³»\nâ€‹\tå°†privateç»§æ‰¿è§†ä¸ºis-implemented-in-terms-of(æ ¹æ®æŸç‰©å®ç°å‡º)\næ³¨æ„ï¼šprivateç»§æ‰¿çº¯ç²¹åªæ˜¯ä¸€ç§å®ç°æŠ€æœ¯ï¼ˆprivate base classçš„æ¯æ ·ä¸œè¥¿åœ¨ä½ çš„classå†…éƒ½æ˜¯privateï¼‰ å¦‚éå¿…è¦ï¼ˆå¿…è¦æ¡ä»¶ï¼Œè§P188ï¼‰ï¼Œåœ¨å¤åˆä¸privateç»§æ‰¿ä¸­ï¼Œå°½é‡é€‰æ‹©å¤åˆã€‚\næ¡æ¬¾40ï¼šæ˜æ™ºè€Œå®¡æ…åœ°ä½¿ç”¨å¤šé‡ç»§æ‰¿ ç»“è®º  å¤šé‡ç»§æ‰¿æ¯”å•ä¸€ç»§æ‰¿å¤æ‚ã€‚å®ƒå¯èƒ½å¯¼è‡´æ–°çš„æ­§ä¹‰æ€§ï¼Œä»¥åŠå¯¹virtualç»§æ‰¿çš„éœ€è¦ã€‚ virtualç»§æ‰¿ä¼šå¢åŠ å¤§å°ã€é€Ÿåº¦ã€åˆå§‹åŒ–ï¼ˆåŠèµ‹å€¼ï¼‰å¤æ‚åº¦ç­‰ç­‰æˆæœ¬ã€‚å¦‚æœvirtual base classesä¸ä¼šå¸¦ä»»ä½•æ•°æ®ï¼Œå°†æ˜¯æœ€å…·å®ç”¨ä»·å€¼çš„æƒ…å†µã€‚ å¤šé‡ç»§æ‰¿çš„ç¡®æœ‰æ­£å½“ç”¨é€”ã€‚å…¶ä¸­ä¸€ä¸ªæƒ…æ™¯æ¶‰åŠâ€œpublicç»§æ‰¿æŸä¸ªinterface classâ€å’Œâ€œprivateç»§æ‰¿æŸä¸ªååŠ©å®ç°çš„classâ€ä¸¤ç›¸ç»„åˆã€‚  ","id":66,"section":"categories","summary":"ç»§æ‰¿ä¸é¢å‘å¯¹è±¡è®¾è®¡ æ¡æ¬¾32ï¼šç¡®å®šä½ çš„publicç»§æ‰¿å¡‘æ¨¡å‡ºâ€œis-aâ€ï¼ˆæ˜¯ä¸€ç§ï¼‰å…³ç³» ç»“è®º â€œpublicç»§æ‰¿å…³ç³»â€æ„å‘³is-aã€‚é€‚ç”¨äºbase","tags":["cpp","book"],"title":"ã€ŠC++ Effectiveã€‹-è¯»ä¹¦ç¬”è®°5","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/lang/c/cppeffective/5/","year":"2021"},{"content":"å®ç° å¤§å¤šæƒ…å†µä¸‹ï¼Œé€‚å½“æå‡ºä½ çš„classï¼ˆå’Œclass templatesï¼‰å®šä¹‰ä»¥åŠfunctions(å’Œ function templates)å£°æ˜ï¼Œæ˜¯èŠ±è´¹æœ€å¤šå¿ƒåŠ›çš„ä¸¤ä»¶äº‹ã€‚\nå®ç°å¤§å¤šç›´æˆªäº†å½“ï¼Œä½†å®ç°ä»ç„¶æœ‰ä¸€äº›ä¸œè¥¿è¦å°å¿ƒã€‚\næ¡æ¬¾26ï¼šå°½å¯èƒ½å»¶åå˜é‡å®šä¹‰å¼çš„å‡ºç°æ—¶é—´ ç»“è®º å°½å¯èƒ½å»¶åå˜é‡å®šä¹‰å¼çš„å‡ºç°ã€‚è¿™æ ·åšå¯å¢åŠ ç¨‹åºçš„æ¸…æ™°åº¦å¹¶æ”¹å–„ç¨‹åºçš„æ•ˆç‡ã€‚\nåŸå›  åªè¦ä½ å®šä¹‰äº†ä¸€ä¸ªå˜é‡è€Œå…¶ç±»å‹å¸¦æœ‰ä¸€ä¸ªæ„é€ å‡½æ•°æˆ–ææ„å‡½æ•°ï¼Œ\né‚£ä¹ˆå½“ç¨‹åºçš„æ§åˆ¶æµåˆ°è¾¾è¿™ä¸ªå˜é‡å®šä¹‰å¼æ—¶ï¼Œä½ ä¾¿å¾—æ‰¿å—æ„é€ æˆæœ¬ï¼›\nå½“è¿™ä¸ªå˜é‡ç¦»å¼€å…¶ä½œç”¨åŸŸæ—¶ï¼Œä½ ä¾¿è¦æ‰¿å—ææ„æˆæœ¬ã€‚\nå³ä½¿è¿™ä¸ªå˜é‡æœ€ç»ˆå¹¶æœªè¢«ä½¿ç”¨ï¼Œä»éœ€æ¶ˆè€—è¿™äº›æˆæœ¬ã€‚\nstd::string encrytPassword(const std::string\u0026amp;ã€€password)\r{\rusing namespace std;\rstring encrypted;\rif(password.length()\u0026lt;MinimumPasswordLength){\rthrow logic_error(\u0026quot;Password is too short\u0026quot;);\r}\r...\t//å¿…è¦åŠ¨ä½œï¼Œå°†ä¸€ä¸ªåŠ å¯†åçš„å¯†ç ç½®å…¥å˜é‡encryptedå†…\rreturn encrypted;\r}\r å¦‚æœå¯†ç é•¿åº¦ä¸å¤Ÿï¼Œä¸¢å‡ºå¼‚å¸¸ï¼Œé‚£ä¹ˆstring encryptedè¢«æ„é€ äº†ï¼Œä¹Ÿè¢«ææ„äº†ï¼Œä½†æ²¡æœ‰è¢«ä½¿ç”¨ã€‚\nP116é‡è¦ï¼Œå…³äºå¾ªç¯ä½“å†…çš„å®šä¹‰ æ¡æ¬¾27ï¼šå°½é‡å°‘åšè½¬å‹åŠ¨ä½œ ç»“è®º  å¦‚æœå¯ä»¥ï¼Œå°½é‡é¿å…è½¬å‹ï¼Œç‰¹åˆ«æ˜¯æ³¨é‡æ•ˆç‡çš„ä»£ç ä¸­é¿å…dynamic_castsã€‚å¦‚æœæœ‰ä¸ªè®¾è®¡éœ€è¦è½¬å‹è®¾è®¡ï¼Œè¯•ç€å‘å±•æ— éœ€è½¬å‹çš„æ›¿ä»£è®¾è®¡ å¦‚æœè½¬å‹æ˜¯å¿…è¦çš„ï¼Œè¯•ç€å°†å®ƒéšè—äºæŸä¸ªå‡½æ•°èƒŒåã€‚å®¢æˆ·éšåå¯ä»¥è°ƒç”¨è¯¥å‡½æ•°ï¼Œè€Œä¸éœ€è¦è½¬å‹æ”¾è¿›å®ƒä»¬è‡ªå·±çš„ä»£ç å†…ã€‚ å®å¯ä½¿ç”¨C++styleï¼ˆæ–°å¼ï¼‰è½¬å‹ï¼Œä¸è¦ä½¿ç”¨æ—§å¼è½¬å‹ã€‚  æ¡æ¬¾28ï¼šé¿å…è¿”å›handlesæŒ‡å‘å¯¹è±¡å†…éƒ¨æˆåˆ†ï¼ˆå³å®ƒçš„æˆå‘˜å˜é‡ï¼‰ ç»“è®º é¿å…è¿”å›handlesï¼ˆåŒ…æ‹¬referencesã€æŒ‡é’ˆã€è¿­ä»£å™¨ï¼‰æŒ‡å‘å¯¹è±¡å†…éƒ¨ã€‚éµå®ˆè¿™ä¸ªæ¡çº¦å¯å¢åŠ å°è£…æ€§ï¼Œå¸®åŠ©cosntæˆå‘˜å‡½æ•°çš„è¡Œä¸ºæ›´åƒconstï¼Œå¹¶å°†å‘ç”Ÿå†…å­˜å¯¹è±¡è¢«é”€æ¯çš„å¯èƒ½æ€§é™åˆ°æœ€ä½ã€‚\nåŸå›  å‡è®¾ä½ çš„ç¨‹åºæ¶‰åŠçŸ©å½¢ï¼Œæ¯ä¸€ä¸ªçŸ©å½¢ç”±å…¶å·¦ä¸Šè§’å’Œå³ä¸‹è§’è¡¨ç¤ºã€‚\nclass Point{\t//è¿™ä¸ªclassç”¨æ¥è¡¨è¿°â€œç‚¹â€\rpublicï¼š\rpointï¼ˆint x,int yï¼‰;\r...\rvoid setXï¼ˆint newValï¼‰;\rvoid setY(int newval);\r...\r}\rstruct RectData{\t//è¿™äº›ç‚¹æ•°æ®ç”¨æ¥è¡¨ç°ä¸€ä¸ªçŸ©å½¢\rPoint ulhc;\t//ulhc=\u0026quot;å³ä¸‹è§’\u0026quot;\rPoint lrhc;//lrhc=\u0026quot;å³ä¸Šè§’\u0026quot;\r};\rclass Rectangle{\r....\rprivate:\rstd::trl::shared_ptr\u0026lt;RectData\u0026gt; pData;\r};\r by reference æ–¹å¼ä¼ é€’ç”¨æˆ·è‡ªå®šä¹‰ç±»å‹å¾€å¾€æ¯”by valueæ–¹å¼æ›´é«˜æ•ˆ\nclass Rectangle{\rpublicï¼š\r....\rPoint\u0026amp; upperLeft() const { return pData-\u0026gt;ulhc;}\rPoint\u0026amp; upperRight() const { return pData-\u0026gt;lrhc;}\r}\r constæˆå‘˜å‡½æ•°ï¼šè‹¥å°†æˆå‘˜æˆå‘˜å‡½æ•°å£°æ˜ä¸ºconstï¼Œåˆ™è¯¥å‡½æ•°ä¸å…è®¸ä¿®æ”¹ç±»çš„æ•°æ®æˆå‘˜ï¼Œä½†è‹¥æ•°æ®æˆå‘˜æ˜¯æŒ‡é’ˆï¼Œåˆ™è¿˜æ˜¯å¯ä»¥ä¿®æ”¹æŒ‡é’ˆæŒ‡å‘çš„å†…å®¹\nupperLeftå’ŒupperRightè¢«å£°æ˜ä¸ºconstæˆå‘˜å‡½æ•°ï¼Œæ˜¯ä¸ºäº†æä¾›å®¢æˆ·ä¸€ä¸ªå¾—çŸ¥Rectangleç›¸å…³åæ ‡ç‚¹çš„æ–¹æ³•ï¼Œè€Œä¸æ˜¯è®©å®¢æˆ·ä¿®æ”¹Rectangleï¼ˆå®¢æˆ·æ˜¯å¯ä»¥é€šè¿‡by referenceä¿®æ”¹å†…éƒ¨æ•°æ®ï¼‰ã€‚\nè§£å†³æ–¹æ³• å®ƒä»¬çš„è¿”å›ç±»å‹åŠ ä¸Šconst\nclass Rectangle\r{\rpublicï¼š\r...\rconst Point\u0026amp; upperLeft() const{ return pData-\u0026gt;ulhc;}\rconst Point\u0026amp; lowerRight() const {return pData-\u0026gt;lrhc;}\r...\r}\r æ¡æ¬¾29ï¼šä¸ºâ€œå¼‚å¸¸å®‰å…¨â€è€ŒåŠªåŠ›æ˜¯å€¼å¾—çš„ ç»“è®º  å¼‚å¸¸å®‰å…¨å‡½æ•°å³ä½¿å‘ç”Ÿå¼‚å¸¸ä¹Ÿä¸ä¼šæ³„æ¼èµ„æºæˆ–å…è®¸ä»»ä½•æ•°æ®ç»“æ„è´¥åã€‚è¿™æ ·çš„å‡½æ•°åŒºåˆ†ä¸ºä¸‰ç§å¯èƒ½çš„ä¿è¯ï¼šåŸºæœ¬å‹ã€å¼ºçƒˆå‹ã€ä¸æŠ›å¼‚å¸¸å‹ â€œå¼ºçƒˆä¿è¯â€å¾€å¾€èƒ½å¤Ÿä»¥copy-and-swapå®ç°å‡ºæ¥ï¼Œä½†â€œå¼ºçƒˆä¿è¯â€å¹¶éå¯¹æ‰€æœ‰å‡½æ•°éƒ½å¯å®ç°æˆ–å…·å¤‡ç°å®æ„ä¹‰ã€‚ å‡½æ•°æä¾›çš„â€œå¼‚å¸¸å®‰å…¨ä¿è¯â€é€šå¸¸æœ€é«˜åªç­‰äºå…¶æ‰€è°ƒç”¨ä¹‹å„ä¸ªå‡½æ•°çš„â€œå¼‚å¸¸å®‰å…¨ä¿è¯â€ä¸­çš„æœ€å¼±è€…ã€‚  \u0026ldquo;COPY-AND-SWAP\u0026quot;æŠ€æœ¯ æŒ‰ç…§C++ primerçš„ç†è§£ï¼Œèµ‹å€¼è¿ç®—ç¬¦ï¼ˆA=Bï¼‰åº”è¯¥å®ç°ä¸¤ä¸ªæ–¹é¢çš„å·¥ä½œï¼š\n1.ææ„å‡½æ•°ï¼ˆåˆ é™¤AåŸæœ‰çš„å†…å®¹ï¼‰\n2.æ‹·è´æ„é€ å‡½æ•°ï¼ˆå°†Bçš„å€¼èµ‹å€¼ç»™Aï¼‰\n ClassA\u0026amp; ClassA::operator= (\u0026hellip;.): é¦–å…ˆæŠŠ\u0026rdquo;=\u0026ldquo;å³è¾¹çš„å€¼å¤åˆ¶åˆ°\u0026rdquo;=\u0026ldquo;å·¦è¾¹, ç„¶åææ„\u0026rdquo;=\u0026ldquo;å·¦è¾¹çš„å€¼;\nä¸ºäº†ä¿è¯å¯ä»¥è‡ªèµ‹å€¼(self-assignment), éœ€è¦ä½¿ç”¨****ä¸´æ—¶å˜é‡****å­˜å‚¨, å†åˆ é™¤å¯¹è±¡;\nclass A {\rprivate:\rint *b;\rint a;\rpublic:\rA():a(0),b(nullptr){};\rA(const A\u0026amp;rhs):a(rhs.a),b(rhs.b==nullptr?nullptr:new int(*rhs.b)){};\r~A(){\rdelete b;\rb = nullptr;\r};\r};\rA\u0026amp; operator=(const A\u0026amp; rhs) {\rif(this!=\u0026amp;rhs) { // é˜²æ­¢è‡ªèµ‹å€¼\rdelete b;\rthis-\u0026gt;b = new int(*rhs.b);// å¯èƒ½å¤±è´¥\rthis-\u0026gt;a = rhs.a;\r}\rreturn *this; // è¿”å›thiså¯¹è±¡çš„å¼•ç”¨\r}\r å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„ä»£ç å‡ ä¹æ˜¯å¯¹æ‹·è´æ„é€ å‡½æ•°å’Œææ„å‡½æ•°çš„å®Œå…¨å¤åˆ¶ï¼Œæ­¤å¤–ï¼Œä¸Šè¿°ä»£ç è™½ç„¶å®Œæˆäº†è‡ªèµ‹å€¼çš„éªŒè¯ï¼Œä½†å¹¶æœªä¿éšœå¼‚å¸¸å®‰å…¨ã€‚ä¸€æ—¦newå¤±è´¥ï¼ŒåŸthiså¯¹è±¡çš„bå·²ç»è¢«åˆ é™¤ï¼Œå› æ­¤ä¼šå¼•å‘å¼‚å¸¸ã€‚\nå¼‚å¸¸ä¸å®‰å…¨ä¸»è¦åœ¨äºï¼Œbå¯¹åº”çš„å¯¹è±¡å¯èƒ½åœ¨å¼‚å¸¸åˆ°æ¥ä¹‹å‰è¢«åˆ é™¤ã€‚å› æ­¤æˆ‘ä»¬é¦–å…ˆä¿å­˜è¯¥å¯¹è±¡çš„å‰¯æœ¬ï¼Œä»è€Œä¿è¯äº†å¼‚å¸¸å®‰å…¨ç‰¹æ€§ï¼Œæ— è®ºnewæ˜¯å¦æˆåŠŸï¼Œthiså¯¹è±¡ä¸­çš„bæŒ‡é’ˆéƒ½ä¼šæŒ‡å‘å·²çŸ¥å¯¹è±¡ A\u0026amp; operator=(const A\u0026amp; rhs) {\rauto orign = this-\u0026gt;b;\t//ä½¿bæŒ‡é’ˆæ‰€æŒ‡å‘çš„å†…å­˜æœ‰orginæŒ‡é’ˆæŒ‡å‘\rthis-\u0026gt;b = new int(*rhs.b);\rdelete orign;\rthis-\u0026gt;a = rhs.a;\rreturn *this;\r}\r copy and swap ä¸ºäº†ä½¿ç”¨copy-swapï¼Œæˆ‘ä»¬éœ€è¦ä¸‰ä»¶äº‹ï¼š\n ä¸€ä¸ªæœ‰æ•ˆçš„æ‹·è´æ„é€ å‡½æ•° ä¸€ä¸ªæœ‰æ•ˆçš„ææ„å‡½æ•° ä¸€ä¸ªè‡ªå®šä¹‰çš„äº¤æ¢å‡½æ•°ï¼Œä¸èƒ½ç”¨std::swap,å› ä¸ºè¯¥å‡½æ•°å®ç°ä¸­è°ƒç”¨äº†æ‹·è´æ„é€ å’Œå¤åˆ¶å‡½æ•°ï¼Œä¸”äº¤æ¢å‡½æ•°ä¸æŠ›å¼‚å¸¸  è¯¥æŠ€æœ¯çš„æ ¸å¿ƒå°±æ˜¯ä¸å†ä½¿ç”¨å¼•ç”¨ä½œä¸ºèµ‹å€¼è¿ç®—ç¬¦å‚æ•°ï¼Œå½¢å‚å°†ç›´æ¥æ˜¯å¯¹è±¡ï¼Œè¿™æ ·çš„å†™æ³•å°†ä¼šä½¿ç¼–è¯‘å™¨è‡ªåŠ¨è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°ï¼Œç”±äºæ‹·è´æ„é€ å‡½æ•°çš„è°ƒç”¨ï¼Œå¼‚å¸¸å®‰å…¨å°†åœ¨è¿›å…¥å‡½æ•°ä½“ä¹‹å‰è¢«é¿å…ï¼ˆè‹¥æ‹·è´å¤±è´¥åˆ™ä»€ä¹ˆéƒ½ä¸ä¼šå‘ç”Ÿï¼‰ã€‚ç»è¿‡swapåçš„å¯¹è±¡åœ¨ç¦»å¼€å‡½æ•°ä½“åä¼šè‡ªåŠ¨é”€æ¯ï¼Œå› æ­¤ä¹Ÿå°±è‡ªåŠ¨è°ƒç”¨äº†ææ„å‡½æ•°ï¼Œå…·ä½“å†™æ³•å¦‚ä¸‹ï¼š â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºCSDNåšä¸»ã€Œfeifeiiongã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ªCC 4.0 BY-SAç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚ åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/feifeiiong/article/details/77866579\nvoid swap(A\u0026amp; rhs) {\rusing std::swap;\rswap(this-\u0026gt;a,rhs.a);\rswap(this-\u0026gt;b,rhs.b);\r}\rA\u0026amp; operator=(A rhs) {\rswap(rhs);\rreturn *this;\r}\r ç½‘ç»œèµ„æºï¼š\n https://blog.csdn.net/hiwubihe/article/details/116667884?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522162631218716780264010481%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D\u0026amp;request_id=162631218716780264010481\u0026amp;biz_id=0\u0026amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-10-116667884.first_rank_v2_pc_rank_v29\u0026amp;utm_term=copy+and+swap\u0026amp;spm=1018.2226.3001.4187  æ¡æ¬¾30ï¼šé€å½»äº†è§£inliningçš„é‡Œé‡Œå¤–å¤– ç»“è®º  å°†å¤§å¤šæ•°inliningé™åˆ¶åœ¨å°å‹ã€è¢«é¢‘ç¹è°ƒç”¨çš„å‡½æ•°èº«ä¸Šã€‚è¿™å¯ä½¿æ—¥åçš„è°ƒè¯•è¿‡ç¨‹å’ŒäºŒè¿›åˆ¶å‡çº§æ›´ä¸ºå®¹æ˜“ï¼Œä¹Ÿå¯ä½¿æ½œåœ¨çš„ä»£ç è†¨èƒ€é—®é¢˜æœ€å°åŒ–ï¼Œä½¿ç¨‹åºçš„é€Ÿåº¦æå‡æœºä¼šæœ€å¤§åŒ–ã€‚ ä¸è¦åªå› ä¸ºfunction templateså‡ºç°åœ¨å¤´æ–‡ä»¶ï¼Œå°±å°†å®ƒä»¬å£°æ˜ä¸ºinlineã€‚  åŸå›  ä¸€å¼€å§‹å…ˆä¸è¦å°†ä»»ä½•å‡½æ•°å£°æ˜ä¸ºinlineï¼Œæˆ–è€…è‡³å°‘å°†inlineæ–½è¡ŒèŒƒå›´å±€é™åœ¨é‚£äº›â€œä¸€å®šæˆä¸ºinlineï¼ˆæ¡æ¬¾46ï¼‰â€æˆ–â€œååˆ†å¹³æ·¡æ— å¥‡â€çš„å‡½æ•°èº«ä¸Šï¼Œå¯ä»¥ä½¿ç¨‹åºè¾¾åˆ°ä¼˜åŒ–ã€‚\nï¼ˆ28æ³•åˆ™ï¼‰å¹³å‡è€Œè¨€ä¸€ä¸ªç¨‹åºå¾€å¾€å°†80%çš„æ‰§è¡Œæ—¶é—´èŠ±è´¹åœ¨20%çš„ä»£ç ä¸Šå¤´ï¼Œä½œä¸ºè½¯ä»¶å¼€å‘è€…ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯æ‰¾å‡ºè¿™å¯ä»¥æœ‰æ•ˆå¢è¿›ç¨‹åºæ•´ä½“æ•ˆç‡çš„20%çš„ä»£ç \ninlineç¼ºç‚¹ï¼š\nä»¥ä»£ç è†¨èƒ€ä¸ºä»£ä»· ç©ºé—´æ¢æ—¶é—´\ninlineå¯¹äºç¼–è¯‘å™¨è€Œè¨€ï¼Œåªæ˜¯å»ºè®®ã€‚\nå»ºè®®ï¼š\n å¼€æ ˆçš„å¼€é”€ \u0026gt; æ‰§è¡Œçš„å¼€é”€ å»ºè®®è®¾ä¸ºinline å¼€æ ˆçš„å¼€é”€ \u0026lt; æ‰§è¡Œçš„å¼€é”€ ä¸å»ºè®®  ä¸ºä»€ä¹ˆä½¿ç”¨inlineå…³é”®å­—ï¼Ÿ 1.1ä¸ºäº†è§£å†³ä¸€äº›é¢‘ç¹è°ƒç”¨çš„å°å‡½æ•°å¤§é‡æ¶ˆè€—æ ˆç©ºé—´ï¼ˆæ ˆå†…å­˜ï¼‰ã€‚ åœ¨é¢„ç¼–è¯‘çš„æ—¶å€™ï¼Œç¼–è¯‘å™¨å°†ç¨‹åºä¸­å‡ºç°çš„å†…è”å‡½æ•°çš„è°ƒç”¨è¡¨è¾¾å¼çš„åœ°æ–¹ç›´æ¥æ’å…¥ç”¨å†…è”å‡½æ•°çš„ä»£ç ã€‚\næ¡æ¬¾31ï¼šå°†æ–‡ä»¶é—´çš„ç¼–è¯‘ä¾å­˜å…³ç³»é™åˆ°æœ€ä½ ç»“è®º  æ”¯æŒâ€œç¼–è¯‘ä¾å­˜æ€§æœ€å°åŒ–â€çš„ä¸€èˆ¬æ„æƒ³æ˜¯ï¼šç›¸ä¾äºå£°æ˜å¼ï¼Œä¸è¦ç›¸ä¾äºå®šä¹‰å¼ã€‚åŸºäºæ­¤æ„æƒ³çš„ä¸¤ä¸ªæ‰‹æ®µæ˜¯Handle classeså’Œinterface classes ç¨‹åºåº“å¤´æ–‡ä»¶åº”è¯¥ä»¥â€œå®Œå…¨ä¸”ä»…æœ‰å£°æ˜å¼â€çš„å½¢å¼å­˜åœ¨ã€‚è¿™ç§åšæ³•ä¸è®ºæ˜¯å¦æ¶‰åŠtemplateséƒ½é€‚åˆã€‚  æ–¹æ³• pimpl idiomæŠ€æœ¯\nhttps://blog.csdn.net/qq_33775402/article/details/76274678?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522162632039416780261938712%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D\u0026amp;request_id=162632039416780261938712\u0026amp;biz_id=0\u0026amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-4-76274678.first_rank_v2_pc_rank_v29\u0026amp;utm_term=%E9%99%8D%E4%BD%8E%E6%96%87%E4%BB%B6%E9%97%B4%E7%9A%84%E7%BC%96%E8%AF%91%E4%BE%9D%E5%AD%98%E5%85%B3%E7%B3%BB\u0026amp;spm=1018.2226.3001.4187\n","id":67,"section":"categories","summary":"å®ç° å¤§å¤šæƒ…å†µä¸‹ï¼Œé€‚å½“æå‡ºä½ çš„classï¼ˆå’Œclass templatesï¼‰å®šä¹‰ä»¥åŠfunctions(å’Œ function templates)å£°æ˜ï¼Œæ˜¯èŠ±è´¹æœ€å¤š","tags":["cpp","book"],"title":"ã€ŠC++ Effectiveã€‹-è¯»ä¹¦ç¬”è®°4","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/lang/c/cppeffective/4/","year":"2021"},{"content":"èµ„æºç®¡ç† èµ„æºï¼šä¸€æ—¦ç”¨äº†å®ƒï¼Œå°†æ¥å¿…é¡»è¿˜ç»™ç³»ç»Ÿã€‚\nè­¬å¦‚ï¼šåŠ¨æ€åˆ†é…å†…å­˜ã€æ–‡ä»¶æè¿°å™¨ã€äº’æ–¥é”ã€å›¾å½¢ç•Œé¢ä¸­çš„å­—å‹å’Œç¬”åˆ·ã€æ•°æ®åº“è¿æ¥ã€ç½‘ç»œsocketsã€‚\næ¡æ¬¾13ï¼šä»¥å¯¹è±¡ç®¡ç†èµ„æº åˆ›å»ºä¸€ä¸ªå¯¹è±¡ç®¡ç†èµ„æºï¼Œèµ„æºç®¡ç†ç±»\nç»“è®º â€‹\t1.ä¸ºé˜²æ­¢èµ„æºæ³„æ¼ï¼Œè¯·ä½¿ç”¨RAIIå¯¹è±¡ï¼Œå®ƒä»¬åœ¨æ„é€ å‡½æ•°ä¸­è·å¾—èµ„æºå¹¶åœ¨ææ„å‡½æ•°ä¸­é‡Šæ”¾èµ„æºã€‚\nâ€‹\t2.ä¸¤ä¸ªå¸¸è¢«ä½¿ç”¨çš„RAII classesåˆ†åˆ«trl::share_ptrå’Œauto_ptrã€‚å‰è€…é€šå¸¸æ˜¯è¾ƒä½³é€‰æ‹©ï¼Œå› ä¸ºå…¶copyè¡Œä¸ºç›´è§‚ã€‚\næ¡æ¬¾14ï¼šåœ¨èµ„æºç®¡ç†ä¸­ï¼Œå°å¿ƒcopyingè¡Œä¸º copyingè¡Œä¸ºä¹Ÿåº”è¯¥å‚è€ƒ\næµ…æ‹·è´\u0026amp;\u0026amp;æ·±æ‹·è´\nç»“è®º 1.å¤åˆ¶RAIIå¯¹è±¡å¿…é¡»ä¸€å¹¶å¤åˆ¶å®ƒæ‰€ç®¡ç†çš„èµ„æºï¼Œæ‰€ä»¥èµ„æºçš„copyingè¡Œä¸ºå†³å®šRAIIå¯¹è±¡çš„copyingè¡Œä¸ºã€‚\n2.æ™®éè€Œå¸¸è§çš„RAII class copyingè¡Œä¸ºæ˜¯ï¼šç¦æ­¢copyingã€æ–½è¡Œå¼•ç”¨è®¡æ•°æ³•ã€‚\nåŸå›  èµ„æºç®¡ç†ç±»å¯¹è±¡è¢«å¤åˆ¶ï¼Œæ˜¯ä¸€ä»¶ä¸åˆç†çš„è¡Œä¸ºï¼Œå› ä¸ºä¾‹å¦‚â€œäº’æ–¥é”â€ã€â€œåŠ¨æ€å†…å­˜åˆ†é…â€ã€ç­‰æ˜¯å…·æœ‰å”¯ä¸€æ€§çš„ï¼Œä¸¤ä¸ªå¯¹è±¡çš„æŒ‡é’ˆåŒæ—¶æŒ‡å‘åŒä¸€å—å†…å­˜ï¼Œé‚£ä¹ˆå¯¹è±¡é”€æ¯æ—¶ï¼Œå†…å­˜é‡Šæ”¾ï¼Œå°±å¿…ç„¶ä¸€ä¸ªæŒ‡é’ˆç§°ä¸ºæ‚¬ç©ºæŒ‡é’ˆã€‚\nè§£å†³æ–¹æ³• å› æ­¤ï¼šæœ‰ä¸¤ç§åšæ³•ï¼š\n  ç¦æ­¢å¤åˆ¶\u0026mdash;\u0026mdash;\u0026ndash;è¯¦ç»†åœ°è§ï¼Œæ¡æ¬¾6ï¼Œå°†copyingæ“ä½œå£°æ˜ä¸ºprivateã€‚\n  å¯¹åº•å±‚èµ„æºç¥­å‡ºâ€œå¼•ç”¨è®¡æ•°æ³•â€ã€‚\næœ‰æ—¶å€™æˆ‘ä»¬å¸Œæœ›ä¿å­˜èµ„æºï¼Œç›´åˆ°å®ƒæœ€åä¸€ä¸ªä½¿ç”¨è€…ï¼ˆæŸå¯¹è±¡ï¼‰è¢«é”€æ¯ã€‚\n  class Lock{\rpublicï¼š\rexplict Lockï¼ˆMutex* pmï¼‰:mutexPtr(pm,unlock)//ä»¥æŸä¸ªMutexåˆå§‹åŒ–share_ptr,å¹¶ä»¥unlockå‡½æ•°ä¸ºåˆ é™¤å™¨\r{\rlockï¼ˆmutePtr.get()ï¼‰;//æ¡æ¬¾15\r}\rprivateï¼š\rstd::trl::shared_ptr\u0026lt;Mutex\u0026gt; mutexPtr;//ä½¿ç”¨share_ptr\r}\r shared_ptr(æ™ºèƒ½æŒ‡é’ˆ)çš„å¦™ç”¨ã€‚\næœ¬ä¾‹çš„Lock Classä¸å†å£°æ˜ææ„å‡½æ•°ï¼Œå› ä¸ºæ²¡ç”¨å¿…è¦ã€‚\nmutexçš„ææ„å‡½æ•°ä¼šåœ¨äº’æ–¥å™¨çš„å¼•ç”¨æ¬¡æ•°ä¸º0æ—¶è‡ªåŠ¨è°ƒç”¨trlï¼šshare_ptrçš„åˆ é™¤å™¨ï¼ˆæœ¬ä¾‹ä¸ºunlockï¼‰ã€‚\næ¡æ¬¾15ï¼šåœ¨èµ„æºç®¡ç†ç±»ä¸­æä¾›å¯¹åŸå§‹èµ„æºçš„è®¿é—® ç»“è®ºï¼š  APIså¾€å¾€è¦æ±‚è®¿é—®åŸå§‹èµ„æºï¼Œæ‰€ä»¥æ¯ä¸€ä¸ªRAII classåº”è¯¥æä¾›ä¸€ä¸ªâ€œå–å¾—å…¶æ‰€ç®¡ç†ä¹‹èµ„æºâ€çš„æ–¹æ³•ã€‚ å¯¹åŸå§‹èµ„æºçš„è®¿é—®å¯èƒ½ç»ç”±æ˜¾å¼è½¬æ¢æˆ–éšå¼è½¬æ¢ã€‚ä¸€èˆ¬è€Œè¨€ï¼Œæ˜¾å¼è½¬æ¢æ¯”è¾ƒå®‰å…¨ï¼Œä½†éšå¼è½¬æ¢å¯¹å®¢æˆ·æ¯”è¾ƒæ–¹ä¾¿ã€‚  åšæ³• trl::share_ptrå’Œauto_ptréƒ½æä¾›ä¸€ä¸ªgetæˆå‘˜å‡½æ•°ï¼Œç”¨æ¥æ‰§è¡Œæ˜¾å¼è½¬æ¢ï¼Œä¹Ÿå°±æ˜¯å®ƒä¼šè¿”å›æ™ºèƒ½æŒ‡é’ˆå†…éƒ¨çš„åŸå§‹æŒ‡é’ˆï¼ˆçš„å¤ä»¶ï¼‰\næ¡æ¬¾16ï¼šæˆå¯¹ä½¿ç”¨newå’Œdeleteæ—¶è¦é‡‡å–ç›¸åŒå½¢å¼ ç»“è®º å¦‚æœä½ åœ¨newè¡¨è¾¾å¼ä¸­ä½¿ç”¨[],å¿…é¡»åœ¨ç›¸åº”çš„deleteè¡¨è¾¾å¼ä¸­ä¹Ÿä½¿ç”¨[]ã€‚å¦‚æœä½ åœ¨newè¡¨è¾¾å¼ä¸­ä¸ä½¿ç”¨[],ä¸€å®šä¸è¦åœ¨ç›¸åº”çš„deleteè¡¨è¾¾å¼ä¸­ä½¿ç”¨[]\næ¡æ¬¾17ï¼šä»¥ç‹¬ç«‹è¯­å¥å°†newedå¯¹è±¡ç½®å…¥æ™ºèƒ½æŒ‡é’ˆ ç»“è®º ä»¥ç‹¬ç«‹è¯­å¥å°†newedå¯¹è±¡å­˜å‚¨äºï¼ˆç½®å…¥ï¼‰æ™ºèƒ½æŒ‡é’ˆå†…ã€‚å¦‚æœä¸è¿™æ ·åšï¼Œä¸€æ—¦å¼‚å¸¸è¢«æŠ›å‡ºï¼Œæœ‰å¯èƒ½å¯¼è‡´éš¾ä»¥å¯Ÿè§‰çš„èµ„æºæ³„æ¼ã€‚\nåŸå›  å‡è®¾æˆ‘ä»¬æœ‰ä¸ªå‡½æ•°ç”¨æ¥æ­ç¤ºå¤„ç†ç¨‹åºçš„ä¼˜å…ˆæƒï¼Œå¦ä¸€ä¸ªå‡½æ•°ç”¨æ¥åœ¨æŸåŠ¨æ€åˆ†é…æ‰€å¾—çš„widgetä¸Šè¿›è¡ŒæŸäº›å¸¦æœ‰ä¼˜å…ˆæƒçš„å¤„ç†ï¼š\nint priority();\rvoid processWidget(std::trl::shared_ptr\u0026lt;Widget\u0026gt; pw, int priority);\r è°ƒç”¨processWidget\nprocessWidget(new Widget, priority());\r ä¸èƒ½é€šè¿‡ç¼–è¯‘ï¼Œå› ä¸ºtrl::share_ptræ„é€ å‡½æ•°éœ€è¦ä¸€ä¸ªåŸå§‹æŒ‡é’ˆï¼Œä½†è¯¥æ„é€ å‡½æ•°æ˜¯ä¸ªexplicitæ„é€ å‡½æ•°ï¼Œæ— æ³•è¿›è¡Œéšå¼è½¬æ¢ï¼Œéœ€è¦å°†â€œnew Widgetâ€çš„åŸå§‹æŒ‡é’ˆè½¬æ¢ä¸ºprocessWidgetæ‰€è¦æ±‚çš„Trlï¼šshare_ptrã€‚\nä½†\nè¿™æ ·ï¼Œå°±å¯ä»¥é€šè¿‡ç¼–è¯‘ã€‚\nprocessWidget(std::trl::share_ptr\u0026lt;Widget\u0026gt;(new Widget), priority());\r å¼ºåˆ¶è½¬æ¢\nç¼ºé™·æ˜¯ï¼šå¯èƒ½æ³„æ¼èµ„æº\nå‡è®¾æ‰§è¡Œé¡ºåºï¼š\n æ‰§è¡Œâ€œnew Widgetâ€ è°ƒç”¨priority è°ƒç”¨trl::shared_ptræ„é€ å‡½æ•°  å¯¹priorityçš„è°ƒç”¨å¯ä»¥æ’åœ¨ç¬¬ä¸€ã€ç¬¬äºŒã€ç¬¬ä¸‰æ‰§è¡Œï¼Œä¸ä¸€å®šï¼Œä¸å¯çŸ¥ã€‚\nå¦‚æœåœ¨ç¬¬äºŒä½æ‰§è¡Œï¼Œå¦‚æœå¯¹priorityçš„è°ƒç”¨å¯¼è‡´å¼‚å¸¸å‘¢ï¼Ÿé‚£ä¹ˆâ€œnew Widgetâ€è¿”å›çš„æŒ‡é’ˆå°†ä¼šé—å¤±ï¼Œå› ç¬¬ä¸‰æ­¥æ‰§è¡Œä¸äº†ï¼Œè€Œç¬¬ä¸‰æ­¥åˆ™æ˜¯æˆ‘ä»¬æœŸç›¼ç”¨æ¥é˜²å«èµ„æºæ³„æ¼çš„æ­¦å™¨ï¼ŒRAIIã€‚\nè§£å†³æ–¹æ³• ä½¿ç”¨åˆ†ç¦»è¯­å¥\nï¼ˆ1ï¼‰åˆ›å»ºwidget\nï¼ˆ2ï¼‰å°†å®ƒç½®å…¥ä¸€ä¸ªæ™ºèƒ½æŒ‡é’ˆï¼Œç„¶åå†æŠŠé‚£ä¸ªæ™ºèƒ½æŒ‡é’ˆä¼ ç»™processWidget\nstd::trl::shared_ptr\u0026lt;Widget\u0026gt; pw(new Widget);//åœ¨å•ç‹¬è¯­å¥å†…ä»¥æ™ºèƒ½æŒ‡é’ˆå­˜å‚¨newedæ‰€å¾—çš„å¯¹è±¡ã€‚\rprocessWidget(pw,priority());//ä¸ä¼šé€ æˆå†…å­˜æ³„æ¼\r ","id":68,"section":"categories","summary":"èµ„æºç®¡ç† èµ„æºï¼šä¸€æ—¦ç”¨äº†å®ƒï¼Œå°†æ¥å¿…é¡»è¿˜ç»™ç³»ç»Ÿã€‚ è­¬å¦‚ï¼šåŠ¨æ€åˆ†é…å†…å­˜ã€æ–‡ä»¶æè¿°å™¨ã€äº’æ–¥é”ã€å›¾å½¢ç•Œé¢ä¸­çš„å­—å‹å’Œç¬”åˆ·ã€æ•°æ®åº“è¿æ¥ã€ç½‘ç»œsocketsã€‚","tags":["cpp","book"],"title":"ã€ŠC++ Effectiveã€‹-è¯»ä¹¦ç¬”è®°2","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/lang/c/cppeffective/2/","year":"2021"},{"content":"æ¥å£çš„è®¾è®¡ä¸å£°æ˜ æ¥å£è®¾è®¡çš„å‡†åˆ™ï¼š è®©æ¥å£å®¹æ˜“è¢«æ­£ç¡®ä½¿ç”¨ï¼Œä¸å®¹æ˜“è¢«è¯¯ç”¨ã€‚\nä»€ä¹ˆæ˜¯æ¥å£ï¼Ÿ\nâ€‹\tå†…éƒ¨å®ç°ç»†èŠ‚å°è£…èµ·æ¥ï¼Œå¤–éƒ¨ç”¨æˆ·ç”¨è¿‡é¢„ç•™çš„æ¥å£å¯ä»¥ä½¿ç”¨æ¥å£çš„åŠŸèƒ½è€Œä¸éœ€è¦çŸ¥æ™“å†…éƒ¨å…·ä½“ç»†èŠ‚ã€‚\nâ€‹\tC++ä¸­ï¼Œé€šè¿‡ç±»å®ç°é¢å‘å¯¹è±¡çš„ç¼–ç¨‹ï¼Œè€Œåœ¨åŸºç±»ä¸­åªç»™å‡ºçº¯è™šå‡½æ•°çš„å£°æ˜ï¼Œç„¶ååœ¨æ´¾ç”Ÿç±»ä¸­å®ç°çº¯è™šå‡½æ•°çš„å…·ä½“å®šä¹‰çš„æ–¹å¼å®ç°æ¥å£ï¼Œä¸åŒæ´¾ç”Ÿç±»å®ç°æ¥å£çš„æ–¹å¼ä¹Ÿä¸å°½ç›¸åŒï¼Œä»è€Œå®ç°å¤šæ€ã€‚\næ¡æ¬¾18ï¼š\tè®©æ¥å£å®¹æ˜“è¢«æ­£ç¡®ä½¿ç”¨ï¼Œä¸å®¹æ˜“è¢«è¯¯ç”¨ã€‚ ### ç»“è®º\r  å¥½çš„æ¥å£å¾ˆå®¹æ˜“è¢«æ­£ç¡®ä½¿ç”¨ï¼Œä¸å®¹æ˜“è¢«è¯¯ç”¨ã€‚ä½ åº”è¯¥åœ¨ä½ çš„æ‰€æœ‰æ¥å£ä¸­åŠªåŠ›è¾¾æˆè¿™äº›æ€§è´¨ã€‚ â€œä¿ƒè¿›æ­£ç¡®ä½¿ç”¨â€çš„åŠæ³•åŒ…æ‹¬æ¥å£çš„ä¸€è‡´æ€§ï¼Œä»¥åŠä¸å†…ç½®ç±»å‹çš„è¡Œä¸ºå…¼å®¹ã€‚ â€œé˜»æ­¢è¯¯ç”¨â€çš„åŠæ³•åŒ…æ‹¬å»ºç«‹æ–°ç±»å‹ã€é™åˆ¶ç±»å‹ä¸Šçš„æ“ä½œï¼ŒæŸç¼šå¯¹è±¡å€¼ï¼Œä»¥åŠæ¶ˆé™¤å®¢æˆ·çš„èµ„æºç®¡ç†è´£ä»»ã€‚ trl::shared_ptræ”¯æŒå®šåˆ¶åˆ é™¤å™¨ã€‚è¿™å¯é˜²èŒƒDLLé—®é¢˜ï¼Œå¯è¢«ç”¨æ¥è‡ªåŠ¨è§£é™¤äº’æ–¥é”ï¼ˆæ¡æ¬¾14ï¼‰ã€‚  åŸå›  é¦–å…ˆå¿…é¡»è€ƒè™‘å®¢æˆ·å¯èƒ½åšå‡ºä»€ä¹ˆé”™è¯¯ã€‚\nclass Date{\rpublicï¼š\rDateï¼ˆint monthï¼Œint dayï¼Œint yearï¼‰;\r.....\r}\r å¦‚æœå¹´æœˆæ—¥çš„é¡ºåºé”™è¯¯å‘¢ï¼Ÿ\nä¾‹å¦‚\nDate dï¼ˆ30,3,1995ï¼‰é”™è¯¯\näº¦æˆ–è€…æŒ‰é”™\nDate dï¼ˆ2,30,1995ï¼‰\nè§£å†³æ–¹æ³• å¯¼å…¥ç®€å•çš„å¤–è¦†ç±»å‹æ¥åŒºåˆ«å¤©æ•°ã€æœˆä»½ã€å¹´ä»½ï¼Œç„¶åäºDateæ„é€ å‡½æ•°ä¸­ä½¿ç”¨è¿™äº›ç±»å‹ï¼š\nstruct Day\r{\rexplicit Day(int d):val(d){}\rint val;\r};\rstruct Month\r{\rexplicit Month(int m):val(m){}\rint val;\r};\rstruct Year\r{\rexplicit Year(int y):val(y){}\rint val;\r};\rclass Date{\rPublic:\rDateï¼ˆconst Month\u0026amp; m,const Day\u0026amp; d,const Year\u0026amp; yï¼‰;//åŒ…è£…äº†ä¸€ä¸‹\r...\r}\rDate dï¼ˆ30,3,1995ï¼‰;\t//é”™è¯¯ï¼\rDate dï¼ˆDayï¼ˆ30ï¼‰ï¼ŒMonthï¼ˆ3ï¼‰ï¼ŒYearï¼ˆ1995ï¼‰ï¼‰ï¼›//é”™è¯¯\rDate d(Month(3),Day(30),Year(1995))//OK,ç±»å‹æ­£ç¡®\r æ¡æ¬¾19ï¼šè®¾è®¡classçŠ¹å¦‚type ç»“è®º classçš„è®¾è®¡å°±æ˜¯typeçš„è®¾è®¡ã€‚åœ¨å®šä¹‰ä¸€ä¸ªæ–°typeä¹‹å‰ï¼Œè¯·ç¡®å®šä½ å·²ç»è€ƒè™‘è¿‡æœ¬æ¡æ¬¾è¦†ç›–çš„æ‰€æœ‰è®¨è®ºä¸»é¢˜ã€‚\nå¦‚ä½•è®¾è®¡é«˜æ•ˆçš„classå‘¢ï¼Ÿ   æ–°typeçš„å¯¹è±¡åº”è¯¥å¦‚ä½•è¢«åˆ›å»ºå’Œé”€æ¯ï¼Ÿ\n  å¯¹è±¡çš„åˆå§‹åŒ–å’Œå¯¹è±¡çš„èµ‹å€¼è¯¥æœ‰ä»€ä¹ˆæ ·çš„å·®åˆ«ï¼Ÿ\n  æ–°typeçš„å¯¹è±¡å¦‚æœè¢«passed by value(ä»¥å€¼ä¼ é€’)ï¼Œæ„å‘³ç€ä»€ä¹ˆï¼Ÿ\n  æ¡æ¬¾20ï¼šå®ä»¥pass-by-reference-to-constæ›¿æ¢pass-by-value ç»“è®º  å°½é‡ä»¥Pass-by-reference-to-constæ›¿æ¢pass-by-valueã€‚å‰è€…é€šå¸¸æ¯”è¾ƒé«˜æ•ˆï¼Œå¹¶å¯é¿å…åˆ‡å‰²é—®é¢˜ã€‚ ä»¥ä¸Šè§„åˆ™å¹¶ä¸é€‚ç”¨å†…ç½®ç±»å‹ã€STLçš„è¿­ä»£å™¨å’Œå‡½æ•°å¯¹è±¡ã€‚å¯¹å®ƒä»¬è€Œè¨€ï¼Œpass-by-valueå¾€å¾€æ¯”è¾ƒåˆé€‚ã€‚  æ¡æ¬¾21ï¼šå¿…é¡»è¿”å›å¯¹è±¡æ—¶ï¼Œåˆ«å¦„æƒ³è¿”å›å…¶reference æ¡æ¬¾22ï¼šå°†æˆå‘˜å˜é‡å£°æ˜ä¸ºprivate ä»å°è£…è§’åº¦æ¥çœ‹ï¼šå…¶å®åªæœ‰ä¸¤ç§è®¿é—®æƒé™ï¼šprivateï¼ˆæä¾›å°è£…ï¼‰å’Œå…¶ä»–ï¼ˆä¸æä¾›å°è£…ï¼Œå³publicã€protectedï¼‰\næ¡æ¬¾23ï¼šå®ä»¥non-memberã€non-friendæ›¿æ¢memberå‡½æ•° ç»“è®º å®ä»¥non-memberã€non-friendæ›¿æ¢memberå‡½æ•°ã€‚è¿™æ ·åšå¯ä»¥å¢åŠ å°è£…æ€§ã€åŒ…è£¹å¼¹æ€§å’Œæœºèƒ½æ‰©å……æ€§\nåŸå›  ä¸€ä¸ªä¾‹å­\næƒ³è±¡æœ‰ä¸€ä¸ªclassç”¨æ¥è¡¨ç¤ºç½‘é¡µæµè§ˆå™¨ã€‚classå¯èƒ½æä¾›çš„è®¸å¤šå‡½æ•°ä¸­ï¼Œæœ‰ä¸€äº›ç”¨æ¥æ¸…é™¤ä¸‹è½½å…ƒç´ é«˜é€Ÿç¼“å­˜åŒºã€æ¸…é™¤è®¿é—®è¿‡çš„URLsçš„å†å²è®°å½•ã€ä»¥åŠç§»é™¤ç³»ç»Ÿä¸­çš„æ‰€æœ‰cookiesï¼š\nclass WebBrowser{\rpublicï¼š\r...\rvoid clearCache(); //æ¸…é™¤é«˜é€Ÿç¼“å­˜\rvoid clearHistory();//æ¸…é™¤å†å²è®°å½•\rvoid removeCookies();//æ¸…é™¤cookies\r...\r}\r è®¸å¤šç”¨æˆ·æƒ³ä¸€ä¸ªå‡½æ•°æ‰§è¡Œæ‰€æœ‰åŠ¨ä½œï¼Œå› æ­¤webBrowserä¹Ÿæä¾›è¿™æ ·ä¸€ä¸ªå‡½æ•°ï¼š\næ–¹æ³•ä¸€ï¼š\rclass WebBrowser\r{\rpublic:\r...\rvoid clearEverything();//è°ƒç”¨clearCacheï¼ˆï¼‰ï¼ŒclearHistoryï¼ˆï¼‰å’ŒremoveCookiesï¼ˆï¼‰\r}\ræ–¹æ³•ä¸€çš„è¡Œä¸ºå¯ä»¥ç”±non-memberå‡½æ•°è°ƒç”¨é€‚ç”¨çš„memberå‡½æ•°è€Œæä¾›å‡ºæ¥ï¼ˆæ–¹æ³•äºŒï¼‰ï¼š\ræ–¹æ³•äºŒï¼š\rvoid clearBrowserï¼ˆWebBrowser\u0026amp; wbï¼‰\r{\rwb.clearCache(); //æ¸…é™¤é«˜é€Ÿç¼“å­˜\rwb.clearHistory();//æ¸…é™¤å†å²è®°å½•\rwb.removeCookies();//æ¸…é™¤cookies\r}\r æ–¹æ³•ä¸€ä¸æ–¹æ³•äºŒï¼Œå“ªä¸€ä¸ªæ›´å¥½ä¸€äº›å‘¢ï¼Ÿ\nä»å°è£…æ€§è€ƒè™‘ï¼Œä¸ºä¿æŠ¤æ•°æ®çš„å°è£…æ€§ï¼ˆprivateï¼‰ï¼Œåº”è¯¥é€‰æ‹©æ–¹æ³•äºŒã€‚\nå°è£…çš„ç›®çš„ï¼šæ„ˆå¤šçš„ä¸œè¥¿è¢«å°è£…ï¼Œæˆ‘ä»¬æ”¹å˜é‚£äº›ä¸œè¥¿çš„èƒ½åŠ›ä¹Ÿå°±è¶Šå¤§ã€‚æ„ˆå¤šå‡½æ•°å¯è®¿é—®å®ƒï¼Œæ•°æ®çš„å°è£…æ€§å°±æ„ˆä½ã€‚\nèƒ½å¤Ÿè®¿é—®privateæˆå‘˜å˜é‡çš„å‡½æ•°åªæœ‰classçš„memberå‡½æ•°+friendå‡½æ•°è€Œå·²ã€‚\nå› ä¸ºæˆå‘˜å‡½æ•°ï¼ˆmemberï¼‰å¯ä»¥è®¿é—®æ— é™åˆ¶çš„è®¿é—®privateçš„æ•°æ®ï¼Œè€Œnon-memberã€non-friendå‡½æ•°å¹¶ä¸èƒ½å¢åŠ â€œèƒ½è®¿é—®classå†…ä¹‹privateæˆåˆ†â€çš„æ•°æ®ã€‚\né“­è®°ï¼šå¦‚æœè¦ä½ åœ¨ä¸€ä¸ªmemberå‡½æ•°ï¼ˆå®ƒä¸åªæ˜¯å¯ä»¥è®¿é—®classå†…çš„privateæ•°æ®ï¼Œä¹Ÿå¯ä»¥å–ç”¨privateå‡½æ•°ã€enumsã€typedefsç­‰ç­‰ï¼‰å’Œä¸€ä¸ªnon-memberï¼Œnon-friendå‡½æ•°ï¼ˆå®ƒæ— æ³•è®¿é—®ä¸Šè¿°çš„ä»»ä½•ä¸œè¥¿ï¼‰ä¹‹é—´åšæŠ‰æ‹©ï¼Œè€Œä¸”ä¸¤è€…æä¾›ç›¸åŒæœºèƒ½ï¼Œé‚£ä¹ˆï¼Œå¯¼è‡´è¾ƒå¤§å°è£…æ€§çš„æ˜¯non-member non-friendå‡½æ•°ï¼Œå› æ­¤é€‰æ‹©åè€…ã€‚ æ³¨æ„ï¼šnon-memberå‡½æ•°ä¹Ÿå¯ä»¥æ˜¯å¦ä¸€ä¸ªclassçš„member\næ¡æ¬¾24ï¼šè‹¥æ‰€æœ‰å‚æ•°çš†éœ€ç±»å‹è½¬æ¢ï¼Œè¯·ä¸ºæ­¤é‡‡ç”¨non-memberå‡½æ•° ç»“è®º å¦‚æœä½ éœ€è¦ä¸ºæŸä¸ªå‡½æ•°çš„æ‰€æœ‰å‚æ•°ï¼ˆåŒ…æ‹¬è¢«thisæŒ‡é’ˆæ‰€æŒ‡çš„é‚£ä¸ªéšå–»å‚æ•°ï¼‰è¿›è¡Œç±»å‹è½¬æ¢ï¼Œé‚£ä¹ˆè¿™ä¸ªå‡½æ•°å¿…é¡»æ˜¯ä¸ªnon-member\n","id":69,"section":"categories","summary":"æ¥å£çš„è®¾è®¡ä¸å£°æ˜ æ¥å£è®¾è®¡çš„å‡†åˆ™ï¼š è®©æ¥å£å®¹æ˜“è¢«æ­£ç¡®ä½¿ç”¨ï¼Œä¸å®¹æ˜“è¢«è¯¯ç”¨ã€‚ ä»€ä¹ˆæ˜¯æ¥å£ï¼Ÿ â€‹ å†…éƒ¨å®ç°ç»†èŠ‚å°è£…èµ·æ¥ï¼Œå¤–éƒ¨ç”¨æˆ·ç”¨è¿‡é¢„ç•™çš„æ¥å£å¯ä»¥ä½¿ç”¨æ¥å£çš„","tags":["cpp","book"],"title":"ã€ŠC++ Effectiveã€‹-è¯»ä¹¦ç¬”è®°3","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/lang/c/cppeffective/3/","year":"2021"},{"content":"æ¡æ¬¾05ï¼š C++é»˜è®¤ç¼–å†™å¹¶è°ƒç”¨é‚£äº›å‡½æ•° é»˜è®¤åˆ›å»º\nclass Base\r{\rpublicï¼š\rdefualtæ„é€ å‡½æ•°\rcopyæ„é€ å‡½æ•°\rcopy assignmentæ“ä½œç¬¦\rææ„å‡½æ•°\r}\r æ¡æ¬¾06ï¼šè‹¥ä¸æƒ³ä½¿ç”¨ç¼–è¯‘å™¨è‡ªåŠ¨ç”Ÿæˆçš„å‡½æ•°ï¼Œå°±è¯¥æ˜ç¡®æ‹’ç»ï¼ˆå³ä¸å¯è¢«è°ƒç”¨ï¼‰ ä½œæ³•ï¼š\nâ€‹\tå°†é»˜è®¤åˆ›å»ºçš„å‡½æ•°å£°æ˜ä¸ºç§æœ‰çš„ï¼ˆâ€”â€”privateâ€”â€”ï¼‰ï¼Œä¸ºé˜²æ­¢memberå‡½æ•°å’Œfriendå‡½æ•°çš„å†…éƒ¨è°ƒç”¨ï¼Œå°†æˆå‘˜å‡½æ•°å£°æ˜ä¸ºprivateè€Œä¸”æ•…æ„ä¸å®ç°å®ƒä»¬\nclass HomeForSale\r{\rpublic:\rprivate:\rHomeForSale(const HomeForSale\u0026amp;);\t//åªæœ‰å£°æ˜ï¼Œä¸å®ç°å®ƒä»¬\rHomeForSale\u0026amp; operator=(const HomeForSale\u0026amp;);\r}\r æ›´ä¸ºå¸¸ç”¨çš„ä½œæ³•ï¼š è®¾è®¡ä¸€ä¸ªåŸºç±»ï¼ˆbase classï¼‰ ï¼Œåœ¨è¿™ä¸ªåŸºç±»å†…å®ç°é˜»æ­¢copyingç­‰é»˜è®¤å‡½æ•°åŠ¨ä½œï¼Œç„¶åç»§æ‰¿å®ƒã€‚\næ¡æ¬¾07ï¼šä¸ºå¤šæ€åŸºç±»å£°æ˜virtualææ„å‡½æ•° ç”¨æ³•: 1.å¦‚æœclassä¸å«virtualå‡½æ•°ï¼Œé€šå¸¸è¡¨ç¤ºå®ƒå¹¶ä¸æ„å›¾è¢«ç”¨åšä¸€ä¸ªbase classã€‚\nâ€‹\tå³ï¼šclassçš„è®¾è®¡ç›®çš„å¦‚æœä¸æ˜¯ä½œä¸ºbase classä½¿ç”¨ï¼Œæˆ–è€…ä¸æ˜¯ä¸ºäº†å…·å¤‡å¤šæ€æ€§ï¼Œå°±ä¸åº”è¯¥virtualææ„å‡½æ•°ã€‚\n2.å½“classä¸ä¼å›¾è¢«å½“åšbase classï¼Œä»¤å…¶ææ„å‡½æ•°ä¸ºvirtualå¾€å¾€æ˜¯ä¸ªé¦Šä¸»æ„\n3.å¤šæ€æ€§è´¨çš„base classesåº”è¯¥å£°æ˜ä¸€ä¸ªvirtualææ„å‡½æ•°ï¼Œå¦‚æœclasså¸¦æœ‰ä»»ä½•virtualå‡½æ•°ï¼Œä»–å°±åº”è¯¥æ‹¥æœ‰ä¸€ä¸ªvirtualææ„å‡½æ•°\nç›®çš„ï¼š 1.C++ä¸­åŸºç±»é‡‡ç”¨virtualè™šææ„å‡½æ•°æ˜¯ä¸ºäº†é˜²æ­¢å†…å­˜æ³„æ¼ã€‚\n2.å‡è®¾åŸºç±»ä¸­é‡‡ç”¨çš„æ˜¯éè™šææ„å‡½æ•°ï¼Œå½“åˆ é™¤åŸºç±»æŒ‡é’ˆæŒ‡å‘çš„æ´¾ç”Ÿç±»å¯¹è±¡æ—¶å°±ä¸ä¼šè§¦å‘åŠ¨æ€ç»‘å®šï¼Œå› è€Œåªä¼šè°ƒç”¨åŸºç±»çš„ææ„å‡½æ•°ï¼Œè€Œä¸ä¼šè°ƒç”¨æ´¾ç”Ÿç±»çš„ææ„å‡½æ•°\nå¯å‚è€ƒblog  https://blog.csdn.net/sinat_20265495/article/details/51775724?ops_request_misc=\u0026amp;request_id=\u0026amp;biz_id=102\u0026amp;utm_term=%E6%9E%90%E6%9E%84%E5%87%BD%E6%95%B0%20virtual\u0026amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-8-.pc_search_result_before_js\u0026amp;spm=1018.2226.3001.4187 https://blog.csdn.net/yhc166188/article/details/81587442?ops_request_misc=%7B%22request%5Fid%22%3A%22162622287916780261951132%22%2C%22scm%22%3A%2220140713.130102334.pc%5Fall.%22%7D  æ¡æ¬¾08ï¼šè¢«è®©å¼‚å¸¸é€ƒç¦»ææ„å‡½æ•° ###ã€€ç»“è®º\nï¼‘ï¼ææ„å‡½æ•°ç»å¯¹ä¸è¦åå‡ºå¼‚å¸¸ã€‚å¦‚æœä¸€ä¸ªè¢«ææ„å‡½æ•°è°ƒç”¨çš„å‡½æ•°å¯èƒ½æŠ›å‡ºå¼‚å¸¸ï¼Œææ„å‡½æ•°åº”è¯¥æ•æ‰ä»»ä½•å¼‚å¸¸ï¼Œç„¶ååä¸‹å®ƒä»¬ï¼ˆä¸ä¼ æ’­ï¼‰æˆ–ç»“æŸç¨‹åºã€‚\nï¼’ï¼å¦‚æœå®¢æˆ·éœ€è¦å¯¹æŸä¸ªæ“ä½œå‡½æ•°è¿è¡ŒæœŸé—´æŠ›å‡ºçš„å¼‚å¸¸åšå‡ºååº”ï¼Œé‚£ä¹ˆclassåº”è¯¥æä¾›ä¸€ä¸ªæ™®é€šå‡½æ•°ï¼ˆè€Œéåœ¨ææ„å‡½æ•°ä¸­ï¼‰æ‰§è¡Œè¯¥æ“ä½œã€‚\nåŸå›   ä¸ºä»€ä¹ˆææ„å‡½æ•°ä¸åº”åå‡ºå¼‚å¸¸ï¼Ÿ\nvectorçš„ä½¿ç”¨\nclass widget{\rpublic:\r~widget(){}\t//å‡è®¾åå‡ºä¸€ä¸ªå¼‚å¸¸\r}\rvoid dosomething()\r{\rstd::vector\u0026lt;Widget\u0026gt; v;\r}\t//våœ¨è¿™é‡Œè¢«è‡ªåŠ¨é”€æ¯\r å‡è®¾vå†…å«åä¸ªWidgets,è€Œåœ¨ææ„ç¬¬ä¸€ä¸ªå…ƒç´ æœŸé—´ï¼Œæœ‰ä¸€ä¸ªå¼‚å¸¸è¢«æŠ›å‡ºï¼Œå…¶ä»–ä¹ä¸ªwidgetsè¿˜æ˜¯åº”è¯¥è¢«é”€æ¯ã€‚\nè¿™ä¼šå¯¼è‡´å¤šä¸ªå¼‚å¸¸åŒæ—¶å­˜åœ¨ï¼Œç¨‹åºä¼šç»“æŸæ‰§è¡Œæˆ–å¯¼è‡´ä¸æ˜ç¡®è¡Œä¸ºã€‚ï¼ˆç»“è®º1ï¼‰\n è‹¥ææ„å‡½æ•°éœ€è¦åå‡ºå¼‚å¸¸ï¼Œæ€ä¹ˆåŠ?\nä¸€ä¸ªä¾‹å­ï¼š æ•°æ®åº“çš„è¿æ¥ï¼Œåˆ›å»ºä¸€ä¸ªç”¨æ¥ç®¡ç†DBConnectionèµ„æºçš„classï¼Œå¹¶åœ¨å…¶ææ„å‡½æ•°ä¸­è°ƒç”¨closeï¼ˆï¼‰ã€‚ä½†closeï¼ˆï¼‰å‡½æ•°å¯èƒ½å…³é—­å¤±è´¥ï¼Œä»è€Œè¾“å‡ºå¼‚å¸¸ã€‚\nclass DBConn\r{\rpublic:\r~DBConn()//ç¡®ä¿æ•°æ®åº“è¿æ¥æ€»æ˜¯ä¼šè¢«å…³é—­\r{\rdb.close();//å¯èƒ½ä¼šå…³é—­å¤±è´¥ï¼Œè¾“å‡ºå¼‚å¸¸\r}\rprivate:\rDBConnection db;\r}\r å¦‚æœcloseï¼ˆï¼‰å¤±è´¥ï¼Œé‚£ä¹ˆå¼‚å¸¸ä¼šç¦»å¼€~DBConnï¼ˆï¼‰ææ„å‡½æ•°ï¼Œæˆä¸ºéº»çƒ¦ã€‚åº”è¯¥é˜»æ­¢å¼‚å¸¸ä»ææ„å‡½æ•°ä¸­ä¼ æ’­å‡ºå»ã€‚\nè§£å†³åŠæ³•ï¼š 1.å¦‚æœcloseæŠ›å‡ºå¼‚å¸¸å°±ç»“æŸç¨‹åºã€‚é€šå¸¸é€šè¿‡è°ƒç”¨abortå®Œæˆï¼š\nå³ï¼š\nDBConn::~DBConn()\r{\rtry{db.close();}\rcatch(...){\råˆ¶ä½œè¿è½¬è®°å½•ï¼Œè®°å½•å¯¹closeï¼ˆï¼‰çš„è°ƒç”¨å¤±è´¥ï¼ˆå³æ—¥å¿—åº“ï¼‰;\rstd::abort();\r}\r}\r 2.åä¸‹å› è°ƒç”¨closeè€Œå‘ç”Ÿçš„å¼‚å¸¸ï¼ˆå³å¯¹å‘ç”Ÿçš„å¼‚å¸¸ï¼Œcatchä¸­ä¸åšå¤„ç†ï¼‰ï¼š\nDBConn::~DBConn()\r{\rtry{db.close();}\rcatch(...){\råˆ¶ä½œè¿è½¬è®°å½•ï¼Œè®°å½•å¯¹closeï¼ˆï¼‰çš„è°ƒç”¨å¤±è´¥ï¼ˆå³æ—¥å¿—åº“ï¼‰;\r}\r}\r å…·ä½“åšæ³• é‡æ–°è®¾è®¡DBConnæ¥å£,ç»™å®¢æˆ·ä¸€ä¸ªå…³é—­closeå‡½æ•°çš„æœºä¼š\nclass DBConn{\rpublicï¼š\r...\rvoid closeï¼ˆï¼‰//ä¾›å®¢æˆ·ä½¿ç”¨çš„æ–°å‡½æ•°\r{\rdb.close();\rclosed=true;\r}\r~DBConn()\r{\rif(!closed)\r{\rtry{\rdb.close();\t//å…³é—­è¿æ¥ï¼ˆå¦‚æœå®¢æˆ·ä¸ä¸»åŠ¨å…³é—­ï¼‰\r}\rcatch(...){\t//å¦‚æœå…³é—­åŠ¨ä½œå¤±è´¥\råˆ¶ä½œè¿è½¬è®°å½•ï¼Œè®°å½•å¯¹closeçš„è°ƒç”¨å¤±è´¥ï¼›//è®°å½•ä¸‹æ¥å¹¶ç»“æŸç¨‹åº æˆ– åä¸‹å¼‚å¸¸\r} }\r}\rprivateï¼š\rDBConnectin db;\rbool closed; }\r æ¡æ¬¾09ï¼šç»ä¸åœ¨æ„é€ å’Œææ„å‡½æ•°è¿‡ç¨‹ä¸­è°ƒç”¨virtualå‡½æ•° ###ã€€ç»“è®º\nåœ¨æ„é€ å’Œææ„æœŸé—´ä¸è¦è°ƒç”¨virtualå‡½æ•°ï¼Œå› ä¸ºè¿™ç±»è°ƒç”¨ä»ä¸ä¸‹é™è‡³derived class\nåŸå›  ä¸€ä¸ªä¾‹å­ï¼š\næ¨¡æ‹Ÿè‚¡å¸‚äº¤æ˜“å¦‚ä¹°è¿›ã€å–å‡ºçš„è®¢å•ç­‰ï¼Œæ¯å½“åˆ›å»ºä¸€ä¸ªäº¤æ˜“å¯¹è±¡ï¼Œåœ¨å®¡è®¡æ—¥å¿—ä¸­ä¹Ÿéœ€è¦åˆ›å»ºä¸€ç¬”é€‚å½“çš„è®°å½•ã€‚\nåŸºç±»\rclass Transaction{\t//æ‰€æœ‰äº¤æ˜“çš„base class\rpublic:\rTransaction();\rvirtual void logTransaction() const = 0;//åšå‡ºä¸€ä»½å› ç±»å‹ä¸åŒè€Œä¸åŒçš„æ—¥å¿—è®°å½•\r};\rTransaction::Transaction()\r{\r.....\rlogTransaction();\t//é—®é¢˜ç‚¹\r}\rå­ç±»\rclass BuyTansaction:public Transaction{\rpublic:\rvirtual void logTransaction() const; //logæ­¤è®°å½•\r....\r} class SellTansaction:public Transaction{\rpublic:\rvirtual void logTransaction() const; //logæ­¤è®°å½•\r....\r} BuyTrasaction b;\r å½“BuyTrasaction båï¼Œé¦–å…ˆTransactionæ„é€ å‡½æ•°ä¸€å®šä¼šè¢«å…ˆè°ƒç”¨ï¼Œç„¶åBuyTransactionæ„é€ å‡½æ•°è¢«è°ƒç”¨ã€‚\nTransaction::Transaction()ä¸­çš„logTransaction()å‡½æ•°æ‰§è¡Œçš„base classä¸­çš„logTransactionã€‚\nè§£å†³æ–¹æ³• åœ¨class Transactionå†…å°†logTransactionå‡½æ•°æ”¹ä¸ºnon-virtualï¼Œç„¶åè¦æ±‚derived classæ„é€ å‡½æ•°ä¼ é€’å¿…è¦ä¿¡æ¯ç»™Transactionæ„é€ å‡½æ•°ï¼Œè€Œåé‚£ä¸ªæ„é€ å‡½æ•°ä¾¿å¯å®‰å…¨åœ°è°ƒç”¨non-virtual logTransactionã€‚\nå³ï¼Œé€šè¿‡æ„é€ å‡½æ•°çš„å‚æ•°ä¼ é€’\n è™šå‡½æ•°æ˜¯ä»base classå‘ä¸‹è°ƒç”¨ã€‚ dervice classå°†å¿…è¦çš„æ„é€ ä¿¡æ¯å‘ä¸Šä¼ é€’è‡³base classæ„é€ å‡½æ•°ã€‚  æ³¨æ„å½¢å‚\rclass Transaction\r{\rpublicï¼š\rexplicit Transaction(const std::string\u0026amp; logInfo);\rvoid logTransaction(const std::string\u0026amp; logInfo) const;//å¦‚ä»Šæ˜¯ä¸€ä¸ªnon-virtualå‡½æ•°\r....\r};\rTransaction::Transacton(const std::string\u0026amp; logInfo)\r{\r...\rlogTransaction(logInfo)\r}\rclass BuyTransaction:public Transaction{\rpublic:\rBuyTransaction( parameters ): Transactionï¼ˆcreateLogStringï¼ˆparameterï¼‰ï¼‰//å°†logä¿¡æ¯ä¼ ç»™base classæ„é€ å‡½æ•°\r{\r...\r}\r...\rprivate:\rstatic std::string createLogString( parameter );//æ³¨æ„è¿™ä¸ªå‡½æ•°è¿”å›stringç±»å‹ï¼Œ å‡½æ•°æ˜¯staticç±»å‹çš„ï¼Œå¯ä»¥ä½œä¸ºæ„é€ å‡½æ•°çš„å‚æ•°ä½¿ç”¨\r}\r å‡½æ•°ä½¿ç”¨staticç±»å‹ï¼Œä½¿ä¹‹ä¸å¯èƒ½æ„å¤–æŒ‡å‘â€œåˆæœŸæœªæˆç†Ÿä¹‹BuyTransactionå¯¹è±¡å†…éƒ¨å°šæœªåˆå§‹åŒ–çš„æˆå‘˜å˜é‡â€ã€‚\n","id":70,"section":"categories","summary":"æ¡æ¬¾05ï¼š C++é»˜è®¤ç¼–å†™å¹¶è°ƒç”¨é‚£äº›å‡½æ•° é»˜è®¤åˆ›å»º class Base { publicï¼š defualtæ„é€ å‡½æ•° copyæ„é€ å‡½æ•° copy assignmentæ“ä½œç¬¦ ææ„å‡½æ•°","tags":["cpp","book"],"title":"ã€ŠC++ Effectiveã€‹-è¯»ä¹¦ç¬”è®°1","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/categories/lang/c/cppeffective/1/","year":"2021"}],"tags":[{"title":"blog","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/tags/blog/"},{"title":"book","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/tags/book/"},{"title":"c ","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/tags/c/"},{"title":"cmake","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/tags/cmake/"},{"title":"command","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/tags/command/"},{"title":"cpp","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/tags/cpp/"},{"title":" docker","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/tags/docker/"},{"title":" git","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/tags/git/"},{"title":"linux","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/tags/linux/"},{"title":" math","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/tags/math/"},{"title":" matlab","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/tags/matlab/"},{"title":"net","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/tags/net/"},{"title":" project","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/tags/project/"},{"title":" python","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/tags/python/"},{"title":"raspberry","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/tags/raspberry/"},{"title":"robat ","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/tags/robat/"},{"title":"ros","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/tags/ros/"},{"title":"slam ","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/tags/slam/"},{"title":"tool","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/tags/tool/"},{"title":" ubuntu","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/tags/ubuntu/"},{"title":" vscode","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/tags/vscode/"},{"title":" wsl1","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/tags/wsl1/"},{"title":"xmake","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/tags/xmake/"},{"title":"å¯¼èˆª","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/tags/%E5%AF%BC%E8%88%AA/"},{"title":"æ¦‚ç‡è®º","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/tags/%E6%A6%82%E7%8E%87%E8%AE%BA/"},{"title":"çŸ©é˜µ","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/tags/%E7%9F%A9%E9%98%B5/"},{"title":"çº¿æ€§ä»£æ•°","uri":"https://blog-0g8860131649bb29-1304987963.tcloudbaseapp.com/tags/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/"}]}